"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["26003"],{621551:function(e,t,n){n.d(t,{Z:function(){return I}});var i=n("563097"),o=n("88648"),r=n("448058"),a=n("713097"),l=n.n(a),s=n("621631"),u=n("651889"),c=n("473677"),d={Hint:"CXnDoue8",failIcon:"G4ot1zPd",textBox:"Io2TGw1Z"},_=n("129150");n("250440");var m=n("763468"),v=n("492163"),f=n("676106");let{ConversationType:p}=s.m,{GROUP_CHAT:h,ONE_TO_ONE_CHAT:g}=p;var w=n("684207"),E=n("81849");let{ConversationType:y}=s.m,{ONE_TO_ONE_CHAT:N}=y;var I=(0,r.inject)("imStore")((0,r.observer)(e=>{var t;let n;let{imStore:r,className:a,converSation:s,lastMessage:p,ext:g,flightStatus:y,participantType:I=_.tQ.REGULAR,showDraft:S=!0,isNeedFilterDraftMessage:T=!1}=e,{id:R}=s||{},{unSendMsgConversationMap:L,userInfoFromServerMap:k,userInfoFromSdkMap:C}=r,P=null==L?void 0:L[R],{visible:b,isFromMe:O,content:x,sender:U,conversationId:A,conversationType:M}=p||{},D=y===u.b3.Failed||y===u.b3.Rejected,j=null==C?void 0:null===(t=C[A])||void 0===t?void 0:t[U],Z=null==k?void 0:k[U];if(!p&&(null==s?void 0:s.type)===N){let{toParticipantUserId:e}=s||{};n=null==k?void 0:k[e]}let G=(0,o.useMemo)(()=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_.tQ.REGULAR,n=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],{id:o,lastVisibleMessage:r,toParticipantUserId:a}=e||{};if(!r){let{userInfoFromServerMap:e}=v.Z,t=(null==e?void 0:e[a])||{},n=(null==t?void 0:t.remark_name)||(null==t?void 0:t.nickname)||a||"",i=n?`和“${n}”`:"";return`${i}打个招呼吧`}let{type:l,visible:s,isFromMe:u,content:c,sender:d,conversationId:p,conversationType:g,flightStatus:w}=r,{unSendMsgConversationMap:E,userInfoFromSdkMap:y,userInfoFromServerMap:N,abTestData:I}=v.Z,S=E[p],T="";if(S&&n&&!i)return`[草稿]${S.text}`;T=(0,m.gc)(r,!0);let R="";t===_.tQ.STRANGER?R=function(e){var t;let n="";if(!e)return n;let{type:i,visible:o,isFromMe:r,content:a,sender:l,conversationId:s,conversationType:u,isRecalled:c}=e,{unSendMsgConversationMap:d,userInfoFromSdkMap:_,userInfoFromServerMap:m}=v.Z,f=null==_?void 0:null===(t=_[s])||void 0===t?void 0:t[l],p=null==m?void 0:m[l],h=(null==p?void 0:p.remark_name)||(null==f?void 0:f.alias)||(null==p?void 0:p.nickname)||"";return n=c?`“${h}”`:`${h}：`}(r):t===_.tQ.REGULAR&&(R=function(e){let t="";if(!e)return t;let{type:n,visible:i,isFromMe:o,content:r,sender:a,conversationId:l,conversationType:s,isRecalled:u}=e,{unSendMsgConversationMap:c,userInfoFromSdkMap:d,userInfoFromServerMap:_}=v.Z,m=[f.pp.GROUP_NOTICE_MESSAGE,f.pp.GROUP_GREET_MESSAGE,f.pp.GROUP_ANNOUNCEMENT_MESSAGE];if(s===h&&!m.includes(n)||u&&!o){var p;let e=null==d?void 0:null===(p=d[l])||void 0===p?void 0:p[a],n=null==_?void 0:_[a],i=(null==n?void 0:n.remark_name)||(null==e?void 0:e.alias)||(null==n?void 0:n.nickname)||"";t=u?`“${i}”`:`${i}：`}return t}(r));let L="";return R&&(L+=R),T&&(L+=T),L||""})(s,I,S,T),[j,Z,s,p,g,y,null==P?void 0:P.text,S,n]),B=(0,o.useMemo)(()=>w.O.getIsSaasPopup()?(0,m.gc)(p,!0):"",[p]);return(0,i.jsxs)("div",{className:l()(a,d.Hint),children:[D&&(0,i.jsx)(c.Z,{className:d.failIcon,src:E.Z,viewBox:"0 0 14 14"}),(0,i.jsx)("pre",{className:d.textBox,children:w.O.getIsSaasPopup()?B:G})]})}))},456798:function(e,t,n){n.r(t),n.d(t,{default:function(){return et}});var i=n("520739"),o=n("563097"),r=n("88648"),a=n("448058"),l=n("713097"),s=n.n(l),u=n("35730"),c=n("746025"),d=n("637005"),_=n("33626"),m="sny3V6GP";n("675373"),n("874386"),n("779788"),n("268917");var v=n("338426"),f=n("652571"),p=n("621631"),h=n("747909"),g=n("739898"),w=n("408609"),E=n("399796"),y=n("32167"),N=n("616520"),I=n("561550"),S=n("30321"),T=n("572076"),R=n("696332"),L=n("490913"),k=n("472570"),C=n("260693"),P=n("416049"),b=n("387572"),O=n("60491"),x=n("358003"),U=n("457815"),A=n("347812"),M=n("72726"),D=n("958829"),j=n("478063"),Z=n("295847"),G=n("254897"),B=n("732218");let V=(0,v.ZP)(()=>Promise.all([n.e("74792"),n.e("23503"),n.e("99019"),n.e("14243"),n.e("51608"),n.e("39906"),n.e("59218")]).then(n.bind(n,44392)),{resolveComponent:e=>e.PopDialog,ssr:!1}),F="dlg-active",Y="dlb-login-guide-active",H=r.forwardRef((e,t)=>{let{hoverTimes:n,newHeaderIsNew:i,changeType:r,abTestData:a}=e,l=("boolean"==typeof i?i:1===n)?"1":"0";return(0,o.jsx)("div",{className:k.default.imLoginGuidePanelWrapper,children:(0,o.jsxs)("div",{ref:t,className:k.default.imLoginGuidePanel,children:[(0,o.jsx)("p",{className:k.default.desc,children:"登录后即可查看私信消息"}),(0,o.jsx)("div",{className:k.default.loginBtn,onClick:()=>{var e,t;null==r||r("",!0),(0,x.navShowAccount)({success:()=>{window.location.reload()},headerText:"登录后即可查看私信消息",next:`${w.tJ}${null===(t=window)||void 0===t?void 0:null===(e=t.location)||void 0===e?void 0:e.host}`,enterMethod:"IM",teaEvtParams:{is_new:l,is_guide:"1",enter_method:"IM"}})},children:"立即登录"})]})})}),W=(0,a.inject)("imStore")((0,a.observer)(e=>{let{isLogin:t,imStore:n={},abTestData:i,customProps:a,transparent:l,uInfo:c}=e,{allUnReadCount:_,curConversation:m={},maskIsTestGroupClickConversionListItem:v}=n,w=(0,f.Z)(t?_:0,300),{type:x,changeType:W,clearShowTimer:J}=(0,C.P)({delayDisappear:200,delayShow:100}),K=(0,r.useRef)();E.Q.getItem({sKey:u.CookieKeys.DouyinWebHideImLoginGuide});let $=(0,r.useRef)(null),Q=(0,r.useRef)(null),[X,q]=(0,r.useState)(0);(0,r.useEffect)(()=>{n.setAbTestData(i)},[i]),(0,r.useEffect)(()=>{w>0&&(0,P.G)("chat_notif_show",{badge_num:w})},[w]);let z=(0,r.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(t){if(W(F),n.clearAllPushList(),d.emit(d.EVENT.showPushList,{from:"im",isShow:!1}),d.emit(d.EVENT.showHeaderPopUp,{type:"im",isShow:!0}),x!==F){var i,o,r;Z.Z.mark("im_dialog_open",{detail:e}),e&&n.setEnterConversation(e),(0,P.G)("chat_notif_hover",{badge_num:w,enter_method:e||n.enterConversation||"",enter_from:(0,y.vM)()||"",url_source:null!==(r=null===(i=(0,N.pf)(null===(o=location)||void 0===o?void 0:o.href))||void 0===i?void 0:i.urlSource)&&void 0!==r?r:""})}}else W(Y),d.emit(d.EVENT.showHeaderPopUp,{type:"im",isShow:!0});let a=$.current;a&&clearTimeout(a),$.current=null},[t,x]),ee=(0,r.useCallback)(async e=>{let{uid:t,enterMethod:i,groupInfo:o,callback:r}=e||{};if((0,I.sF)()&&!(0,I.kB)()&&!(0,S.Nr)(location.pathname)){T.asyncCall("webview:im:sendImUserMsg",{uid:t,enterMethod:i,groupInfo:o});return}if(o){let{id:e,shortId:t,type:a=2,inboxType:l=0,invitorUserId:s,sourceType:u=7,isAutoAdd:d}=o,_=!1;if(d){let n=await U.ImSdk.addParticipants({conversation:{id:e,shortId:t,type:a,inboxType:l,coreInfo:{inboxType:l}},participant:[`${c.uid}`],bizExt:{track_enter_from:"pc-im",invitation:JSON.stringify({invitee:{source_app_id:6383},invitor:{im_user_id:s},source_type:u})}});if(null==n?void 0:n.checkMsg)try{let e=JSON.parse(n.checkMsg);(null==e?void 0:e.status_code)===0||(null==e?void 0:e.status_code)===7549?(null==r||r({isSuccess:!0,result:n,errorMessage:""}),_=!0):null==r||r({isSuccess:!1,result:n,errorMessage:"checkMsg.status_code error"})}catch(e){null==r||r({isSuccess:!1,result:n,errorMessage:"parse checkMsg json error"})}else null==r||r({isSuccess:!1,result:n,errorMessage:"not success"})}else _=!0;if(_){let t=await U.ImSdk.getConversationByIdWithOnline({conversationId:e,shortId:e,type:p.m.ConversationType.GROUP_CHAT});if(t){if(U.ImSdk.setCurConversation(),n.setIsInStrangerConversationList(!1),U.ImSdk.setCurConversation(t,"openOrCreateConversationDetail1"))return;i&&n.setEnterConversation(i),n.setConversationPullUp(t),n.setSelectChatUserShortId(t.shortId),z(i)}}}else t&&(U.ImSdk.setCurConversation(),n.setIsInStrangerConversationList(!1),U.ImSdk.getConversationWithUid(t).then(e=>{if(e){if(i&&n.setEnterConversation(i),!U.ImSdk.setCurConversation(e,"openOrCreateConversationDetail2"))n.setConversationPullUp(e),n.setSelectChatUserShortId(e.shortId),z(i)}}))},[z]);(0,j.Z)({openOrCreateConversationDetail:ee,openDlg:z});let et=(0,A.w)();(0,r.useEffect)(()=>{Z.Z.mark("im_content_component_mount")},[]),(0,r.useEffect)(()=>{let e=d.listen(d.EVENT.sendImUserMsg,ee),t=d.listen(d.EVENT.openImConversation,e=>{let{conversationId:t,enterMethod:i}=e;try{if((0,I.sF)()&&!(0,I.kB)()&&!(0,S.Nr)(location.pathname)){T.asyncCall("webview:im:openImConversation",{conversationId:t,enterMethod:i});return}if(U.ImSdk.setCurConversation(),t){if("stranger"!==t){n.setIsInStrangerConversationList(!1);let e=U.ImSdk.getConversationById(t);if(e&&U.ImSdk.setCurConversation(e,"openImModalHandler"))return;i&&n.setEnterConversation(i),z(i)}else t&&(n.setIsOpenMessageList(!0),n.setMaskIsTestGroupClickConversionListItem(!0),n.setIsInStrangerConversationList(!0),z(i))}else n.setIsOpenMessageList(!0),z(i);et(),U.ImSdk.syncToTray()}catch(e){}}),i=d.listen(d.EVENT.closeImConversation,()=>{W(void 0,!0)});return()=>{e(),t(),i()}},[z]),(0,r.useEffect)(()=>{x!==Y||t||(0,P.G)("im_login_notify",{is_new:0===X?"1":"0"})},[x]),(0,r.useEffect)(()=>{n.setDlgShow(x===F)},[x]);let en=(0,r.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!x){d.emit(d.EVENT.showPushList,{from:"im",isShow:!0}),J();return}W(void 0,!0===e),Z.Z.mark("im_dialog_close"),q(e=>e+1);let t=setTimeout(()=>{d.emit(d.EVENT.showPushList,{from:"im",isShow:!0})},230);$.current=t,g.YY.finishTask(g.BE.HoverTaskId),U.ImSdk.syncToTray()},[x]);return(0,r.useEffect)(()=>{let e=e=>{U.ImSdk.syncToTray()};return document.addEventListener("visibilitychange",e),window.addEventListener("focus",e),window.addEventListener("blur",e),()=>{document.removeEventListener("visibilitychange",e),window.removeEventListener("focus",e),window.removeEventListener("blur",e)}},[]),(0,r.useEffect)(()=>{x||d.emit(d.EVENT.showHeaderPopUp,{type:"im",isShow:!1})},[x]),(0,r.useEffect)(()=>{let e=d.listen(d.EVENT.showHeaderPopUp,e=>{let{type:t,isShow:n}=e||{};n&&"im"!==t&&!m&&en(!0),n&&("im"===t?Q.current&&clearTimeout(Q.current):en(!0))});return()=>e()},[m,en]),(0,r.useEffect)(()=>{let e=d.listen(d.EVENT.clickPush,e=>{let{type:n}=e||{};if("im"===n){if(t&&(0,B.Z)()){d.emit(d.EVENT.showPushList,{from:"im",isShow:!1});return}z(D.Q.push)}});return()=>e()},[z]),(0,r.useEffect)(()=>()=>{Q.current&&clearTimeout(Q.current)},[]),(0,r.useEffect)(()=>{if(!!m)!v&&n.setMaskIsTestGroupClickConversionListItem(!0),n.setSelectChatUserShortId(null==m?void 0:m.shortId)},[m]),(0,r.useEffect)(()=>{(0,I.x1)()&&T.asyncCall("webview:im:setUnReadCount",{unReadCount:w})},[w]),(0,o.jsx)("div",{"data-e2e":"im-entry",className:k.default.cicleButtonWithText,children:(0,o.jsxs)(M.Y,{needRenderInSSR:!0,type:"circleButtonWithText",text:R.a.t("private_message",{},"私信"),onMouseEnter:e=>{!(0,b.i)(e.target,e=>(null==e?void 0:e.id)==="pushListBoxId")&&z(D.Q.hover_icon)},onMouseLeave:()=>{if(!m)Q.current&&clearTimeout(Q.current),en()},svg:(0,o.jsx)(G.z,{svg:(0,o.jsx)(L.Z,{className:k.default.semiIcon}),needRenderInSSR:!0}),activityName:null==a?void 0:a.activityName,headerPopupName:"im",className:k.default.polymorphicButton,transparent:l,children:[(0,o.jsx)("div",{className:s()(k.default.popNum,{isLight:(null==a?void 0:a.isActivity)||l}),children:!!w&&(0,o.jsx)(h.Badge,{countClassName:s()(k.default.PopStyle,{[k.default.digitsNumberPop]:w<10,[k.default.numberPoint]:w>=10}),count:w,overflowCount:99})}),x===Y?(0,o.jsx)(H,{ref:K,newHeaderIsNew:1===X,changeType:W,abTestData:i}):x===F?(0,o.jsx)(V,{closeFn:en,customProps:a}):null,(0,o.jsx)(O.Z,{})]})})}));var J=n("492163"),K=n("129150"),$=n("233570"),Q=n("668118"),X=n("438607"),q=n("874204"),z=n("703785"),ee=()=>{(0,r.useEffect)(()=>{(async()=>{var e,t;(null===(t=J.Z.abTestData)||void 0===t?void 0:null===(e=t.pc_im_new_window)||void 0===e?void 0:e.open_type)&&(await U.ImSdk.bytedIMInstanceDeferred.promise,(0,z.l)(()=>{(0,q.At)().preloadRemote([{nameOrAlias:"im"}])}))})()},[J.Z.abTestData])},et=e=>{let{isLogin:t,uInfo:n,customProps:l,className:v,initImSDK:f=!0,abTestData:p}=e,h=r.useRef();return(0,r.useEffect)(()=>{J.Z.setCurUserInfo(n)},[t,n,f]),(0,X.Z)({isLogin:t,info:n},f),r.useLayoutEffect(()=>{Z.Z.mark("im_entry_component_mount");let e=performance.now(),t=Z.Z.get("set_sdk_ready");(0,P.G)("pc_im_entry_show",{duration:e,domComplete:Z.Z.performanceNavigationTiming.domComplete,ready_type:null==t?void 0:t.detail})},[]),(0,Q.Z)(p),ee(),(0,r.useEffect)(()=>($.Z.log("ImEntry load"),()=>{if($.Z.log("ImEntry unload"),h.current){var e,t;null===(t=h.current)||void 0===t||null===(e=t.tryStart)||void 0===e||e.call(t,!1,{})}}),[]),(0,r.useEffect)(()=>{J.Z.setDownloadInfo({showDownload:!0})},[]),(0,r.useEffect)(()=>{let e=(0,c.Dr)(E.Q.getItem({sKey:u.CookieKeys.Theme}));e!==K.rS.light&&e!==K.rS.dark?J.Z.setTheme(K.rS.dark):J.Z.setTheme(e);let t=d.listen(d.EVENT.changeTheme,e=>{let{theme:t}=e;J.Z.setTheme(t)});return()=>{t()}},[]),(0,r.useEffect)(()=>{let e=d.listen(d.EVENT.userBlockEvent,e=>{let{uid:t,isBlock:n}=e;J.Z.setUserInfoBlockStatus(t,n)});return()=>{e()}},[]),(0,r.useEffect)(()=>(_.m.startInterval(),()=>{_.m.stopInterval()}),[]),(0,o.jsx)("li",{className:s()(m,v),children:(0,o.jsx)(a.Provider,{imStore:J.Z,children:(0,o.jsx)(W,(0,i._)({},e))})})}},129150:function(e,t,n){n.d(t,{$u:function(){return i},DK:function(){return g},GB:function(){return a},Hv:function(){return h},IM:function(){return f},Lo:function(){return u},XJ:function(){return s},_3:function(){return E},_t:function(){return y},dF:function(){return m},de:function(){return w},dx:function(){return l},eD:function(){return d},eY:function(){return c},pt:function(){return v},ql:function(){return _},rS:function(){return r},tQ:function(){return p},vW:function(){return o}});var i={FollowRelationUnknown:-1,"-1":"FollowRelationUnknown",NoRelationStatus:0,0:"NoRelationStatus",FollowingStatus:1,1:"FollowingStatus",FollowEachOtherStatus:2,2:"FollowEachOtherStatus",FollowRequestStatus:4,4:"FollowRequestStatus"},o={Created:0,0:"Created",Preparing:1,1:"Preparing",Inflight:2,2:"Inflight",Succeeded:3,3:"Succeeded",Received:4,4:"Received",Failed:-1,"-1":"Failed",Rejected:-2,"-2":"Rejected",SelfVisible:-3,"-3":"SelfVisible"},r={light:"light",dark:"dark"},a={MEMBER:0,0:"MEMBER",OWNER:1,1:"OWNER",ADMIN:2,2:"ADMIN"},l={SCENE_TYPE_DEFAULT:0,0:"SCENE_TYPE_DEFAULT",SCENE_TYPE_REPLY_OTHER:1,1:"SCENE_TYPE_REPLY_OTHER",SCENE_TYPE_REPLY_SELF:2,2:"SCENE_TYPE_REPLY_SELF",SCENE_TYPE_AWEME_MENTION:3,3:"SCENE_TYPE_AWEME_MENTION",SCENE_TYPE_COMMENT_MENTION:4,4:"SCENE_TYPE_COMMENT_MENTION",SCENE_TYPE_SHARE:5,5:"SCENE_TYPE_SHARE",SCENE_TYPE_REPLY_INPUT:6,6:"SCENE_TYPE_REPLY_INPUT",SCENE_TYPE_NOTICE_REPLY_DIGG:7,7:"SCENE_TYPE_NOTICE_REPLY_DIGG",SCENE_TYPE_NOTICE_REPLY_COMMENT:8,8:"SCENE_TYPE_NOTICE_REPLY_COMMENT",SCENE_TYPE_NOTICE_REPLY_ATME:9,9:"SCENE_TYPE_NOTICE_REPLY_ATME"},s={AVAILABLE:0,0:"AVAILABLE",NOT_EXTST:1,1:"NOT_EXTST",INVISIBLE:2,2:"INVISIBLE",RECALLED:3,3:"RECALLED",DELETED:4,4:"DELETED"},u={AUDIT_NOT_PASS:1,1:"AUDIT_NOT_PASS",AUDIT_ONLY_SELF:2,2:"AUDIT_ONLY_SELF",REVIEWING:3,3:"REVIEWING",ONLY_FRIEND:4,4:"ONLY_FRIEND",ONLY_SELF:5,5:"ONLY_SELF",AUTHOR_SECRET:6,6:"AUTHOR_SECRET",DELETE:7,7:"DELETE",UNKNOWN:8,8:"UNKNOWN",STORY:9,9:"STORY",PART_SEE:10,10:"PART_SEE"},c={CHAT_NOTIFY:"chat_notif",CHAT_PANEL:"chat_panel",PUSH:"push",CLIENT_PUSH:"client_push"},d={GROUP:"group",PRIVATE:"private"},_={SYSTEM:"system",RECOMMAND:"recommend",INTERACTION:"interaction",FAVORITE:"favorite"},m={CHAT:"chat",CHAT_HEAD:"chat_head",CHAT_LIST:"chat_list"},v={CHAT:"chat"},f={ISME:"1",NOISME:"0"},p={REGULAR:0,0:"REGULAR",STRANGER:1,1:"STRANGER"},h={REGULAR:0,0:"REGULAR",REGULAR_USER:1,1:"REGULAR_USER",REGULAR_GROUP:2,2:"REGULAR_GROUP",REGULAR_SELF:3,3:"REGULAR_SELF",STARNGER_ITEM:4,4:"STARNGER_ITEM",STRANGER_BOX:5,5:"STRANGER_BOX",REGULAR_DAREN_USER:6,6:"REGULAR_DAREN_USER"},g={INIT_VALUE:0,0:"INIT_VALUE",DELETE_CONVERSATION:1,1:"DELETE_CONVERSATION",STICK_ON_TOP:2,2:"STICK_ON_TOP",REPORT:3,3:"REPORT",SET_MUTED:4,4:"SET_MUTED",BLOCK_USER:5,5:"BLOCK_USER",QUIT_GROUP:6,6:"QUIT_GROUP",ENABLE_PIGEON_SYNC:7,7:"ENABLE_PIGEON_SYNC",DISSOLVE_GROUP:8,8:"DISSOLVE_GROUP"},w={TEXT:1,1:"TEXT",PIC:2,2:"PIC",BIG_EMOJI:3,3:"BIG_EMOJI",VIDEO:4,4:"VIDEO"},E={LOGIN:0,0:"LOGIN",IM:1,1:"IM"},y={USE_VIDEO_INFO:0,0:"USE_VIDEO_INFO",USE_VIDEO_INFO_ISLOADING:1,1:"USE_VIDEO_INFO_ISLOADING",USE_VIDEO_INFO_NOT_ALLOW_LOOK:2,2:"USE_VIDEO_INFO_NOT_ALLOW_LOOK",USE_VIDEO_INFO_DEL_STATUS:3,3:"USE_VIDEO_INFO_DEL_STATUS",USE_VIDEO_MODAL_MAIN_URL:4,4:"USE_VIDEO_MODAL_MAIN_URL"}},387572:function(e,t,n){n.d(t,{i:function(){return i}});let i=(e,t)=>{let n=(null==e?void 0:e.parentElement)||(null==e?void 0:e.parentNode);return!!n&&n!==document&&n!==window&&((null==t?!!void 0:!!t(n))||i(n,t))}},478063:function(e,t,n){n.d(t,{Z:function(){return c}}),n(874386),n(179133),n(826893);var i=n(567754),o=n(88648),r=n(697239),a=n(593231),l=n(492163),s=n(732218);let u=!1;function c(e){let{openOrCreateConversationDetail:t,openDlg:n}=e,{isShowGetConversaionListLoading:c,curUserInfo:d}=l.Z,[_,m]=(0,o.useState)(null),[v,f]=(0,o.useMemo)(()=>{let e=(0,i.parse)(window.location.search);return[null==e?void 0:e.imToSecUid,null==e?void 0:e.nextLoginSecUid]},[]);(0,o.useEffect)(()=>{if(!f||f===(null==d?void 0:d.secUid))v&&!u&&(0,a.Z)((0,r.fetchUserProfile)(v)).then(e=>{var t;let[n,i]=e;m(null==i?void 0:null===(t=i.user)||void 0===t?void 0:t.uid)})},[v,null==d?void 0:d.secUid]),(0,o.useEffect)(()=>{_&&((0,s.Z)()&&!u?(t({uid:_,enterMethod:"openByUrlParams"}),u=!0):(n(),!c&&!u&&(t({uid:_,enterMethod:"openByUrlParams"}),u=!0)))},[_,c])}},438607:function(e,t,n){n.d(t,{Z:function(){return d}});var i=n("520739");n("675373"),n("874386");var o=n("480596"),r=n("598053"),a=n("295847"),l=n("416049"),s=n("936538"),u=n("88648");let c=async()=>{let e={pullInterval:o.TCC_DEFAULT_VALUE_MAP.get(o.TccKey.ImConfig)};try{e=await r.get({key:o.TccKey.ImConfig,defaultValue:o.TCC_DEFAULT_VALUE_MAP.get(o.TccKey.ImConfig)})}catch(e){}return e};function d(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{info:o,isLogin:r}=e||{};(0,u.useEffect)(()=>{if(!t)return;let e=a.Z.get("set_sdk_ready");a.Z.mark("imsdk_load_module_start"),Promise.all([Promise.resolve().then(n.bind(n,457815)),n.e("4750").then(n.bind(n,879909)),c()]).then(t=>{let{ImSdk:n}=t[0]||{};if(!(n&&t[1])||n.bytedIMInstance)return;a.Z.mark("imsdk_load_module_end"),(0,l.G)("pc_im_sdk_import_time",{duration:a.Z.measure("imsdk_load_module_start","imsdk_load_module_end"),ready_type:null==e?void 0:e.detail});let{default:u}=t[1],c=s.Z.getInstance().get("imPerformanceOptimization.pc_im_message_storage");n.tryStart(r,o,(0,i._)({},t[2]),{encryption:c,storage:c,debug:!0}),(null==o?void 0:o.uid)&&u.init(o.uid),setTimeout(()=>{n.conversationChange()},500)})},[r,o])}},936538:function(e,t,n){n.d(t,{Z:function(){return a}});var i=n(134761);n(874386);var o=n(645260),r=n.n(o);class a{static getInstance(){return!this.instance&&(this.instance=new a),this.instance}setAbTest(e){this.abTest=e}get(e){if(this.cacheKeyMap[e])return this.cacheKeyMap[e];let t=!!(!localStorage.getItem(e)&&r()(this.abTest,e));return this.cacheKeyMap.set(e,t),t}set(e,t){this.cacheKeyMap[e]=t,localStorage.setItem(e,t)}clear(e){this.cacheKeyMap.delete(e),localStorage.removeItem(e)}clearAll(){this.cacheKeyMap=new Map,localStorage.clear()}constructor(){(0,i._)(this,"cacheKeyMap",new Map),(0,i._)(this,"abTest",void 0)}}(0,i._)(a,"instance",void 0)},958829:function(e,t,n){n.d(t,{Q:function(){return s},i:function(){return l}});var i=n(520739),o=n(878389),r=n(16583);let a=(0,o._)((0,i._)({},r.xM),{chat_notif_show:{eventName:"chat_notif_show",params:{}},uc_login_notify:{eventName:"uc_login_notify",params:{}},uc_login_submit:{eventName:"uc_login_submit",params:{}},uc_login_result:{eventName:"uc_login_result",params:{}},chat_cell_show:{eventName:"chat_cell_show",params:{}},chat_cell_click:{eventName:"chat_cell_click",params:{}},enter_chat:{eventName:"enter_chat",params:{}},click_enter_chat_page:{eventName:"click_enter_chat_page",params:{}},chat_setting_show:{eventName:"chat_setting_show",params:{}},chat_setting_click:{eventName:"chat_setting_click",params:{}},chat_block_popup_show:{eventName:"chat_block_popup_show",params:{}},chat_block_popup_click:{eventName:"chat_block_popup_click",params:{}},send_message:{eventName:"send_message",params:{}},send_message_response:{eventName:"send_message_response",params:{}},follow:{eventName:"follow",params:{}},follow_cancel:{eventName:"follow_cancel",params:{}},emoji_tab_show:{eventName:"emoji_tab_show",params:{}},at_panel_show:{eventName:"at_panel_show",params:{}},send_at_message:{eventName:"send_at_message",params:{}},send_at_message_response:{eventName:"send_at_message_response",params:{}},message_function_show:{eventName:"message_function_show",params:{}},pc_im_story_image_load:{eventName:"pc_im_story_image_load",params:{loadDuration:0}},im_sdk_init_time:{eventName:"im_sdk_init_time",params:{}},message_function_click:{eventName:"message_function_click",params:{}},like_message:{eventName:"like_message",params:{}},forward_message:{eventName:"forward_message",params:{}},quote_message:{eventName:"quote_message",params:{}},recall_message:{eventName:"recall_message",params:{}},delete_message:{eventName:"delete_message",params:{}},unsupported_message_show:{eventName:"unsupported_message_show",params:{}},video_cover_show:{eventName:"video_cover_show",params:{}},video_cover_click:{eventName:"video_cover_click",params:{}},click_comment_button:{eventName:"click_comment_button",params:{}},share_menu_show:{eventName:"share_menu_show",params:{}},share_video_click_head:{eventName:"share_video_click_head",params:{}},share_video_click_more_friend:{eventName:"share_video_click_more_friend",params:{}},share_video:{eventName:"share_video",params:{}},share_user:{eventName:"share_user",params:{}},share_comment:{eventName:"share_comment",params:{}},share_search:{eventName:"share_search",params:{enter_from:"others_homepage"}},click_send_message:{eventName:"click_send_message",params:{}},im_push_show:{eventName:"im_push_show",params:{}},im_push_click:{eventName:"im_push_click",params:{}},im_push_close:{eventName:"im_push_close",params:{}},new_im_show:{eventName:"new_im_show",params:{}},share_video_click_more_group:{eventName:"share_video_click_more_group",params:{}},unknown_notif_show:{eventName:"unknown_notif_show",params:{}},unknown_notif_click:{eventName:"unknown_notif_click",params:{}},unknown_notif_hover:{eventName:"unknown_notif_hover",params:{}},unknown_notif_delete:{eventName:"unknown_notif_delete",params:{}},unknown_cell_show:{eventName:"unknown_cell_show",params:{}},chat_cell_click_all:{eventName:"chat_cell_click_all",params:{}},click_author_head:{eventName:"click_author_head",params:{click_from:"im",is_full_webscreen:"0",clarity:""}},click_fold_im:{eventName:"click_fold_im",params:{}},click_exit_chat:{eventName:"click_exit_chat",params:{}},imsdk_debug_read_index_greater:{eventName:"imsdk_debug_read_index_greater",params:{}},pc_im_upload_btn_click:{eventName:"pc_im_upload_btn_click",params:{confirmStatus:"1",isGroup:"0"}},im_customer_group_notify:{eventName:"im_customer_group_notify",params:{}},im_customer_notify:{eventName:"im_customer_notify",params:{}},im_customer_click:{eventName:"im_customer_click",params:{action:"1"}},livesdk_share_success:{eventName:"livesdk_share_success",params:{share_from:"",share_type:"message",user_id:"",anchor_id:"",room_id:"",enter_from_merge:"",enter_method:"",action_type:"",request_id:""}},send_link:{eventName:"send_link",params:{enter_from:"",chat_type:"private",conversation_id:"",to_user_id:"",link_type:""}},soraka_sli_report:{eventName:"soraka_sli_report",params:{}},pc_im_show:{eventName:"pc_im_show",params:{status:"",is_show_chat_room:!1,is_fold_chat_list:!1,unread_count:0}},pc_im_chat_detail_show:{eventName:"pc_im_chat_detail_show",params:{conversation_id:"",conversation_short_id:"",chat_type:"private"}},pc_im_click:{eventName:"pc_im_click",params:{click_type:"",module_type:""}},pc_im_conversation_detail_stay_time:{eventName:"pc_im_conversation_detail_stay_time",params:{duration:-1,chat_type:"private"}},pc_im_message_show:{eventName:"pc_im_message_show",params:{message_type:"",message_id:"",chat_type:"private",aweme_type:"",card_type:"",card_key:"",to_user_id:"",from_user_id:""}},pc_im_message_click:{eventName:"pc_im_message_click",params:{message_id:"",message_type:"",chat_type:"private",aweme_type:"",card_type:"",card_key:"",to_user_id:"",from_user_id:"",click_type:"click"}},pc_im_message_click_download:{eventName:"pc_im_message_click_download",params:{message_id:"",message_type:"",chat_type:"private",aweme_type:"",card_type:"",card_key:"",to_user_id:"",from_user_id:"",click_type:"click"}},pc_interaction_click:{eventName:"pc_interaction_click",params:{message_id:"",message_type:"",chat_type:"private",aweme_type:"",card_type:"",card_key:"",click_type:""}},pc_im_conversation_list_fps:{eventName:"pc_im_conversation_list_fps",params:{fps:-1,drop_fps:-1}},pc_im_message_list_fps:{eventName:"pc_im_message_list_fps",params:{fps:-1,drop_fps:-1}},pc_im_notice_list_fps:{eventName:"pc_im_notice_list_fps",params:{fps:-1,drop_fps:-1}},pc_im_window_show_perf:{eventName:"pc_im_window_show_perf",params:{duration_fmp:"",duration_fcp:""}},pc_im_conversation_detail_perf:{eventName:"pc_im_conversation_detail_perf",params:{duration_fmp:"",duration_fcp:""}},pc_im_message_perf:{eventName:"pc_im_message_perf",params:{duration_fmp:""}},pc_im_location_click:{eventName:"pc_im_location_click",params:{conversation_id:"",message_id:"",showImNewMeessage:""}},pc_im_voice_to_text_click:{eventName:"pc_im_voice_to_text_click",params:{isCancel:""}},im_image_zoom:{eventName:"im_image_zoom",params:{}},pc_share_fps:{eventName:"pc_share_fps",params:{fps:-1,drop_fps:-1}},pc_share_render:{eventName:"pc_share_render",params:{duration:-1,listNum:-1}},pc_share_search:{eventName:"pc_share_search",params:{searchNum:-1}},pc_share_stay_time:{eventName:"pc_share_stay_time",params:{duration:-1}},pc_im_entry_show:{eventName:"pc_im_entry_show",params:{duration:-2,ready_type:""}},im_login_notify:{eventName:"im_login_notify",params:{}},pc_im_stay_time:{eventName:"pc_im_stay_time",params:{duration:-1,close_type:"hover"}},chat_notif_hover:{eventName:"chat_notif_hover",params:{}},chat_detach_btn_show:{eventName:"chat_detach_btn_show",params:{}},chat_detach_btn_click:{eventName:"chat_detach_btn_click",params:{}},open_im_new_page:{eventName:"open_im_new_page",params:{}}});r.iL._initLog(a);let l=r.iL;var s={chat_page:"chat_page",chat_panel:"chat_panel",share_board:"share_board",share_message:"share_message",chat_notif:"chat_notif",push:"push",client_push:"client_push",hover_icon:"hover_icon",im_private:"im_private",recommend_side_card:"recommend_side_card"}},16583:function(e,t,n){n.d(t,{OZ:function(){return m},Os:function(){return _},iL:function(){return c},xM:function(){return u},yW:function(){return d}});var i,o,r=n(520739);n(338172),n(250440);var a=n(544933),l=n(658065),s=n(32167);let u={pc_im_entry_show:{eventName:"pc_im_entry_show",params:{duration:-2,ready_type:""}},im_login_notify:{eventName:"im_login_notify",params:{}},pc_im_stay_time:{eventName:"pc_im_stay_time",params:{duration:-1,close_type:"hover"}},chat_notif_hover:{eventName:"chat_notif_hover",params:{}},pc_im_click:{eventName:"pc_im_click",params:{click_type:"",module_type:""}},other_share:{eventName:"other_share",params:{}},chat_vmok_perf:{eventName:"chat_vmok_perf",params:{duration_vmok_load:-1}},chat_entry_perf:{eventName:"chat_entry_perf",params:{duration_im_before_load:-1}}},c=new a.h(u),d=()=>(0,l.yW)(),_=()=>(0,s.vM)();let m=(null===(i=self.location.hostname)||void 0===i?void 0:i.startsWith("live.douyin.com"))?"live":(null===(o=self.location.pathname)||void 0===o?void 0:o.includes("/search/"))?"search":"douyin";t.ZP=(e,t)=>{try{c.sendLog(e,(0,r._)({page_host:m,enter_from:d(),previous_page:_()},t||{}))}catch(e){}}},347812:function(e,t,n){n.d(t,{w:function(){return a}});var i=n(637005),o=n(860684),r=n(631493);function a(){let{clickMethod:e=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,o.n)();return()=>{var n;null==t||null===(n=t.exitFullscreen)||void 0===n||n.call(t),i.emit(i.EVENT.triggerModalPlayerClose,{}),r.s.setPageFullscreen({playerId:t.playerId,isPageFullscreen:!1}),i.emit(i.EVENT.pageFullScreen,{clickMethod:e,fullScreen:!1,playerId:t.playerId})}}},668118:function(e,t,n){var i=n(88648),o=n(492163);t.Z=e=>{(0,i.useEffect)(()=>{if(!!Object.keys(e||{}).length)o.Z.getEmojiList(),o.Z.getEmojiGifListAsync(),o.Z.getShowSugEmoji(),o.Z.getCustomEmojiListAsync(),o.Z.getRecentEmojiAsync(),o.Z.getRecentGifAsync(),o.Z.getInteractiveEmojiListAsync()},[e])}},60491:function(e,t,n){n.d(t,{Z:function(){return er}}),n("874386"),n("179133"),n("826893");var i=n("563097"),o=n("88648"),r=n("448058"),a=n("309931"),l=n("713097"),s=n.n(l),u=n("909543"),c=n("30321"),d=n("561550"),_=n("637005"),m=n("572076"),v={pushList:"ba6T47mN",inLynxWindow:"V3Fae8d0",inLynxWindowLoading:"pRNmbF9C"},f="UWvHlhZH",p="tO1OJndl",h=n("621631"),g=n("473677"),w=n("186910"),E=n("375944"),y={pushItem:"vlXyJ9Hj",headBox:"DXjIR0VB",headIcon:"tpVYMkyN",isGroup:"zWu4vMot",userInfo:"DRrOsYSQ",titleBox:"te4iSPSS",titleTxt:"yi4ieyYy",contentBox:"I01heAIX",msgTxt:"njCt16dm",operateBox:"JACH7Bjp",isOhosOperateBox:"PB1eZovP",replyBtn:"Q5_PT2rp",closeBtn:"DlpQZ6fM",onlineTag:"rRWjbfmI"},N=n("129150"),I=n("457815"),S=n("416049"),T=n("524621"),R=n("129965"),L=n("643946"),k=n("621551"),C=n("503479"),P=n("687381"),b=n("684207"),O=n("134761"),x=n("326823"),U=n("21480");let A=new class e{getConversationById(e){var t,n;return null===(n=this.imContext)||void 0===n?void 0:null===(t=n.saasApi)||void 0===t?void 0:t.getConversationById(e)}setCurConversation(e,t){var n,i;null===(i=this.imContext)||void 0===i||null===(n=i.saasApi)||void 0===n||n.setCurConversation(e)}constructor(){(0,O._)(this,"imContext",null),(0,O._)(this,"imSdkInstanceReadyDeferred",new U.Z),b.O.getIsSaasPopup()&&(0,x.a)().then(e=>{this.imContext=e,this.imSdkInstanceReadyDeferred.resolve()})}},{ConversationType:M}=h.m,{GROUP_CHAT:D,ONE_TO_ONE_CHAT:j}=M,Z=(0,r.inject)("imStore")((0,r.observer)(e=>{var t;let{msg:n,imStore:r,openDlg:a}=e,{conversationInfoMap:l,setSelectChatUserShortId:u}=r,{serverId:_,conversationId:m,conversationType:v,ext:f,sender:p}=n,h=(0,E.O)(),O=(null==l?void 0:l[m])||(b.O.getIsSaasPopup()?A.getConversationById(m):I.ImSdk.getConversationById(m)),x=(0,o.useRef)(null),U=async()=>{let e=await (0,T.p)(p);x.current=e};(0,o.useEffect)(()=>{(async()=>{let e={conversation_id:m,chat_type:R.n[v],message_type:(0,R.G)(n)};if(v===j&&p){!(x.current||0===x.current)&&await U();let t=x.current;e.personal_relation=String(t)}(0,S.G)("im_push_show",e)})()},[m]),(0,o.useEffect)(()=>{let e=setTimeout(()=>{r.clearOldMsgListToPush()},300);return()=>{clearTimeout(e)}},[]);let M=(0,o.useRef)(0);(0,o.useEffect)(()=>(clearTimeout(M.current),M.current=setTimeout(()=>{r.closeMsgPushPop(m)},5e3),()=>{clearTimeout(M.current)}),[m]);let{headIcon:Z,title:G}=(0,P.v)(O),B=(0,o.useCallback)(async e=>{if(clearTimeout(M.current),r.clearAllPushList(),e){let e={conversation_id:m,chat_type:R.n[v]};if(v===j&&p){!(x.current||0===x.current)&&await U();let t=x.current;e.personal_relation=String(t)}(0,S.G)("im_push_close",e)}},[]),V=(0,o.useCallback)(async()=>{null==a||a({conversationId:m});let e=(0,c.Nr)(location.pathname),t=(0,d.sF)()&&!(0,d.kB)();if(t&&!e){B();let e={conversation_id:m,chat_type:R.n[v],message_type:(0,R.G)(n)};if(v===j&&p){!(x.current||0===x.current)&&await U();let t=x.current;e.personal_relation=String(t)}(0,S.G)("im_push_click",e);return}let i=!1;if(b.O.getIsSaasPopup()?(i=!1,A.setCurConversation(O,N.eY.PUSH)):i=I.ImSdk.setCurConversation(O,"PushItem"),i)return;!b.O.getIsSaasPopup()&&(r.setEnterConversation(N.eY.PUSH),u(O.shortId)),B();let o={conversation_id:m,chat_type:R.n[v],message_type:(0,R.G)(n)};if(v===j&&p){!(x.current||0===x.current)&&await U();let e=x.current;o.personal_relation=String(e)}(0,S.G)("im_push_click",o)},[]),F=(0,o.useCallback)(()=>{clearTimeout(M.current)},[]),Y=(0,o.useCallback)(()=>{M.current=setTimeout(()=>{r.closeMsgPushPop(m)},5e3)},[m]),H=null!==(t=r.uidSecUidMap[null==O?void 0:O.toParticipantUserId])&&void 0!==t?t:"",W=(0,w.V)({enable:!0,secUid:H}),J=null==W?void 0:W.isOnline;return(0,i.jsxs)("div",{className:y.pushItem,onMouseEnter:F,onMouseLeave:Y,children:[(0,i.jsx)("div",{className:y.headBox,onClick:V,children:(0,i.jsx)(L.n,{srcList:Z,className:s()(y.headIcon,v===D?y.isGroup:"")})}),(0,i.jsxs)("div",{className:y.userInfo,onClick:V,children:[(0,i.jsxs)("div",{className:y.titleBox,children:[(0,i.jsx)("div",{className:y.titleTxt,children:G}),J&&(0,i.jsx)("div",{className:y.onlineTag,children:"在线"})]}),(0,i.jsx)("div",{className:y.contentBox,children:(0,i.jsx)(k.Z,{className:y.msgTxt,converSation:O,lastMessage:n,ext:f,isNeedFilterDraftMessage:!0})})]}),(0,i.jsx)("div",{className:s()(y.operateBox,{[y.isOhosOperateBox]:h}),children:(0,i.jsx)("div",{className:y.replyBtn,onClick:V,children:"回复"})}),(0,i.jsx)(g.Z,{src:C.Z,className:y.closeBtn,viewBox:"0 0 13 13",onClick:()=>{B(!0)}})]})})),G=(0,r.inject)("imStore")((0,r.observer)(e=>{let{imStore:t,openDlg:n}=e,{msgListToPush:o}=t;return(0,i.jsx)("div",{className:s()(f,{[p]:!(null==o?void 0:o.length)}),id:"IMpushListBoxId",children:null==o?void 0:o.map(e=>{let{conversationId:t}=e;return(0,i.jsx)(Z,{msg:e,openDlg:n},t)})})}));var B=n("520739"),V=n("878389");n("250440");var F="anZNhKjx",Y="_m509CgH",H=n("709475"),W=n("44498"),J=n("760430"),K=n("116674"),$=n("223209"),Q=n("156157");let X=(0,r.inject)("noticeStore")((0,r.observer)(e=>{let{noticeStore:t,notice:n,handleClickPush:r=()=>{}}=e,{nid_str:a="",type:l}=n,s=(0,o.useRef)(null),u=(0,K.e)(n,H._q.NOTICE_PUSH),c=(0,o.useCallback)(()=>{s.current&&clearTimeout(s.current)},[]),d=(0,o.useCallback)(()=>{s.current=setTimeout(()=>{t.closeNoticePushPop(a)},5e3)},[]),m=(0,o.useCallback)(e=>{var n;s.current&&clearTimeout(s.current),null===(n=t.clearNoticePushList)||void 0===n||n.call(t),e&&(0,$.Gb)("interact_push_close",u)},[]),v=(0,o.useCallback)(e=>{if((null===W.p0||void 0===W.p0?void 0:W.p0.includes(l))&&e){let{personal_relation:t,interact_type:n}=u;_.emit(_.EVENT.openNoticeAwemeModal,(0,V._)((0,B._)({},e),{logParams:{enter_from:J.QZ[H.DL.NOTICE_PUSH],personal_relation:t,interact_type:n}})),null==r||r()}m(),(0,$.Gb)("interact_push_click",u)},[l]);return(0,o.useEffect)(()=>{(0,$.Gb)("interact_push_show",u)},[]),(0,o.useEffect)(()=>{let e=setTimeout(()=>{t.clearOldNoticeInPushList()},300);return s.current=setTimeout(()=>{t.closeNoticePushPop(a)},5e3),()=>{e&&clearTimeout(e),s.current&&clearTimeout(s.current)}},[]),(0,i.jsx)("div",{className:F,onMouseEnter:c,onMouseLeave:d,children:(0,i.jsx)(Q.Z,{className:Y,notice:n,showScene:H.DL.NOTICE_PUSH,handleClickInPush:v,handleClosePush:()=>m(!0)})})}));var q="d6qRXkia";let z=(0,r.inject)("noticeStore")((0,r.observer)(e=>{let{noticeStore:t,clickNoticePush:n}=e,{noticePushList:o=[]}=t;return(null==o?void 0:o.length)?(0,i.jsx)("div",{className:q,id:"NoticepushListBoxId",children:null==o?void 0:o.map(e=>(0,i.jsx)(X,{notice:e,handleClickPush:n},null==e?void 0:e.nid_str))}):null}));var ee=n("492163"),et=n("945730"),en=n("358995");let ei={IMShowByPushClick:"webview:im:showByPushClick",PushHide:"webview:push:hide",PushShow:"webview:push:show"},eo=(0,r.inject)("noticeStore","imStore")((0,r.observer)(function(e){var t,n;let{setTopOffset:i,noticeStore:r,imStore:a}=e,l=null==r?void 0:null===(t=r.noticePushList)||void 0===t?void 0:t.length,s=null==a?void 0:null===(n=a.msgListToPush)||void 0===n?void 0:n.length;return(0,o.useLayoutEffect)(()=>{if(l||s){var e,t,n;let o=null===(n=document.getElementById("douyin-header"))||void 0===n?void 0:null===(t=n.getBoundingClientRect)||void 0===t?void 0:null===(e=t.call(n))||void 0===e?void 0:e.bottom;o>0?null==i||i(o+2):null==i||i(void 0)}},[l,s]),null}));var er=()=>{let[e,t]=(0,o.useState)(!0),[n,l]=(0,o.useState)(0),{pathname:f,search:p}=(0,u.a)(),h=(0,o.useRef)(null),g=(0,o.useRef)(null),w=(0,c.Nr)(f),E=(0,d.sF)(p)&&!(0,d.kB)(p)&&!w,y=(0,o.useCallback)((e,t)=>{if(!!e)E?m.asyncCall(ei.IMShowByPushClick,t):null==_||_.emit(_.EVENT.clickPush,{type:e,params:t})},[E]),N=function(){var e,t,n,i,o,r;let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(e=(t=(0,et.getImStore)()).setCanShowImPush)||void 0===e||e.call(t,a),null===(n=en.Z.setCanShowNoticePush)||void 0===n||n.call(en.Z,a),!a&&(null===(i=(o=(0,et.getImStore)()).clearAllPushList)||void 0===i||i.call(o),null===(r=en.Z.clearNoticePushList)||void 0===r||r.call(en.Z))};(0,o.useEffect)(()=>{let e=null==_?void 0:_.listen(_.EVENT.showPushList,async e=>{if(!0==!!(document.hidden&&"hidden"===document.visibilityState)){t(!1);return}let{isShow:n=!1,from:i}=e||{};switch(i){case H.No.IM:h.current=!n;break;case H.No.NOTICE:g.current=!n}h.current||g.current?(t(!1),N(!1)):(t(n),N(n))}),n=null==_?void 0:_.listen(_.EVENT.clickPush,()=>{var e,t,n;null===(e=(t=(0,et.getImStore)()).clearAllPushList)||void 0===e||e.call(t),null===(n=en.Z.clearNoticePushList)||void 0===n||n.call(en.Z)});return()=>{null==e||e(),null==n||n()}},[]);let{noticePushList:I=[]}=en.Z,{msgListToPush:S}=(0,et.getImStore)();(0,o.useEffect)(()=>{let t;let n=document.getElementById("pushListBoxId");if(E&&n&&"/LynxLoading"===f&&!e&&m.asyncCall(ei.PushHide),e&&E&&n&&"/LynxLoading"===f){let e=()=>{clearTimeout(t),t=setTimeout(()=>{if(n.clientHeight){let e=function e(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(t instanceof HTMLElement))return null;for(let i of Array.from(t.children)){let t=i.offsetWidth,o=i.offsetHeight;if(t>0&&o>0)return i;if(n&&i.children.length>0){let t=e(i,!0);if(t)return t}}return null}(n,!0);e?m.asyncCall(ei.PushShow,{style:`width:${e.offsetWidth}px; height:${e.offsetHeight}px;`}):m.asyncCall(ei.PushHide)}else m.asyncCall(ei.PushHide)},100)},i=new MutationObserver(()=>{e()});return i.observe(n,{childList:!0,subtree:!0,attributes:!0}),(null==I?void 0:I.length)||(null==S?void 0:S.length)?e():m.asyncCall(ei.PushHide),()=>{i.disconnect()}}},[e,E,f,null==I?void 0:I.length,null==S?void 0:S.length]);let T="/LynxLoading"===f;return(0,d.kB)(p)?null:e&&E?(0,a.createPortal)((0,i.jsx)(r.Provider,{imStore:ee.Z,noticeStore:en.Z,children:(0,i.jsxs)("div",{className:s()(v.pushList,T?v.inLynxWindowLoading:v.inLynxWindow),id:"pushListBoxId",children:[(0,i.jsx)(eo,{setTopOffset:l}),(0,i.jsx)(G,{openDlg:e=>y(H.No.IM,e)}),(0,i.jsx)(z,{clickNoticePush:()=>y(H.No.NOTICE)})]})}),document.body):e?(0,i.jsx)(r.Provider,{imStore:(0,et.getImStore)(),noticeStore:en.Z,children:(0,i.jsxs)("div",{className:v.pushList,id:"pushListBoxId",style:{top:n||void 0},children:[(0,i.jsx)(eo,{setTopOffset:l}),(0,i.jsx)(G,{openDlg:e=>y(H.No.IM,e)}),(0,i.jsx)(z,{clickNoticePush:()=>y(H.No.NOTICE)})]})}):null}},114981:function(e,t,n){n.d(t,{L:function(){return o}}),n(675373),n(874386);var i=n(255686);let o=e=>{let{promotionId:t,originType:n,secAuthorId:o,roomId:r,itemId:a}=e;return Promise.all([(0,i.y3)({promotionId:t,originType:n,secAuthorId:o,roomId:r,itemId:a}),(0,i.$P)({promotionId:t,originType:n})])}},242007:function(e,t,n){n.d(t,{J9:function(){return v},Se:function(){return f},VY:function(){return p}});var i=n(134761),o=n(520739),r=n(878389);n(675373),n(874386);var a=n(340290),l=n(913807),s=n(782442),u=n(419936),c=n.n(u),d=n(289089),_=n(823685);let m={recommendDetail:{},getTime:0,awemeId:void 0,duplicateRemoveAwemeIds:[]},v=new class e{async fetchRelatedRecommendById(e){var t,n,i,l;if(!e)return{};let s=await (0,a.bJ)({awemeId:e,count:1,filterGids:(null===(t=this._relatedRecommendInfo.duplicateRemoveAwemeIds)||void 0===t?void 0:t.map(e=>null==e?void 0:e.awemeId).join(","))||"",subChannelId:4}),u=null==s?void 0:null===(n=s.awemeList)||void 0===n?void 0:n[0];if((null==s?void 0:s.statusCode)===0&&(null==u?void 0:u.awemeId)){let t=(0,r._)((0,o._)({},u),{id:u.awemeId,insertId:e,width:null===(i=u.video)||void 0===i?void 0:i.width,height:null===(l=u.video)||void 0===l?void 0:l.height});return this._relatedRecommendInfo={recommendDetail:t,getTime:Date.now(),awemeId:e},this._relatedRecommendInfo}return{}}async recommendDuplicateRemove(){let{awemeId:e}=this._relatedRecommendInfo.recommendDetail;e&&await (0,l.fetchHomeImpression)({awemeIds:e})}getRelatedRecommendInfoById(e){var t;return e===(null===(t=this._relatedRecommendInfo)||void 0===t?void 0:t.awemeId)?this._relatedRecommendInfo:{}}setRemoveAwemeIds(e){c()(e)&&(this._relatedRecommendInfo.duplicateRemoveAwemeIds=e)}resetInfo(){this._relatedRecommendInfo=m,this._recommendInfoPromise=void 0}get relatedRecommendInfo(){return this._relatedRecommendInfo}get recommendInfoPromise(){return this._recommendInfoPromise}set recommendInfoPromise(e){this._recommendInfoPromise=e}constructor(){(0,i._)(this,"_relatedRecommendInfo",m),(0,i._)(this,"_recommendInfoPromise",void 0)}},f=function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=s.Le.getConfig(s.gI.DiscoverRelatedRecommendInfo)||{},o={[_.DiscoverRelatedRecommendType.Off]:[],[_.DiscoverRelatedRecommendType.V1]:d.MD,[_.DiscoverRelatedRecommendType.V2]:d.U_},r=n?[...d.MD,...d.U_]:[],a=o[e]?o[e]:r,l=null==a?void 0:null===(t=a.some)||void 0===t?void 0:t.call(a,e=>!!i[e]),u=d.IU.some(e=>!!i[e]);return!!l&&!u||!1},p=e=>{let{info:t,awemeId:n,abData:i}=e;if(!t){s.Le.setConfig(s.gI.DiscoverRelatedRecommendInfo,{},!1);return}let{awemeId:o,follow:r,unFollow:a}=s.Le.getConfig(s.gI.DiscoverRelatedRecommendInfo)||{};if(n!==o){(null==t?void 0:t.awemeId)&&s.Le.setConfig(s.gI.DiscoverRelatedRecommendInfo,t,!1);return}void 0===r&&(null==t?void 0:t.follow)===!1&&(t.unFollow=!0),void 0!==a&&void 0!==(null==t?void 0:t.follow)&&(t.unFollow=!(null==t?void 0:t.follow)),s.Le.setConfig(s.gI.DiscoverRelatedRecommendInfo,t),f(i,!0)&&!v.recommendInfoPromise&&(v.recommendInfoPromise=v.fetchRelatedRecommendById(n))}},767927:function(e,t,n){n.d(t,{t:function(){return r}});var i=n(88648),o=n(870105);function r(e){let t=(0,o.U)(),n=(0,i.useRef)(!0),r=(0,i.useRef)(e);r.current=e,(0,i.useEffect)(()=>{var e;if("function"!=typeof r.current||!t)return;let i=n.current;return n.current=!1,null===(e=r.current)||void 0===e?void 0:e.call(r,i)},[t])}},870105:function(e,t,n){n.d(t,{U:function(){return a}}),n(874386);var i=n(88648),o=n(244885),r=n(287209);let a=()=>{let e=(0,i.useContext)(o.I),[t,n]=(0,i.useState)(!0);return((0,r.m)(e=>n(e)),e)?e.isActive:t}},235248:function(e,t,n){n.d(t,{t:function(){return r}});var i=n(88648),o=n(244885);let r=()=>{var e;let{ref:t}=null!==(e=(0,i.useContext)(o.I))&&void 0!==e?e:{};return t?t:null}},900674:function(e,t,n){n.d(t,{v:function(){return i}});let i=(0,n(88648).createContext)(null)},474932:function(e,t,n){n.d(t,{m:function(){return s},w:function(){return l}});var i=n(520739);n(675373);var o=n(496349),r=n(231755);let{COMMON_SEARCH_PARAMS:a}=o||{};async function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=await (0,r.v_)("/aweme/v1/web/commit/dislike/item/",(0,i._)({aweme_id:e},a),{aweme_id:e}),n=t.status_code;return{statusCode:n,errMsg:0===n||t.status_msg?t.status_msg:"啊哦，服务器打瞌睡了"}}async function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=await (0,r.v_)("/aweme/v1/web/dislike/dimension/update/",(0,i._)({aweme_id:e,block_type:2},a),{aweme_id:e}),n=t.status_code;return{statusCode:n,errMsg:0===n||t.status_msg?t.status_msg:"啊哦，服务器打瞌睡了"}}},255686:function(e,t,n){n.d(t,{$P:function(){return P},FE:function(){return b},G:function(){return O},N7:function(){return x},Q2:function(){return N},Sn:function(){return k},Ws:function(){return R},XK:function(){return E},XQ:function(){return y},YB:function(){return T},du:function(){return S},jZ:function(){return L},w:function(){return I},y3:function(){return C}});var i=n(520739),o=n(878389),r=n(368200);n(675373),n(779788);var a=n(496349),l=n(871212),s=n(231755),u=n(349135),c=n(138871),d=n.n(c);let{COMMON_SEARCH_PARAMS:_}=a;function m(e){var t,n,i;return{text:null!==(t=null==e?void 0:e.text)&&void 0!==t?t:"",iconUrl:null!==(n=null==e?void 0:e.icon_url)&&void 0!==n?n:"",jumpUrl:null!==(i=null==e?void 0:e.jump_url)&&void 0!==i?i:""}}function v(e){var t,n,i,o;return{userAvatar:null!==(t=null==e?void 0:e.user_avatar)&&void 0!==t?t:"",userNickname:null!==(n=null==e?void 0:e.user_nickname)&&void 0!==n?n:"",text:null!==(i=null==e?void 0:e.text)&&void 0!==i?i:"",imageList:null!==(o=null==e?void 0:e.image_list)&&void 0!==o?o:[]}}function f(e){var t,n,i,o,r;return{image:null!==(t=null==e?void 0:e.image)&&void 0!==t?t:"",name:null!==(n=null==e?void 0:e.name)&&void 0!==n?n:"",price:(i=Number(null==e?void 0:e.price)/100,i),sales:null!==(o=null==e?void 0:e.sales)&&void 0!==o?o:0,productUrl:null!==(r=null==e?void 0:e.product_url)&&void 0!==r?r:""}}function p(e){var t,n,i,o,r,a,l,s,u,c,d,_,f,p,h,g,w,E,y,N,I,S,T,R,L,k,C,P,b,O,x,U,A,M,D,j,Z,G,B,V,F,Y,H,W,J,K;let{item_info:$,status_code:Q,log_pb:X}=e;return{statusCode:Q,logPb:null!==(P=null==X?void 0:X.impr_id)&&void 0!==P?P:"",itemInfo:{productInfo:{name:null!==(b=null==$?void 0:null===(t=$.product_info)||void 0===t?void 0:t.name)&&void 0!==b?b:"",price:(O=Number(null==$?void 0:null===(n=$.product_info)||void 0===n?void 0:n.price)/100,O),promiseTextList:null!==(x=null==$?void 0:null===(i=$.product_info)||void 0===i?void 0:i.promise_text_list)&&void 0!==x?x:[],logisticsTextList:null!==(U=null==$?void 0:null===(o=$.product_info)||void 0===o?void 0:o.logistics_text_list)&&void 0!==U?U:[],imageUrlList:null!==(A=null==$?void 0:null===(r=$.product_info)||void 0===r?void 0:r.image_url_list)&&void 0!==A?A:[],scheme:null!==(M=null==$?void 0:null===(a=$.product_info)||void 0===a?void 0:a.scheme)&&void 0!==M?M:"",schemeQRcodeBase64:null!==(D=null==$?void 0:null===(l=$.product_info)||void 0===l?void 0:l.scheme_qrcode_base64)&&void 0!==D?D:""},shopInfo:{name:null!==(j=null==$?void 0:null===(s=$.shop_info)||void 0===s?void 0:s.name)&&void 0!==j?j:"",image:null!==(Z=null==$?void 0:null===(u=$.shop_info)||void 0===u?void 0:u.image)&&void 0!==Z?Z:"",label:m(null==$?void 0:null===(c=$.shop_info)||void 0===c?void 0:c.label),score:null!==(G=null==$?void 0:null===(d=$.shop_info)||void 0===d?void 0:d.score)&&void 0!==G?G:0,percent:null!==(B=null==$?void 0:null===(_=$.shop_info)||void 0===_?void 0:_.percent)&&void 0!==B?B:0,tagList:null!==(V=null==$?void 0:null===(h=$.shop_info)||void 0===h?void 0:null===(p=h.tag_list)||void 0===p?void 0:null===(f=p.map)||void 0===f?void 0:f.call(p,m))&&void 0!==V?V:[],accountName:null!==(F=null==$?void 0:null===(g=$.shop_info)||void 0===g?void 0:g.account_name)&&void 0!==F?F:""},commentInfo:{totalCount:null!==(Y=null==$?void 0:null===(w=$.comment_info)||void 0===w?void 0:w.total_count)&&void 0!==Y?Y:0,tagList:null!==(H=null==$?void 0:null===(E=$.comment_info)||void 0===E?void 0:E.tag_list)&&void 0!==H?H:[],commentList:null!==(W=null==$?void 0:null===(I=$.comment_info)||void 0===I?void 0:null===(N=I.comment_list)||void 0===N?void 0:null===(y=N.map)||void 0===y?void 0:y.call(N,v))&&void 0!==W?W:[]},extraInfo:{productParams:null!==(J=null==$?void 0:null===(R=$.extra_info)||void 0===R?void 0:null===(T=R.product_params)||void 0===T?void 0:null===(S=T.map)||void 0===S?void 0:S.call(T,e=>{var t,n;return{name:null!==(t=e.name)&&void 0!==t?t:"",value:null!==(n=e.value)&&void 0!==n?n:""}}))&&void 0!==J?J:[],detailImageList:null!==(K=null==$?void 0:null===(C=$.extra_info)||void 0===C?void 0:null===(k=C.detail_image_list)||void 0===k?void 0:null===(L=k.map)||void 0===L?void 0:L.call(k,e=>null!=e?e:""))&&void 0!==K?K:[]}}}}function h(e){var t;let{status_code:n,product_preview_list:i,log_pb:o}=e;return{statusCode:n,logPb:null!==(t=null==o?void 0:o.impr_id)&&void 0!==t?t:"",productPreviewList:null==i?void 0:i.map(e=>f(e))}}function g(e){var t,n;let{status_code:i,video_info_list:o,has_product_data:r,product_card:a,log_pb:l}=e;return{statusCode:i,logPb:null!==(t=null==l?void 0:l.impr_id)&&void 0!==t?t:"",videoInfoList:null!==(n=null==o?void 0:o.map(e=>(0,u.s0)(e)))&&void 0!==n?n:[],hasProductData:null!=r&&r,productCard:r?f(a):void 0}}function w(e){let{promotions:t=[],top_promotion:n,target_promotions:i=[],status_code:o,next_offset:r=-1,log_id:a,page_header:l,page_hint:s}=e||{};return{statusCode:o,promotions:t,topPromotion:n,targetPromotions:i,nextOffset:r,logId:a,pageHeader:l,pageHint:s}}async function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=await (0,s.U2)("/aweme/v1/web/seo/ecom/detail/product_meta",(0,o._)((0,i._)({},_),{product_id:e}),{},void 0,t,{});return(0,u.RL)(n,p)}async function y(e){let{productId:t="0",itemId:n,needProductCard:r=!1}=e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=await (0,s.U2)("/aweme/v1/web/seo/ecom/detail/related_video",(0,o._)((0,i._)({},_),{product_id:t,item_id:n,need_product_card:r}),{},void 0,a,{});return(0,u.RL)(l,g)}async function N(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=await (0,s.U2)("/aweme/v1/web/seo/ecom/detail/recommend_product",(0,o._)((0,i._)({},_),{product_id:e}),{},void 0,t,{});return(0,u.RL)(n,h)}async function I(e){let{roomId:t,authorId:n,offset:r,limit:a=20}=e,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=await (0,s.v_)("/live/promotions/page/",(0,o._)((0,i._)({},_),{room_id:t,author_id:n,offset:r,limit:a}),{},void 0,l);return(0,u.RL)(c,w)}async function S(e){let{roomId:t,authorId:n}=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await (0,s.v_)("/live/promotions/page/top/",(0,o._)((0,i._)({},_),{room_id:t,author_id:n}),{},void 0,r)}async function T(e,t){let{roomId:n,authorId:a,productId:l}=e;return(0,r._)(e,["roomId","authorId","productId"]),await (0,s.U2)(t,(0,i._)((0,o._)((0,i._)({},_),{room_id:n,author_id:a,product_infos:JSON.stringify([{product_id:l}])}),e),{},void 0,null)}async function R(e){return(0,s.U2)("/aweme/v1/commerce/order/getUserAuth/",(0,o._)((0,i._)({},_),{user_id:e,app_id:l.APP_ID}))}async function L(e){return(0,s.U2)("/aweme/v1/commerce/order/saveUserAuth/",(0,o._)((0,i._)({},_),{user_id:e,app_id:l.APP_ID,auth_flag:1}))}async function k(e){let{roomId:t,authorId:n,liveSceneId:r=0,entranceInfo:a}=e,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await (0,s.U2)("/live/promotions/pop/v3/",(0,o._)((0,i._)({},_),{room_id:t,author_id:n,live_scene_id:r,entrance_info:a}),{},void 0,l)}async function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{promotionId:n,originType:o,roomId:r,secAuthorId:a,itemId:l}=e||{};return await (0,s.v_)("/ecom/product/detail/saas/pc/",(0,i._)({is_h5:1,origin_type:o},_),{is_h5:1,use_new_price:1,bff_type:2,room_id:r,live_room_id:r,item_id:l,sec_author_id:a,origin_type:o,promotion_ids:String(n),ec_promotion_id:n},void 0,t)}async function P(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{promotionId:n,originType:i}=e||{};return await (0,s.v_)("/aweme/v2/shop/promotion/pack/detail/",{is_h5:1,origin_type:i},{is_h5:1,bff_type:2,origin_type:i,promotion_id:n},void 0,t)}async function b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{productId:n,shopId:r,cursor:a,count:l,statId:u,tagId:c,sortType:m}=e||{};return await (0,s.U2)("/aweme/v1/web/ecom/product/comments/",(0,o._)((0,i._)({},_),{product_id:n,shop_id:r,cursor:a,count:l,stat_id:u,tag_id:c,sort_type:m}),{transformResponse:e=>d().parse(e)},void 0,t)}async function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{productId:n,shopId:r,statId:a}=e||{};return await (0,s.U2)("/aweme/v1/web/ecom/product/comment/counter/",(0,o._)((0,i._)({},_),{product_id:n,shop_id:r,stat_id:a}),{},void 0,t)}async function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{commentId:n,action:i}=e;return await (0,s.v_)("/aweme/v1/web/ecom/comment/action/",_,{comment_id:n,action:i},void 0,t)}},576669:function(e,t,n){n.d(t,{FF:function(){return g},HN:function(){return w},Lz:function(){return R},MQ:function(){return S},Zl:function(){return T},iv:function(){return y},nQ:function(){return E},vf:function(){return I}});var i=n(520739),o=n(878389);n(779788),n(675373);var r=n(746864),a=n(14108),l=n(658065),s=n(496349),u=n(349135),c=n(231755);let{COMMON_SEARCH_PARAMS:d,CHANNEL_PC_WEB:_}=s||{};function m(e){let{aweme_list:t,has_more:n,item_id_to_episode:i,status_code:o,cursor:r,log_pb:a}=e,l={};try{l=JSON.parse(i)}catch(e){}return{logPb:a&&JSON.stringify(a),itemIdToEpisode:l,statusCode:o||0,hasMore:n,cursor:r,data:(0,u.TN)({awemeList:t||[],logPb:a&&JSON.stringify(a)})||[]}}function v(e){let{aweme_list:t,has_more:n,status_code:i,max_cursor:o,log_pb:r}=e;return{logPb:r&&JSON.stringify(r),statusCode:i||0,hasMore:n,cursor:o,data:(0,u.TN)({awemeList:t||[],logPb:r&&JSON.stringify(r)})||[]}}function f(e){let{mix_infos:t,has_more:n,status_code:i,cursor:o,total:r,log_pb:a}=e;return{statusCode:i,hasMore:n,cursor:o,total:r,logPb:a&&JSON.stringify(a),data:(0,u.NR)(t||[])}}function p(e){let{extra:t,logId:n,log_pb:i,status_code:o,status_msg:r}=e,a="";try{a=JSON.stringify(i)}catch(e){}return{extra:t,logId:n,logPb:a,statusCode:o,statusMsg:r}}function h(e){let{extra:t,logId:n,log_pb:i,status_code:o,status_msg:r}=e,a="";try{a=JSON.stringify(i)}catch(e){}return{extra:t,logId:n,logPb:a,statusCode:o,statusMsg:r}}async function g(e){let{mixId:t,cursor:n,count:r=12,mixScene:a}=e,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=await (0,c.U2)("/aweme/v1/web/mix/aweme/",(0,o._)((0,i._)({},d),{mix_id:t,cursor:Math.max(n,0),count:r,mix_scene:a}),{errorTags:{mixId:t}},void 0,l,{}),_=(0,u.RL)(s,m);return(null==_?void 0:_.data)&&_.data.forEach(e=>{e.logPb=_.logPb}),_}async function w(e){let{uid:t,cursor:n=0,count:r=12,listScene:a}=e,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=await (0,c.U2)("/aweme/v1/web/mix/list/",(0,o._)((0,i._)({},d),{sec_user_id:t,req_from:_,cursor:n,count:r,list_scene:a}),{errorTags:{uid:t}},void 0,l,{});return(0,u.RL)(s,f)}function E(e,t,n){var i,o,s,u;let{currentEpisode:c}=(null==n?void 0:null===(i=n.seriesInfo)||void 0===i?void 0:i.seriesId)?null==n?void 0:n.seriesInfo:(null==n?void 0:n.mixInfo)||{},{data:d,currentEpisode:_}=(null==n?void 0:null===(o=n.seriesInfo)||void 0===o?void 0:o.seriesId)?t:e||{};if(_!==c)return!1;if(null==d?void 0:d.length){for(let e=0;e<d.length;e++)if((null===(s=d[e])||void 0===s?void 0:s.mixInfo.currentEpisode)===_&&(null==d?void 0:null===(u=d[e+1])||void 0===u?void 0:u.awemeId)){let t=null==d?void 0:d[e+1];return{awemeId:null==t?void 0:t.awemeId,url:(null==t?void 0:t.awemeType)===r.e.Note?(0,a.Wr)(null==t?void 0:t.awemeId,`previous_page=${(0,l.yW)()||""}`):(0,a.$N)(null==t?void 0:t.awemeId,`previous_page=${(0,l.yW)()||""}`),img:null==t?void 0:t.video.cover,desc:`第${null==t?void 0:t.mixInfo.currentEpisode}集 | ${null==t?void 0:t.desc}`}}}return!1}async function y(e){let{mixId:t,totalEpisode:n,currentEpisode:i,count:o}=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=Math.max(Math.min(i-1,n-o),0),{statusCode:l,data:s,hasMore:u,cursor:c,logPb:d}=await g({mixId:t,cursor:a,count:o},r);return{mixId:t,statusCode:l,data:s,currentEpisode:i,hasMore:u,cursor:0===l?c:a,logPb:d}}function N(e){let{mix_info:t,status_code:n,log_pb:i}=e;return{mixInfo:(0,u.BH)(t),statusCode:n,logPb:i}}async function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{mixId:n}=e,r=await (0,c.U2)("/aweme/v1/web/mix/detail/",(0,o._)((0,i._)({},d),{mix_id:n,req_from:_}),{},void 0,t,{});return(0,u.RL)(r,N)}async function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{mixId:n,action:r}=e,a=await (0,c.U2)("/aweme/v1/web/mix/collect/",(0,o._)((0,i._)({},d),{mix_id:n,action:r}),{},void 0,t,{});return(0,u.RL)(a,p)}async function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{mixId:n,episode:r,awemeId:a,scene:l}=e,s=await (0,c.U2)("/aweme/v1/web/mix/watch/record/",(0,o._)((0,i._)({},d),{mix_id:n,episode:r,item_id:a,scene:l}),{},void 0,t,{});return(0,u.RL)(s,h)}async function R(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{albumId:n,cursor:r,count:a=12,pullType:l=2}=e,s=await (0,c.U2)("/aweme/v1/web/minor/album/items/",(0,o._)((0,i._)({},d),{album_id:n,count:a,pull_type:l,cursor:r}),{},void 0,t,{});return(0,u.RL)(s,v)}},405039:function(e,t,n){n.d(t,{T:function(){return u},a:function(){return s}});var i=n(520739),o=n(878389);n(675373);var r=n(496349),a=n(231755);let{COMMON_SEARCH_PARAMS:l}=r||{},s=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return await (0,a.v_)("/aweme/v1/web/familiar/recommend/submit",(0,o._)((0,i._)({},l),{app_name:"douyin_web",device_platform:""}),{type:2,item_id:e,source:0,is_friend_recommend:t},{})},u=async e=>await (0,a.v_)("/aweme/v1/web/familiar/recommend/cancel",(0,o._)((0,i._)({},l),{app_name:"douyin_web",device_platform:""}),{type:2,item_id:e,source:0},{})},340290:function(e,t,n){n.d(t,{Ts:function(){return d},WW:function(){return m},bJ:function(){return _}});var i=n(520739),o=n(878389);n(779788),n(675373),n(209955);var r=n(496349),a=n(349135),l=n(231755),s=n(913807);let{COMMON_SEARCH_PARAMS:u}=r;function c(e){let{aweme_list:t=[],status_code:n,has_more:i,log_pb:o}=e;return{logPb:o&&JSON.stringify(o),statusCode:n,hasMore:i,awemeList:(0,a.TN)({awemeList:t,logPb:o&&JSON.stringify(o)})}}let d="/aweme/v1/web/aweme/related/";async function _(e){let{awemeId:t,count:n=6,filterGids:r="",seoFlag:_=0,subChannelId:m=0,refreshIndex:v}=e,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,p=await (0,l.U2)(d,(0,o._)((0,i._)({},u),{aweme_id:t,count:n,filterGids:r,awemePcRecRawData:(0,s.getAwemePcRecRawData)(f),sub_channel_id:m,"Seo-Flag":_,refresh_index:v}),{errorTags:{awemeId:t}},void 0,f,{}),h=(0,a.RL)(p,c);return h.awemeList&&h.awemeList.forEach(e=>{e.logPb=h.logPb}),h}async function m(e){let{awemeId:t,count:n=1}=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{status_code:a,aweme_id:c,desc:d,duration:_,cover:m,extra:v}=await (0,l.U2)("/aweme/v1/web/related/video/lite",(0,o._)((0,i._)({},u),{aweme_id:t,count:n,awemePcRecRawData:(0,s.getAwemePcRecRawData)(r,{is_related_hover:1}),channel:"channel_pc_web"}),{errorTags:{awemeId:t}},void 0,r,{});if(a)throw Error();return{awemeId:c,title:d,duration:_,cover:null==m?void 0:m[0],debugInfo:JSON.parse(v||"null")}}},577094:function(e,t,n){n.d(t,{F8:function(){return _},Ts:function(){return v},Ws:function(){return d},d0:function(){return f},hl:function(){return p}});var i=n(520739),o=n(878389);n(268917),n(779788),n(675373);var r=n(496349),a=n(231755),l=n(349135);n(658016);var s=n(105600);let{COMMON_SEARCH_PARAMS:u}=r;function c(e){let{status_code:t,link_data:n=[],show_pos:i=0}=e;return{statusCode:t,data:n.map(e=>{let{link_type:t=0,count:n=0,link_list:i=[]}=e;return{type:t,count:n,links:i}}),showPos:null!=i?i:0}}async function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=await (0,a.U2)("/aweme/v1/web/seo/inner/link/",(0,o._)((0,i._)({},u),{entity_id:t,entity_type:n}),{},void 0,e,{});return(0,l.RL)(r,c)}async function _(){let{count:e=2}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return arguments.length>1&&void 0!==arguments[1]&&arguments[1],{statusCode:-1,data:[]}}function m(e){var t;let{status_code:n,status_msg:i,data:o,log_pb:r}=e;return{statusCode:n,statusMsg:i,data:null==o?void 0:o.map(e=>({targetId:e.target_id,hitStatus:e.hit_status})),logPb:null!==(t=null==r?void 0:r.impr_id)&&void 0!==t?t:""}}async function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=await (0,a.U2)("/aweme/v1/web/seo/judge/whitelist/",(0,o._)((0,i._)({},u),{target_ids:e}),{},void 0,t,{});return(0,l.RL)(n,m)}async function f(e){let{awemeId:t,url:n}=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=await (0,a.U2)("/aweme/v1/web/seo/keyword/related/",(0,o._)((0,i._)({},u),{itemIds:t,url:n}),{},void 0,r,{});return(0,l.RL)(s,e=>(0,l.Fo)(e,t))}async function p(e){let{awemeId:t="",secUid:n="",entityType:r=s.EntityType.Video,cusotmConfig:c={},entityId:d=""}=e,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,m=await (0,a.U2)("/aweme/v1/web/seo/detail/links/",(0,o._)((0,i._)({},u),{aweme_id:t,entity_type:r,sec_uid:n,entity_id:d}),{},void 0,_,{});return(0,l.RL)(m,e=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{links_list:n,status_code:i,log_pb:o}=e,r=[];return(n||[]).forEach(e=>{r.push({moduleSource:e.module_source,moduleTitle:e.module_title,isShowUserUrl:e.is_show_user_url,list:(0,l.TN)({awemeList:null==e?void 0:e.aweme_list,logPb:o,config:t}),linkList:(0,l.uJ)({linkList:null==e?void 0:e.link_list})})}),{statusCode:0===i?0:-1,detail:r,logPb:o&&JSON.stringify(o)}})(e,c))}},366334:function(e,t,n){n.d(t,{A4:function(){return T},DS:function(){return I},Id:function(){return y},NN:function(){return _},Rh:function(){return f},XL:function(){return E},bV:function(){return R},fd:function(){return h},v6:function(){return m}});var i=n(520739),o=n(878389);n(779788),n(675373);var r=n(496349),a=n(493523),l=n(349135),s=n(231755),u=n(237156);let{COMMON_SEARCH_PARAMS:c}=r||{};function d(e){let{aweme_list:t=[],status_code:n,log_pb:i,position:o,is_force_insert:r=!1}=e;return{statusCode:n,position:o,isForceInsert:r,hasMore:!0,awemeList:(0,l.TN)({awemeList:t||[],logPb:i&&JSON.stringify(i)}),logPb:i&&JSON.stringify(i)}}async function _(){let{tagId:e="",count:t=10,refreshIndex:n=1,globalwid:r="",pullType:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,_=await (0,s.U2)("/aweme/v1/web/tab/feed/",(0,o._)((0,i._)({},c),{tag_id:e,count:t,refresh_index:n,video_type_select:1,globalwid:r,pull_type:a}),{errorTags:{tagId:e}},void 0,u,{});return(0,l.RL)(_,d)}async function m(e){let{count:t=10,refreshIndex:n=1,scene:r="recommend"}=e||{},a=await (0,s.v_)("/aweme/v2/web/tab_listen/feed/",(0,o._)((0,i._)({},c),{count:t,pull_type:2,refresh_index:n,web_listen_feed_scene:r}),{},void 0,null);return(0,l.RL)(a,d)}function v(e){let{status_code:t,log_pb:n,ch_info:i}=e;return{statusCode:t,info:(0,l.P$)(i),logPb:n&&JSON.stringify(n)}}async function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{chId:n,queryType:r=0}=e,a=await (0,s.U2)("/aweme/v1/web/challenge/detail/",(0,o._)((0,i._)({},c),{ch_id:n,query_type:r}),{},void 0,t,{});return(0,l.RL)(a,v)}function p(e){let{aweme_list:t=[],status_code:n,log_pb:i,has_more:o,cursor:r}=e;return{statusCode:n,awemeList:(0,l.TN)({awemeList:t||[],logPb:i&&JSON.stringify(i)}),logPb:i&&JSON.stringify(i),hasMore:o,cursor:r}}async function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{chId:n,hashtagName:r,queryType:a=0,sortType:d=u.H.Comprehensive,count:_,cursor:m,isCommerce:v=!1}=e,f=await (0,s.U2)(v?"/aweme/v1/web/commerce/challenge/aweme/":"/aweme/v1/web/challenge/aweme/",(0,o._)((0,i._)({},c),{ch_id:n,hashtag_name:r,query_type:a,sort_type:v?0:d,offset:m,cursor:m,count:_}),{},void 0,t,{});return(0,l.RL)(f,p)}function g(e){let{music_info:t,status_code:n,log_pb:i}=e;return{statusCode:n,musicInfo:(0,l.o0)(t),logPb:i&&JSON.stringify(i)}}function w(e){let{music_info:t,status_code:n,log_pb:i,msg:o,res_list:r,extra:a}=e,l="";try{l=JSON.stringify(i)}catch(e){}return{musicInfo:t,statusCode:n,logPb:l,msg:o,resList:r,extra:a}}async function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{musicId:n,scene:r=1}=e,a=await (0,s.U2)("/aweme/v1/web/music/detail/",(0,o._)((0,i._)({},c),{music_id:n,scene:r}),{},void 0,t,{});return(0,l.RL)(a,g)}async function y(e){let{musicId:t,action:n}=e,o=await (0,s.v_)("/aweme/v1/web/music/collect/",(0,i._)({},c),{music_id:t,type:n,action:n},void 0,null);return(0,l.RL)(o,w)}function N(e){let{aweme_list:t=[],status_code:n,log_pb:i,has_more:o,cursor:r}=e;return{statusCode:n,awemeList:(0,l.TN)({awemeList:t||[],logPb:i&&JSON.stringify(i)}),logPb:i&&JSON.stringify(i),hasMore:o,cursor:r}}async function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{musicId:n,count:r=10,cursor:a}=e,u=await (0,s.U2)("/aweme/v1/web/music/aweme/",(0,o._)((0,i._)({},c),{count:r,cursor:a,music_id:n}),{},void 0,t,{});return(0,l.RL)(u,N)}function S(e){let{extra:t,cursor:n,status_code:i,has_more:o,challenge_list:r=[],qs:a,is_match:s,keyword_disabled:u}=e;return{statusCode:i,hasMore:o,challengeList:(null==r?void 0:r.map(e=>(0,l.P$)(null==e?void 0:e.challenge_info)))||[],qs:a,isMatch:s,cursor:n,keywordDisabled:u,extra:{now:null==t?void 0:t.now,logid:null==t?void 0:t.logid}}}async function T(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{keyword:n,count:r=10,cursor:a}=e,u=await (0,s.U2)("/aweme/v1/web/challenge/search/",(0,o._)((0,i._)({},c),{count:r,cursor:a,keyword:n}),{},void 0,t,{});return(0,l.RL)(u,S)}async function R(){let{scene:e=a.t.PcOftenWatch,ids:t=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],0===t.filter(e=>e).length)return;let n=await (0,s.v_)("/aweme/v1/web/write/impression/",(0,i._)({},c),{scene:e,ids:t.join(" ")});return(0,l.RL)(n,d)}},28237:function(e,t,n){n.d(t,{R:function(){return u},n:function(){return s}}),n(250440);var i=n(256277),o=n(32167),r=n(658065),a=n(577786),l=n(669201);let s=e=>{var t,n,i,o,r,a,s;return(null==e?void 0:null===(t=e.anchorInfo)||void 0===t?void 0:t.type)===l.as.AnchorShop&&(null==e?void 0:null===(o=e.anchorInfo)||void 0===o?void 0:null===(i=o.extra)||void 0===i?void 0:null===(n=i[0])||void 0===n?void 0:n.product_detail_schema)&&[1,4].includes(Number(null==e?void 0:null===(s=e.anchorInfo)||void 0===s?void 0:null===(a=s.extra)||void 0===a?void 0:null===(r=a[0])||void 0===r?void 0:r.platform))},u=e=>{var t,n,l,s;let u=(null==e?void 0:null===(n=e.anchorInfo)||void 0===n?void 0:null===(t=n.extra)||void 0===t?void 0:t[0])||{},c=(0,i.Rx)(e)||{};return{source_page:(0,o.mo)(),enter_from:(0,o.mo)(),enter_from_merge:(0,r.yW)(),group_id:e.awemeId,content_id:e.awemeId,author_id:null===(l=e.authorInfo)||void 0===l?void 0:l.uid,follow_status:(0,a.F)(null===(s=e.authorInfo)||void 0===s?void 0:s.followStatus)?"1":"0",commodity_id:u.promotion_id||"",commodity_type:u.promotion_source||"",product_id:u.product_id||"",cid:c.creative_id}}},503479:function(e,t,n){var i=n(520739),o=n(878389),r=n(563097),a=n(88648);let l=(0,a.forwardRef)((e,t)=>(0,r.jsx)("svg",(0,o._)((0,i._)({width:13,height:13,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,r.jsx)("path",{d:"M11.867 11.867a1.211 1.211 0 0 1-1.712 0l-3.71-3.71-3.711 3.71a1.211 1.211 0 1 1-1.713-1.712l3.71-3.71-3.71-3.711A1.21 1.21 0 1 1 2.734 1.02l3.71 3.71 3.71-3.71a1.211 1.211 0 0 1 1.713 1.713l-3.71 3.71 3.71 3.71c.473.474.473 1.24 0 1.713z",fill:"#2F3035",fillOpacity:".7"})})));t.Z=l},81849:function(e,t,n){var i=n(520739),o=n(878389),r=n(563097),a=n(88648);let l=(0,a.forwardRef)((e,t)=>(0,r.jsx)("svg",(0,o._)((0,i._)({width:14,height:14,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 14A7 7 0 1 0 7 0a7 7 0 0 0 0 14zM6 3.678C6 3.301 6.41 3 6.924 3h.205c.514 0 .924.301.924.678v4.343c0 .377-.41.679-.924.679h-.205C6.411 8.7 6 8.398 6 8.02V3.678zm.3 7.878a.95.95 0 0 1-.3-.683.95.95 0 0 1 .3-.684 1.073 1.073 0 0 1 1.453 0c.19.179.3.43.3.684a.95.95 0 0 1-.3.683 1.073 1.073 0 0 1-1.452 0z",fill:"#FE3824"})})));t.Z=l},652571:function(e,t,n){var i=n(88648),o=n(774765);function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}t.Z=function(e,t){var n,a,l=(a=2,function(e){if(Array.isArray(e))return e}(n=(0,i.useState)(e))||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,o=!1,r=void 0;try{for(var a,l=e[Symbol.iterator]();!(i=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&null!=l.return&&l.return()}finally{if(o)throw r}}return n}}(n,2)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}(n,a)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=l[0],u=l[1];return(0,o.Z)(function(){u(e)},t,[e]),s}},774765:function(e,t,n){var i=n(88648),o=n(784492);function r(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=a.immediately,s=void 0!==l&&l,u=a.trailing,c=void 0===u||u,d=a.leading,_=void 0!==d&&d,m=(0,i.useRef)(),v=(0,i.useRef)(!1),f=(0,i.useRef)(!1),p=(0,i.useRef)(e);p.current=e;var h=(0,i.useRef)([]),g=(0,i.useCallback)(function(){m.current&&clearTimeout(m.current)},[]),w=(0,i.useCallback)(function(){for(var e,n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];if(h.current=i,s&&!v.current){p.current.apply(p,r(h.current)),v.current=!0;return}g(),_&&!1==f.current&&(p.current.apply(p,r(h.current)),f.current=!0),m.current=(e=c,window.setTimeout(function(){e&&p.current.apply(p,r(h.current)),f.current=!1},t))},[t,g]);return(0,o.Z)(function(){return w(),g},[].concat(r(n),[w])),(0,i.useEffect)(function(){return g},[]),{run:w,cancel:g}}}}]);
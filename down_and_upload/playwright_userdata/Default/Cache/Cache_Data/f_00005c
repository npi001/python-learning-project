"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["27269"],{769901:function(e,t,i){e.exports=i.p+"media/db_tap.b545ba4bedef03d8.png"},569231:function(e,t,i){e.exports=i.p+"media/generalBG.9f4484112e793191.png"},730843:function(e,t,i){i.d(t,{Q:function(){return u}});var l=i("520739"),n=i("878389");i("874386"),i("826893"),i("268917"),i("455663"),i("675373");var o=i("88648"),r=i("63976");i("338172");var a=i("782442"),d=i("903868");let s=e=>{let{awemeInfo:t}=e,{desc:i,webRawData:l}=t,{isMainland:n}=(0,d.Iq)(e=>{let{isMainland:t}=e;return{isMainland:t}}),[s,u]=(0,o.useState)(`${i}${(null==l?void 0:l.targetTitle)?`\\N${null==l?void 0:l.targetTitle}`:""}`);return(0,o.useEffect)(()=>{(null==l?void 0:l.targetTitle)?u(`${i}\\N${null==l?void 0:l.targetTitle}`):u(i)},[l,i]),(0,o.useEffect)(()=>{var e;let t=a.Le.getConfig(a.gI.AbtestData);(null==t?void 0:t.i18nAb)&&!n&&!(null===(e=navigator)||void 0===e?void 0:e.language.startsWith("zh"))&&!l.targetTitle&&(async()=>{let e=await (0,r.O9)({sourceText:i,targetLanguage:"en"});if(0===e.statusCode){var t,l;let n=null===(l=e.translation)||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:t.translation;u(`${i}\\N${n}`)}})()},[l,n,i]),{finalTitle:s}},u=e=>{var t;let{awemeInfo:i,abTestData:a}=e,{itemTitle:u,caption:c,textExtra:v}=i,{isMainland:f}=(0,d.Iq)(e=>{let{isMainland:t}=e;return{isMainland:t}}),m=(0,o.useRef)(null),g=(null==a?void 0:a.videoInfoTitleDisplayStrategy)===1&&!!(null===(t=i.itemTitle)||void 0===t?void 0:t.trim()),{finalTitle:h}=s({awemeInfo:i}),[p,_]=(0,o.useState)(u),[y,x]=(0,o.useState)(c),w=(0,o.useMemo)(()=>{let e;if(!g||!v||!Array.isArray(v)||0===v.length)return v;let t=[],i=/#[^\s#]+/g;for(;e=i.exec(y);)t.push({hashtagName:e[0].substring(1),start:e.index,end:e.index+e[0].length});return v.filter(e=>t.some(t=>t.hashtagName===e.hashtagName)).map(e=>{let i=t.find(t=>t.hashtagName===e.hashtagName);return(0,n._)((0,l._)({},e),{start:(null==i?void 0:i.start)||0,end:(null==i?void 0:i.end)||0})})},[g,v,y]),[I,b]=(0,o.useState)(1),[C,T]=(0,o.useState)(!1),S=(0,o.useMemo)(()=>g?Math.max(1,3-I):3,[g,I]);return(0,o.useLayoutEffect)(()=>{if(!m.current)return;let e=e=>{var t;if(!e){b(1),T(!1);return}let i=null===(t=getComputedStyle(e))||void 0===t?void 0:t.lineHeight;b(Math.round(e.offsetHeight/parseFloat(i))),T(function(e){if(!(e instanceof HTMLElement))return!1;let t=getComputedStyle(e);return"hidden"===t.overflow&&("nowrap"===t.whiteSpace?e.scrollWidth>e.offsetWidth:!!t.webkitLineClamp&&e.scrollHeight>e.offsetHeight)}(e))};if(e(m.current),"undefined"!=typeof ResizeObserver){let t=new ResizeObserver(t=>{e(t[0].target)});return t.observe(m.current),()=>{t.disconnect()}}{let t=()=>e(m.current);return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}},[m.current]),(0,o.useEffect)(()=>{f?(_(u),x(c)):(async()=>{let e=await Promise.all([(0,r.O9)({sourceText:u,targetLanguage:"en"}),(0,r.O9)({sourceText:c,targetLanguage:"en"})]);if(e.every(e=>0===e.statusCode)){var t,i,l,n;let[o,r]=e;_(null===(i=o.translation)||void 0===i?void 0:null===(t=i[0])||void 0===t?void 0:t.translation),x(null===(n=r.translation)||void 0===n?void 0:null===(l=n[0])||void 0===l?void 0:l.translation)}})()},[f,u,c]),{isShowTitleAndDescAlone:g,finalTitle:h,title:p,desc:y,computedTextExtra:w,titleElRef:m,descLine:S,isTitleWrapped:C}}},121038:function(e,t,i){i.d(t,{o:function(){return M}});var l=i("520739");i("874386");var n=i("563097"),o=i("88648"),r=i("877639"),a=i.n(r),d=i("713097"),s=i.n(d),u=i("702726"),c=i("919780"),v=i("256277"),f=i("637005"),m=i("606604"),g=i("929582"),h=i("56497"),p=i("410665"),_=i("831202"),y=i("428647"),x=i("999349"),w=i("878389");let I=(0,o.forwardRef)((e,t)=>(0,n.jsxs)("svg",(0,w._)((0,l._)({width:30,height:16,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:[(0,n.jsxs)("g",{clipPath:"url(#ad_svg__clip0_315_3529)",children:[(0,n.jsx)("path",{d:"M28 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h26a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z",fill:"#000",fillOpacity:".08"}),(0,n.jsx)("path",{d:"M9.491 2.004L8.22 2.22c.216.336.408.72.588 1.128h-4.38v3.636c-.024 2.34-.348 4.176-.972 5.496l.96.852c.744-1.596 1.128-3.708 1.164-6.348V4.452h8.796V3.348h-4.308a16.724 16.724 0 0 0-.576-1.344zm15.564 6.672h-8.04v4.548h1.152v-.576h5.736v.576h1.152V8.676zm-6.888 2.904V9.756h5.736v1.824h-5.736zm-.276-6.732h2.688v1.656h-5.04V7.62h10.92V6.504h-4.74V4.848h3.828V3.756H21.72V2.148h-1.14v1.608h-2.016c.204-.408.372-.852.516-1.32l-1.128-.144c-.384 1.248-1.104 2.292-2.16 3.144l.684.9a8.301 8.301 0 0 0 1.416-1.488z",fill:"#fff",fillOpacity:".8"})]}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"ad_svg__clip0_315_3529",children:(0,n.jsx)("path",{fill:"#fff",d:"M0 0h30v16H0z"})})})]})));var b=i("906499"),C=i("473677"),T=i("769901"),S=i("418622"),E=i("254897");let k=e=>{var t,i,l,r,d,v,m,g,h,w;let{awemeInfo:k,isActive:N,className:P,onBrandComponentShow:L,onBrandComponentClose:j,onImgError:M,brandAdComponentFloatTip:A,onBrandComponentHide:R}=e||{},[Z,B]=(0,o.useState)(!1),[D,V]=(0,o.useState)(!1),U=(0,o.useRef)(!1),F=(0,o.useRef)(!1);(0,S.e)({timerCb:e=>{var t,i;if(U.current)return;let{currentTime:l,isEnd:n}=e,o=null!==(t=A.show_time)&&void 0!==t?t:3,r=null!==(i=A.show_time+.5)&&void 0!==i?i:3.5;l<o&&(B(!1),V(!1),null==R||R()),l>=o&&(!F.current&&(null==L||L(),F.current=!0),B(!0),null==L||L()),l>=r&&V(!0),n&&!U.current&&(!F.current&&(null==L||L(),F.current=!0),B(!0),V(!0),null==R||R())},stopBySeeking:!1,awemeInfo:k,isActive:N,needInit:!0});let z=a()(e=>{var t,i;if(e.stopPropagation(),u.logInstance.sendLog("brandAdIconClick",{group_id:null==k?void 0:k.awemeId,brand_ad_type:c.AD_LOG_MAP[null==k?void 0:null===(i=k.webRawData)||void 0===i?void 0:null===(t=i.brandAd)||void 0===t?void 0:t.brand_type],img_url:null==A?void 0:A.img_url,position:"lower_left",icon_type:"image"}),null==A?void 0:A.is_open_JX_modal){e.preventDefault(),f.emit(f.EVENT.OpenJXModal,{source:"feed_interstitial_ad"});return}f.emit(f.EVENT.videoPause,"FloatTip_onClick")},1e3,{leading:!0,trailing:!1}),O=(0,p.x)(()=>{var e,t;u.logInstance.sendLog("brandAdIconShow",{group_id:null==k?void 0:k.awemeId,brand_ad_type:c.AD_LOG_MAP[null==k?void 0:null===(t=k.webRawData)||void 0===t?void 0:null===(e=t.brandAd)||void 0===e?void 0:e.brand_type],img_url:null==A?void 0:A.img_url,position:"lower_left",icon_type:"image"})});return(0,n.jsxs)("div",{className:s()(x.default.adWrapper,P,{[x.default.show]:Z}),style:{width:null==A?void 0:null===(t=A.img_size)||void 0===t?void 0:t.width,height:null==A?void 0:null===(i=A.img_size)||void 0===i?void 0:i.height},ref:O,children:[(0,n.jsxs)(b.a,{onClick:e=>z(e),className:x.default.adButton,style:{width:null==A?void 0:null===(l=A.img_size)||void 0===l?void 0:l.width,height:null==A?void 0:null===(r=A.img_size)||void 0===r?void 0:r.height},target:"_blank",href:null==k?void 0:null===(v=k.webRawData)||void 0===v?void 0:null===(d=v.brandAd)||void 0===d?void 0:d.open_url,children:[(0,n.jsx)("img",{className:x.default.brandImg,src:null==A?void 0:A.img_url,style:{width:null==A?void 0:null===(m=A.img_size)||void 0===m?void 0:m.width,height:null==A?void 0:null===(g=A.img_size)||void 0===g?void 0:g.height},onError:()=>{var e,t;null==M||M(),B(!1),U.current=!0,null==j||j(),_.oe.event.error({name:_.Mo.BrandComponentError,report:{type:"img"}}),u.logInstance.sendLog("brandAdIconClose",{group_id:null==k?void 0:k.awemeId,brand_ad_type:c.AD_LOG_MAP[null==k?void 0:null===(t=k.webRawData)||void 0===t?void 0:null===(e=t.brandAd)||void 0===e?void 0:e.brand_type]})}}),A.has_guide&&D&&(0,n.jsx)("img",{src:T,className:x.default.tapIcon}),(0,n.jsx)(C.Z,{className:x.default.adIcon,src:I,width:30,height:16,viewBox:"0 0 30 16"})]}),A.has_close_btn&&(0,n.jsx)(E.z,{className:x.default.close,svg:(0,n.jsx)(y.Z,{}),style:{position:"absolute",bottom:`${null==A?void 0:null===(h=A.close_btn_position)||void 0===h?void 0:h.bottom}px`,right:`${null==A?void 0:null===(w=A.close_btn_position)||void 0===w?void 0:w.right}px`},onClick:e=>{var t,i;B(!1),U.current=!0,null==j||j(),u.logInstance.sendLog("brandAdIconClose",{group_id:null==k?void 0:k.awemeId,brand_ad_type:c.AD_LOG_MAP[null==k?void 0:null===(i=k.webRawData)||void 0===i?void 0:null===(t=i.brandAd)||void 0===t?void 0:t.brand_type]})}})]})};var N=i("205457"),P=i("894416");let L=e=>{var t,i,l,r,d,v,p,_;let{awemeInfo:y,className:x,isActive:w,onBrandComponentClose:I,onBrandComponentShow:C}=e||{},[T,S]=(0,o.useState)(!1),[N,P]=(0,o.useState)(!1),L=null==y?void 0:null===(t=y.webRawData)||void 0===t?void 0:t.brandAd,j=null==L?void 0:null===(r=L.biz_content)||void 0===r?void 0:null===(l=r.brand_ad_component_config)||void 0===l?void 0:null===(i=l.left)||void 0===i?void 0:i[0],M=(0,o.useRef)(!1),A=a()(e=>{var t,i,l;if(e.stopPropagation(),u.logInstance.sendLog("brandAdIconClick",{group_id:null==y?void 0:y.awemeId,brand_ad_type:c.AD_LOG_MAP[null==y?void 0:null===(i=y.webRawData)||void 0===i?void 0:null===(t=i.brandAd)||void 0===t?void 0:t.brand_type],position:"lower_left",icon_type:"button"}),null==j?void 0:null===(l=j.brand_ad_component_float_tip)||void 0===l?void 0:l.is_open_JX_modal){e.preventDefault(),f.emit(f.EVENT.OpenJXModal,{source:"feed_interstitial_ad"});return}f.emit(f.EVENT.videoPause,"FeedBrandCard_handleAdBtnClick")},1e3,{leading:!0,trailing:!1}),R=!T&&(null==j?void 0:j.brand_ad_component_type)===m.Wy.Img&&!N;return((0,o.useEffect)(()=>{if(!R&&!M.current){var e,t;u.logInstance.sendLog("brandAdIconShow",{group_id:null==y?void 0:y.awemeId,brand_ad_type:c.AD_LOG_MAP[null==y?void 0:null===(t=y.webRawData)||void 0===t?void 0:null===(e=t.brandAd)||void 0===e?void 0:e.brand_type],position:"lower_left",icon_type:"button"}),M.current=!0}},[R]),R)?(0,n.jsx)(k,{awemeInfo:y,isActive:w,onBrandComponentClose:()=>{null==I||I(),P(!0)},onBrandComponentHide:()=>{null==I||I()},onBrandComponentShow:C,onImgError:()=>{S(!0)},brandAdComponentFloatTip:null==j?void 0:j.brand_ad_component_float_tip}):(0,n.jsx)("div",{className:s()(h.default.adWrapper,x),id:h.default.adWrapper,children:(0,n.jsxs)(b.a,{onClick:e=>A(e),className:h.default.adButton,target:"_blank",href:null==y?void 0:null===(v=y.webRawData)||void 0===v?void 0:null===(d=v.brandAd)||void 0===d?void 0:d.open_url,children:[(0,n.jsx)("span",{children:(null==y?void 0:null===(_=y.webRawData)||void 0===_?void 0:null===(p=_.brandAd)||void 0===p?void 0:p.brand_title)||"查看详情"}),(0,n.jsx)(E.z,{svg:(0,n.jsx)(g.Z,{}),style:{color:"#ffffff",height:"14px",fontSize:"14px"}})]})})};function j(e){var t,i,o,r,a,d,s,u,c;let{awemeInfo:f}=e||{},m=(0,v.Kf)(f),g=null==f?void 0:null===(t=f.webRawData)||void 0===t?void 0:t.brandAd,h=null==g?void 0:g.open_url,p=null==g?void 0:null===(d=g.biz_content)||void 0===d?void 0:null===(a=d.brand_ad_component_config)||void 0===a?void 0:null===(r=a.left)||void 0===r?void 0:null===(o=r[0])||void 0===o?void 0:null===(i=o.brand_ad_component_float_tip)||void 0===i?void 0:i.is_open_JX_modal;return m&&(h||p)&&(null==g?void 0:null===(c=g.biz_content)||void 0===c?void 0:null===(u=c.brand_ad_component_config)||void 0===u?void 0:null===(s=u.left)||void 0===s?void 0:s.length)>0?(0,n.jsx)(L,(0,l._)({},e)):null}let M=e=>{let t=(0,P.N)();return(0,n.jsx)(N.k,{componentName:"FeedBrandAd",Slardar:t,children:(0,n.jsx)(j,(0,l._)({},e))})}},418622:function(e,t,i){i.d(t,{e:function(){return f}});var l=i(88648),n=i(734123),o=i(948375),r=i(784492),a=i(256277),d=i(325982),s=i(945977),u=i(597321),c=i(860684),v=i(288679);function f(e){let{timerCb:t,isActive:i,awemeInfo:f,needInit:m=!0,stopBySeeking:g=!0}=e,h=(0,c.n)(),p=(0,l.useRef)(!0),_=(0,l.useRef)(!1),y=(0,o.Z)(e=>{let{currentTime:i}=e||{};t({currentTime:i,isSeeking:!1})}),x=(0,o.Z)(e=>{let{currentTime:i}=e;if(0!==i){g&&(I(),p.current=!1),t({currentTime:i,isSeeking:!0});let e=(0,a.Rx)(f);(null==e?void 0:e.creative_id)&&(0,d.E)("drag_bar",{tag:(0,s.f)(),value:null==e?void 0:e.creative_id,log_extra:null==e?void 0:e.log_extra})}}),w=(0,o.Z)(()=>{if(!_.current){var e,t;null==h||null===(e=h.on)||void 0===e||e.call(h,u.B.TimeUpdate,y),null==h||null===(t=h.on)||void 0===t||t.call(h,n.Events.SEEKING,x)}_.current=!0}),I=(0,o.Z)(()=>{if(_.current){var e,t;null==h||null===(e=h.off)||void 0===e||e.call(h,u.B.TimeUpdate,y),null==h||null===(t=h.off)||void 0===t||t.call(h,n.Events.SEEKING,x)}_.current=!1}),b=(0,l.useCallback)(()=>{p.current=!0},[]),C=(0,l.useCallback)(()=>{m&&(b(),w()),t({currentTime:0,isSeeking:!0,isEnd:!0})},[m,b,w,t]);return(0,v.u)(h,u.B.Ended,C),(0,r.Z)(()=>{b()},[f]),(0,l.useEffect)(()=>{if(!!i){if(h&&p.current)return w(),()=>{I()}}},[h,f,i,w,I]),(0,l.useEffect)(()=>{(null==h?void 0:h.currentTime)&&y({currentTime:h.currentTime})},[h]),{stopListen:I}}},477435:function(e,t,i){i.d(t,{x:function(){return O}});var l=i("520739");i("874386"),i("250440");var n=i("563097"),o=i("88648"),r=i("734123"),a=i("309931"),d=i("35730"),s=i("60013"),u=i("79307"),c=i("399796"),v=i("555106"),f=i("658065"),m=i("330746"),g=i("782442"),h=i("637005"),p=i("544933"),_=new p.h({voiceBubbleShow:{eventName:"voice_bubble_show",params:{enter_from:"",mute_type:""}},voiceBarShow:{eventName:"voice_bar_show",params:{enter_from:""}},clickVoiceBubble:{eventName:"click_voice_bubble",params:{is_open:1,mute_type:""}}}),y=i("878389"),x={User:"user",Browser:"browser"};let w={isAlwaysPrevent:!1,slideTime:0,isTipShow:!1},I={isAlwaysPrevent:!1,slideTime:5,isTipShow:!0},b=d.LocalStorageKeys.forceMuteInfo,C=g.gI.ForceMuted,T=()=>{let e=(0,v.$o)(b),t=!!((null==e?void 0:e.user)||(null==e?void 0:e.browser));return!t&&(0,v.bv)(b),t?e:null},S=e=>(0,v.qQ)(b,(0,l._)({},(0,v.$o)(b),e)),E=(e,t)=>g.Le.setConfig(C,(0,y._)((0,l._)({},g.Le.getConfig(C)),{[e]:t})),k=e=>{var t;return null===(t=g.Le.getConfig(C))||void 0===t?void 0:t[e]},N=e=>g.Le.setConfig(C,(0,l._)({},w,e)),P=(e,t)=>g.Le.setConfig(C,(0,l._)((0,y._)((0,l._)({},I),{currentMuteType:e,slideTime:5}),t)),L=e=>{let t=T(),{showTime:i,closeTime:l}=(null==t?void 0:t[e])||{},n=null!=l?l:i;return n&&Date.now()-n<=864e5*("user"===e?7:3)},j=e=>e.muted||0===e.volume,M=e=>{let{onFail:t,onSuccess:i,player:l}=e;!j(l)&&(E("isMuted",!0),l.muted=!0),setTimeout(()=>{!j(l)&&(E("isMuted",!0),l.muted=!0),l.paused&&l.play(),setTimeout(()=>{l.paused?(l.muted=!1,null==t||t()):j(l)&&(null==i||i())},500)},100)};var A=i("205457"),R=i("860684"),Z=i("894416"),B=i("631493"),D=i("597321"),V=i("962820"),U=i("302511"),F=i("764942");let z=e=>{var t,i;let{isShowGuide:l=!1,isActive:p,awemeInfo:y,abtestData:w,scene:I}=e,{awemeId:b}=y,C=(0,R.n)(),[T,j]=(0,o.useState)(!1),A=(0,o.useRef)(!1),Z=k("isTipShow"),[z,O]=(0,o.useState)(null!=Z&&Z),{attemptOpen:W,executeClose:$}=(0,s.B)({popName:"浏览器限制-声音提醒",onOpen:()=>{O(!0)},onClose:()=>{O(!1)}}),H=(0,o.useMemo)(()=>(!C||B.s.getPlayerScene(C.playerId)===u.lT.Modal||!(B.s.getPlayersByScene(u.lT.Modal).length>0))&&C&&p&&!l&&!k("isAlwaysPrevent"),[p,l,C]),K=(0,o.useCallback)(e=>{if(H){if(!k("isTipShow"))M({player:C,onSuccess:()=>{W({afterCallback:()=>{P(e),_.sendLog("voiceBubbleShow",{enter_from:(0,f.yW)(),mute_type:k("currentMuteType")}),S({[e]:{showTime:Date.now()}})}})},onFail:()=>{N({isAlwaysPrevent:!0})}}),E("currentMuteType",e),e===x.Browser&&(0,v.qQ)(d.LocalStorageKeys.browserMute,!0)}},[C,H]),G=(0,o.useCallback)(()=>{let e=k("currentMuteType");if(!!e&&!!k("isTipShow"))$(),E("isTipShow",!1),S({[e]:{closeTime:Date.now()}})},[]),q=(0,o.useRef)(!1);(0,o.useEffect)(()=>{if(C&&p){let e=()=>{q.current=!0};return C.on("autoplay_was_prevented",e),()=>{C.off("autoplay_was_prevented",e)}}},[C,p]),(0,o.useEffect)(()=>{let e=()=>{if(!(!C.paused&&!C.muted&&C.volume>0||(0,m.G6)()||A.current||(0,F.f)())){if(A.current=!0,L(x.Browser)){M({player:C}),(0,v.qQ)(d.LocalStorageKeys.browserMute,!0);return}K(x.Browser)}};return C&&(q.current||C.inlinePlayerAutoPlayWasPrevented)&&(e(),q.current=!1,C.inlinePlayerAutoPlayWasPrevented=!1),null==C||C.on("autoplay_was_prevented",e),()=>null==C?void 0:C.off("autoplay_was_prevented",e)},[C,K]),(0,o.useEffect)(()=>{C&&C.muted&&(0,v.$o)(d.LocalStorageKeys.browserMute)&&!L(x.Browser)&&K(x.Browser)},[C,K]),(0,o.useEffect)(()=>{if("user"!==k("currentMuteType"))((c.Q.getItem({sKey:d.CookieKeys.VolumeInfo})||{}).isUserMute||(0,v.$o)(d.LocalStorageKeys.userMute))&&!L(x.User)&&K(x.User)},[K]),(0,o.useEffect)(()=>{var e;let{isInMiniModal:t}=null!==(e=g.Le.getConfig(g.gI.IsInLookMiniModal))&&void 0!==e?e:{};if(t){$();return}let i=k("isTipShow");p&&(i?W({afterCallback:()=>{let e=k("slideTime")-1;E("slideTime",e),e<=0&&G()}}):$())},[b,p,G]),(0,o.useEffect)(()=>{if(C){let e=e=>{((null==e?void 0:e.action)==="change_muted"||(null==e?void 0:e.action)==="change_volume")&&((0,v.qQ)(d.LocalStorageKeys.browserMute,!1),(z||k("isTipShow"))&&G(),setTimeout(()=>{!0===C.muted||0===C.volume?((0,v.qQ)(d.LocalStorageKeys.userMute,!0),S({[x.User]:{closeTime:Date.now()}})):(0,v.qQ)(d.LocalStorageKeys.userMute,!1)}))};return C.on(r.Events.USER_ACTION,e),()=>{C.off(r.Events.USER_ACTION,e)}}},[C,z,G]),(0,o.useEffect)(()=>{if(C){let e=e=>{("volumeDown"===e.action||"volumeUp"===e.action)&&((0,v.qQ)(d.LocalStorageKeys.browserMute,!1),(z||k("isTipShow"))&&G(),setTimeout(()=>{0===C.volume?((0,v.qQ)(d.LocalStorageKeys.userMute,!0),S({[x.User]:{closeTime:Date.now()}})):(0,v.qQ)(d.LocalStorageKeys.userMute,!1)}))};return C.on(D.B.CustomShortCut,e),()=>{C.off(D.B.CustomShortCut,e)}}},[C,z,G]);if((0,o.useEffect)(()=>{!p&&T&&j(!1)},[p,T]),(0,o.useEffect)(()=>{if(!!b)h.emit(h.EVENT.silentStatusChange,{awemeId:b,isAuto:!0,status:z&&(null==C?void 0:C.muted)})},[z,b,null==C?void 0:C.muted]),!z||!(null==C?void 0:C.muted))return null;let J=null==C?void 0:null===(i=C.getPlugin)||void 0===i?void 0:null===(t=i.call(C,"SoundGuideTooltipPlugin"))||void 0===t?void 0:t.root,Q=k("currentMuteType");return["browser","user"].includes(Q)&&J?(0,a.createPortal)((0,n.jsx)(U.V,{onClose:()=>{G(),(0,v.qQ)(d.LocalStorageKeys.browserMute,!1),(0,v.qQ)(d.LocalStorageKeys.userMute,!0),S({[x.User]:{closeTime:Date.now()}}),_.sendLog("clickVoiceBubble",{is_open:0,mute_type:k("currentMuteType")})},onOpen:()=>{let{volume:e}=(0,V.J)(w);C&&(C.muted?C.muted=!1:C.volume=e),G(),C.emit("volumechange"),null==C||C.emit(r.Events.USER_ACTION,{action:"change_muted"}),(0,v.qQ)(d.LocalStorageKeys.browserMute,!1),(0,v.qQ)(d.LocalStorageKeys.userMute,!1),_.sendLog("clickVoiceBubble",{is_open:1,mute_type:k("currentMuteType")})},description:"browser"===Q?"因浏览器限制，当前为静音":"当前为静音，是否要打开声音？"}),J):null},O=e=>{let t=(0,Z.N)();return(0,n.jsxs)(A.k,{componentName:"AutoSilentPlugin",Slardar:t,children:[(0,n.jsx)(U.I,(0,l._)({},e)),(0,n.jsx)(z,(0,l._)({},e))]})}},537073:function(e,t,i){var l=i(563097);i(88648);var n=i(720509),o=i(14108),r=i(637005),a=i(669774);t.Z=e=>{let{author:t,roleTitle:i}=e,{secUid:d}=t;return(0,l.jsxs)(n.a,{className:a.default.container,isNeedSeoOpt:!1,href:(0,o.HC)(d,"enter_method=cooperation_list"),target:"_blank",rel:"noopener noreferrer",onClick:()=>{r.emit(r.EVENT.videoPause,"CommonAuthor_onClick")},children:[(0,l.jsx)("img",{src:t.avatarUri,alt:"",className:a.default.avatar}),(0,l.jsx)("div",{className:a.default.name,children:t.nickname}),(0,l.jsx)("div",{className:a.default.character,children:i})]})}},985917:function(e,t,i){i.d(t,{Y:function(){return N}});var l=i("520739");i("874386"),i("250440"),i("981168");var n=i("563097"),o=i("88648"),r=i("713097"),a=i.n(r),d=i("116989"),s=i("837455"),u=i("702726"),c=i("720359"),v=i("231755"),f=i("507217"),m=i("34644"),g=i("32167"),h=i("637005"),p=i("878389");let _=(0,o.forwardRef)((e,t)=>(0,n.jsx)("svg",(0,p._)((0,l._)({width:28,height:28,xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:(0,n.jsx)("path",{d:"M19.59 9.59a.833.833 0 1 0-1.18-1.18L14 12.823 9.59 8.41a.833.833 0 1 0-1.18 1.178L12.822 14l-4.41 4.41a.833.833 0 0 0 1.178 1.18L14 15.177l4.41 4.411a.833.833 0 0 0 1.18-1.178L15.177 14l4.411-4.41z"})})));var y=i("878999"),x=i("720509"),w=i("14108"),I=i("49000");let b=e=>e.map(e=>({avatarUri:e.avatar_thumb.url_list[0],nickname:e.nickname,uid:e.uid,followStatus:e.follow_status,followerCount:e.follower_count,followerStatus:e.follower_status,roleId:e.role_id,roleTitle:e.role_title,secUid:e.sec_uid})),C=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fontSize:14},i=t.fontSize<12?12:t.fontSize,l=t.fontSize<12?t.fontSize/12:1,n=document.createElement("div");n.innerText=e,n.style.fontSize=`${i}px`,n.style.position="fixed",n.style.zIndex="-999",document.body.appendChild(n);let o=n.offsetWidth;return document.body.removeChild(n),o*l};var T=e=>{let{size:t,prename:i,roleTitle:l,author:r}=e,{secUid:d}=r,[s,u]=(0,o.useState)();return(0,o.useLayoutEffect)(()=>{u(C(l,{fontSize:12}))},[l]),(0,n.jsxs)(x.a,{className:I.default.container,isNeedSeoOpt:!1,href:(0,w.HC)(d,"enter_method=cooperation_list"),target:"_blank",rel:"noopener noreferrer",onClick:()=>{h.emit(h.EVENT.videoPause,"SignificantAuthor_onClick")},children:[(0,n.jsx)("img",{src:r.avatarUri,alt:"",className:a()(I.default.avatar,"small"===t&&I.default.small)}),(0,n.jsx)("div",{className:I.default.name,children:r.nickname}),(0,n.jsxs)("div",{className:I.default.role,children:[(0,n.jsx)("div",{className:I.default["role-prename"],children:(0,n.jsx)("span",{children:i})}),(0,n.jsx)("div",{className:I.default["role-name"],children:(0,n.jsx)("span",{style:{width:s},children:l})})]})]})},S=i("537073"),E=i("394561");let k=e=>{let{totalNum:t,cursor:i,authorList:l,extra:r,awemeInfo:p,userInfo:x}=e,{significant_uid_list:w,custom_role_prename_map:I}=r;(0,o.useEffect)(()=>{let e="showCooperationList";return(0,m.o)({pausePlayControlShortcut:!0,pauseCustomShortcut:!0,pauseGlobalShortcut:!0},e),()=>{(0,m.m)(e)}},[]);let C=(0,o.useRef)(null);(0,o.useEffect)(()=>{let e=C.current,t=e=>e.stopPropagation();return null==e||e.addEventListener("wheel",t),()=>{null==e||e.removeEventListener("wheel",t)}},[]),(0,o.useEffect)(()=>(u.logInstance.sendLog("enterCoPublishPanel",{group_id:p.groupId,author_id:p.authorInfo.uid,enter_from_merge:"recommend",enter_from:(0,g.mo)()}),h.emit(h.EVENT.videoStopPlayNext),()=>{h.emit(h.EVENT.videoRemoveStopPlayNext)}),[]);let k=(0,o.useRef)((0,o.useMemo)(()=>new Set(l.map(e=>e.uid)),[])),N=(0,o.useMemo)(()=>l.find(e=>e.roleId===f.CooperationRoleId.Author),[]),P=(0,o.useMemo)(()=>(null==w?void 0:w.length)?w.map(e=>l.find(t=>t.uid===e)):[],[]),L=(0,o.useRef)(!1);(0,o.useEffect)(()=>()=>{L.current=!0},[]);let[j,M]=(0,o.useState)(()=>l.filter(e=>!P.includes(e)).sort((e,t)=>{var i,l;return t.roleId===f.CooperationRoleId.Author||t.uid===(null===(i=x.info)||void 0===i?void 0:i.uid)?1:e.roleId===f.CooperationRoleId.Author||e.uid===(null===(l=x.info)||void 0===l?void 0:l.uid)?-1:0})),A=(0,o.useRef)(i),[R,Z]=(0,o.useState)(!1),[B,D]=(0,o.useState)(!0),[V,U]=(0,o.useState)(t>l.length),{ref:F,inView:z}=(0,d.useInView)(),O=(0,c.d)(z),W=(0,c.d)(async()=>{if(!V||R||L.current)return;Z(!0),D(!1);let e=await (0,v.U2)("/aweme/v1/co/cocreator/list/",{item_id:p.awemeId,index:A.current+1}).catch(e=>{throw D(!0),Z(!1),e});if(L.current)return;let{user_info_list:t,has_more:i,status_code:l}=e;if(l&&l<0){D(!0),Z(!1);return}let n=A.current,o=t.filter(e=>{let t=k.current.has(e.uid);return k.current.add(e.uid),n=e.index,!t});M(e=>[...e,...b(o)]),U(i),Z(!1),A.current=n,setTimeout(()=>{O.current&&W.current()},50)});return(0,o.useEffect)(()=>{z&&W.current()},[z]),(0,n.jsxs)("div",{className:y.default.container,children:[(0,n.jsxs)("div",{className:y.default.header,children:[(0,n.jsxs)("span",{children:[t,"人共同创作"]}),(0,n.jsx)(_,{className:y.default.close,onClick:()=>{E.Uq.destroy()}})]}),(0,n.jsxs)("div",{className:y.default.content,ref:C,children:[P.length>0&&(0,n.jsx)("div",{className:a()(y.default["significant-authors"],P.length>2&&y.default["significant-authors__small"]),children:P.map(e=>(0,n.jsx)(T,{author:e,prename:I[e.uid],roleTitle:e.uid===(null==N?void 0:N.uid)&&r.author_role_name?r.author_role_name:e.roleTitle,size:P.length>2?"small":"normal"},e.uid))}),(0,n.jsx)("div",{className:y.default["common-authors"],children:j.map(e=>(0,n.jsx)(S.Z,{author:e,roleTitle:e.uid===(null==N?void 0:N.uid)&&r.author_role_name?r.author_role_name:e.roleTitle},e.uid))}),(0,n.jsx)("div",{ref:F,className:y.default["loading-container"],children:V?B?(0,n.jsxs)(n.Fragment,{children:["服务异常，重新",(0,n.jsx)("span",{onClick:W.current,className:y.default.refresh,children:"刷新"}),"拉取数据"]}):(0,n.jsx)(s.g,{text:"加载中"}):"没有更多数据"})]})]})},N=e=>{E.Uq.render({children:(0,n.jsx)(k,(0,l._)({},e)),className:y.default.mask,onMaskClick:()=>E.Uq.destroy()})}},24825:function(e,t,i){var l=i(563097),n=i(88648),o=i(713097),r=i.n(o),a=i(880421),d=i(250258),s=i(254897);t.Z=e=>{let{authorList:t,isTag:i=!1,onClick:o,className:u="",num:c}=e,v=(0,n.useMemo)(()=>c>=1e4?"万":c>=1e3?"千":c>=100?"百":String(c),[c]);return t.length<=1?null:(0,l.jsxs)("div",{className:r()(d.default.peopleCount,u,{[d.default.tagStyle]:i}),onClick:o,children:[(0,l.jsx)(s.z,{svg:(0,l.jsx)(a.Z,{style:{fontSize:"12px"}}),className:d.default.svg}),(0,l.jsxs)("span",{className:d.default.text,children:[v,"人共创",!i&&" : "]})]})}},965901:function(e,t,i){i.d(t,{N:function(){return V}});var l=i("520739");i("874386");var n=i("563097"),o=i("88648"),r=i("702726"),a=i("146914"),d=i("506467"),s=i("34644"),u=i("32167"),c=i("637005"),v=i("477667"),f=i("49737"),m=i("394561"),g=i("473677"),h=i("720509"),p=i("228495"),_=i("14108"),y=i("63151"),x=i("878389"),w=i("713097"),I=i.n(w),b=i("747909"),C=i("507217"),T=i("234048"),S=i("658065"),E=i("367366"),k=i("150566"),N=i("577786"),P=i("734017"),L=i("150877"),j=i("871415"),M=i("447298");function A(e){var t,i,r,a,d,s,u,c,v;let{loginDispatch:f,userInfo:m,loginUserInfo:g,awemeInfo:h,reportExtraParams:p,isLogin:_,onLoginChange:y}=e,{followStatus:w,followerStatus:A,uid:R}=m||{},Z=(0,o.useMemo)(()=>{var e;return(null==m?void 0:m.uid)===(null==g?void 0:null===(e=g.info)||void 0===e?void 0:e.uid)},[m,g]),{followStatus:B,text:D,buttonType:V}=(0,j.r)({selfUid:null==g?void 0:null===(t=g.info)||void 0===t?void 0:t.uid,actionUid:R,defaultFollowerStatus:A,defaultFollowStatus:w}),{follow:U,unFollow:F}=(0,M.OM)({selfUid:null==g?void 0:null===(i=g.info)||void 0===i?void 0:i.uid,actionUid:R,defaultFollowerStatus:A,defaultFollowStatus:w,isLogin:_,onLoginSuccess:()=>{null==y||y(!0),null==f||f({type:"updateUserInfo"})},logExtraParams:(0,x._)((0,l._)({to_user_id:R,enter_from:(0,S.yW)(),is_full_screen:(0,E.r)()?"1":"0",author_id:null==h?void 0:null===(r=h.authorInfo)||void 0===r?void 0:r.uid,group_id:null==h?void 0:h.awemeId,tab_name:(0,P.zD)()||(0,k.Rs)("tab_name")||"",from_group_id:null==h?void 0:h.awemeId,music_id:null==h?void 0:null===(a=h.music)||void 0===a?void 0:a.mid,compilation_id:null==h?void 0:null===(d=h.mixInfo)||void 0===d?void 0:d.mixId,aweme_type:null==h?void 0:h.awemeType,item_duration_ms:(null==h?void 0:null===(s=h.video)||void 0===s?void 0:s.duration)||0},p),{is_co_publish:1,co_publish_author_list:null==h?void 0:null===(v=h.cooperationInfo)||void 0===v?void 0:null===(c=v.cooperationCreators)||void 0===c?void 0:null===(u=c.filter(e=>e.roleId!==C.CooperationRoleId.Author))||void 0===u?void 0:u.map(e=>`${e.uid}_${null==e?void 0:e.roleId}`),enter_method:"co_publish_panel"})});return(0,n.jsx)("div",{className:I()(L.default.buttonsWrap,L.default.following,{[L.default.hidden]:Z}),children:(0,n.jsx)(b.Button,{theme:"solid",className:L.default.follow,type:V===T.TT.Active?"primary":"secondary",onClick:()=>{(0,N.V)(B)?F():U()},size:"small",children:(0,n.jsx)("div",{className:L.default.contentBlock,children:D})})})}var R=i("422959");function Z(e){let{userInfo:t}=e,{avatarUri:i,nickname:o,secUid:r,roleTitle:d}=t;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:y.default.card,children:[(0,n.jsx)("div",{className:y.default.avatarWrap,children:(0,n.jsx)(h.a,{isNeedSeoOpt:!1,href:(0,_.HC)(r,"enter_method=cooperation_list"),target:"_blank",rel:"noopener noreferrer",onClick:()=>{c.emit(c.EVENT.videoPause,"UserCard_onClick")},children:(0,n.jsx)(p.q,{src:i,alt:`${o}头像`,type:"extraSmall"})})}),(0,n.jsx)("div",{className:y.default.info,children:(0,n.jsx)("div",{className:y.default.nameInfo,children:(0,n.jsxs)("div",{className:y.default.nickname,children:[(0,n.jsx)(h.a,{isNeedSeoOpt:!1,href:(0,_.HC)(r,"enter_method=cooperation_list"),target:"_blank",rel:"noopener noreferrer",onClick:()=>{c.emit(c.EVENT.videoPause,"UserCard_onClick1")},children:(0,n.jsx)(R.Z,{text:o})}),d&&(0,n.jsx)("div",{className:y.default.roleTitle,children:d})]})})}),(0,n.jsx)(A,(0,l._)({},e))]}),(0,n.jsx)(a.i,{className:y.default.divider})]})}let{Escape:B}=d.bf,D=e=>{let{showCooperationList:t,loginUserInfo:i,loginDispatch:l,awemeInfo:d,reportExtraParams:h}=e,p=o.useRef(null),[_,y]=(0,o.useState)(i.isLogin);return o.useEffect(()=>{let e="showCooperationList";return(0,s.o)({pausePlayControlShortcut:!0,pauseCustomShortcut:!0,pauseGlobalShortcut:!0,disableKey:[B].map(e=>e.code)},e),()=>{(0,s.m)(e)}},[]),o.useEffect(()=>{let e=p.current,t=e=>e.stopPropagation();return null==e||e.addEventListener("wheel",t),()=>{null==e||e.removeEventListener("wheel",t)}},[]),o.useEffect(()=>(r.logInstance.sendLog("enterCoPublishPanel",{group_id:d.groupId,author_id:d.authorInfo.uid,enter_from_merge:"recommend",enter_from:(0,u.mo)()}),c.emit(c.EVENT.videoStopPlayNext),()=>{c.emit(c.EVENT.videoRemoveStopPlayNext)}),[]),(0,n.jsxs)("div",{className:f.default.shortcutList,children:[(0,n.jsxs)("div",{className:f.default.header,children:[(0,n.jsx)("div",{className:f.default.title,children:`${null==t?void 0:t.length}人共同创作`}),(0,n.jsx)(g.Z,{className:f.default.close,width:36,height:36,src:v.Z,color:"#A9AAB7",onClick:()=>{m.Uq.destroy()}})]}),(0,n.jsx)(a.i,{className:f.default.divider}),(0,n.jsx)("div",{className:f.default.container,ref:p,children:t.map(e=>(0,n.jsx)(Z,{userInfo:e,loginDispatch:l,loginUserInfo:i,isLogin:_,onLoginChange:e=>{y(e)},awemeInfo:d,reportExtraParams:h},e.secUid))})]})},V=e=>{m.Uq.render({children:(0,n.jsx)(D,(0,l._)({},e)),className:f.default.mask,onMaskClick:()=>m.Uq.destroy()})}},279025:function(e,t,i){i.d(t,{Z:function(){return w}});var l=i(520739),n=i(878389),o=i(368200);i(874386);var r=i(563097),a=i(88648),d=i(713097),s=i.n(d),u=i(907831),c=i.n(u),v=i(507217),f=i(367366),m=i(322372),g=i(70386),h=i(271979),p=i(447298),_=i(860684),y=i(254897);function x(e){var t,i,o,d,u,m,y,x,w,I,b,C;let{loginUserInfo:T,loginDispatch:S,fullScreenTarget:E,reportExtraParams:k,authorItem:N,awemeInfo:P,onCooperationAuthorClick:L,showRoleTitle:j,showFollowBtn:M,loginPanelTarget:A,abTestData:R,isDetail:Z}=e,{isLogin:B}=T||{};(0,a.useRef)();let D=(0,_.n)(),[V,U]=(0,a.useState)(!1),F=(0,a.useRef)(!1),z=(0,a.useRef)(null),O=(0,a.useMemo)(()=>{let e=c()(P);return e.authorInfo=N,e},[P,N]),{follow:W,unFollow:$}=(0,p.OM)({selfUid:null==T?void 0:null===(t=T.info)||void 0===t?void 0:t.uid,actionUid:null==O?void 0:null===(i=O.authorInfo)||void 0===i?void 0:i.uid,defaultFollowerStatus:null==O?void 0:null===(o=O.authorInfo)||void 0===o?void 0:o.followerStatus,defaultFollowStatus:null==O?void 0:null===(d=O.authorInfo)||void 0===d?void 0:d.followStatus,logExtraParams:(0,n._)((0,l._)({author_id:null==P?void 0:null===(u=P.authorInfo)||void 0===u?void 0:u.uid,group_id:null==P?void 0:P.awemeId,from_group_id:null==P?void 0:P.awemeId,music_id:null==P?void 0:null===(m=P.music)||void 0===m?void 0:m.mid,compilation_id:null==P?void 0:null===(y=P.mixInfo)||void 0===y?void 0:y.mixId,aweme_type:null==P?void 0:P.awemeType,to_user_id:null==O?void 0:null===(x=O.authorInfo)||void 0===x?void 0:x.uid},k),{is_co_publish:1,item_duration_ms:(null==P?void 0:null===(w=P.video)||void 0===w?void 0:w.duration)||0,co_publish_author_list:null==O?void 0:null===(C=O.cooperationInfo)||void 0===C?void 0:null===(b=C.cooperationCreators)||void 0===b?void 0:null===(I=b.filter(e=>e.roleId!==v.CooperationRoleId.Author))||void 0===I?void 0:I.map(e=>`${e.uid}_${null==e?void 0:e.roleId}`),enter_method:"co_publish_entrance"}),isLogin:B,accountParentEl:(0,f.r)()&&E,onLoginSuccess:()=>{null==S||S({type:"updateUserInfo"})}});return(0,r.jsxs)("li",{className:s()(g.default.itemContainer,{[g.default.vertical]:!j}),ref:z,"data-click-from":"click_icon",children:[(0,r.jsx)(h.Z,{player:D,loginUserInfo:T,actionFollow:W,actionUnFollow:$,awemeInfo:O,isLogin:B,loginDispatch:S,fullScreenTarget:E,isFollowClickedRef:F,onCooperAitonClick:()=>{null==L||L(O)},reportExtraParams:k,className:g.default.avatarContainer,isShowTip:!0,isShowKeyHotTip:!1,followBtnMouseEnter(){},followBtnMouseLeave(){},imBtnMouseEnter(){},imBtnMouseLeave(){},showPendantTip:V,setShowPendantTip:U,showImBtn:!1,showFollowBtn:M,loginPanelTarget:A,abtestData:R}),(0,r.jsx)("div",{className:g.default.nickNameContainer,children:(0,r.jsx)("span",{className:s()(g.default.nickName,g.default.changeSize),onClick:()=>{null==L||L(O)},children:N.nickname})})]})}function w(e){let{authorList:t,onClickMore:i}=e,d=(0,o._)(e,["authorList","onClickMore"]),u=(0,a.useRef)(null),c=(0,a.useMemo)(()=>t.length>5,[t]);return(null==t?void 0:t.length)<=1?null:(0,r.jsxs)("div",{className:s()(g.default.container,{videoCooperationHideTitleContainer:!0}),children:[(0,r.jsx)("ul",{className:g.default.avatarList,children:t.map((e,t)=>c&&t>=4?null:(0,r.jsx)(x,(0,n._)((0,l._)({},d),{authorItem:e,showFollowBtn:!0}),e.uid))}),c&&(0,r.jsx)("div",{className:g.default.moreBox,children:(0,r.jsx)("div",{className:g.default.more,onClick:i,children:(0,r.jsx)(y.z,{svg:(0,r.jsx)(m.Z,{})})})}),(0,r.jsx)("div",{className:"disturb-login-panel disturb-login-panel-related",ref:u})]})}},944450:function(e,t,i){i.d(t,{Z:function(){return d}});var l=i("758454"),n=i("928673");i("897860");let o=[{tag:"xg-cache",className:"xgplayer-progress-cache",styleKey:"cachedColor"},{tag:"xg-played",className:"xgplayer-progress-played transition",styleKey:"playedColor"}];class r{updateDuration(e){this.duration=parseInt(1e3*e);let t=0,{fragments:i}=this;this.fragments=i.map(e=>(e.start=t,e.end=t+e.percent*this.duration,e.duration=e.percent*this.duration,t+=e.percent*this.duration,e))}updateProgress(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"played",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{newIndex:0,curIndex:0,millisecond:0},{progressList:i,fragments:l}=this,{newIndex:n,curIndex:o,millisecond:r}=t;n!==o&&i.map((t,i)=>{i<n?t[e].style.width="100%":i>n&&(t[e].style.width=0)});let a=l[n],d=0===r?0:(r-a.start)/a.duration;i[n]&&(i[n][e].style.width=d<0?0:`${100*d}%`)}reset(){let{progressList:e,fragments:t}=this;e.map((e,t)=>{n.ZP.removeClass(e.played,"transition"),setTimeout(()=>n.ZP.addClass(e.played,"transition"),100)}),this.update({played:0},this.duration)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cached:0,played:0},t=arguments.length>1?arguments[1]:void 0;if(!this.duration||parseInt(1e3*t,10)!==this.duration){if(!t&&0!==t)return;this.updateDuration(t)}let{playedIndex:i,cachedIndex:l}=this;if("Undefined"!==n.ZP.typeOf(e.played)){let t=this.findIndex(1e3*e.played,i);this.updateProgress("played",{newIndex:t,curIndex:i,millisecond:parseInt(1e3*e.played,10)}),this.playedIndex=t}if("Undefined"!==n.ZP.typeOf(e.cached)){let t=this.findIndex(1e3*e.cached,l);this.updateProgress("cached",{newIndex:t,curIndex:l,millisecond:parseInt(1e3*e.cached,10)}),this.cachedIndex=t}}findIndex(e,t){let{fragments:i}=this;if(1===i.length||0===e)return 0;let l=t;for(let t=0;t<this.fragments.length;t++){let i=this.fragments[t];if(l=t,e>i.start&&e<=i.end)break}return l}findHightLight(){let{children:e}=this.root;for(let t=0;t<e.length;t++)if(n.ZP.hasClass(e[t],this.focusClass))return{dom:e[t],pos:e[t].getBoundingClientRect()}}findFragment(e){let{children:t}=this.root;return e<0||e>=t.length?null:{dom:t[e],pos:t[e].getBoundingClientRect()}}unHightLight(){let{children:e}=this.root;for(let t=0;t<e.length;t++)n.ZP.removeClass(e[t],this.focusClass)}setHightLight(e){let{children:t}=this.root;if(e<t.length)return n.ZP.addClass(t[e],this.focusClass),{dom:t[e],pos:t[e].getBoundingClientRect()}}destroy(){this.progressList=null,this.fragments=null,this.root.innerHTML=""}render(){let{progressColor:e}=this.style;return this.root=n.ZP.createDom("xg-inners","",{},"progress-list"),this.fragments&&(this.progressList=this.fragments.map((t,i)=>{let l=n.ZP.createDom("xg-inner","",{style:e?`background:${e}; flex: ${t.percent}`:`flex: ${t.percent}`},`${t.isFocus?"inner-focus":""} xgplayer-progress-inner picture-inner`);return l.addEventListener("click",()=>this.onInnerClick(i)),this.root.appendChild(l),o.map(e=>{l.appendChild(n.ZP.createDom(e.tag,"",{style:e.styleKey?`background: ${this.style[e.styleKey]}; width:0;`:"width:0;"},e.className))}),{cached:l.children[0],played:l.children[1]}})),this.root}constructor(e){this.fragments=e.fragments||[],this.onInnerClick=e.onInnerClick,this.focusClass="inner-focus",this.style=e.style||{playedColor:"",cachedColor:"",progressColor:""},this.duration=0,this.cachedIndex=0,this.playedIndex=0}}i("954629");class a extends l.ZP{static get pluginName(){return"pictureProgress"}static get defaultConfig(){return{position:l.kd.CONTROLS_CENTER,index:0,disable:!1,isDragingSeek:!0,closeMoveSeek:!1,isPauseMoving:!1,isCloseClickSeek:!1,fragments:[{percent:1}],miniMoveStep:5,miniStartStep:2,onMoveStart:()=>{},onMoveEnd:()=>{}}}get duration(){return this.playerConfig&&this.playerConfig.customDuration||this.player.duration}get timeOffset(){return this.playerConfig.timeOffset||0}beforeCreate(e){"boolean"==typeof e.player.config.progress&&(e.config.disable=!e.player.config.progress)}createInner(){try{this.innerList=new r({fragments:this.config.fragments,style:this.playerConfig.commonStyle||{},onInnerClick:this.config.onInnerClick}),this.outer.insertBefore(this.innerList.render(),this.outer.children[0]),["findHightLight","unHightLight","setHightLight","findFragment"].map(e=>{this[e]=this.innerList[e].bind(this.innerList)})}catch(e){}}afterCreate(){if(!this.config.disable&&!this.playerConfig.isLive)this.pos={x:0,y:0,moving:!1,isDown:!1,isEnter:!1},this.outer=this.find("xg-outer"),this.createInner(),this.bind("pointerdown",this.onStopPropagation),this.bind("touchstart",this.onStopPropagation)}focus(){this.player.controls.pauseAutoHide(),n.ZP.addClass(this.root,"active")}blur(){this.player.controls.recoverAutoHide(),n.ZP.removeClass(this.root,"active")}onStopPropagation(e){e.stopPropagation()}onMouseDown(e){let{player:t,pos:i,config:l,playerConfig:o}=this,r=n.ZP.getEventPos(e,t.zoom),{width:a,height:d,top:s,left:u}=this.root.getBoundingClientRect(),c=(r.clientX-u)/a;this.updatePercent(c)}updateTime(e){let{player:t,duration:i}=this;e>i?e=i:e<0&&(e=0);let l=t.plugins.time;l&&l.updateTime(e)}updatePercent(e){e=e>1?1:e<0?0:e,this.percent=e,this.innerList.update({played:e*this.duration},this.duration)}getPercent(){return this.percent}destroy(){this.thumbnailPlugin=null,this.innerList.destroy(),this.innerList=null,this.unbind("mousedown",this.onMouseDown),this.unbind("pointerdown",this.onStopPropagation),this.unbind("touchstart",this.onStopPropagation)}render(){if(this.config.disable||this.playerConfig.isLive)return;let e=this.player.controls?this.player.controls.config.mode:"";return`
    <xg-progress class="xgplayer-progress ${"bottom"===e?"xgplayer-progress-bottom":""}">
      <xg-outer class="xgplayer-progress-outer picture">
      </xg-outer>
    </xg-progress>
    `}constructor(e){super(e),this.percent=0,this._state={now:-1,direc:0,time:0}}}var d=a},708739:function(e,t,i){i.d(t,{e:function(){return P}});var l=i(520739);i(874386);var n=i(563097),o=i(88648),r=i(510063),a=i(974865),d=i(713097),s=i.n(d),u=i(734123),c=i(877639),v=i.n(c),f=i(746864),m=i(367366),g=i(782442),h=i(32167),p=i(150566),_=i(816299),y=i(734017),x=i(515330),w=i(623607),I=i(944450),b=i(548988),C=i(410033),T=i(473677),S=i(534739),E=i(366498),k=i(860684),N=i(943695);let P=e=>{var t;let{isActive:i,awemeInfo:d,swiper:c,onPlayFinish:P,playNextFunc:L,ablePlayNext:j,playPrevFunc:M,ablePlayPrev:A,logParams:R,arrowButtonSize:Z=56,isClientMiniWin:B,disableShortCut:D=!1,isShowSideBar:V=!1,inSearch:U,leftStyle:F,rightStyle:z}=e,O=(0,k.n)(),[W,$]=(0,o.useState)(!0),[H,K]=(0,o.useState)([!0,!0]),G=(0,o.useRef)(Date.now()),q=(0,o.useRef)(0),J=(0,o.useRef)(R),Q=(0,o.useRef)(!0),X=(0,o.useRef)(null),Y=e=>{$(e),Q.current=e},ee=(0,C.i)({player:O});J.current=R;let et=(0,o.useCallback)(e=>{var t;let i=null==O?void 0:O.getPlugin("pictureProgress");null==i||null===(t=i.updatePercent)||void 0===t||t.call(i,e),q.current=e},[O]),ei=(0,o.useCallback)(e=>{var t,i;E.Z.sendLog("multiPhotoSlide",(0,l._)({enter_from:null===(t=J.current)||void 0===t?void 0:t.enter_from,enter_method:"click_pic",author_id:null==d?void 0:null===(i=d.authorInfo)||void 0===i?void 0:i.uid,group_id:null==d?void 0:d.awemeId,pic_cnt:d.images.length,is_zoom:(0,m.r)()},J.current)),K([0===c.activeIndex,c.activeIndex===(null==d?void 0:d.images.length)-1]),Y(!1),et((e+1)/d.images.length),null==c||c.slideTo(e,0)},[c,et,d]),el=(0,o.useCallback)(e=>{if(c.activeIndex>0){var t,i;E.Z.sendLog("multiPhotoSlide",(0,l._)({enter_from:null===(t=J.current)||void 0===t?void 0:t.enter_from,enter_method:(null==e?void 0:e.type)==="click"?"click_button":"keyboard",author_id:null==d?void 0:null===(i=d.authorInfo)||void 0===i?void 0:i.uid,group_id:null==d?void 0:d.awemeId,pic_cnt:d.images.length,is_zoom:(0,m.r)()},J.current)),Y(!1),et(c.activeIndex/d.images.length),c.slidePrev(),K([0===c.activeIndex,c.activeIndex===(null==d?void 0:d.images.length)-1])}},[c,et,d]),en=(0,o.useCallback)(e=>{if(c.activeIndex<c.slides.length-1){var t;E.Z.sendLog("multiPhotoSlide",(0,l._)({enter_from:null==R?void 0:R.enter_from,enter_method:(null==e?void 0:e.type)==="click"?"click_button":"keyboard",author_id:null==d?void 0:null===(t=d.authorInfo)||void 0===t?void 0:t.uid,group_id:null==d?void 0:d.awemeId,pic_cnt:d.images.length,is_zoom:(0,m.r)()},J.current)),Y(!1),et((c.activeIndex+2)/d.images.length),c.slideNext(),K([0===c.activeIndex,c.activeIndex===(null==d?void 0:d.images.length)-1])}},[c,et,d]);return(0,b.X)({preClick:el,nextClick:en,disableShortCut:D}),(0,o.useEffect)(()=>{if(O&&(null==d?void 0:d.awemeType)===f.e.Note){let e=e=>{if(e){var t;E.Z.sendLog("enterGraphicDetail",{enter_from:null==R?void 0:R.enter_from,author_id:null==d?void 0:null===(t=d.authorInfo)||void 0===t?void 0:t.uid,group_id:null==d?void 0:d.awemeId,pic_cnt:d.images.length})}};return O.on(u.Events.FULLSCREEN_CHANGE,e),()=>{O.off(u.Events.FULLSCREEN_CHANGE,e)}}},[d,O]),(0,o.useEffect)(()=>{if(O&&(null==d?void 0:d.awemeType)===f.e.Note){let e=O.getPlugin("AutoPlaySettingPlugin")||O.getPlugin("SearchAutoPlaySettingPlugin");if(e)return e.playeNextWeightNum+=1,()=>{e.playeNextWeightNum-=1}}},[d,O]),(0,o.useEffect)(()=>{if(O&&(null==d?void 0:d.awemeType)===f.e.Note){let e=O.getPlugin("InnerAutoPlayPlugin");if(e)return e.config.innerAutoPlayWeight+=1,()=>{e.config.innerAutoPlayWeight-=1}}},[d,O]),(0,o.useEffect)(()=>{if(O)return q.current=0,O.registerPlugin(I.Z,{fragments:d.images.map(e=>({percent:1/d.images.length})),onInnerClick:ei}),O.getPlugin(r.Z.pluginName)&&O.unRegisterPlugin(r.Z.pluginName,!0),O.getPlugin(a.Z.pluginName)&&O.unRegisterPlugin(a.Z.pluginName,!0),()=>{O.getPlugin(I.Z.pluginName)&&O.unRegisterPlugin(I.Z.pluginName,!0),O.registerPlugin(r.Z,{}),O.registerPlugin(a.Z,{})}},[O,ei]),(0,o.useEffect)(()=>{if(c){let e=!1,t=()=>{e=!1,setTimeout(()=>ei(c.activeIndex))},i=()=>{Y(!1),et((c.activeIndex+1)/d.images.length),e||c.once("touchEnd",t),e=!0};try{c.on("touchMove",i)}catch(e){}return()=>{try{null==c||c.off("touchMove",i)}catch(e){}}}},[c,et,ei]),(0,o.useEffect)(()=>{if(i&&O){var e,t,n,o,r;if(W){G.current=Date.now()-3e3*q.current*d.images.length;let i=O.getPlugin("pictureProgress");0===q.current?null==i||null===(e=i.innerList)||void 0===e||e.reset():null==i||null===(n=i.innerList)||void 0===n||null===(t=n.progressList)||void 0===t||t.map((e,t)=>{u.Util.addClass(null==e?void 0:e.played,"transition")});let o=v()(()=>{O.cumulateTime>=5e3&&(X.current(),O.off(u.Events.TIME_UPDATE,o))},500,{leading:!0,trailing:!0}),r=()=>{var e,t,n,r,a,s;if(1===d.images.length&&(null==d?void 0:null===(e=d.imageAlbumMusicInfo)||void 0===e?void 0:e.endTime)/1e3-O.currentTime>.4);else if((Date.now()-G.current)/(3e3*d.images.length)>=1){O.off(u.Events.TIME_UPDATE,o),O.on(u.Events.TIME_UPDATE,o),et(1),q.current=0,G.current=Date.now(),null==i||null===(t=i.innerList)||void 0===t||t.reset();let e=O.getPlugin("AutoPlaySettingPlugin")||O.getPlugin("SearchAutoPlaySettingPlugin"),l=O.getPlugin("InnerAutoPlayPlugin");e&&(null==e?void 0:null===(n=e.config)||void 0===n?void 0:n.nextAutoPlay)&&(null==e?void 0:e.playeNextWeightNum)<=1&&j&&(null==e?void 0:e.stopFlag)===0?null==L||L():l&&(null===(r=g.Le.getConfig(g.gI.InnerAutoPlay))||void 0===r?void 0:r.modeIndex)===N.KM.Nomal&&l.config.innerAutoPlayWeight>=0&&j&&(null==l?void 0:l.stopFlag)===0?null==L||L({from:"auto"}):l&&(null===(a=g.Le.getConfig(g.gI.InnerAutoPlay))||void 0===a?void 0:a.modeIndex)===N.KM.Reverse&&l.config.innerAutoPlayWeight>=0&&A&&(null==l?void 0:l.stopFlag)===0&&(null==M||M({from:"auto"}))}else et((Date.now()-G.current)/(3e3*d.images.length));let v=Math.floor((Date.now()-G.current)/3e3);if((null==c?void 0:c.activeIndex)!==v){if(null==c?void 0:c.destroyed)return;E.Z.sendLog("multiPhotoSlide",(0,l._)({enter_from:null==R?void 0:R.enter_from,enter_method:"auto",author_id:null==d?void 0:null===(s=d.authorInfo)||void 0===s?void 0:s.uid,group_id:null==d?void 0:d.awemeId,pic_cnt:d.images.length,is_zoom:(0,m.r)()},J.current)),1!==d.images.length&&(null==c||c.slideTo(v,c.activeIndex===d.images.length-1?0:250)),K([(null==c?void 0:c.activeIndex)===0,(null==c?void 0:c.activeIndex)===(null==d?void 0:d.images.length)-1])}},a=()=>{G.current=Date.now()-3e3*q.current*d.images.length};return O.on(u.Events.TIME_UPDATE,r),O.on(u.Events.PLAY,a),()=>{O.off(u.Events.TIME_UPDATE,r),O.off(u.Events.PLAY,a),O.off(u.Events.TIME_UPDATE,o)}}{let e=O.getPlugin("pictureProgress");null==e||null===(r=e.innerList)||void 0===r||null===(o=r.progressList)||void 0===o||o.map((e,t)=>{u.Util.removeClass(null==e?void 0:e.played,"transition")});let t=()=>{Y(!0)};(null==O?void 0:O.paused)&&O.once(u.Events.PLAY,t);let i=()=>{O.once(u.Events.PLAY,t)},l=()=>{O.off(u.Events.PLAY,t)};return O.on(u.Events.PAUSE,i),O.on(u.Events.ENDED,l),()=>{var n,o;O.off(u.Events.PAUSE,i),O.off(u.Events.ENDED,l),O.off(u.Events.PLAY,t),null==e||null===(o=e.innerList)||void 0===o||null===(n=o.progressList)||void 0===n||n.map((e,t)=>{u.Util.addClass(null==e?void 0:e.played,"transition")})}}}q.current=0},[i,O,W,et,c,L,j,d]),(0,o.useEffect)(()=>{if(c){let e=()=>{if(c.activeIndex===(null==d?void 0:d.images.length)-1){var t,i,n,o,r,a,s,u;E.Z.sendLog("videoPlayFinish",(0,l._)({urlParamList:["enter_method","trending_topic","previous_page"],enter_from:(0,h.mo)(),author_id:null==d?void 0:null===(t=d.authorInfo)||void 0===t?void 0:t.uid,group_id:null==d?void 0:d.awemeId,log_pb:null==d?void 0:d.logPb,compilation_id:null==d?void 0:null===(i=d.mixInfo)||void 0===i?void 0:i.mixId,playlet_id:null==d?void 0:null===(n=d.seriesInfo)||void 0===n?void 0:n.seriesId,tab_name:(0,y.zD)()||(0,p.Rs)("tab_name")||"",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(o=g.Le.getConfig("isCollapseAuthorCard"))||void 0===o?void 0:o.isCollapseAuthorCard)?0:1,from_follow_list:(null===(r=g.Le.getConfig("fromFollowList"))||void 0===r?void 0:r.tag)?"1":"0",is_mute:(null==O?void 0:O.muted)?"1":"0",is_force:(null===(a=g.Le.getConfig(g.gI.ForceMuted))||void 0===a?void 0:a.currentMuteType)==="browser"?"1":"0",trending_topic:"",aweme_type:(null==d?void 0:d.isSlides)?f.e.Slides:null==d?void 0:d.awemeType,pic_cnt:null==d?void 0:null===(s=d.images)||void 0===s?void 0:s.length,is_small_window:"0",column_type:(null==R?void 0:R.column_type)||(null==R?void 0:null===(u=R.search_params)||void 0===u?void 0:u.column_type),is_selected_label:(null==d?void 0:d.weeklyRecommend)?1:0},R,(0,_.Wc)()));try{c.off("slideChange",e)}catch(e){}null==P||P()}};try{c.slideTo(0,0),K([0===c.activeIndex,c.activeIndex===(null==d?void 0:d.images.length)-1]),c.on("slideChange",e)}catch(e){}return()=>{try{c.off("slideChange",e)}catch(e){}}}},[c,d]),(0,o.useEffect)(()=>{if(c){X.current=()=>{var e,t,i,n,o,r,a;E.Z.sendLog("finishTuji",(0,l._)({urlParamList:["enter_method","trending_topic","previous_page"],enter_from:(0,h.mo)(),author_id:null==d?void 0:null===(e=d.authorInfo)||void 0===e?void 0:e.uid,group_id:null==d?void 0:d.awemeId,log_pb:null==d?void 0:d.logPb,compilation_id:null==d?void 0:null===(t=d.mixInfo)||void 0===t?void 0:t.mixId,playlet_id:null==d?void 0:null===(i=d.seriesInfo)||void 0===i?void 0:i.seriesId,tab_name:(0,y.zD)()||(0,p.Rs)("tab_name")||"",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(n=g.Le.getConfig("isCollapseAuthorCard"))||void 0===n?void 0:n.isCollapseAuthorCard)?0:1,from_follow_list:(null===(o=g.Le.getConfig("fromFollowList"))||void 0===o?void 0:o.tag)?"1":"0",is_mute:(null==O?void 0:O.muted)?"1":"0",is_force:(null===(r=g.Le.getConfig(g.gI.ForceMuted))||void 0===r?void 0:r.currentMuteType)==="browser"?"1":"0",trending_topic:"",aweme_type:null==d?void 0:d.awemeType,pic_cnt:null==d?void 0:null===(a=d.images)||void 0===a?void 0:a.length,is_small_window:"0"},R)),X.current=()=>{}};let e=()=>{c.activeIndex===(null==d?void 0:d.images.length)-1&&X.current&&!Q.current&&X.current()};return c.on("slideChange",e),()=>{c.off("slideChange",e)}}},[c,d]),!B&&(null==d?void 0:null===(t=d.images)||void 0===t?void 0:t.length)>1?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:s()(S.default.leftArrow,S.default.arrow,{[S.default.disabled]:H[0],[S.default.inSideBar]:V,[S.default.inSearch]:U,[S.default.hide]:ee,[F]:F}),style:{width:`${Z}px`,height:`${Z}px`},children:(0,n.jsx)(T.Z,{src:x.Z,width:Z,height:Z,viewBox:"0 0 56 56",onClick:el})}),(0,n.jsx)("div",{className:s()(S.default.rightArrow,S.default.arrow,{[S.default.disabled]:H[1],[S.default.inSideBar]:V,[S.default.inSearch]:U,[S.default.hide]:ee,[z]:z}),style:{width:`${Z}px`,height:`${Z}px`},children:(0,n.jsx)(T.Z,{src:w.Z,width:Z,height:Z,viewBox:"0 0 56 56",onClick:en})})]}):null}},410033:function(e,t,i){i.d(t,{i:function(){return n}}),i(874386);var l=i(88648);let n=e=>{let{player:t,timeDuration:i=3e3}=e,[n,o]=(0,l.useState)(!1),r=(0,l.useRef)(),a=(0,l.useCallback)(()=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{o(!0),r.current=null},i)},[i]);return(0,l.useEffect)(()=>{if(null==t?void 0:t.root){var e,i,l;let n=()=>{r.current&&clearTimeout(r.current),o(!1)},d=()=>{o(!1),a()},s=()=>{o(!1),a()};return null==t||null===(e=t.root)||void 0===e||e.addEventListener("mouseenter",d),null==t||null===(i=t.root)||void 0===i||i.addEventListener("mousemove",s),null==t||null===(l=t.root)||void 0===l||l.addEventListener("mouseleave",n),()=>{var e,i,l;null==t||null===(e=t.root)||void 0===e||e.removeEventListener("mouseenter",d),null==t||null===(i=t.root)||void 0===i||i.removeEventListener("mousemove",s),null==t||null===(l=t.root)||void 0===l||l.removeEventListener("mouseleave",n)}}},[null==t?void 0:t.root,a,o]),(0,l.useEffect)(()=>()=>{r.current&&clearTimeout(r.current),r.current=null},[]),n}},257165:function(e,t,i){i.d(t,{Z:function(){return d}});var l=i("758454"),n=i("928673");i("897860");let o=[{tag:"xg-cache",className:"xgplayer-progress-cache",styleKey:"cachedColor"},{tag:"xg-played",className:"xgplayer-progress-played transition",styleKey:"playedColor"}];class r{updateProgress(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"played",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{newIndex:0,curIndex:0,millisecond:0},{progressList:i,fragments:l}=this,{newIndex:n,curIndex:o,millisecond:r}=t;n!==o&&i.map((t,i)=>{i<n?t[e].style.width="100%":i>n&&(t[e].style.width=0)});let a=l[n],d=0===r?0:(r-a.start)/a.duration;i[n]&&(i[n][e].style.width=d<0?0:`${100*d}%`)}reset(){let{progressList:e,fragments:t}=this;this.update({played:0})}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cached:0,played:0},{playedIndex:t,cachedIndex:i}=this;if("Undefined"!==n.ZP.typeOf(e.played)){let i=this.findIndex(e.played,t);if(i!==t){var l,o;n.ZP.removeClass(null===(l=this.progressList[t])||void 0===l?void 0:l.played,"transition"),n.ZP.addClass(null===(o=this.progressList[i])||void 0===o?void 0:o.played,"transition")}this.updateProgress("played",{newIndex:i,curIndex:t,millisecond:e.played}),this.playedIndex=i}if("Undefined"!==n.ZP.typeOf(e.cached)){let t=this.findIndex(e.cached,i);this.updateProgress("cached",{newIndex:t,curIndex:i,millisecond:parseInt(e.cached,10)}),this.cachedIndex=t}}findIndex(e,t){let{fragments:i}=this;if(1===i.length||0===e)return 0;let l=t;for(let t=0;t<this.fragments.length;t++){let i=this.fragments[t];if(l=t,e>=i.start&&e<=i.end)break}return l}findHightLight(){let{children:e}=this.root;for(let t=0;t<e.length;t++)if(n.ZP.hasClass(e[t],this.focusClass))return{dom:e[t],pos:e[t].getBoundingClientRect()}}findFragment(e){let{children:t}=this.root;return e<0||e>=t.length?null:{dom:t[e],pos:t[e].getBoundingClientRect()}}unHightLight(){let{children:e}=this.root;for(let t=0;t<e.length;t++)n.ZP.removeClass(e[t],this.focusClass)}setHightLight(e){let{children:t}=this.root;if(e<t.length)return n.ZP.addClass(t[e],this.focusClass),{dom:t[e],pos:t[e].getBoundingClientRect()}}destroy(){this.progressList=null,this.fragments=null,this.root.innerHTML=""}render(){let{progressColor:e}=this.style;return this.root=n.ZP.createDom("xg-inners","",{},"progress-list"),this.fragments&&(this.progressList=this.fragments.map((t,i)=>{let l=n.ZP.createDom("xg-inner","",{style:e?`background:${e}; flex: ${t.percent}`:`flex: ${t.percent}`},`${t.isFocus?"inner-focus":""} xgplayer-progress-inner picture-inner`);return l.addEventListener("click",()=>this.onInnerClick(i)),this.root.appendChild(l),o.map(e=>{l.appendChild(n.ZP.createDom(e.tag,"",{style:e.styleKey?`background: ${this.style[e.styleKey]}; width:0;`:"width:0;"},e.className))}),{cached:l.children[0],played:l.children[1]}})),this.root}constructor(e){this.fragments=e.fragments||[],this.onInnerClick=e.onInnerClick,this.focusClass="inner-focus",this.style=e.style||{playedColor:"",cachedColor:"",progressColor:""},this.cachedIndex=0,this.playedIndex=0}}i("78590");class a extends l.ZP{static get pluginName(){return"pictureProgress"}static get defaultConfig(){return{position:l.kd.CONTROLS_CENTER,index:0,disable:!1,isDragingSeek:!0,closeMoveSeek:!1,isPauseMoving:!1,isCloseClickSeek:!1,fragments:[],miniMoveStep:5,miniStartStep:2,onMoveStart:()=>{},onMoveEnd:()=>{}}}beforeCreate(e){"boolean"==typeof e.player.config.progress&&(e.config.disable=!e.player.config.progress)}createInner(){try{this.innerList=new r({duration:this.config.duration,fragments:this.config.fragments,style:this.playerConfig.commonStyle||{},onInnerClick:this.config.onInnerClick}),this.outer.insertBefore(this.innerList.render(),this.outer.children[0]),["findHightLight","unHightLight","setHightLight","findFragment"].map(e=>{this[e]=this.innerList[e].bind(this.innerList)})}catch(e){}}afterCreate(){if(!this.config.disable&&!this.playerConfig.isLive)this.pos={x:0,y:0,moving:!1,isDown:!1,isEnter:!1},this.outer=this.find("xg-outer"),this.createInner(),this.bind("pointerdown",this.onStopPropagation),this.bind("touchstart",this.onStopPropagation)}focus(){this.player.controls.pauseAutoHide(),n.ZP.addClass(this.root,"active")}blur(){this.player.controls.recoverAutoHide(),n.ZP.removeClass(this.root,"active")}onStopPropagation(e){e.stopPropagation()}updateIndex(e,t){let i="video"===this.config.fragments[e].type||t?this.config.fragments[e].start:this.config.fragments[e].end;this.innerList.update({played:i})}updateTime(e){this.innerList.update({played:e})}destroy(){this.thumbnailPlugin=null,this.innerList.destroy(),this.innerList=null,this.unbind("pointerdown",this.onStopPropagation),this.unbind("touchstart",this.onStopPropagation)}render(){if(this.config.disable||this.playerConfig.isLive)return;let e=this.player.controls?this.player.controls.config.mode:"";return`
    <xg-progress class="xgplayer-progress ${"bottom"===e?"xgplayer-progress-bottom":""} ${this.config.hide?"one-live-hide":""}">
      <xg-outer class="xgplayer-progress-outer picture">
      </xg-outer>
    </xg-progress>
    `}constructor(e){super(e),this._state={now:-1,direc:0,time:0}}}var d=a},841135:function(e,t,i){i.d(t,{X:function(){return p}});var l=i(520739),n=i(88648),o=i(645260),r=i.n(o),a=i(613063),d=i.n(a),s=i(506467),u=i(860684),c=i(680475),v=i(288386);let{ArrowLeft:f,ArrowRight:m,A:g,D:h}=s.bf,p=e=>{let t=(0,u.n)(),{preClick:i,nextClick:o,disableShortCut:a=!1,active:s=!0}=e;return(0,n.useEffect)(()=>{if(!!s){if(t){if(a)return(0,c.K)(t);let e={left:{keyCode:f.keyCode,action:i,disable:!1,noBodyTarget:!1},right:{keyCode:m.keyCode,action:o,disable:!1,noBodyTarget:!1},leftA:{keyCode:g.keyCode,action:i,disable:!1,noBodyTarget:!1},rightD:{keyCode:h.keyCode,action:o,disable:!1,noBodyTarget:!1}},n={left:r()(t,"plugins.keyboard.keyCodeMap.left"),right:r()(t,"plugins.keyboard.keyCodeMap.right"),leftA:r()(t,"plugins.keyboard.keyCodeMap.leftA"),rightD:r()(t,"plugins.keyboard.keyCodeMap.rightD")};return d()(t,"plugins.keyboard.keyCodeMap",(0,l._)({},r()(t,"plugins.keyboard.keyCodeMap")||{},e)),()=>{t.plugins.keyboard&&((0,v.v)({currentCodeMap:t.plugins.keyboard.keyCodeMap,additionalCodeMap:e}),d()(t,"plugins.keyboard.keyCodeMap",(0,l._)({},r()(t,"plugins.keyboard.keyCodeMap")||{},n)))}}}},[t,i,o,a,s]),null}},73729:function(e,t,i){i.d(t,{i:function(){return n}}),i(874386);var l=i(88648);let n=e=>{let{player:t,timeDuration:i=3e3}=e,[n,o]=(0,l.useState)(!1),r=(0,l.useRef)(),a=(0,l.useCallback)(()=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{o(!0),r.current=null},i)},[i]);return(0,l.useEffect)(()=>{if(null==t?void 0:t.root){var e,i,l;let n=()=>{r.current&&clearTimeout(r.current),o(!1)},d=()=>{o(!1),a()},s=()=>{o(!1),a()};return null==t||null===(e=t.root)||void 0===e||e.addEventListener("mouseenter",d),null==t||null===(i=t.root)||void 0===i||i.addEventListener("mousemove",s),null==t||null===(l=t.root)||void 0===l||l.addEventListener("mouseleave",n),()=>{var e,i,l;null==t||null===(e=t.root)||void 0===e||e.removeEventListener("mouseenter",d),null==t||null===(i=t.root)||void 0===i||i.removeEventListener("mousemove",s),null==t||null===(l=t.root)||void 0===l||l.removeEventListener("mouseleave",n)}}},[null==t?void 0:t.root,a,o]),(0,l.useEffect)(()=>()=>{r.current&&clearTimeout(r.current),r.current=null},[]),n}},843029:function(e,t,i){i.r(t),i.d(t,{PictureMode:function(){return q},PictureModeInner:function(){return G}});var l=i("520739");i("874386");var n=i("563097"),o=i("88648"),r=i("205457");i("635303");var a=i("713097"),d=i.n(a),s=i("734123"),u=i("746864"),c=i("147613"),v=i("35730"),f=i("161045"),m=i("555106"),g=i("534739"),h=i("708739"),p=i("878389");i("527785");var _=i("510063"),y=i("974865"),x=i("367366"),w=i("782442"),I=i("637005"),b=i("32167"),C=i("150566"),T=i("816299"),S=i("734017"),E=i("515330"),k=i("623607"),N=i("257165"),P=i("841135"),L=i("73729"),j=i("473677"),M=i("366498"),A=i("860684"),R=i("943695");let Z={singleTime:2e3,speed:250},B=e=>{var t,i,r,a,c,v;let{isActive:f,awemeInfo:m,swiper:h,onPlayFinish:B,playNextFunc:D,ablePlayNext:V,playPrevFunc:U,ablePlayPrev:F,logParams:z,arrowButtonSize:O=56,isClientMiniWin:W,disableShortCut:$=!1,isShowSideBar:H=!1,inSearch:K,leftStyle:G,rightStyle:q}=e,J=(0,A.n)(),[Q,X]=(0,o.useState)(!0),[Y,ee]=(0,o.useState)([!0,!0]),et=(0,o.useRef)(z),ei=(0,o.useRef)(!0),el=(0,o.useRef)(null),en=e=>{X(e),ei.current=e},eo=(0,o.useRef)(null),er=(0,o.useRef)(null),ea=(null==m?void 0:null===(t=m.images)||void 0===t?void 0:t.length)===1&&(null==m?void 0:null===(r=m.images)||void 0===r?void 0:null===(i=r[0])||void 0===i?void 0:i.clipType)===5,ed=ea&&(null==m?void 0:null===(c=m.images)||void 0===c?void 0:null===(a=c[0])||void 0===a?void 0:a.livePhotoType)===1,es=(0,L.i)({player:J}),eu=(0,o.useMemo)(()=>m.images.reduce((e,t)=>e+(t.video?t.video.duration:Z.singleTime),0),[m]),ec=(0,o.useMemo)(()=>{if(m&&0===m.images.length)return[];let e=-1;return m.images.map(t=>{if(t.video){let i={type:"video",start:e+1,end:e+t.video.duration+.999,duration:t.video.duration,percent:1/m.images.length};return e=i.end,i}{let t={type:"image",start:e+1,end:e+Z.singleTime,duration:Z.singleTime,percent:1/m.images.length};return e=t.end,t}})},[m]);et.current=z;let ev=(0,o.useCallback)(e=>{var t;let i=null==J?void 0:J.getPlugin("pictureProgress");null==i||null===(t=i.updateIndex)||void 0===t||t.call(i,e,ei.current)},[J]),ef=(0,o.useCallback)(e=>{var t;let i=null==J?void 0:J.getPlugin("pictureProgress");null==i||null===(t=i.updateTime)||void 0===t||t.call(i,e)},[J]),em=(0,o.useCallback)(e=>{var t,i;M.Z.sendLog("multiPhotoSlide",(0,p._)((0,l._)({enter_from:null===(t=et.current)||void 0===t?void 0:t.enter_from,author_id:null==m?void 0:null===(i=m.authorInfo)||void 0===i?void 0:i.uid,group_id:null==m?void 0:m.awemeId,pic_cnt:m.images.length,is_zoom:(0,x.r)()},et.current),{enter_method:"click_pic",aweme_type:(null==m?void 0:m.isSlides)?151:null==m?void 0:m.awemeType})),h.slideTo(e,0),en(!1),ev(e),ee([0===h.activeIndex,h.activeIndex===(null==m?void 0:m.images.length)-1])},[h,ev,m]),eg=(0,o.useCallback)(e=>{if(h.activeIndex>0){var t,i;M.Z.sendLog("multiPhotoSlide",(0,p._)((0,l._)({enter_from:null===(t=et.current)||void 0===t?void 0:t.enter_from,author_id:null==m?void 0:null===(i=m.authorInfo)||void 0===i?void 0:i.uid,group_id:null==m?void 0:m.awemeId,pic_cnt:m.images.length,is_zoom:(0,x.r)()},et.current),{enter_method:(null==e?void 0:e.type)==="click"?"click_button":"keyboard",aweme_type:(null==m?void 0:m.isSlides)?151:null==m?void 0:m.awemeType})),en(!1),ev(h.activeIndex-1),h.slidePrev(),ee([0===h.activeIndex,h.activeIndex===(null==m?void 0:m.images.length)-1])}},[h,ev,m]),eh=(0,o.useCallback)(e=>{if(h.activeIndex<h.slides.length-1){var t;M.Z.sendLog("multiPhotoSlide",(0,p._)((0,l._)({enter_from:null==z?void 0:z.enter_from,author_id:null==m?void 0:null===(t=m.authorInfo)||void 0===t?void 0:t.uid,group_id:null==m?void 0:m.awemeId,pic_cnt:m.images.length,is_zoom:(0,x.r)()},et.current),{enter_method:(null==e?void 0:e.type)==="click"?"click_button":"keyboard",aweme_type:(null==m?void 0:m.isSlides)?151:null==m?void 0:m.awemeType})),en(!1),ev(h.activeIndex+1),h.slideNext(),ee([0===h.activeIndex,h.activeIndex===(null==m?void 0:m.images.length)-1])}},[h,ev,m]);(0,P.X)({preClick:eg,nextClick:eh,disableShortCut:$}),(0,o.useEffect)(()=>{if(J&&(null==m?void 0:m.awemeType)===u.e.Note){let e=e=>{if(e){var t;M.Z.sendLog("enterGraphicDetail",{enter_from:null==z?void 0:z.enter_from,author_id:null==m?void 0:null===(t=m.authorInfo)||void 0===t?void 0:t.uid,group_id:null==m?void 0:m.awemeId,pic_cnt:m.images.length})}};return J.on(s.Events.FULLSCREEN_CHANGE,e),()=>{J.off(s.Events.FULLSCREEN_CHANGE,e)}}},[m,J]),(0,o.useEffect)(()=>{if(J&&(null==m?void 0:m.awemeType)===u.e.Note){let e=J.getPlugin("AutoPlaySettingPlugin")||J.getPlugin("SearchAutoPlaySettingPlugin");if(e)return e.playeNextWeightNum+=1,()=>{e.playeNextWeightNum-=1}}},[m,J]),(0,o.useEffect)(()=>{if(J&&(null==m?void 0:m.awemeType)===u.e.Note){let e=J.getPlugin("InnerAutoPlayPlugin");if(e){let t=e.config.innerAutoPlayWeight;return e.config.innerAutoPlayWeight=t<0?t-1:0,()=>{let i=e.config.innerAutoPlayWeight;e.config.innerAutoPlayWeight=i<-1?t+1:0}}}},[m,J]),(0,o.useEffect)(()=>{if(J)return J.registerPlugin(N.Z,{fragments:ec,duration:eu,hide:ea,onInnerClick:em}),J.getPlugin(_.Z.pluginName)&&J.unRegisterPlugin(_.Z.pluginName,!0),J.getPlugin(y.Z.pluginName)&&J.unRegisterPlugin(y.Z.pluginName,!0),()=>{J.getPlugin(N.Z.pluginName)&&J.unRegisterPlugin(N.Z.pluginName,!0),J.registerPlugin(_.Z,{}),J.registerPlugin(y.Z,{})}},[J,em]),(0,o.useEffect)(()=>{if(h){let e=!1,t=()=>{e=!1,setTimeout(()=>em(h.activeIndex))},i=()=>{en(!1),ev(h.activeIndex),e||h.once("touchEnd",t),e=!0};try{h.on("touchMove",i)}catch(e){}return()=>{try{null==h||h.off("touchMove",i)}catch(e){}}}},[h,ev,em]);let ep=(0,o.useCallback)(()=>{var e,t,i;let l=J.getPlugin("AutoPlaySettingPlugin")||J.getPlugin("SearchAutoPlaySettingPlugin"),n=J.getPlugin("InnerAutoPlayPlugin");l&&(null==l?void 0:null===(e=l.config)||void 0===e?void 0:e.nextAutoPlay)&&(null==l?void 0:l.playeNextWeightNum)<=1&&V&&(null==l?void 0:l.stopFlag)===0?null==D||D():n&&(null===(t=w.Le.getConfig(w.gI.InnerAutoPlay))||void 0===t?void 0:t.modeIndex)===R.KM.Nomal&&n.config.innerAutoPlayWeight>=0&&V&&(null==n?void 0:n.stopFlag)===0?null==D||D({from:"auto"}):n&&(null===(i=w.Le.getConfig(w.gI.InnerAutoPlay))||void 0===i?void 0:i.modeIndex)===R.KM.Reverse&&n.config.innerAutoPlayWeight>=0&&F&&(null==n?void 0:n.stopFlag)===0&&(null==U||U({from:"auto"}))},[J,F,V,U,D]);return(0,o.useEffect)(()=>{if(f&&J&&h&&Q&&"video"!==ec[h.activeIndex].type){let e=1e3*J.currentTime;e>100&&m.imageAlbumMusicInfo.beginTime>1e3&&(e-=m.imageAlbumMusicInfo.beginTime);let t=()=>{let t=((J.currentTime+J.duration)*1e3-e)%(1e3*J.duration);if(m.imageAlbumMusicInfo.beginTime>1e3){let{beginTime:i,endTime:l}=m.imageAlbumMusicInfo,n=l-i;t=(1e3*J.currentTime-i+n-e)%n}if(t>=Z.singleTime){var i,n,o;if(h.activeIndex===m.images.length-1){ep(),ev(0),ee([!0,!1]),h.slideTo(0,0);let e=J.getPlugin("pictureProgress");null==e||null===(n=e.innerList)||void 0===n||n.reset(),M.Z.sendLog("multiPhotoSlide",(0,p._)((0,l._)({enter_from:null==z?void 0:z.enter_from,author_id:null==m?void 0:null===(o=m.authorInfo)||void 0===o?void 0:o.uid,group_id:null==m?void 0:m.awemeId,pic_cnt:m.images.length,is_zoom:(0,x.r)()},et.current),{enter_method:"auto",aweme_type:(null==m?void 0:m.isSlides)?151:null==m?void 0:m.awemeType})),J.cumulateTime>=5e3&&el.current();return}ev(h.activeIndex+1),ee([!1,h.activeIndex+1===(null==m?void 0:m.images.length)-1]),h.slideTo(h.activeIndex+1,Z.speed),M.Z.sendLog("multiPhotoSlide",(0,p._)((0,l._)({enter_from:null==z?void 0:z.enter_from,author_id:null==m?void 0:null===(i=m.authorInfo)||void 0===i?void 0:i.uid,group_id:null==m?void 0:m.awemeId,pic_cnt:m.images.length,is_zoom:(0,x.r)()},et.current),{enter_method:"auto",aweme_type:(null==m?void 0:m.isSlides)?151:null==m?void 0:m.awemeType}));return}ef(ec[h.activeIndex].start+t)};return J.on(s.Events.TIME_UPDATE,t),()=>{J.off(s.Events.TIME_UPDATE,t)}}},[null==h?void 0:h.activeIndex,J,f,Q,ec,ep]),(0,o.useEffect)(()=>{if(f&&J&&h){let e=e=>{"switch_play_pause"===e.action&&e.paused&&en(!0)};return J.on(s.Events.USER_ACTION,e),()=>{J.off(s.Events.USER_ACTION,e)}}},[f,J,h]),(0,o.useEffect)(()=>{if(J){let e=!1,t=!1,i=()=>{e&&I.emit(I.EVENT.notevideo,{type:"replay",playerId:J.playerId,index:h.activeIndex}),t&&ep()},l=()=>{eo.current&&(e=!0,clearTimeout(eo.current)),er.current&&(t=!0,clearTimeout(er.current))};return J.on("play",i),J.on("pause",l),()=>{J.off("play",i),J.off("pause",l)}}},[J]),(0,o.useEffect)(()=>{if(f&&J&&h){let e=I.listen(I.EVENT.notevideo,e=>{let{type:t,data:i,index:n,playerId:o}=e;if(J.playerId===o){if("start"===t&&ea&&setTimeout(()=>{I.emit(I.EVENT.notevideo,{type:"onelive_start",playerId:J.playerId,isMix:ed})},100),"timeupdate"===t&&h.activeIndex===n&&ef(ec[h.activeIndex].start+i),"end"===t){if(ea&&(I.emit(I.EVENT.notevideo,{type:"onelive_end",playerId:J.playerId,isMix:ed}),ed?eo.current=setTimeout(()=>{I.emit(I.EVENT.notevideo,{type:"replay",playerId:J.playerId,index:h.activeIndex})},2500):setTimeout(()=>{I.emit(I.EVENT.notevideo,{type:"replay",playerId:J.playerId,index:h.activeIndex})},300)),Q){var r,a,d;if(h.activeIndex===m.images.length-1){ed?er.current=setTimeout(()=>{ep()},2500):ep(),ev(0),ee([!0,!1]),h.slideTo(0,0);let e=J.getPlugin("pictureProgress");null==e||null===(a=e.innerList)||void 0===a||a.reset(),M.Z.sendLog("multiPhotoSlide",(0,p._)((0,l._)({enter_from:null==z?void 0:z.enter_from,author_id:null==m?void 0:null===(d=m.authorInfo)||void 0===d?void 0:d.uid,group_id:null==m?void 0:m.awemeId,pic_cnt:m.images.length,is_zoom:(0,x.r)()},et.current),{enter_method:"auto",aweme_type:(null==m?void 0:m.isSlides)?151:null==m?void 0:m.awemeType})),J.cumulateTime>=5e3&&el.current();return}ev(h.activeIndex+1),ee([!1,h.activeIndex+1===(null==m?void 0:m.images.length)-1]),h.slideTo(h.activeIndex+1,Z.speed),M.Z.sendLog("multiPhotoSlide",(0,p._)((0,l._)({enter_from:null==z?void 0:z.enter_from,author_id:null==m?void 0:null===(r=m.authorInfo)||void 0===r?void 0:r.uid,group_id:null==m?void 0:m.awemeId,pic_cnt:m.images.length,is_zoom:(0,x.r)()},et.current),{enter_method:"auto",aweme_type:(null==m?void 0:m.isSlides)?151:null==m?void 0:m.awemeType}))}else setTimeout(()=>{I.emit(I.EVENT.notevideo,{type:"replay",playerId:J.playerId,index:h.activeIndex})},100)}}});return()=>{e(),clearTimeout(eo.current),clearTimeout(er.current)}}},[f,J,h,Q,ep]),(0,o.useEffect)(()=>{if(h){let e=()=>{if(h.activeIndex===(null==m?void 0:m.images.length)-1){var t,i,n,o,r,a,d,s;M.Z.sendLog("videoPlayFinish",(0,l._)({urlParamList:["enter_method","trending_topic","previous_page"],enter_from:(0,b.mo)(),author_id:null==m?void 0:null===(t=m.authorInfo)||void 0===t?void 0:t.uid,group_id:null==m?void 0:m.awemeId,log_pb:null==m?void 0:m.logPb,compilation_id:null==m?void 0:null===(i=m.mixInfo)||void 0===i?void 0:i.mixId,playlet_id:null==m?void 0:null===(n=m.seriesInfo)||void 0===n?void 0:n.seriesId,tab_name:(0,S.zD)()||(0,C.Rs)("tab_name")||"",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(o=w.Le.getConfig(w.gI.IsCollapseAuthorCard))||void 0===o?void 0:o.isCollapseAuthorCard)?0:1,from_follow_list:(null===(r=w.Le.getConfig(w.gI.FromFollowList))||void 0===r?void 0:r.tag)?"1":"0",is_mute:(null==J?void 0:J.muted)?"1":"0",is_force:(null===(a=w.Le.getConfig(w.gI.ForceMuted))||void 0===a?void 0:a.currentMuteType)==="browser"?"1":"0",trending_topic:"",aweme_type:(null==m?void 0:m.isSlides)?u.e.Slides:null==m?void 0:m.awemeType,pic_cnt:null==m?void 0:null===(d=m.images)||void 0===d?void 0:d.length,is_small_window:"0",column_type:(null==z?void 0:z.column_type)||(null==z?void 0:null===(s=z.search_params)||void 0===s?void 0:s.column_type),is_selected_label:(null==m?void 0:m.weeklyRecommend)?1:0},z,(0,T.Wc)()));try{h.off("slideChange",e)}catch(e){}null==B||B()}};try{h.slideTo(0,0),ee([0===h.activeIndex,h.activeIndex===(null==m?void 0:m.images.length)-1]),h.on("slideChange",e)}catch(e){}return()=>{try{h.off("slideChange",e)}catch(e){}}}},[h,m]),(0,o.useEffect)(()=>{if(h){el.current=()=>{var e,t,i,n,o,r,a;M.Z.sendLog("finishTuji",(0,l._)({urlParamList:["enter_method","trending_topic","previous_page"],enter_from:(0,b.mo)(),author_id:null==m?void 0:null===(e=m.authorInfo)||void 0===e?void 0:e.uid,group_id:null==m?void 0:m.awemeId,log_pb:null==m?void 0:m.logPb,compilation_id:null==m?void 0:null===(t=m.mixInfo)||void 0===t?void 0:t.mixId,playlet_id:null==m?void 0:null===(i=m.seriesInfo)||void 0===i?void 0:i.seriesId,tab_name:(0,S.zD)()||(0,C.Rs)("tab_name")||"",is_visible:String("visible"===document.visibilityState?1:0),is_author_card_expand:(null===(n=w.Le.getConfig(w.gI.IsCollapseAuthorCard))||void 0===n?void 0:n.isCollapseAuthorCard)?0:1,from_follow_list:(null===(o=w.Le.getConfig(w.gI.FromFollowList))||void 0===o?void 0:o.tag)?"1":"0",is_mute:(null==J?void 0:J.muted)?"1":"0",is_force:(null===(r=w.Le.getConfig(w.gI.ForceMuted))||void 0===r?void 0:r.currentMuteType)==="browser"?"1":"0",trending_topic:"",aweme_type:null==m?void 0:m.awemeType,pic_cnt:null==m?void 0:null===(a=m.images)||void 0===a?void 0:a.length,is_small_window:"0"},z)),el.current=()=>{}};let e=()=>{h.activeIndex===(null==m?void 0:m.images.length)-1&&el.current&&!ei.current&&el.current()};return h.on("slideChange",e),()=>{h.off("slideChange",e)}}},[h,m]),!W&&(null==m?void 0:null===(v=m.images)||void 0===v?void 0:v.length)>1?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:d()(g.default.leftArrow,g.default.arrow,{[g.default.disabled]:Y[0],[g.default.inSideBar]:H,[g.default.inSearch]:K,[g.default.hide]:es,[G]:G}),style:{width:`${O}px`,height:`${O}px`},children:(0,n.jsx)(j.Z,{src:E.Z,width:O,height:O,viewBox:"0 0 56 56",onClick:eg})}),(0,n.jsx)("div",{className:d()(g.default.rightArrow,g.default.arrow,{[g.default.disabled]:Y[1],[g.default.inSideBar]:H,[g.default.inSearch]:K,[g.default.hide]:es,[q]:q}),style:{width:`${O}px`,height:`${O}px`},children:(0,n.jsx)(j.Z,{src:k.Z,width:O,height:O,viewBox:"0 0 56 56",onClick:eh})})]}):null};var D=i("158073"),V=i("330746"),U=i("569231"),F=i.p+"media/douyinDefault.330eae8fad2b7adc.png",z=i("64815");let O=e=>{let{imageInfo:t,className:i,imgPlaceHolderClassName:l,isMini:r,inSearch:a,isOneLive:s,isOneLiveMix:u}=e,[c,v]=(0,o.useState)(!0),[m,g]=(0,o.useState)(!1),[h,p]=(0,o.useState)(null),[_,y]=(0,o.useState)(-1),[x,w]=(0,o.useState)(!1),b=(0,o.useRef)(0),C=(0,V.G6)(),T=(0,V.vU)();b.current=(null==t?void 0:t.width)/(null==t?void 0:t.height);let S=(0,o.useCallback)(()=>{h&&b.current&&(h.offsetWidth/b.current>h.offsetHeight-(r?0:33)?v(!0):v(!1))},[h,r]),E=(0,o.useCallback)(()=>{m||g(!0)},[m]);(0,o.useEffect)(()=>{if(h&&S){let e=f.Z.bind(h,S);return()=>{e&&e()}}},[h,S]),(0,o.useEffect)(()=>{h&&(r?h.setAttribute("normal",""):h.removeAttribute("normal"))},[h,r]),(0,o.useEffect)(()=>{let e=I.listen(I.EVENT.notevideo,e=>{"onelive_start"===e.type&&!0===e.isMix&&w(!0),"onelive_end"===e.type&&!0===e.isMix&&w(!1)});return()=>e()},[]);let k=(0,o.useMemo)(()=>{if(m)return null;if(-1!==_)return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{src:null==t?void 0:t.urlList[_],className:d()({[z.default.baseWidth]:!c,[z.default.baseHeight]:c,[z.default.isSafari]:C,[z.default.inSearch]:a},z.default.imgPlaceHolder,l),onError:E}),(0,n.jsxs)("div",{className:d()({[z.default.backgroundImg]:!C,[z.default.backgroundImgFirefox]:T,[z.default.backgroundImgSarari]:C}),children:[(0,n.jsx)("img",{src:C?U:(null==t?void 0:t.urlList[_])||U}),!C&&(0,n.jsx)("div",{className:z.default.backgroundMask})]})]});{let e=new Image;e.src=null==t?void 0:t.urlList[0];let i=setTimeout(()=>{null==t||t.urlList.map((e,t)=>{let i=new Image;i.src=e,i.onload=()=>y(t)})},2e3);return e.onload=()=>{y(0),clearTimeout(i)},(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{src:F,className:d()({[z.default.baseWidth]:!c,[z.default.baseHeight]:c,[z.default.isSafari]:C,[z.default.inSearch]:a},z.default.imgPlaceHolder,l)}),(0,n.jsxs)("div",{className:d()({[z.default.backgroundImg]:!C,[z.default.backgroundImgFirefox]:T,[z.default.backgroundImgSarari]:C}),children:[(0,n.jsx)("img",{src:C?U:F}),!C&&(0,n.jsx)("div",{className:z.default.backgroundMask})]})]})}},[m,_,E,c]);return(0,n.jsx)("div",{className:d()(i,z.default.imgBackground,z.default.playerShowInfo,{[z.default.isFirefox]:T,[z.default.livePhoto]:5===t.clipType,[z.default.withoutProgress]:s,[z.default.isOneLiveMix]:u,[z.default.isInLive]:x}),ref:p,children:k})};var W=i("894416"),$=i("750733"),H=i("217281"),K=i("962820");let G=e=>{var t,i,l,r,a;let{isActive:p,awemeInfo:_,playNextFunc:y,playPrevFunc:x,ablePlayPrev:w,ablePlayNext:I,logParams:b,isMini:C,isClientMiniWin:T,onPlayFinish:S,customProps:E,disableShortCut:k=!1,isShowSideBar:N=!1,inSearch:P}=e,L=(0,A.n)(),[j,M]=(0,o.useState)(null),[R,Z]=(0,o.useState)(_),{arrowButtonSize:V=56,disableInactiveCursor:U=!1,leftStyle:F,rightStyle:z}=E||{},W=(null==_?void 0:null===(t=_.images)||void 0===t?void 0:t.length)===1&&(null==_?void 0:null===(l=_.images)||void 0===l?void 0:null===(i=l[0])||void 0===i?void 0:i.clipType)===5,G=W&&(null==_?void 0:null===(a=_.images)||void 0===a?void 0:null===(r=a[0])||void 0===r?void 0:r.livePhotoType)===1,q=(0,o.useMemo)(()=>{var e;if((null==_?void 0:_.awemeType)!==u.e.Note)return[];if(p)return null==_?void 0:_.images;return(null==_?void 0:null===(e=_.images)||void 0===e?void 0:e.slice(0,1))||[]},[null==_?void 0:_.images,p,null==_?void 0:_.awemeType]),J=(0,o.useMemo)(()=>{var e,t;return!!(null==_?void 0:null===(t=_.images)||void 0===t?void 0:null===(e=t.find)||void 0===e?void 0:e.call(t,e=>e.video))},[null==_?void 0:_.images]);return((0,o.useEffect)(()=>()=>M(null),[]),(0,o.useEffect)(()=>{let e=null==L?void 0:L.innerContainer;if(e&&(null==_?void 0:_.awemeType)===u.e.Note)return s.Util.addClass(e,"hideXgVideo"),()=>{s.Util.removeClass(e,"hideXgVideo")}},[L,_]),(0,o.useEffect)(()=>{let{beginTime:e=0,endTime:t=Number.MAX_SAFE_INTEGER}=(null==_?void 0:_.imageAlbumMusicInfo)||{},i=()=>{(L.currentTime>=t/1e3||L.currentTime<e/1e3)&&(L.currentTime=e/1e3)};return(null==_?void 0:_.awemeType)===u.e.Note&&e>=0&&t>e&&(null==L||L.on(s.Events.TIME_UPDATE,i)),()=>{null==L||L.off(s.Events.TIME_UPDATE,i)}},[L,_]),(0,o.useEffect)(()=>{if(p&&j&&L){var e;j.update();let t=f.Z.bind(null==j?void 0:null===(e=j.$el)||void 0===e?void 0:e[0],()=>{j.update()});return()=>{t&&t()}}},[j,p,L]),(0,o.useEffect)(()=>{Z(_)},[_]),(0,c.o)(()=>{var e,t;if(p&&L&&(null==_?void 0:null===(e=_.imageAlbumMusicInfo)||void 0===e?void 0:e.volume)===0)return L.config.volume_raw=L.volume,L.volume=.01,()=>{L.volume=L.config.volume_raw,(0,m.qQ)(v.LocalStorageKeys.PLAYER_VOLUME,L.config.volume_raw),(0,K.c)({volume:L.config.volume_raw})};!p&&L&&(null==_?void 0:null===(t=_.imageAlbumMusicInfo)||void 0===t?void 0:t.volume)===0&&L.config.volume_raw&&((0,m.qQ)(v.LocalStorageKeys.PLAYER_VOLUME,L.config.volume_raw),(0,K.c)({volume:L.config.volume_raw}))},[p,L]),(null==_?void 0:_.awemeType)!==u.e.Note)?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)($.t,{direction:0,onSwiper:M,className:d()(g.default.swiperContainer,"focusPanel"),tabIndex:-1,data:q,slideKey:(e,t)=>`${null==e?void 0:e.uri}_${t}`,speed:250,children:(0,n.jsx)(H.o,{className:g.default.pictureFeed,children:e=>{let{slideData:t,activeIndex:i,currentIndex:l}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{style:{width:"100%",height:"100%",zIndex:2,background:"transparent"},className:d()(g.default.mask,{[g.default.inactive]:i!==l&&U}),type:"button",onKeyDown:e=>null==e?void 0:e.preventDefault()}),(0,n.jsx)(O,{imageInfo:t,isMini:C,className:g.default.itemImage,inSearch:P,isOneLive:W,isOneLiveMix:G}),p&&t.video&&(0,n.jsx)(D.v,{albumMusic:_.imageAlbumMusicInfo,info:t,isMini:C,activeIndex:i,currentIndex:l,inSearch:P,isOneLive:W})]})}})}),R===_&&p&&!J&&(0,n.jsx)(h.e,{isActive:p,awemeInfo:_,swiper:j,onPlayFinish:S,playNextFunc:y,playPrevFunc:x,ablePlayNext:I,ablePlayPrev:w,logParams:b,arrowButtonSize:V,isClientMiniWin:T,disableShortCut:k,isShowSideBar:N,inSearch:P,leftStyle:F,rightStyle:z}),R===_&&p&&J&&(0,n.jsx)(B,{isActive:p,awemeInfo:_,swiper:j,onPlayFinish:S,playNextFunc:y,playPrevFunc:x,ablePlayNext:I,ablePlayPrev:w,logParams:b,arrowButtonSize:V,isClientMiniWin:T,disableShortCut:k,isShowSideBar:N,inSearch:P,leftStyle:F,rightStyle:z})]})},q=e=>{let t=(0,W.N)();return(0,n.jsx)(r.k,{componentName:"PictureMode",Slardar:t,children:(0,n.jsx)(G,(0,l._)({},e))})}},366498:function(e,t,i){var l=i(746864),n=i(544933);let o={multiPhotoSlide:{eventName:"multi_photo_slide",params:{aweme_type:l.e.Note,enter_from:"",enter_method:"",author_id:"",group_id:"",pic_cnt:0,is_zoom:!1}},enterGraphicDetail:{eventName:"enter_graphic_detail",params:{enter_from:"",author_id:"",group_id:"",pic_cnt:0}},videoPlayFinish:{eventName:"video_play_finish",params:{author_id:"",group_id:"",log_pb:"",is_visible:"1",enter_from:"",compilation_id:"",playlet_id:"",previous_page:"",tab_name:"",from_follow_list:"0",is_mute:"0",is_force:"0",trending_topic:"",open_from_page:"",multi_window_order:""}},finishTuji:{eventName:"finish_tuji",params:{author_id:"",group_id:"",log_pb:"",is_visible:"1",enter_from:"",compilation_id:"",playlet_id:"",previous_page:"",tab_name:"",from_follow_list:"0",is_mute:"0",is_force:"0",trending_topic:""}}};t.Z=new n.h(o)},997671:function(e,t,i){i.d(t,{Z:function(){return p},H:function(){return h}});var l=i("563097");i("88648");var n=i("713097"),o=i.n(n),r=i("410665"),a=i("32167"),d=i("637005"),s=i("863499"),u=i("929582"),c=i("2196"),v=i("544933"),f=new v.h({videoRiskRemindBarShow:{eventName:"video_risk_remind_bar_show",params:{enter_from:"",warn_type:"",is_skip:!1,group_id:"",author_id:""}},videoRiskRemindBarClick:{eventName:"video_risk_remind_bar_click",params:{enter_from:"",warn_type:"",is_skip:!1,group_id:"",author_id:""}}}),m=i("906499"),g=i("254897");let h=(e,t)=>!!((null==e?void 0:e.content)&&!(null==e?void 0:e.url));var p=e=>{let{risk:t,awemeInfo:i,isDetail:n,className:v}=e,{content:h,type:p,icon_url:_,url:y}=t,x=(0,r.Y)((()=>{var e;f.sendLog("videoRiskRemindBarShow",{enter_from:(0,a.vM)(),warn_type:String(p),is_skip:!!y,group_id:null==i?void 0:i.awemeId,author_id:null==i?void 0:null===(e=i.authorInfo)||void 0===e?void 0:e.uid})}).bind(null));return(0,l.jsx)("div",{ref:x,className:v,children:(0,l.jsxs)(m.a,{href:decodeURIComponent(y),target:"_blank",onClick:e=>{if(y){var t;d.emit(d.EVENT.videoPause,"SafetyWarningBar_onClick"),f.sendLog("videoRiskRemindBarClick",{enter_from:(0,a.vM)(),warn_type:String(p),is_skip:!!y,group_id:null==i?void 0:i.awemeId,author_id:null==i?void 0:null===(t=i.authorInfo)||void 0===t?void 0:t.uid})}else null==e||e.preventDefault()},className:o()("safetyBar",c.default.bar,{[c.default.barDetail]:n,[c.default.hasUrl]:!!y}),children:[_?(0,l.jsx)("img",{src:_,className:c.default.iconImage}):(0,l.jsx)(g.z,{svg:(0,l.jsx)(s.Z,{}),className:c.default.icon}),(0,l.jsx)("div",{className:c.default.content,children:h}),y&&(0,l.jsx)(g.z,{svg:(0,l.jsx)(u.Z,{style:{fontSize:"14px"}}),className:c.default.rightIcon})]})})}},207850:function(e,t,i){i.d(t,{T:function(){return _}});var l=i("520739"),n=i("88648"),o=i("79307"),r=i("746864"),a=i("658065"),d=i("792429"),s=i("367366"),u=i("782442"),c=i("349998"),v=i("637005"),f=i("14108"),m=i("176638"),g=i("32167"),h=i("544933"),p=new h.h({clickTitleAt:{eventName:"click_title_at",params:{to_user_id:"",author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",is_full_screen:"0"}},clickVideoTitle:{eventName:"click_video_title",params:{action:"expand",author_id:"",group_id:"",enter_from:"",log_pb:"",previous_page:"",is_full_screen:"0",player_display_mode:"",play_current_time:0}},clickTitleHashtag:{eventName:"click_title_hashtag",params:{hashtag:"",author_id:"",group_id:"",log_pb:"",enter_from:"",previous_page:"",is_full_screen:"0",tag_id:"",status:"",player_display_mode:""}},xiguaAnchorShow:{eventName:"xigua_anchor_show",params:{author_id:"",group_id:""}},xiguaAnchorClick:{eventName:"xigua_anchor_click",params:{author_id:"",group_id:""}},clickAuthorHead:{eventName:"click_author_head",params:{author_id:"",group_id:"",enter_from:"",previous_page:"",is_full_screen:"0",log_pb:"",from_follow_list:"0",from_xigua:0,click_from:"",clarity:"",aweme_type:"",is_auto:1}},trendingShow:{eventName:"trending_show",params:{words_source:"related_search_anchor_v2",enter_from:"",words_num:0,enter_group_id:"",impr_id:""}},trendingWordsClick:{eventName:"trending_words_click",params:{words_source:"title_named_entity",enter_group_id:"",enter_group_type:"",group_id:"",search_position:"",words_content:"",words_position:0,impr_id:""}},trendingWordsShow:{eventName:"trending_words_show",params:{words_source:"title_named_entity",enter_group_id:"",enter_group_type:"",group_id:"",search_position:"",words_content:"",words_position:0,impr_id:""}},videoInfoAreaShow:{eventName:"video_info_area_show",params:{enter_from:"",player_display_mode:"",group_id:"",author_id:"",is_fold:"0"}},videoInfoAreaClick:{eventName:"video_info_area_click",params:{enter_from:"",player_display_mode:"",group_id:"",author_id:""}}});function _(e){let{awemeInfo:t,videoTags:i,onClickUserName:h,authorId:_,awemeType:y,logPb:x,awemeId:w,player:I}=e;(0,n.useEffect)(()=>{let e=i.filter(e=>e.type===o.WZ.RelatedSearch);e.length&&p.sendLog("trendingShow",{words_source:"related_search_anchor_v2",enter_from:(0,a.yW)(),words_num:e.length,enter_group_id:t.awemeId,impr_id:(0,d.U)(t).impr_id})},[i]);let b=(0,n.useCallback)(()=>{var e;p.sendLog("clickAuthorHead",(0,l._)({click_from:"title",urlParamList:["previous_page"],author_id:_,group_id:w,log_pb:x,enter_from:(0,a.yW)(),is_full_screen:(0,s.r)()?"1":"0",from_follow_list:(null===(e=u.Le.getConfig(u.gI.FromFollowList))||void 0===e?void 0:e.tag)?"1":"0",from_xigua:y===r.e.XgVideo?1:0,aweme_type:y},(0,c.t)())),v.emit(v.EVENT.videoPause,"useLog_clickAuthorHeadLog"),window.open((0,f.GN)(_),(0,m.f)()?"_self":"_blank")},[_,y,x,w]),C=(0,n.useCallback)(()=>p.sendLog("xiguaAnchorClick",{author_id:_,group_id:w}),[_,w]),T=(0,n.useCallback)(()=>p.sendLog("xiguaAnchorShow",{author_id:_,group_id:w}),[_,w]),S=(0,n.useCallback)((e,t,i)=>{p.sendLog("clickTitleHashtag",{hashtag:t.slice(1),urlParamList:["previous_page"],author_id:_,group_id:w,log_pb:x,enter_from:(0,a.yW)(),is_full_screen:(0,s.r)()?"1":"0",tag_id:e,status:"on",player_display_mode:(0,g.Ok)()})},[_,w,x]),E=(0,n.useCallback)(e=>{p.sendLog("clickTitleAt",{to_user_id:e,urlParamList:["previous_page"],author_id:_,group_id:w,log_pb:x,enter_from:(0,a.yW)(),is_full_screen:(0,s.r)()?"1":"0"})},[w,_,x]),k=(0,n.useCallback)(e=>{p.sendLog("clickVideoTitle",{action:e?"fold":"expand",urlParamList:["previous_page"],author_id:_,group_id:w,log_pb:x,enter_from:(0,a.yW)(),is_full_screen:(0,s.r)()?"1":"0",player_display_mode:(0,g.Ok)(),play_current_time:Math.floor((null==I?void 0:I.currentTime)||0)})},[w,_,x,I]),N=(0,n.useCallback)((e,i,l)=>{p.sendLog("trendingWordsClick",{enter_group_id:w,enter_group_type:y===r.e.Note?"aweme_image":"aweme_video",group_id:i,search_position:(0,a.yW)(),words_content:e,words_position:l,impr_id:(0,d.U)(t).impr_id})},[w,y,t]),P=(0,n.useCallback)((e,i,l)=>{p.sendLog("trendingWordsShow",{enter_group_id:w,enter_group_type:y===r.e.Note?"aweme_image":"aweme_video",group_id:i,search_position:(0,a.yW)(),words_content:e,words_position:l,impr_id:(0,d.U)(t).impr_id})},[w,y,t]),L=(0,n.useCallback)(()=>{p.sendLog("videoInfoAreaShow",{enter_from:(0,a.yW)(),group_id:w,player_display_mode:(0,g.Ok)(),author_id:_})},[w,_]);return{clickAuthorHeadLog:b,xiguaAnchorClickLog:C,xiguaAnchorShowLog:T,clickTitleHashtagLog:S,clickTitleAtLog:E,clickVideoTitleLog:k,titleNamedEntityWordsClickLog:N,titleNamedEntityWordsShowLog:P,videoInfoAreaShowLog:L,videoInfoAreaClickLog:(0,n.useCallback)(()=>{p.sendLog("videoInfoAreaClick",{enter_from:(0,a.yW)(),group_id:w,player_display_mode:(0,g.Ok)(),author_id:_})},[w,_])}}},48559:function(e,t,i){i.r(t),i.d(t,{VideoInfo:function(){return eU},VideoInfoNew:function(){return eF}});var l=i("520739");i("874386"),i("250440"),i("268917");var n=i("563097"),o=i("88648"),r=i("713097"),a=i.n(r),d=i("79307"),s=i("240894"),u=i("507217"),c=i("410665"),v=i("702726"),f=i("256277"),m=i("325982"),g=i("746864"),h=i("452894"),p=i("823685"),_=i("337499"),y=i("782442"),x=i("32167"),w=i("55426"),I=i("637005"),b=i("945977"),C=i("782563"),T=i("367366"),S=i("14108"),E=i("687297"),k=i("330746"),N=i("153606"),P=i("801021"),L=i("794676"),j=i("207850");let M=e=>{let{abTestData:t}=e,[i,l]=(0,o.useState)(!1),n=(0,o.useMemo)(()=>({"no-video-info-mask":i}),[i]);return{maskWrapperClass:n,onAlphaChange:(0,o.useCallback)(e=>{let{no_mask_threshold:i}=(null==t?void 0:t.videoInfoMask)||{};"number"==typeof i&&l(e<=i)},[t])}};var A=i("30321"),R=i("161045");let Z=e=>{let{abTestData:t,parentDom:i,isDetail:l,scene:n,awemeInfo:r}=e,[a,s]=(0,o.useState)(n===d.lT.Search?118:124),[u,c]=(0,o.useState)({}),v=()=>{if(l||(0,A.yk)(location.pathname)||n===d.lT.CreatorCenter||!i)return;let e=null==i?void 0:i.clientWidth,t=e-a,o=.36*e;t>=320&&t>=o?o>=320?c({width:"100%",maxWidth:o}):c({width:"100%",maxWidth:320,minWidth:320}):c({width:"100%"})};return(0,o.useEffect)(()=>{if(!l&&!(0,A.yk)(location.pathname)&&i){let e=()=>{v()},t=R.Z.bind(i,e);return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e),t()}}},[i,t,l]),(0,o.useEffect)(()=>{v()},[a]),(0,o.useEffect)(()=>{let e=I.listen(I.EVENT.InteractionWidthChange,e=>{let{width:t=62,awemeId:i}=e||{};i===(null==r?void 0:r.awemeId)&&s(t+40)});return()=>{null==e||e()}},[r]),{childStyle:u,updateChildStyle:v,offset:a}};var B=i("826110"),D=i("516599"),V=i("422959"),U=i("172451"),F=i("868203"),z=i("473677"),O=i("895599"),W=i("673024"),$=i("554288"),H=i("469554"),K=i("860684");i("985085");var G=i("279025"),q=i("24825"),J=i("965901"),Q=i("121038"),X=i("997671"),Y=i("383639"),ee=i("878389");let et=(0,o.forwardRef)((e,t)=>(0,n.jsxs)("svg",(0,ee._)((0,l._)({width:30,height:16,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:[(0,n.jsx)("rect",{width:30,height:16,rx:2,fill:"#fff",fillOpacity:".08"}),(0,n.jsx)("path",{d:"M9.492 2.004L8.22 2.22c.216.336.408.72.588 1.128h-4.38v3.636c-.024 2.34-.348 4.176-.972 5.496l.96.852c.744-1.596 1.128-3.708 1.164-6.348V4.452h8.796V3.348h-4.308a16.717 16.717 0 0 0-.576-1.344zm15.564 6.672h-8.04v4.548h1.152v-.576h5.736v.576h1.152V8.676zm-6.888 2.904V9.756h5.736v1.824h-5.736zm-.276-6.732h2.688v1.656h-5.04V7.62h10.92V6.504h-4.74V4.848h3.828V3.756H21.72V2.148h-1.14v1.608h-2.016c.204-.408.372-.852.516-1.32l-1.128-.144c-.384 1.248-1.104 2.292-2.16 3.144l.684.9a8.301 8.301 0 0 0 1.416-1.488z",fill:"#fff",fillOpacity:".5"})]})));var ei=i("530240"),el=i("631493"),en=i("985917"),eo=i("247056"),er=i("250556"),ea=i("701523"),ed=i("375944");function es(e){var t;let{awemeInfo:i,isInfoFold:l,isInnerFeed:r,isActive:d,player:s,config:u,onAlphaChange:c}=e,[v,f]=(0,o.useState)(.4),m=(0,o.useCallback)(()=>{let e=function(e,t){let i=function(e){var t,i,l,n,o;let r=null===(i=e.video)||void 0===i?void 0:null===(t=i.meta)||void 0===t?void 0:t.title_info;if("string"==typeof r){let e=null===(o=JSON.parse(r))||void 0===o?void 0:o.avg_br_pc;if(e>0)return e}return null===(n=e.video)||void 0===n?void 0:null===(l=n.meta)||void 0===l?void 0:l.brightness_mean}(e);if(void 0===i)return .4;let{target_contrast:l,max_alpha:n=.4}=t,o=Number(i)/255;return Math.min(Math.max(0,(l*(o+.05)-1.05)/(l*o)),n)}(i,u);f(e),null==c||c(e)},[]);(0,er.O)(d,()=>{if(!d)return;if("number"!=typeof u.use_blocked_detect){m();return}let e=function(e){let t=e.pcBlockedAreaRatio||[],i=t.indexOf(6686);if(-1!==i)return t[i+1]}(i);if("number"!=typeof e){m();return}if((null==s?void 0:s.video)instanceof HTMLVideoElement){let t;let{width:i,height:l}=s.video.getBoundingClientRect(),{videoWidth:n,videoHeight:o}=s.video,r=n/o;t=r>i/l?i:l*r;let a=(i-t)/2+t*e/100,d=.36*i;!((d-a)/d>u.use_blocked_detect)&&m()}});let g={};if(l&&.4!==v){if(0===v)return null;g.background=`linear-gradient(360deg,rgba(0,0,0,${v}) 0%,transparent 100%)`}return(0,n.jsx)("div",{style:g,className:a()("video-info-mask",{"windows-client-flag":(null===(t=(0,ed.fV)())||void 0===t?void 0:t.os)==="Windows"&&(0,C.DT)(),"splash-brand":(0,ea.p)(i)&&!r,"expanded-video-info-mask":!l})})}var eu=o.memo(function(e){var t;let{awemeInfo:i,isInfoFold:o,isInnerFeed:r,abTestData:d}=e,s=(null==d?void 0:d.videoInfoMask)||{},{target_contrast:u}=s;return"number"==typeof u?(0,n.jsx)(es,(0,ee._)((0,l._)({},e),{config:s})):(0,n.jsx)("div",{className:a()("video-info-mask",{"windows-client-flag":(null===(t=(0,ed.fV)())||void 0===t?void 0:t.os)==="Windows"&&(0,C.DT)(),"splash-brand":(0,ea.p)(i)&&!r,"expanded-video-info-mask":!o})})}),ec=i("4395"),ev=i("558518"),ef=i("439837"),em=i.n(ef),eg=i("376309"),eh=i.n(eg);em().extend(eh());var ep=i("720359");let e_=e=>{let{awemeInfo:t,isActive:i,player:l,abTestData:n}=e,[r,a]=(0,o.useState)(),[d,s]=(0,o.useState)([]),u=(0,o.useRef)(1e3*((null==l?void 0:l.currentTime)||0)),c=(0,ep.d)((null==r?void 0:r.knowledge)||""),v=(0,o.useMemo)(()=>{var e;return!(0,k.km)(80)&&(0,ev.b2)(t)&&!(0,f.Jt)(t)&&(null==t?void 0:null===(e=t.douyinPcVideoExtra)||void 0===e?void 0:e.aiSearchMention)===1},[t]),m=(0,o.useCallback)(()=>(function(e){let t=em().utc(e),i=t.hour(),l=t.minute();return i>0?t.format("hh:mm:ss"):l>0?t.format("mm:ss"):`00:${t.format("ss")}`})(u.current),[]),g=(0,o.useMemo)(()=>v&&!!r,[v,r]),h=(0,o.useCallback)(async()=>{let e=await (0,ec.hs)({awemeId:null==t?void 0:t.awemeId});(null==e?void 0:e.statusCode)===0&&s((null==e?void 0:e.knowledgeList)||[])},[null==t?void 0:t.awemeId]);return(0,o.useEffect)(()=>{if(v&&l&&(null==d?void 0:d.length)>0){var e;u.current=1e3*(l.currentTime||0);let t=e=>{var t,i;let l=(null!==(i=e.currentTime)&&void 0!==i?i:0)*1e3;u.current=l;let n=null==d?void 0:null===(t=d.find)||void 0===t?void 0:t.call(d,e=>l>=e.startTime&&l<=e.endTime);(null==n?void 0:n.knowledge)!==c.current&&a(n)};return null==l||null===(e=l.on)||void 0===e||e.call(l,"timeupdate",t),()=>{var e;null==l||null===(e=l.off)||void 0===e||e.call(l,"timeupdate",t)}}},[v,l,d]),(0,o.useEffect)(()=>{i&&v&&(null==t?void 0:t.awemeId)&&h()},[i,v,null==t?void 0:t.awemeId,h]),{hasMentionEntry:v,mentionTagVisible:g,currentMention:r,fetchAiMentionData:h,getCurrentMentionTime:m}};var ey=i("254457"),ex=i("658065"),ew=i("781061");let eI=(0,o.forwardRef)((e,t)=>(0,n.jsxs)("svg",(0,ee._)((0,l._)({width:18,height:20,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:[(0,n.jsx)("g",{filter:"url(#icon_ai_svg__filter0_d_219_5791)",children:(0,n.jsx)("path",{d:"M11.07 12.226l.3.705c.325.763.694 1.518 1.098 2.243l.273.49-.056.028-.557.28-.053.028-.027-.053-.298-.561c-.034-.064-.07-.132-.114-.219a3.986 3.986 0 0 0-2.017.001l-.113.218-.298.561-.027.053-.053-.027-.556-.28-.056-.029.03-.056.242-.434c.404-.725.773-1.48 1.098-2.242l.3-.706.02-.044.047.008c.25.045.501.045.75 0l.048-.008.019.044zm3.107-.01c-.05.153-.079.31-.089.467a8.259 8.259 0 0 0-.017.534v1.586c0 .178.005.358.017.535.01.156.04.313.089.465l.026.079h-.993l.026-.08c.049-.152.08-.309.09-.465.011-.178.017-.358.017-.534v-1.586c0-.176-.006-.356-.018-.534a1.943 1.943 0 0 0-.09-.466l-.025-.08h.993l-.026.08zm-6.03-8.21c.657.048 1.232.362 1.623.828.352.418.555.958.534 1.54l-.003.055a2.22 2.22 0 0 1-.066.428l-.06.232 1.014-.26.058-.016c1.23-.283 2.493.424 2.825 1.622l.026.095a2.256 2.256 0 0 1-.277 1.687l-.03.05a2.322 2.322 0 0 1-1.038.873c-1.904.727-3.026-.791-3.423-1.655l.07-.017 1.157-.297c.017.17.07.341.172.508.268.435.783.682 1.297.598l.058-.01a1.27 1.27 0 0 0 .716-.427l.152-.232c.132-.252.178-.55.109-.846l-.01-.038a1.272 1.272 0 0 0-1.505-.907h-.005l-3.882.99c-.008.003-.015 0-.021-.004a.026.026 0 0 1-.01-.02l.008-.106.07-1.156A1.275 1.275 0 0 0 9.23 6.488a1.225 1.225 0 0 0-.157-.816l-.029-.047a1.272 1.272 0 0 0-.959-.578l-.039-.003a1.268 1.268 0 0 0-1.34 1.13v.006l-.245 3.938a.024.024 0 0 1-.027.02h-.006l-.086-.034-1.111-.43c.087-.146.148-.315.164-.509l.003-.048a1.263 1.263 0 0 0-.653-1.166l-.044-.021-.054-.026a1.284 1.284 0 0 0-.78-.08l-.053.012a1.263 1.263 0 0 0-.87.755c-.251.63.054 1.34.677 1.607l.005.001 3.73 1.446c.017.006.02.025.011.036l-.058.07-.759.908a1.208 1.208 0 0 0-.408-.296l-.035-.015-.045-.017a1.303 1.303 0 0 0-1.325.25l-.037.033a1.244 1.244 0 0 0 .098 1.852c.53.429 1.308.363 1.759-.138h.002v-.003l1.802-2.151v1.636l-.258.311-.667.797c-.806.965-2.247 1.152-3.246.404l-.047-.036a2.28 2.28 0 0 1-.862-1.59l-.004-.058a2.265 2.265 0 0 1 .836-1.907l.184-.153-.977-.377c-1.201-.462-1.828-1.787-1.373-2.966a2.313 2.313 0 0 1 1.325-1.32 2.368 2.368 0 0 1 2.103.192l.203.126.063-1.03H5.64a2.348 2.348 0 0 1 2.443-2.201l.065.004zm2.354 9.25c-.153.377-.32.758-.498 1.134a4.761 4.761 0 0 1 1.25 0 23.677 23.677 0 0 1-.498-1.133l-.127-.31-.127.31z",fill:"#fff"})}),(0,n.jsx)("defs",{children:(0,n.jsxs)("filter",{id:"icon_ai_svg__filter0_d_219_5791",x:-3.333,y:-1.333,width:22.667,height:22.667,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{}),(0,n.jsx)("feGaussianBlur",{stdDeviation:1.667}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0"}),(0,n.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_219_5791"}),(0,n.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_219_5791",result:"shape"})]})})]}))),eb=e=>{let{className:t,mentionItem:i,textClassName:l,onClick:o,onMouseEnter:r,awemeInfo:d}=e,s=(0,c.x)(()=>{v.logInstance.sendLog("aiChatButtonShow",{enter_from:(0,ex.yW)(),ai_chat_button_position:"bottom_bar_mention",group_id:null==d?void 0:d.awemeId,text:null==i?void 0:i.knowledge})}),u=(e,t)=>{v.logInstance.sendLog("aiChatButtonClick",{enter_from:(0,ex.yW)(),ai_chat_button_position:"bottom_bar_mention",group_id:null==d?void 0:d.awemeId,text:null==t?void 0:t.knowledge}),null==o||o(e,t)};return(0,n.jsxs)("div",{ref:s,className:a()(ew.default.aiMentionTag,t),onMouseEnter:e=>null==r?void 0:r(e,{from:P.jE.BottomBarMention}),onClick:e=>null==u?void 0:u(e,i),children:[(0,n.jsx)("span",{className:a()(ew.default.tagBg)}),(0,n.jsx)(z.Z,{className:a()(ew.default.aiIcon),src:eI,width:18,height:20,viewBox:"0 0 18 20"}),(0,n.jsxs)("span",{className:a()(ew.default.knowledge,l),children:["当前提及：",null==i?void 0:i.knowledge]}),(0,n.jsx)(z.Z,{src:ey.Z,className:ew.default.aiArrowSvg,width:12,height:12,viewBox:"0 0 12 12"})]})};var eC=i("436227");let eT=(0,o.forwardRef)((e,t)=>(0,n.jsxs)("svg",(0,ee._)((0,l._)({width:18,height:20,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t},e),{children:[(0,n.jsx)("g",{filter:"url(#icon_ai_svg__filter0_d_219_5791)",children:(0,n.jsx)("path",{d:"M11.07 12.226l.3.705c.325.763.694 1.518 1.098 2.243l.273.49-.056.028-.557.28-.053.028-.027-.053-.298-.561c-.034-.064-.07-.132-.114-.219a3.986 3.986 0 0 0-2.017.001l-.113.218-.298.561-.027.053-.053-.027-.556-.28-.056-.029.03-.056.242-.434c.404-.725.773-1.48 1.098-2.242l.3-.706.02-.044.047.008c.25.045.501.045.75 0l.048-.008.019.044zm3.107-.01c-.05.153-.079.31-.089.467a8.259 8.259 0 0 0-.017.534v1.586c0 .178.005.358.017.535.01.156.04.313.089.465l.026.079h-.993l.026-.08c.049-.152.08-.309.09-.465.011-.178.017-.358.017-.534v-1.586c0-.176-.006-.356-.018-.534a1.943 1.943 0 0 0-.09-.466l-.025-.08h.993l-.026.08zm-6.03-8.21c.657.048 1.232.362 1.623.828.352.418.555.958.534 1.54l-.003.055a2.22 2.22 0 0 1-.066.428l-.06.232 1.014-.26.058-.016c1.23-.283 2.493.424 2.825 1.622l.026.095a2.256 2.256 0 0 1-.277 1.687l-.03.05a2.322 2.322 0 0 1-1.038.873c-1.904.727-3.026-.791-3.423-1.655l.07-.017 1.157-.297c.017.17.07.341.172.508.268.435.783.682 1.297.598l.058-.01a1.27 1.27 0 0 0 .716-.427l.152-.232c.132-.252.178-.55.109-.846l-.01-.038a1.272 1.272 0 0 0-1.505-.907h-.005l-3.882.99c-.008.003-.015 0-.021-.004a.026.026 0 0 1-.01-.02l.008-.106.07-1.156A1.275 1.275 0 0 0 9.23 6.488a1.225 1.225 0 0 0-.157-.816l-.029-.047a1.272 1.272 0 0 0-.959-.578l-.039-.003a1.268 1.268 0 0 0-1.34 1.13v.006l-.245 3.938a.024.024 0 0 1-.027.02h-.006l-.086-.034-1.111-.43c.087-.146.148-.315.164-.509l.003-.048a1.263 1.263 0 0 0-.653-1.166l-.044-.021-.054-.026a1.284 1.284 0 0 0-.78-.08l-.053.012a1.263 1.263 0 0 0-.87.755c-.251.63.054 1.34.677 1.607l.005.001 3.73 1.446c.017.006.02.025.011.036l-.058.07-.759.908a1.208 1.208 0 0 0-.408-.296l-.035-.015-.045-.017a1.303 1.303 0 0 0-1.325.25l-.037.033a1.244 1.244 0 0 0 .098 1.852c.53.429 1.308.363 1.759-.138h.002v-.003l1.802-2.151v1.636l-.258.311-.667.797c-.806.965-2.247 1.152-3.246.404l-.047-.036a2.28 2.28 0 0 1-.862-1.59l-.004-.058a2.265 2.265 0 0 1 .836-1.907l.184-.153-.977-.377c-1.201-.462-1.828-1.787-1.373-2.966a2.313 2.313 0 0 1 1.325-1.32 2.368 2.368 0 0 1 2.103.192l.203.126.063-1.03H5.64a2.348 2.348 0 0 1 2.443-2.201l.065.004zm2.354 9.25c-.153.377-.32.758-.498 1.134a4.761 4.761 0 0 1 1.25 0 23.677 23.677 0 0 1-.498-1.133l-.127-.31-.127.31z",fill:"#fff"})}),(0,n.jsx)("defs",{children:(0,n.jsxs)("filter",{id:"icon_ai_svg__filter0_d_219_5791",x:-3.333,y:-1.333,width:22.667,height:22.667,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,n.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,n.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,n.jsx)("feOffset",{}),(0,n.jsx)("feGaussianBlur",{stdDeviation:1.667}),(0,n.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,n.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0"}),(0,n.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_219_5791"}),(0,n.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_219_5791",result:"shape"})]})})]})));var eS=e=>{let{className:t,onClick:i,onMouseEnter:l,awemeInfo:o}=e,r=(0,c.x)(()=>{v.logInstance.sendLog("aiChatButtonShow",{enter_from:getLogPageName(),ai_chat_button_position:"bottom_bar_screen",group_id:null==o?void 0:o.awemeId})});return(0,n.jsxs)("div",{ref:r,className:a()(eC.default.aiScreenshot,t),onClick:()=>{v.logInstance.sendLog("aiChatButtonClick",{enter_from:getLogPageName(),ai_chat_button_position:"bottom_bar_screen"}),null==i||i()},onMouseEnter:l,children:[(0,n.jsx)("span",{className:a()(eC.default.tagBg)}),(0,n.jsx)(z.Z,{className:a()(eC.default.aiIcon),src:eT,width:18,height:20,viewBox:"0 0 18 20"}),(0,n.jsx)("span",{className:eC.default.text,children:"识别画面"})]})},eE=i("734123");let ek=e=>{let{player:t,awemeInfo:i,isActive:l}=e||{},n=(0,o.useMemo)(()=>!(0,k.km)(80)&&(0,ev.b2)(i)&&!(0,f.Jt)(i)&&[i]),[r,a]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{if(n&&t&&l){let e=!1,i=()=>{a(!1)},l=()=>{e&&a(!0)},n=()=>{e=!0,t.off(eE.Events.TIME_UPDATE,n)};return t.on(eE.Events.PAUSE,l),t.on(eE.Events.PLAY,i),t.once(eE.Events.TIME_UPDATE,n),()=>{t.off(eE.Events.PAUSE,l),t.off(eE.Events.PLAY,i),t.off(eE.Events.TIME_UPDATE,n)}}a(!1)},[n,t,l]),{aiScreenShotVisible:r,hasAiScreenshot:n}};var eN=i("877639"),eP=i.n(eN),eL=i("752144"),ej=i("574138"),eM=e=>{let{player:t,awemeInfo:i,isActive:l,abTestData:n}=e||{},r=(0,o.useRef)(!1),a=(0,o.useRef)(""),d=eP()(async()=>{try{var e;let l=await (0,eL.yO)(.6,()=>t);null==t||null===(e=t.play)||void 0===e||e.call(t);let n=()=>{I.emit(I.EVENT.aiSearchShotScreen,{awemeId:null==i?void 0:i.awemeId,dataURL:l,imgMethod:"bottom_bar_screen"})};r.current?I.emit(I.EVENT.openAiCard,{awemeId:null==i?void 0:i.awemeId,from:"bottom_bar_screen",tab:ej.X.Search}):(a.current=l,I.emit(I.EVENT.openAiCard,{awemeId:null==i?void 0:i.awemeId,from:"bottom_bar_screen",tab:ej.X.Search,onLoginCancel(){a.current=""},onLoginSuccess(){a.current=l}})),n()}catch(e){D.F.info("截图失败，请重试")}},1e3);return(0,o.useEffect)(()=>{if(l&&(null==i?void 0:i.awemeId)){let e=I.listen(I.EVENT.aiSearchPageLoad,e=>{if((null==i?void 0:i.awemeId)!==(null==e?void 0:e.awemeId))return;if(r.current=!0,!!a.current)setTimeout(()=>{I.emit(I.EVENT.aiSearchShotScreen,{awemeId:null==i?void 0:i.awemeId,dataURL:a.current,imgMethod:"bottom_bar_screen"}),a.current=""},1e3)});return()=>{null==e||e()}}},[null==i?void 0:i.awemeId,l,n]),{handleClickAiScreenshot:d,handleMouseEnterAiScreenshot:()=>{I.emit(I.EVENT.renderAiCard,{awemeId:null==i?void 0:i.awemeId,from:"bottom_bar_screen"})}}},eA=i("51570"),eR=i("730843"),eZ=i("794593"),eB=i("47119");let eD=e=>{var t,i;let{className:l,onSodaClick:r,awemeInfo:d}=e,s=(0,c.Y)(()=>{var e,t,i;eZ.K.report("show_ticker_icon_entrance",{author_id:(null==d?void 0:null===(e=d.authorInfo)||void 0===e?void 0:e.uid)||"",enter_from:(0,ex.yW)(),enter_method:"video_bottom",group_id:(null==d?void 0:d.awemeId)||"",luna_group_id:String((null==d?void 0:null===(i=d.relatedMusicAnchor)||void 0===i?void 0:null===(t=i.extraJson)||void 0===t?void 0:t.luna_sid)||"")})}),u=(0,o.useMemo)(()=>{var e,t;let{title:i="",author:l="",anchor_text:n="相关音乐"}=null!==(t=null==d?void 0:null===(e=d.relatedMusicAnchor)||void 0===e?void 0:e.extraJson)&&void 0!==t?t:{};if(!i)return n;let o=`${n}: ${i}`;return i.length<=5&&l&&(o=`${n}: ${i}-${l}`),o},[]),v=(null==d?void 0:null===(i=d.relatedMusicAnchor)||void 0===i?void 0:null===(t=i.extraJson)||void 0===t?void 0:t.anchor_icon)||"https://p3-luna.douyinpic.com/tos-cn-i-b829550vbb/sodaIcon.svg~tplv-b829550vbb-obj.image";return(0,n.jsxs)("div",{ref:s,className:a()(eB.default.container,l),onClick:()=>{r({from:"video_bottom"})},children:[(0,n.jsx)("span",{className:a()(eB.default.tagBg)}),(0,n.jsx)("img",{src:v,className:a()(eB.default.icon)}),(0,n.jsx)("span",{className:eB.default.text,children:u}),(0,n.jsx)(z.Z,{className:a()(eB.default.arrowSvg),src:ey.Z,width:12,height:12,viewBox:"0 0 12 12"})]})};var eV=i("909543");let eU=e=>{var t,i,r,A,R,ee,ei,er,ea,ed,es,ec,ev,ef,em,eg,eh;let{abTestData:ep,awemeInfo:ey,scene:ex,isTopicLinkSearchResult:ew,videoHashtagClassName:eI,isTopicLinkDetail:eC,videoTags:eT=[],onSodaClick:eE,isShowCreateTime:eN=!1,userInfo:eP,onClickUserName:eL,className:ej,children:eZ,loginUserInfo:eB,loginDispatch:eU,fullScreenTarget:eF,reportExtraParams:ez,onCooperationAuthorClick:eO,isShowCooperation:eW=!1,showSideBar:e$=!1,isActive:eH,toast:eK,showFriendIcon:eG,showAccountName:eq=!0,showTitle:eJ=!0,isInnerFeed:eQ=!1,showGuideDownloadClient:eX=!1,isShowBrandComponent:eY=!1,onBrandComponentHide:e0,onBrandComponentShow:e1,handleMobileSiteClick:e2,oneLineWarginig:e3,modalEnterFrom:e6,openSpecificTab:e8,isDetail:e7,hideAiSearchEntry:e5,sideCardContext:e4,showExpandButtonInner:e9}=e,te=(0,K.n)(),tt=e7||el.s.getPlayerScene(null==te?void 0:te.playerId)===d.lT.Detail,[ti,tl]=(0,o.useState)(!0),tn=(0,o.useRef)(null),to=null===(t=y.Le.getConfig(y.gI.WallPaperIds))||void 0===t?void 0:t.includes(null==ey?void 0:ey.awemeId),{changeKeyword:tr,resetSearchParams:ta}=(0,s.w)(),{cooperationInfo:td,awemeType:ts,awemeId:tu,authorInfo:tc,logPb:tv,mixInfo:tf}=ey||{},{maskWrapperClass:tm,onAlphaChange:tg}=M({abTestData:ep}),th=(0,eV.a)(),{mentionTagVisible:tp,currentMention:t_,getCurrentMentionTime:ty}=e_({awemeInfo:ey,player:te,isActive:eH,abTestData:ep}),{handleClickAiSearchBar:tx,handleMouseEnterAiSearchBar:tw}=(0,eA.p)({awemeInfo:ey,isActive:eH}),{aiScreenShotVisible:tI}=ek({player:te,awemeInfo:ey,abTestData:ep,isActive:eH}),{handleClickAiScreenshot:tb,handleMouseEnterAiScreenshot:tC}=eM({awemeInfo:ey,player:te,isActive:eH,abTestData:ep}),[tT,tS]=(0,o.useState)(),{childStyle:tE={},offset:tk}=Z({abTestData:ep,parentDom:tT,isDetail:tt,scene:ex,awemeInfo:ey}),{isShowTitleAndDescAlone:tN,finalTitle:tP,title:tL,desc:tj,computedTextExtra:tM,titleElRef:tA,descLine:tR,isTitleWrapped:tZ}=(0,eR.Q)({awemeInfo:ey,abTestData:ep}),{cooperationCreators:tB,acceptedNums:tD=0,cursor:tV}=td||{},tU=(0,o.useRef)(null),tF=(0,o.useMemo)(()=>{if(!(null==tB?void 0:tB.length))return[];let e=[],t=tB.filter(t=>(t.roleId===u.CooperationRoleId.Author&&e.push(t),t.roleId!==u.CooperationRoleId.Author));return[...e,...t]},[tB]),tz=(0,o.useMemo)(()=>{if(!!(null==td?void 0:td.extra))return JSON.parse(td.extra)},[null==td?void 0:td.extra]),tO=(null==tz?void 0:tz.is_large_co_activity)&&tD>=14,tW=tO?tD+1:tF.length||0,t$=()=>{if("function"==typeof e2){e2();return}if(tO){(0,en.Y)({awemeInfo:ey,authorList:tF,totalNum:tW,cursor:tV,extra:tz,userInfo:eP});return}(0,J.N)({logParams:{clickMethod:"more_button"},showCooperationList:tF,loginUserInfo:eB,awemeInfo:ey,reportExtraParams:ez,loginDispatch:eU})},{uid:tH,nickname:tK,remarkName:tG,accountCertInfo:tq}=tc||{},tJ=ex===d.lT.CreatorCenter,tQ=y.Le.getConfig(y.gI.AbtestData),tX=(0,c.Y)(()=>{v.logInstance.sendLog("postTimeShow",{enter_from:(0,x.mo)(),group_id:ey.awemeId,post_time:(0,w.MH)(1e3*ey.createTime)})}),{lineHeight:tY}=(0,B.c)(te),{clickAuthorHeadLog:t0,xiguaAnchorClickLog:t1,xiguaAnchorShowLog:t2,clickTitleHashtagLog:t3,clickTitleAtLog:t6,clickVideoTitleLog:t8,titleNamedEntityWordsClickLog:t7,titleNamedEntityWordsShowLog:t5,videoInfoAreaShowLog:t4,videoInfoAreaClickLog:t9}=(0,j.T)({awemeInfo:ey,videoTags:eT,onClickUserName:eL,authorId:tH,awemeType:ts,logPb:tv,awemeId:tu,player:te}),ie=(0,o.useCallback)(()=>{if("function"==typeof e2){e2();return}if(null==eL||eL(),(0,f.Jt)(ey)){if(ex===d.lT.Recommend||ex===d.lT.Modal&&"discover"===(0,x.vM)()){I.emit(I.EVENT.openAdSideCard);let e=(0,f.Rx)(ey);(0,m.E)("realtime_click",{tag:(0,b.f)(),value:null==e?void 0:e.creative_id,log_extra:null==e?void 0:e.log_extra,refer:"title"});return}if((0,f.gc)(ey)){eK?eK("广告视频不支持此功能"):D.F.info("广告视频不支持此功能");return}}if((0,f.gc)(ey)){eK?eK("广告视频不支持此功能"):D.F.info("广告视频不支持此功能");return}ts===g.e.XgVideo?t0():I.emit(I.EVENT.videoTitleClick,{awemeId:tu,playerId:null==te?void 0:te.playerId})},[tH,ts,tv,tu,eL,te,t0,e2]),it=(0,o.useCallback)(()=>{t1(),ie()},[ie,t1,e2]),ii=[d.lT.Recommend].includes(ex)||e6===h.a.WaterFall,il=(0,o.useMemo)(()=>ts===g.e.XgVideo?(t2(),(0,n.jsx)("div",{className:"account-badge",onClick:it,children:(0,n.jsxs)("div",{className:"badge-xg-bg",children:[(0,n.jsx)("div",{className:"badge-xg"}),(0,n.jsx)("span",{children:"来自西瓜视频"})]})})):"",[ts,it,t2]),io=(0,o.useCallback)((e,t,i)=>{var l;let n=null==ep?void 0:ep.searchOpenCurrentTab;((null==n?void 0:n.save_status)!==1||(0,C.DT)()||(null===(l=window)||void 0===l?void 0:l.location.pathname)!=="/")&&ew&&I.emit(I.EVENT.videoPause,"VideoInfo_onHashTagClick"),t3(e,t,i)},[ew,t3,e2]),ir=(0,o.useCallback)((e,t,i)=>{var l;let n=null==ep?void 0:ep.searchOpenCurrentTab;((null==n?void 0:n.save_status)!==1||(0,C.DT)()||(null===(l=window)||void 0===l?void 0:l.location.pathname)!=="/")&&I.emit(I.EVENT.videoPause,"VideoInfo_onSearchTextClick"),(0,eo.v2)(e,{source:"related_search_anchor_v2"},(null==ep?void 0:ep.open_current_tab)===1,(null==ep?void 0:ep.save_video)===1,(null==ep?void 0:ep.clientSpaV2)===p.CommonSwitch.On&&(0,C.DT)(),tr,ta),null==t7||t7(e,t,i)},[t7]),ia=(0,o.useCallback)(e=>{I.emit(I.EVENT.videoPause,"VideoInfo_onUserNameClick"),t6(e)},[t6,e2]),id=(0,o.useCallback)(e=>{if(e9)e4.handleRelated({tab:_.L.VideoDetail,awemeInfo:ey,clickMethod:"video_info"}),t8(e);else{var t;I.emit(I.EVENT.hideFakeScreen,!1),null==te||null===(t=te.emit)||void 0===t||t.call(te,"titleIsFold",e),t8(e),tl(e),!tt&&!tJ&&I.emit(I.EVENT.openVideoInfoSideCard,{awemeId:null==ey?void 0:ey.awemeId})}},[e9,e4,te,t8,ey,tJ,tt]),is=(0,o.useCallback)(()=>{e9&&id(!1)},[e9,id]),iu=!tt&&!tJ&&!ti||(null==e4?void 0:e4.showSideCard)&&(null==e4?void 0:e4.curTab)===_.L.VideoDetail,ic=(0,o.useCallback)(e=>{if(!iu&&!eY&&eJ&&(null==e?void 0:e.isShow)){var t;v.logInstance.sendLog("showVideoTitle",{enter_from:(0,x.mo)(),group_id:null==ey?void 0:ey.awemeId,author_id:null==ey?void 0:null===(t=ey.authorInfo)||void 0===t?void 0:t.uid,is_full_screen:(0,T.r)()?"1":"0",urlParamList:["previous_page"]})}},[iu,eY,eJ,ey]);(0,o.useEffect)(()=>{if(!tt&&!tJ){let e=I.listen(I.EVENT.closeVideoInfoSideCard,e=>{(null==e?void 0:e.awemeId)===(null==ey?void 0:ey.awemeId)&&tl(!0)}),t=I.listen(I.EVENT.openVideoInfoSideCard,e=>{(null==e?void 0:e.awemeId)===(null==ey?void 0:ey.awemeId)&&tl(!1)});return()=>{null==e||e(),null==t||t()}}},[ey,tJ,tt]),(0,o.useEffect)(()=>{tl(!0)},[tu]);let iv=(0,o.useMemo)(()=>(0,f.Jt)(ey),[ey]),im=(0,o.useMemo)(()=>(0,f.Kf)(ey),[ey]),ig=(0,f.Kf)(ey),ih=(0,o.useCallback)(e=>{let{isUnfold:t}=e;return(0,n.jsx)(V.Z,{wrapperClassName:L.default.videoTitleWrapper,className:a()(L.default.videoTitle,L.default.adaptive),userTextClassName:a()(L.default.hashTagSpan,L.default.userText),hashTagClassName:a()({[L.default.linkHashTag]:ew},eI),getHashTagHref:(e,t)=>ew?`https://www.douyin.com/search/${encodeURIComponent(e)}?source=pc_click_hashtag_feed&enter_from=${(0,x.vM)()}&aweme_id=${ey.awemeId}&gid=${ey.groupId}`:eC?(0,S.bP)(t):"",text:tN?tj:tP,getSearchTextUrl:e=>`https://www.douyin.com/search/${encodeURIComponent(e)}?source=title_named_entity&enter_from=${(0,x.vM)()}&aweme_id=${ey.awemeId}&gid=${ey.groupId}`,isRemoveRowspan:!t,textExtra:tM,awemeInfo:ey,onClickHashtag:e2||io,onClickUser:e2||ia,onSearchTextClick:e2||ir,onSearchTextMounted:t5,enterMethod:"video_title_at",searchWordsType:U.L.VideoInfoTitle,abTestData:ep,player:te,children:(null==tf?void 0:tf.currentEpisode)&&!tN&&(0,n.jsxs)("span",{children:["第",null==tf?void 0:tf.currentEpisode,"集："]})})},[ey,tP,tj,tL,tN]),ip=(0,o.useCallback)(()=>{v.logInstance.sendLog("hover_author_head",{enter_from:(0,x.mo)(),click_from:"title"})},[]),i_=(0,o.useMemo)(()=>eT.slice(0,1),[eT]),iy=eT.length>0,ix=(0,o.useMemo)(()=>"/user/self"===th.pathname&&e6===h.a.UserPost,[th.pathname,e6]),iw=!iy&&eE&&(null==ey?void 0:null===(r=ey.relatedMusicAnchor)||void 0===r?void 0:null===(i=r.extraJson)||void 0===i?void 0:i.luna_sid)&&eH&&!ix&&(!(0,C.DT)()||(0,E.y)(null!==(eh=(0,C.FJ)().awemePcClient)&&void 0!==eh?eh:"",">=","6.2.0"));return((0,o.useEffect)(()=>{t4()},[t4]),null==te?void 0:te.video)?(0,n.jsxs)("div",{id:"video-info-wrap",className:a()("xgplayer-video-info-wrap xgplayer-video-info-wrap-new douyin-player-video-info-wrap douyin-player-video-info-wrap-new",L.default.infoContainer,(0,l._)({fullscreen:!ti,isVideoInfoOptimize:!tt&&!tJ,isInSearch:ex===d.lT.Search},tm)),"data-state":"normal",children:[eZ,(0,n.jsx)("div",{ref:tS,className:a()("video-info-detail",{isFireFox:(0,k.vU)(),wallpaperTitle:(null===(A=y.Le.getConfig(y.gI.WallPaperIds))||void 0===A?void 0:A.includes(null==ey?void 0:ey.awemeId))||eX,wallpaperClientTile:(null===(R=y.Le.getConfig(y.gI.WallPaperIds))||void 0===R?void 0:R.includes(null==ey?void 0:ey.awemeId))&&(0,C.DT)(),isVideoInfoOptimise:!tt&&!tJ},ej),"data-e2e":"video-info","data-e2e-aweme-id":ey.awemeId,style:(0,l._)({},tk?{paddingRight:`${tk}px`}:{}),children:(0,n.jsxs)("div",{style:tE,children:[ex!==d.lT.Search&&(0,n.jsx)($.A,{isShowBuy:el.s.getPlayerScene(null==te?void 0:te.playerId)!==d.lT.CreatorCenter,awemeInfo:ey,isActive:eH,isDetail:el.s.getPlayerScene(null==te?void 0:te.playerId)===d.lT.Detail,abTestData:ep,userInfo:eP,logParams:ez}),!iu&&!eY&&eq&&(0,n.jsxs)("div",{className:a()("account"),children:[(0,n.jsxs)("div",{className:a()("account-name","userAccountTextHover"),"data-e2e":"feed-video-nickname",onMouseEnter:ip,ref:tU,"data-click-from":"title",children:[(0,n.jsx)("span",{className:"account-name-text",onClick:ie,children:(0,n.jsx)(V.Z,{className:a()(L.default.userText,L.default.adaptive),text:`@${tG||tK}`})}),(0,n.jsx)(F.C,{accountCertInfo:tq,className:L.default.badge,isRoleNameShow:!1,certLabelStyle:null==ey?void 0:ey.certLabelStyle,useCertLabelStyle:ii})]}),(0,n.jsx)("div",{className:"video-create-time",children:eN&&(0,n.jsx)("span",{ref:tX,className:"time",children:`\xb7 ${(0,w.MH)(1e3*ey.createTime)}`})}),!eQ&&(iv&&(0,f.Gu)(ey)||im)&&(0,n.jsx)(z.Z,{src:et,width:30,height:16,viewBox:"0 0 30 16",style:{marginLeft:4}}),il,ts===g.e.Note&&((null==tQ?void 0:tQ.liveicon)&&(null==ey?void 0:null===(ei=ey.images)||void 0===ei?void 0:null===(ee=ei.every)||void 0===ee?void 0:ee.call(ei,e=>5===e.clipType))?(0,n.jsx)("div",{className:"account-card",children:(0,n.jsx)(H.EJ,{className:L.default.pictureStyle})}):(!(null==ey?void 0:ey.isSlides)||(null==ey?void 0:null===(ea=ey.images)||void 0===ea?void 0:null===(er=ea.every)||void 0===er?void 0:er.call(ea,e=>[2,5].includes(e.clipType))))&&(0,n.jsx)("div",{className:"account-card",children:(0,n.jsx)(H.J2,{className:L.default.pictureStyle})})),!!((null==ey?void 0:null===(es=ey.authorInfo)||void 0===es?void 0:null===(ed=es.relationLabel)||void 0===ed?void 0:ed.label_info)&&eG)&&(0,n.jsx)("div",{className:"account-card",children:(0,n.jsx)("span",{className:L.default.friendIcon,children:null==ey?void 0:null===(ev=ey.authorInfo)||void 0===ev?void 0:null===(ec=ev.relationLabel)||void 0===ec?void 0:ec.label_info})}),(null==tF?void 0:tF.length)>1&&eW&&(0,n.jsx)(q.Z,{authorList:tF,num:tW,isTag:!0,onClick:t$})]}),!iu&&!eY&&(null==tF?void 0:tF.length)>0&&eW&&(0,n.jsx)(G.Z,{authorList:tF,loginUserInfo:eB,loginDispatch:eU,fullScreenTarget:eF,reportExtraParams:ez,awemeInfo:ey,onCooperationAuthorClick:eO,abTestData:ep,showSideBar:e$,onClickMore:t$,isDetail:tt}),!iu&&!eY&&eJ&&(0,n.jsxs)("div",{className:a()("title",e9&&"cursorPointer"),"data-e2e":"video-desc",onClick:is,children:[tN&&(0,n.jsxs)("div",{ref:tA,className:a()(L.default.videoTitle,L.default.adaptive,L.default.aloneVideoTitle),children:[(null==tf?void 0:tf.currentEpisode)&&(0,n.jsxs)("span",{children:["第",null==tf?void 0:tf.currentEpisode,"集："]}),(0,n.jsx)("span",{children:tL})]}),(0,n.jsx)(O.Z,{maxLine:tR,lineClamp:tR,btnClassName:a()(L.default.button,L.default.expandButton,L.default.adaptive),onlyKey:tP,btnOnClick:id,lineHeight:tY,renderContent:ih,showExpandButton:!iv,player:te,isActive:eH,optimizeReflow:N.f.isMultiLineReflow(ep),showExpandButtonInner:e9&&(null==ey?void 0:null===(ef=ey.douyinPcVideoExtra)||void 0===ef?void 0:ef.aiNoteV2)===1,btnOnShow:ic,alwaysShowExpandButton:tZ})]}),(0,n.jsx)("div",{className:a()(L.default.underTitleTagContainer,L.default.rsBarOpt),onClickCapture:e=>null==e2?void 0:e2(e),ref:tn,children:!to&&!eX&&!eY&&!ig&&(0,n.jsxs)(n.Fragment,{children:[iw?(0,n.jsx)(eD,{className:a()(L.default.marginTop,L.default.maxWidth100),awemeInfo:ey,onSodaClick:eE}):null,iy&&(0,n.jsx)("div",{className:a()("under-title-tag",L.default.videoTagContainer,L.default.marginTop),children:(0,n.jsx)(W.h,{tagList:i_,awemeInfo:ey,userInfo:eP,isActive:eH,reportExtraParams:ez,isShowUpdateText:!0,player:te,abTestData:ep,containerRef:tn,showMiniTag:tp&&tI&&!e5,hiddenMixUpdateText:tp&&!e5,hiddenNextBtn:tI&&!e5,hiddenAiSearchEntry:e5,onAiSearchTagHover:tw,onAiSearchTagClick:tx})}),!e5&&tp&&(0,n.jsx)(eb,{className:a()(L.default.aiMentionTag,L.default.marginTop),textClassName:L.default.aiMentionText,mentionItem:t_,onClick:(e,t)=>tx(e,{query:t.knowledge,from:P.jE.BottomBarMention,getCurrentMentionTime:ty}),onMouseEnter:tw,awemeInfo:ey}),!e5&&tI&&(0,n.jsx)(eS,{className:L.default.marginTop,onClick:tb,onMouseEnter:tC,awemeInfo:ey})]})}),(0,f.Kf)(ey)&&!eQ&&(0,n.jsx)(Q.o,{awemeInfo:ey,isActive:eH,className:L.default.brandAd,onBrandComponentClose:()=>{null==e0||e0()},onBrandComponentShow:()=>{null==e1||e1()}}),!iu&&(0,X.H)(null==ey?void 0:ey.riskInfos,ep)&&(0,n.jsx)(X.Z,{awemeInfo:ey,risk:null==ey?void 0:ey.riskInfos,className:a()(L.default.marginTop,{[L.default.oneLineText]:e3})}),ex===d.lT.Search&&!!ey.videoAbstract&&(null===(em=ey.videoAbstract)||void 0===em?void 0:em.displayType)===2&&(0,n.jsx)("div",{id:"video-abstract",style:{marginTop:"12px"},children:(0,n.jsx)(Y.r,{awemeInfo:ey,isActive:eH,player:te,logParams:ez,isInnerFeed:eQ,isModal:void 0!==e6,openSpecificTab:e8})}),ex!==d.lT.Search&&!eQ&&(e6===h.a.GeneralSearch||e6===h.a.Search)&&!!ey.videoAbstract&&[2,3].includes(null===(eg=ey.videoAbstract)||void 0===eg?void 0:eg.displayType)&&(0,n.jsx)("div",{id:"video-abstract",style:{marginTop:"12px"},children:(0,n.jsx)(Y.r,{awemeInfo:ey,isActive:eH,player:te,logParams:ez,isInnerFeed:eQ,isModal:void 0!==e6,openSpecificTab:e8})})]})}),(0,n.jsx)(eu,{isActive:eH,player:te,isInfoFold:ti,isInnerFeed:eQ,awemeInfo:ey,abTestData:ep,onAlphaChange:tg}),(0,n.jsx)("div",{className:"mini-progress-outer",children:(0,n.jsx)("div",{className:"mini-progress-inner"})})]}):null},eF=(0,ei.K)(eU)}}]);
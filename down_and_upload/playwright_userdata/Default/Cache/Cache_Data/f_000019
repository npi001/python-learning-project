/*! For license information please see player-1.81bd1c29.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).xss={})}(this,function(e){"use strict";var t=function(){return(t=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function n(e,t,n){if(n||2==arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var i=/[^a-zA-Z0-9\\_:.-]/gim,r=/</g,a=/>/g,o=/&#([a-zA-Z0-9]*);?/gim,s=/&quot;/g,u=/&colon;?/gim,l=/&newline;?/gim,c=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,g=/u\s*r\s*l\s*\(.*/gi,d=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,f=/"/g,h=function(e){return e.replace(r,"&lt;").replace(a,"&gt;")},p={indexOf:function(e,t){var n,i;for(n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return -1},forEach:function(e,t,n){var i,r;for(i=0,r=e.length;i<r;i++)t.call(n,e[i],i,e)},some:function(e,t,n){var i,r;for(i=0,r=e.length;i<r;i++)if(t.call(n,e[i],i,e))return!0;return!1},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},includes:function(e,t){if("string"==typeof e)return -1!==e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1},uniq:function(e){for(var t={},n=[],i=0;i<e.length;i++)t[e[i]]||(n.push(e[i]),t[e[i]]=!0);return n},from:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},keys:function(e){var t=[];for(var n in e)t.push(n);return t}};function m(e){return null==e}function v(e){var t;return'"'===(t=e)[0]&&'"'===t[t.length-1]||"'"===t[0]&&"'"===t[t.length-1]?e.substr(1,e.length-2):e}function y(e){var t,n,i,r,a,o,s,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",c=0;for(e=function(e){e=e.replace(/rn/g,"n");for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t+=String.fromCharCode(i):i>127&&i<2048?t+=String.fromCharCode(i>>6|192)+String.fromCharCode(63&i|128):t+=String.fromCharCode(i>>12|224)+String.fromCharCode(i>>6&63|128)+String.fromCharCode(63&i|128)}return t}(e);c<e.length;)r=(t=e.charCodeAt(c++))>>2,a=(3&t)<<4|(n=e.charCodeAt(c++))>>4,o=(15&n)<<2|(i=e.charCodeAt(c++))>>6,s=63&i,isNaN(n)?o=s=64:isNaN(i)&&(s=64),l=l+u.charAt(r)+u.charAt(a)+u.charAt(o)+u.charAt(s);return l}function I(e){var t,n,i,r,a,o,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");l<e.length;)t=s.indexOf(e.charAt(l++))<<2|(r=s.indexOf(e.charAt(l++)))>>4,n=(15&r)<<4|(a=s.indexOf(e.charAt(l++)))>>2,i=(3&a)<<6|(o=s.indexOf(e.charAt(l++))),u+=String.fromCharCode(t),64!==a&&(u+=String.fromCharCode(n)),64!==o&&(u+=String.fromCharCode(i));return function(e){for(var t="",n=0,i=0,r=0,a=0;n<e.length;)(i=e.charCodeAt(n))<128?(t+=String.fromCharCode(i),n++):i>191&&i<224?(t+=String.fromCharCode((31&i)<<6|63&(a=e.charCodeAt(n+1))),n+=2):(a=e.charCodeAt(n+1),t+=String.fromCharCode((15&i)<<12|(63&a)<<6|63&(r=e.charCodeAt(n+2))),n+=3);return t}(u)}function C(e,t,n){var i="",r=0,a=!1,o=!1,s=0,u=e.length,l="",c="";e:for(s=0;s<u;s++){var g=e.charAt(s);if(!1===a){if("<"===g){a=s;continue}}else if(!1===o){if("<"===g){i+=n(e.slice(r,s)),a=s,r=s;continue}if(">"===g||s===u-1){i+=n(e.slice(r,a)),l=function(e){var t,n=p.spaceIndex(e);return t=-1===n?e.slice(1,-1):e.slice(1,n+1),"/"===(t=p.trim(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}(c=e.slice(a,s+1)),i+=t(a,i.length,l,c,"</"===c.slice(0,2)),r=s+1,a=!1;continue}if('"'===g||"'"===g)for(var d=1,f=e.charAt(s-d);""===f.trim()||"="===f;){if("="===f){o=g;continue e}f=e.charAt(s-++d)}}else if(g===o){o=!1;continue}}return r<u&&(i+=n(e.substr(r))),i}function A(e,t){var n=0,r=0,a=[],o=!1,s=e.length;function u(e,n){if(!((e=(e=p.trim(e)).replace(i,"").toLowerCase()).length<1)){var r=t(e,n||"");r&&a.push(r)}}for(var l=0;l<s;l++){var c=e.charAt(l),g=void 0;if(!1!==o||"="!==c){if(!1===o||l!==r){if(/\s|\n|\t/.test(c)){if(e=e.replace(/\s|\n|\t/g," "),!1===o){if(-1===(g=function(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"="===n?t:-1}return -1}(e,l))){u(p.trim(e.slice(n,l))),o=!1,n=l+1;continue}l=g-1;continue}if(-1===(g=function(e,t){for(;t>0;t--){var n=e[t];if(" "!==n)return"="===n?t:-1}return -1}(e,l-1))){u(o,v(p.trim(e.slice(n,l)))),o=!1,n=l+1;continue}}}else{if(-1===(g=e.indexOf(c,l+1)))break;u(o,p.trim(e.slice(r+1,g))),o=!1,n=(l=g)+1}}else o=e.slice(n,l),n=l+1,r='"'===e.charAt(n)||"'"===e.charAt(n)?n:function(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"'"===n||'"'===n?t:-1}return -1}(e,l+1)}return n<e.length&&(!1===o?u(e.slice(n)):u(o,v(p.trim(e.slice(n))))),p.trim(a.join(" "))}function _(e,t,n){if(n=function(e){return e=function(e){for(var t="",n=0,i=e.length;n<i;n++)t+=32>e.charCodeAt(n)?" ":e.charAt(n);return p.trim(t)}(e=(e=(e=e.replace(s,'"')).replace(o,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))})).replace(u,":").replace(l," "))}(n),"href"===t||"src"===t){if("#"===(n=p.trim(n)))return"#";if("http://"!==n.substr(0,7)&&"https://"!==n.substr(0,8)&&"mailto:"!==n.substr(0,7)&&"tel:"!==n.substr(0,4)&&"data:image/"!==n.substr(0,11)&&"ftp://"!==n.substr(0,6)&&"./"!==n.substr(0,2)&&"../"!==n.substr(0,3)&&"#"!==n[0]&&"/"!==n[0])return""}else if("background"===t){if(c.lastIndex=0,c.test(n))return""}else if("style"===t&&(d.lastIndex=0,d.test(n)||(g.lastIndex=0,g.test(n)&&(c.lastIndex=0,c.test(n)))))return"";return n=function(e){return e=h(e=e.replace(f,"&quot;"))}(n)}var b=function(e){return"string"==typeof e?e.replace(/'/g,'"').replace('=""',"").replace(/\s+/g,"").toLowerCase():""},T=function(){function e(e){var t=function(e){var t={};for(var n in e)t[n]=e[n];return t}(e||{});t.stripIgnoreTag&&(t.onIgnoreTag,t.onIgnoreTag=function(){return""}),t.whiteList={},t.onTag=function(){},t.onTagAttr=function(){},t.onIgnoreTag=function(){},t.onIgnoreTagAttr=function(){},t.safeAttrValue=_,t.escapeHtml=h,this.options=Object.assign(t,e)}return e.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t,n,i,r,a,o,s=this.options,u=s.whiteList,l=s.onTag,c=s.onIgnoreTag,g=s.onTagAttr,d=s.onIgnoreTagAttr,f=s.safeAttrValue,h=s.escapeHtml;s.stripBlankChar&&(e=(t=(t=e.split("")).filter(function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)})).join("")),s.allowCommentTag||(e=function(e){for(var t="",n=0;n<e.length;){var i=e.indexOf("\x3c!--",n);if(-1===i){t+=e.slice(n);break}t+=e.slice(n,i);var r=e.indexOf("--\x3e",i);if(-1===r)break;n=r+3}return t}(e));var m=!1;s.stripIgnoreTagBody&&(n=s.stripIgnoreTagBody,"function"!=typeof(i=c)&&(i=function(){}),r=!Array.isArray(n),a=[],o=!1,c=(m={onIgnoreTag:function(e,t,s){var u;if(u=e,r||-1!==p.indexOf(n,u)){if(s.isClosing){var l="[/removed]",c=s.position+l.length;return a.push([!1!==o?o:s.position,c]),o=!1,l}return o||(o=s.position),"[removed]"}return i(e,t,s)},remove:function(e){var t="",n=0;return p.forEach(a,function(i){t+=e.slice(n,i[0]),n=i[1]}),t+=e.slice(n)}}).onIgnoreTag);var v=C(e,function(e,t,n,i,r){var a={sourcePosition:e,position:t,isClosing:r,isWhite:Object.prototype.hasOwnProperty.call(u,n)},o=l(n,i,a);if(null!=o)return o;if(a.isWhite){if(a.isClosing)return"</".concat(n,">");var s=function(e){var t=p.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var n="/"===(e=p.trim(e.slice(t+1,-1)))[e.length-1];return n&&(e=p.trim(e.slice(0,-1))),{html:e,closing:n}}(i),m=u[n],v=A(s.html,function(e,t){var i=-1!==p.indexOf(m,e),r=g(n,e,t,i);return null==r?i?(t=f(n,e,t,null))?"".concat(e,'="').concat(t,'"'):e:null==(r=d(n,e,t,i))?void 0:r:r});return i="<".concat(n),v&&(i+=" ".concat(v)),s.closing&&(i+=" /"),i+=">"}return null==(o=c(n,i,a))?h(i):o},h);return m&&(v=m.remove(v)),v},e}(),k=Function("\nvar _checkXSS = function (it) {\n  return it && it.Math == Math && it;\n};\nreturn _checkXSS(typeof globalThis === 'object' && globalThis) ||\n_checkXSS(typeof window === 'object' && window) ||\n_checkXSS(typeof self === 'object' && self) ||\n_checkXSS(typeof global === 'object' && global) ||\nFunction('return this')();\n")(),Z=new(function(){function e(){var e=this;this.batchData=[],this.uniqKeys=new Set,this.timeout=2e3,this.lock=!1,this.getSlardarBid=function(){var t,n,i="douyin_web";if(!p.includes(i,"bid"))return i;if(e.config&&e.config.bid)return e.config.bid;if(k&&k._xssBid)return k._xssBid;if(k&&k.slardar&&"function"==typeof k.slardar.config){var r=(k.slardar.config()||{}).bid;if(r)return r}if(k&&k.Slardar&&"function"==typeof k.Slardar.config){var a=(k.Slardar.config()||{}).bid;if(a)return a}return(null===(n=null===(t=null==k?void 0:k.Slardar)||void 0===t?void 0:t._baseParams)||void 0===n?void 0:n.bid)||"argus"},this.getConfigRegion=function(){var t;return p.includes("cn","region")?e.config&&e.config.region?e.config.region:((null===(t=null==k?void 0:k.gfdatav1)||void 0===t?void 0:t.region)||"cn").toLowerCase():"cn"},this.gerReportUrl=function(){var t={cn:I("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boe:I("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),ttp:I("aHR0cHM6Ly9tb24udXMudGlrdG9rdi5jb20vbW9uaXRvcl9icm93c2VyL2NvbGxlY3QvYmF0Y2gvc2VjdXJpdHkvP2JpZD0="),va:I("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),maliva:I("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),sg:I("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boei18n:I("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9")}[e.getConfigRegion()];if(t)return t+e.getSlardarBid()}}return e.prototype.setConfig=function(e){this.config=e},e.prototype.upload=function(){var e=this,t=this.gerReportUrl();!this.lock&&t&&0!==this.batchData.length&&(this.lock=!0,setTimeout(function(){var n=e.batchData.slice(0,100);e.batchData=e.batchData.slice(100),k.fetch(t,{method:"post",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).catch(function(e){}),e.lock=!1,e.upload()},this.timeout))},e.prototype.generateKey=function(e){return e.collectKey?[e.collectMode,e.collectKey].join("___"):""},e.prototype.push=function(e){this.batchData.push(e),this.upload()},e.prototype.report=function(e){var t=this.generateKey(e);if(k.fetch&&e.collectKey){var n="object"==typeof window?window.location.href:"SSR";e.documentUrl=n;var i={age:Math.floor(Date.now()),type:"xss",url:n,body:e,"user-agent":""};"enforce"===e.disposition&&"SSR"!==n||(i.url=t),"SSR"===n&&(i.url="SSR___".concat(i.url),i.body.ssr=!0),this.push(i)}},e}()),S=function(e){for(var t=0,n=function(n){Array.isArray(e[n])?0===e[n].length?delete e[n]:(e[n]=p.from(p.uniq(e[n])),t+=e[n].length):0===p.keys(e[n]).length?delete e[n]:p.keys(e[n]).forEach(function(i){e[n][i]=p.from(p.uniq(e[n][i])),t+=e[n][i].length})},i=0,r=p.keys(e);i<r.length;i++)n(r[i]);return{count:t,ret:e}};function E(e,t){return Z.setConfig(t),new T(t).process(e)}function w(e){var t,n=(t=/\s|\n|\t/.exec(e))?t.index:-1;if(-1===n)return{html:"",closing:"/"===e[e.length-2]};var i="/"===(e=e.slice(n+1,-1).trim())[e.length-1];return i&&(e=e.slice(0,-1).trim()),{html:e,closing:i}}var x=function(e){return -1===(e=(e=(e=(e=e.replace(/&colon;/gi,":")).replace(/&tab;/gi,"")).replace(/&newline;/gi,"")).replace(/(\t|\n|\r)/g,"")).indexOf("&#")?e.trim().toLowerCase():e.trim().replace(/&#(?:(x)([0-9a-f]+)|([0-9]+));?/gi,function(e,t,n,i){return String.fromCharCode(t?parseInt(n,16):parseInt(i))}).replace(/(\t|\n|\r)/g,"").toLowerCase()};function R(e,t){if(void 0===e&&(e=""),"string"!=typeof e)return!0;if(e=x(e),p.includes(e,"base64")&&!function(e){if(""===e||""===e.trim())return!0;try{return!p.includes(e,"data:text/html;base64")}catch(e){return!0}}(e))return t&&t("data:text/html;base64"),!1;var n=["expression(","behavior:","view-source:"];if(p.some(n,function(t){return -1!==e.indexOf(t)}))return p.forEach(n,function(n){-1!==e.indexOf(n)&&t&&t(n)}),!1;var i=["data:application","data:javascript","data:text/html","data:texthtml"];if(p.some(i,function(t){return -1!==e.indexOf(t)}))return p.forEach(i,function(n){-1!==e.indexOf(n)&&t&&t(n)}),!1;if(e.indexOf("javascript:")>0)return t&&t("javascript:"),!1;if(/^javascript:/i.test(e)){var r=e.slice(11).replace(/\s/g,"").trim();return!!p.some(["void","void(0)","void0","false","undefined",";"],function(e){return e===r})||(t&&t("javascript:"),!1)}return!0}var L=function(e,t){var n,i,r="<%= isSaveValidUrl =>";if("string"!=typeof e||(i=Number("<%= urlLimit =>"),void 0!==n&&(i=n),"NaN"!==e.toString()&&-1!==i&&e.length>=i)||R(e,t))return e;try{if(!0===(r=JSON.parse(r))||"true"===r){var a=new URL(e);return a.origin+a.pathname}}catch(e){}return"#"};function V(e,t,i){if(void 0===e&&(e=""),void 0===t&&(t=[]),"string"!=typeof e)return!0;if(!R(e=x(e)))return!1;var r,a={url:(r=e.match(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/)||[])[0],scheme:r[1],slash:r[2],host:r[3],port:r[4],path:r[5],query:r[6],hash:r[7]},o=a.scheme,s=a.host;return i?!!i(e):!(!o||!s)&&(!p.includes(["http","https","file"],o)||("object"==typeof window&&window&&(t=n(n([],t,!0),[location.host],!1)),p.some(t,function(e){return!!(e instanceof RegExp&&e.test(s))||e===s})))}var B={a:["target","title","spellcheck","rel"],canvas:[],abbr:["title"],address:[],area:["shape","coords","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:["dir"],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["alt","title","width","height","decoding"],ins:["datetime"],li:[],mark:[],nav:[],ol:["start"],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],delete:[],form:[],strong:[],mask:["maskunits","x","y","width","height","fill"],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],wbr:[],video:["autoplay","controls","loop","preload","height","width"],svg:["viewBox","version","xmlns","fill","width","height","stroke","stroke-width","style"],path:["d","fill","opacity","stroke","p-id","fill-rule","clip-rule","stroke-width","stroke-linecap","stroke-linejoin","fill-opacity","mask"],rect:["x","y","width","height","fill","stroke","rx"],g:[]},N={collect:null,initCollect:function(){this.collect={whiteList:{},filterProtocol:[]}},removeCollect:function(){var e=S(this.collect),t=e.count,n=e.ret;return this.collect=null,{collectKey:0===t?null:JSON.stringify(n),collectMode:"white"}},onIgnoreTagAttr:function(e,t,i){return e&&p.indexOf(["href","src"],t)>-1?N.domainWhiteList&&Array.isArray(N.domainWhiteList)&&N.domainWhiteList.length>0&&!V(i,n([],N.domainWhiteList,!0))?"":"".concat(t,'="').concat(L(i,function(e){var t;null===(t=N.collect)||void 0===t||t.filterProtocol.push(e)}),'"'):e&&(p.indexOf(["style","class","id"],t)>-1||t.indexOf("data-")>-1)?"".concat(t,'="').concat(i,'"'):(N.collect.whiteList[e]=N.collect.whiteList[e]||[],void N.collect.whiteList[e].push(t))},onIgnoreTag:function(e,t){if("style"===e)return t;C(t,function(e,t,n,i){A(w(i).html.replace("/",""),function(e){N.collect.whiteList[n]=N.collect.whiteList[n]||[],N.collect.whiteList[n].push(e)})},h)},whiteList:B,mergeWhiteList:function(e){for(var t,n={},i=0,r=p.keys(B);i<r.length;i++)n[t=r[i]]=p.from(B[t]);for(var a=0,o=p.keys(e);a<o.length;a++)n[t=o[a]]=t in B?B[t].concat(e[t]):p.from(e[t]);return n},setWhiteList:function(e){for(var t=0,n=p.keys(e);t<n.length;t++){var i=n[t];this.whiteList[i]=i in B?B[i].concat(e[i]):p.from(e[i])}}};try{var P={},G="merge";p.includes(G,"override")&&(N.whiteList=P.whiteList),p.includes(G,"merge")&&N.setWhiteList(P.whiteList)}catch(e){}var O=function(e,t){for(var n={},i=0,r=p.keys(e);i<r.length;i++){var a=r[i];Array.isArray(e[a])?n[a]=p.from(e[a]):n[a]=O({},e[a])}for(var o=0,s=p.keys(t);o<s.length;o++)(a=s[o])in e?Array.isArray(e[a])?n[a]=e[a].concat(t[a]):n[a]=O(e[a],t[a]):Array.isArray(t[a])?n[a]=p.from(t[a]):n[a]=O({},t[a]);return n},D={blackList:{a:["folder"],meta:["content"],iframe:["srcdoc"],input:["pattern"],vmlframe:["xmlns"]},blackTags:["script","xml","embed","isindex","object","base","set","handler","animate","payload","import"],blackAttrs:["charset","ns","namespace","formaction","xlink:href","xmlns:xlink","handler","repeat","repeat-start","repeat-end"],blackAttrRegExps:[/^on/],filterList:{param:["value"],video:["poster"],form:["action"]},filterAttrs:["href","src","background","style","dynsrc","lowsrc","content"]};try{var W={};W.blackAttrRegExps&&(W.blackAttrRegExps=W.blackAttrRegExps.map(function(e){return new RegExp(e.toString().slice(1,e.toString().length-1))}));var U="merge";p.includes(U,"override")&&(D=W),p.includes(U,"merge")&&(D=O(D,W))}catch(e){}var Y={mode:"black",whiteList:{},blackConfig:D,collect:null,initCollect:function(){Y.collect={blackList:{},blackTags:[],blackAttrs:[],blackAttrRegExps:[],filterAttrs:[],filterList:{},filterProtocol:[]}},removeCollect:function(){var e=S(Y.collect),t=e.count,n=e.ret;return Y.collect=null,{collectKey:0===t?null:JSON.stringify(n),collectMode:"black"}},onIgnoreTag:function(e,t){var n;if(!p.includes(D.blackTags,e))return C(t,function(e,t,n,i,r){if(-1!==n.indexOf("/"))return h(i);if(r)return"</".concat(n,">");var a=w(i),o=A(a.html,function(e,t){var i,r=0;if(D.blackList[n]&&p.includes(D.blackList[n],e)&&(Y.collect.blackList[n]=Y.collect.blackList[n]||[],Y.collect.blackList[n].push(e),r++),D.blackAttrRegExps.length&&D.blackAttrRegExps.some(function(t){return t.test(e)})&&p.forEach(D.blackAttrRegExps,function(t){t.test(e)&&(Y.collect.blackAttrRegExps.push("".concat(t.toString(),"->").concat(e)),r++)}),D.blackAttrs.length&&p.includes(D.blackAttrs,e)&&(D.blackAttrs.push(e),r++),!r){if(D.filterList&&D.filterList[n]&&p.includes(D.filterList[n],e)){var a=L(t,function(e){var t;null===(t=Y.collect)||void 0===t||t.filterProtocol.push(e)});return a!==t&&(Y.collect.filterList[n]=Y.collect.filterList[n]||[],Y.collect.filterList[n].push(e)),t?"".concat(e,"='").concat(a,"'"):e}return D.filterAttrs&&p.includes(D.filterAttrs,e)?((a=L(t,function(e){var t;null===(t=Y.collect)||void 0===t||t.filterProtocol.push(e)}))!==t&&(null===(i=Y.collect)||void 0===i||i.filterAttrs.push(e)),t?"".concat(e,"='").concat(a,"'"):e):t?"".concat(e,"='").concat(t,"'"):e}});return i="<".concat(n),o&&(i+=" ".concat(o)),a.closing&&(i+=" /"),i+=">"},h);null===(n=Y.collect)||void 0===n||n.blackTags.push(e)}},F=function(e){var t=e.reportOnly,n=void 0===t||t,i=e.block;return n&&"all"===n?"report":("string"==typeof n&&("true"===n&&(n=!0),"false"===n&&(n=!1)),i?"enforce":n?"report":"enforce")},K=function(e){return function(n,i,r){if(!n||"string"!=typeof n)return n;var a=i;e===E&&(a=N).initCollect();var o=e(n,a);if(b(o)===b(n))return n;if(!r)return o;var s=r.logType,u=F(r),l=a.removeCollect();return Z.report(t(t({type:s,disposition:u},l),{sourceText:y(n),filterText:y(o)})),"enforce"===u?o:n}},H=K(function(e,t){return void 0===t&&(t={}),t&&t.whiteList||(t.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}),new T(t).process(e)}),X=K(E),M=function(e,t,n){var i=[],r=L(e,function(e){i.push(e)});if(r===e)return e;i=p.from(p.uniq(i));var a=t||n||{};if(!a)return r;var o=a.logType,s=F(n);return Z.report({type:o,disposition:s,collectKey:i.join("___"),collectData:JSON.stringify(i),collectMode:"black",sourceText:y(e),filterText:y(r)}),"enforce"===s?r:e},j=k._xssProject||{},J=k.xssNamespace||{},z="3.0.26",Q={FilterXSS:T,version:z,webpackPluginVersion:"<%= webpackPluginVersion =>",reportOnly:"<%= reportOnly =>",filterXSS:H,_filterXSS:X,filterUrl:M,Config:N,BlackConfig:Y,project:j,setProjectName:function(e){j[e]=this,k._xssProjectName=e}};J.douyin_web=Q,k.xssNamespace=J,k.Math&&!k.Math.xssNamespace&&(k.Math.xssNamespace=J),j[z]=Q,k.globalThis=k,k.getFilterXss=function(){return void 0!==this._xssProjectName?this._xssProject[this._xssProjectName]:Q},k.xss=Q,k.isSafeUrl=V,k.isSafeDomain=V,k.isSafeProtocol=R,k._xssProject=j,k._xssProjectName&&(j[k._xssProjectName]=Q);var q=Q.setProjectName.bind(Q);e.BlackConfig=Y,e.Config=N,e.FilterXSS=T,e._filterXSS=X,e.filterUrl=M,e.filterXSS=H,e.isSafeDomain=V,e.isSafeProtocol=R,e.isSafeUrl=V,e.project=j,e.setProjectName=q,e.setXssNamespace=function(e){var t=e.appId,n=e.bid,i=e.region;J[t]=Q;N.bid=n,N.region=i,N.enabled=!0},e.xssNamespace=J,Object.defineProperty(e,"__esModule",{value:!0})});"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["7824"],{323806:function(e,t,n){n.d(t,{Z:function(){return i}});let i="0.12.13"},382800:function(e,t,n){n.d(t,{B:function(){return r}});var i=n(452006),r=(0,i.qH)(function e(t){var n=this;(0,i.PA)(this,e),this.alive=!0,this.timeoutId=null,this.onTick=function(e){var t,i;null===(t=n.cancelPending)||void 0===t||t.call(n),n.alive&&(null===(i=n.onTick_)||void 0===i||i.call(n),null==e||e())},this.onTick_=t},[{key:"tickAfter",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.cancelPending?this.cancelPending():this.cancelPending=function(){t.timeoutId&&(clearTimeout(t.timeoutId),t.timeoutId=null)},this.alive=!0,this.timeoutId=setTimeout(this.onTick,1e3*e,n),this}},{key:"tickEvery",value:function(e){var t=this;this.tickAfter(e,function(){t.tickEvery(e)})}},{key:"stop",value:function(){this.alive=!1,this.cancelPending&&(this.cancelPending(),this.cancelPending=void 0)}}])},22450:function(e,t,n){function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}n.d(t,{$w:function(){return o},Ac:function(){return b},Kd:function(){return v},PA:function(){return s},XW:function(){return f},ZQ:function(){return C},Zj:function(){return m},_x:function(){return g},l5:function(){return y},qH:function(){return l},sf:function(){return c},u:function(){return A},x:function(){return a}});function r(e,t,n,i,r,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(i,r)}function a(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){var o=e.apply(t,n);function s(e){r(o,i,a,s,u,"next",e)}function u(e){r(o,i,a,s,u,"throw",e)}s(void 0)})}}function o(e,t,n){return t=d(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,h()?Reflect.construct(t,n||[],d(e).constructor):t.apply(e,n))}function s(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_(i.key),i)}}function l(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=T(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function g(e,t,n){return(t=_(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}function h(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(h=function(){return!!e})()}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach(function(t){g(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function v(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if(({}).hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function y(){y=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(t,n,i,a){var o=Object.create((n&&n.prototype instanceof m?n:m).prototype);return r(o,"_invoke",{value:function(t,n,i){var r=d;return function(a,o){if(r===f)throw Error("Generator is already running");if(r===h){if("throw"===a)throw o;return{value:e,done:!0}}for(i.method=a,i.arg=o;;){var s=i.delegate;if(s){var u=function t(n,i){var r=i.method,a=n.iterator[r];if(a===e)return i.delegate=null,"throw"===r&&n.iterator.return&&(i.method="return",i.arg=e,t(n,i),"throw"===i.method)||"return"!==r&&(i.method="throw",i.arg=TypeError("The iterator does not provide a '"+r+"' method")),p;var o=g(a,n.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,p;var s=o.arg;return s?s.done?(i[n.resultName]=s.value,i.next=n.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,p):s:(i.method="throw",i.arg=TypeError("iterator result is not an object"),i.delegate=null,p)}(s,i);if(u){if(u===p)continue;return u}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===d)throw r=h,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=f;var l=g(t,n,i);if("normal"===l.type){if(r=i.done?h:"suspendedYield",l.arg===p)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(r=h,i.method="throw",i.arg=l.arg)}}}(t,i,new E(a||[]))}),o}function g(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var d="suspendedStart",f="executing",h="completed",p={};function m(){}function v(){}function I(){}var C={};l(C,o,function(){return this});var A=Object.getPrototypeOf,_=A&&A(A(w([])));_&&_!==n&&i.call(_,o)&&(C=_);var b=I.prototype=m.prototype=Object.create(C);function T(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function k(e,t){var n;r(this,"_invoke",{value:function(r,a){function o(){return new t(function(n,o){!function n(r,a,o,s){var u=g(e[r],e,a);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==typeof c&&i.call(c,"__await")?t.resolve(c.__await).then(function(e){n("next",e,o,s)},function(e){n("throw",e,o,s)}):t.resolve(c).then(function(e){l.value=e,o(l)},function(e){return n("throw",e,o,s)})}s(u.arg)}(r,a,n,o)})}return n=n?n.then(o,o):o()}})}function Z(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(Z,this),this.reset(!0)}function w(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw TypeError(typeof t+" is not iterable")}return v.prototype=I,r(b,"constructor",{value:I,configurable:!0}),r(I,"constructor",{value:v,configurable:!0}),v.displayName=l(I,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,I):(e.__proto__=I,l(e,u,"GeneratorFunction")),e.prototype=Object.create(b),e},t.awrap=function(e){return{__await:e}},T(k.prototype),l(k.prototype,s,function(){return this}),t.AsyncIterator=k,t.async=function(e,n,i,r,a){void 0===a&&(a=Promise);var o=new k(c(e,n,i,r),a);return t.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},T(b),l(b,u,"Generator"),l(b,o,function(){return this}),l(b,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=w,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return s.type="throw",s.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var u=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;S(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:w(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),p}},t}function I(e,t){return(I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,o,s=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=a.call(n)).done)&&(s.push(i.value),s.length!==t);u=!0);}catch(e){l=!0,r=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw r}}return s}}(e,t)||T(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||T(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){if(e){if("string"==typeof e)return i(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}},498871:function(e,t,n){n.r(t),n.d(t,{DashPreloader:function(){return I.Z},default:function(){return Z},encryptUtils:function(){return s}});var i=n("22450");n("836654"),n("910795"),n("464135"),n("891555"),n("429532"),n("98601"),n("110617"),n("927234"),n("250440"),n("742611");var r=n("734123"),a=n("749517"),o=n("810815"),s=n("906579"),u=n("258817"),l=n("546041"),c=n("383640"),g=n("262416"),d=n("1285"),f=n("806394"),h=n("21976"),p=n("585130"),m=n("180893"),v=n("943495"),y=n("212401"),I=n("126609"),C={bufferThreshold:10,defaultFormat:"dash",useEME:null,getLicenseUrl:"",intertrustServerURL:null,defaultDefinition:null,useGapJump:!0,useDurationBackoff:!1,preloadTime:void 0,maxBufferLength:void 0,minBufferLength:10,dynamicPreloadTimeOpts:null,preloadCancelTime:5,progressTimer:1e3,tickInSeconds:void 0,disableCanplayCheck:!0,canplayTimeout:2e3,disableBufferBreakCheck:!0,waitingTimeOut:2e4,definitionText:null,useUnionInfoDRM:!1,keyTokenExpiredDuration:null,keyToken:null,playDomain:null,usePlaySpade:!1,preloadBufferThreshold:.5,vtype:l.l0.DASH,useProgressiveAppend:!1,useProgressiveAppendAll:!1,loader:m.d,logMaxSize:204800,timeout:5e3,reqOptions:{},timerInWorker:!1,resumePlayWaterLevel:0,waitingInBufferTimeOut:5e3,waitJampBufferMaxCnt:3,removeBufferLen:60,removeBufferWhenSeekInBuffer:!0,replayReset:!0,resetStateUpdrade:!1,netNoRetryCode:[403,404],progressiveTimeout:1500,usePCDNProgressiveCheck:!1,useCDNProgressiveCheck:!1,useSeparationMode:!0,loadFirstGopData:!1,useGopCacheAcc:!1,mseOpenTimeout:-1,useInitTimeout:!1,initTimeout:1500,usePlayAbortRetry:!1,useStuckCheck:!1,useStuckWaitBuffer:!1,usePCDNOpt:!1,pcdnDelays:[0,1e3,3e3],useMSENotOpenDegrade:!1,mseNotOpenDegradeCount:2,useWaitingInBufferOptimize:!1},A=n("119106"),_=r.Events.STATS_EVENTS,b={MP4:"mp4",DASH:"dash",VOID:"void"};function T(e){return{playerVersion:{get:function(){return"3.5.34"},configurable:!0},downloadSpeed:{get:function(){return m.Z.currentSpeed/8},configurable:!0},historyAvspeed:{get:function(){return m.Z.historyAvspeed/8},configurable:!0},abrInstance:{get:function(){return e.abrInstance},configurable:!0},menuCodeType:{get:function(){return e.menuCodeType},configurable:!0},playerType:{get:function(){return e.playerType},configurable:!0},supportMenus:{get:function(){return e.supportMenus},configurable:!0},domain:{get:function(){return e.domain},configurable:!0},loadURL:{get:function(){return e.loadURL},configurable:!0},performance:{get:function(){var t=e.stat;return t&&t.performance},configurable:!0},stat:{get:function(){return e.stat},configurable:!0},preLoadData:{get:function(){var t=e.stat;return t&&t.preLoadData?t.preLoadData:{byteLength:0,duration:0}},configurable:!0},ext:{get:function(){var t=Math.max(0,m.Z.historySpeed.length-10),n=m.Z.historySpeed.slice(t,t+10);return(0,i.Zj)((0,i.Zj)({},e.stat),{},{speed:n.map(function(e){return"".concat(e/8)}),vtype:"DASH",format:e._kernalType,performance:void 0,preLoadData:void 0})},configurable:!0},getLogCache:{get:function(){var e=(0,a.jl)();return e.getLogCache&&e.getLogCache()},configurable:!0},pcdnReq:{get:function(){var t;return e._kernalType===b.DASH?null===(t=e._kernal)||void 0===t?void 0:t.pcdnReq:null},configurable:!0},currentDefitionFromPlayer:{get:function(){return e.currentDefitionFromPlayer},configurable:!0},encryptedInfo:{get:function(){var t;return{encryptedType:(null===(t=e._kernal)||void 0===t?void 0:t.encryptedType)||0}},configurable:!0},pcdnVVStat:{get:function(){var t;return e._kernalType===b.DASH?null===(t=e._kernal)||void 0===t?void 0:t.pcdnVVStat():null},configurable:!0},beforeLoadStartCostTime:{get:function(){var t;if(e._kernalType!==b.DASH||!e._kernal)return 0;return null===(t=e._kernal)||void 0===t?void 0:t.beforeLoadStartCostTime},configurable:!0},startTimelines:{get:function(){if(e._startTimelines){var t=u.Z.nowTime();e._startTimelines.startuploadtime=t;var n=e._kernalType===b.DASH?e._startTimelines.reqtime:e._startTimelines.downgradetime;if(e._startTimelines.startdelta=t-n,e._startTimelines.firstframedp=e._hasFirstFramed?1:0,e._startTimelines.playerstate=e.player.state,!e._hasFirstFramed){var i,r,a=e.player.getBufferedRange();e._startTimelines.startbufferlength=a[1]-a[0],null===(r=e.player)||void 0===r||r.emit("xglog_cache")}}var o=null===(i=e.stat)||void 0===i?void 0:i.stage;return JSON.parse(JSON.stringify(Object.assign({},e._startTimelines,o)))},configurable:!0}}}var k=null,Z=function(e){function t(){var e;(0,i.PA)(this,t);for(var n=arguments.length,r=Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=(0,i.$w)(this,t,[].concat(r)),(0,i._x)(e,"_hasUsedBackUrl",!1),(0,i._x)(e,"_onPlayAbort",function(){var t=e.config,n=u.Z.nowTime(),i=!1;e._playTime>-1&&e._pauseTime>-1&&e._playTime<=e._pauseTime&&e._pauseTime<=n&&(i=!0),t.usePlayAbortRetry&&!e._hasPlayAbortRetry&&!i&&(e._hasPlayAbortRetry=!0,e.player.play(),a.ZP.log(t.vid,"playAbortRetry"))}),(0,i._x)(e,"_onPlayStarted",function(){e._startTimelines&&(e._startTimelines.playtime=u.Z.nowTime())}),(0,i._x)(e,"_onLoadStart",function(){-1===e._startTimelines.loadstarttype&&(e._startTimelines.loadstarttime=u.Z.nowTime(),e._startTimelines.loadstarttype=e._kernalType===b.DASH?1:2)}),(0,i._x)(e,"_onLoadData",function(){-1===e._startTimelines.loadeddatatype&&(e._startTimelines.loadeddatatime=u.Z.nowTime(),e._startTimelines.loadeddatatype=e._kernalType===b.DASH?1:2)}),(0,i._x)(e,"_onSourceError",function(t){if(!e._hasFirstFramed){if(!(null!==(n=t.message)&&void 0!==n&&n.includes("PCDN"))){var n,i,r,a,o="".concat(e.player.vtype,"-host:").concat(null==t?void 0:t.host,"-").concat(null==t?void 0:t.errorCode,"-").concat(null!==(i=null==t||null===(r=t.mediaError)||void 0===r?void 0:r.message)&&void 0!==i?i:null==t?void 0:t.message);e.setStartTimelines(l.l1.HTTP_ERROR,{message:o,httpCode:null==t?void 0:t.errorCode}),null===(a=e._startTimelines)||void 0===a||null===(a=a.httpError)||void 0===a||a.push({message:o,httpCode:null==t?void 0:t.errorCode,range:(null==t?void 0:t.range)&&JSON.stringify(null==t?void 0:t.range),mediaType:null==t?void 0:t.mediaType})}}}),(0,i._x)(e,"_onSeeking",function(){var t=e.player;e.waitLevelStartTime=t.currentTime}),(0,i._x)(e,"_onPlaying",function(){a.ZP.log("onPlaying,",JSON.stringify({curtime:e.player.currentTime,buffer:JSON.stringify(null===(i=e.player)||void 0===i||null===(i=i.buffered2)||void 0===i?void 0:i.bufferedList)})),e._waitAdjustTimeCnt>0&&e._waitInBufferTimer&&(e._waitAdjustTimeCnt-=1,a.ZP.log("[waitInBuffer resume play], waitAdjustTimeCnt,",e._waitAdjustTimeCnt)),clearTimeout(e._waitInBufferTimer),e._waitInBufferTimer=null;var t=e.player,n=e.config.resumePlayWaterLevel;if(e._kernalType===b.MP4){e.checkResumePlayTimer>0&&(clearTimeout(e.checkResumePlayTimer),e.checkResumePlayTimer=null,t.isBufferControlPaused&&(t.isBufferControlPaused=!1),t.paused&&t.play());return}if(!(t.duration>0)||!(t.duration-t.currentTime<=n)){if(e.waitLevelStartTime<0&&(e.waitLevelStartTime=t.currentTime),!e.playFlag&&(e.playFlag=!0),n>0&&t.currentTime-e.waitLevelStartTime>=o.Ef){var i,r,s=t.getBufferedRange(t.buffered2);s[1]>0&&s[1]-t.currentTime<n?(!t.paused&&(e.emit(o.of,{type:o.a1.WAITING}),t.pause(null===(r=o.Im)||void 0===r?void 0:r.BUFFER_CONTROLS),t.isBufferControlPaused=!0,a.ZP.log("[!!!!!buffer not rich, pause],currentTime, ",t.currentTime,", bufferEnd,",s[1])),clearTimeout(e.checkResumePlayTimer),e.checkResumePlayTimer=setTimeout(e._onPlaying,n/2*1e3)):t.isBufferControlPaused&&t.paused&&(a.ZP.log("[!!!!!buffer rich, play],, currentTime, ",t.currentTime,", bufferEnd,",s[1]),clearTimeout(e.checkResumePlayTimer),e.checkResumePlayTimer=null,t.isBufferControlPaused=!1,e.emit(o.of,{type:o.a1.PLAYING}),t.play())}}}),(0,i._x)(e,"_onWaiting",function(){var t,n=e.player,i=e.config;clearTimeout(e._waitInBufferTimer),e._waitInBufferTimer=null;var r=n.currentTime,o=e._lastWaitTimestamp;e._lastWaitTimestamp=u.Z.nowTime(),a.ZP.log(i.vid,",[onWaiting],curTime, ",r,",buffer,",JSON.stringify(null==n||null===(t=n.buffered2)||void 0===t?void 0:t.bufferedList),",dur,",n.duration,"adjustTimeCnt",e._waitAdjustTimeCnt);var s=n.bufferedPoint;s.end>0&&s.end-r>=2&&(i.useWaitingInBufferOptimize&&(a.ZP.log(i.vid,"useWaitingInBuffer isseek",n.isSeeking),n.isSeeking?e._waitInBufferTimer=setTimeout(function(){clearTimeout(e._waitInBufferTimer);var t=n.currentTime;t===r&&!n.paused&&(a.ZP.log(i.vid,"useWaitingInBuffer seek, curTime, ",r,", time, ",t),n.currentTime=n.currentTime+.1,n._invalidSeekTag=!0)},500):e._lastWaitTimestamp-o>1e3&&(a.ZP.log(i.vid,"useWaitingInBuffer seek 0.1"),n.currentTime=n.currentTime+.1,n._invalidSeekTag=!0)),e._waitAdjustTimeCnt<i.waitJampBufferMaxCnt&&(e._waitInBufferTimer=setTimeout(function(){e._waitAdjustTimeCnt++,n.currentTime=n.currentTime+.5},i.waitingInBufferTimeOut)))}),e}return(0,i.XW)(t,e),(0,i.qH)(t,[{key:"initDashPlayer",value:function(e){this._checkVideoSwitch(),this._hasTriggerBufferThreshold=!1,this._lastWaitTimestamp=-1,this._setArgsFromConfig(),this.lastBuffer="0,0",this._menuCodeType=null,this._setConfigDashType(),u.Z.promisePolyfill(),(window.location.href.indexOf("playerInstance=true")>-1||g.Xb.getItem("playerInstance"))&&(void 0===window.dashPlayerInstanceList&&(window.dashPlayerInstanceList=[]),window.dashPlayerInstanceList.push(e)),this._startBufferCheck(),this.changeKernal(!1),window.addEventListener("beforeunload",this.cacheSpeed)}},{key:"_checkVideoSwitch",value:function(){var e=this.player,t=this.playerConfig.mediaType;if(this.softVideo="xg-video"===t,!(e.video instanceof HTMLVideoElement)&&!this.softVideo){var n=r.Util.createDom("video","",this.getVideoConfig(this.playerConfig));this.removeVideo=e.video,n.muted=e.video.muted,n.volume=e.video.volume,e.video=n,e.attachVideoEvents(e.video);var i=this.removeVideo.parentNode;i&&i.removeChild(this.removeVideo),this.removeVideo=null}}},{key:"getVideoConfig",value:function(e){var t=Object.assign({},{controls:!1,autoplay:e.autoplay,playsinline:e.playsinline,"x5-playsinline":e.playsinline,"webkit-playsinline":e.playsinline,"x5-video-player-fullscreen":e["x5-video-player-fullscreen"]||e.x5VideoPlayerFullscreen,"x5-video-orientation":e["x5-video-orientation"]||e.x5VideoOrientation,airplay:e.airplay,"webkit-airplay":e.airplay,tabindex:2,mediaType:e.mediaType||"video"},e.videoConfig,e.videoAttributes);return e.loop&&(t.loop="loop"),t}},{key:"bitRateAdapter",get:function(){var e=this.player,t=this.config;return e&&e.plugins?t.needAutoBitrate?e.plugins.bitrateselector:null:null}},{key:"next",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NEXT",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;a.ZP.log("next currentTime: ".concat(e,", nextType: ").concat(t,", autoplay:").concat(i));var u=this.player,l=this.config;this._setStartTimelineData(),this._unbindPlayerProxyAttr(),r.BasePlugin.defineGetterOrSetter(u,T(this)),this._pausedWhenExpiredRestart=!1,"MEDIA_EXPIRED"===t&&u.paused&&(this._pausedWhenExpiredRestart=!0),u.dashState=o.U2;var c=!1;if(!u.isSrcVoid&&(l.dashOpts||l.mp4Opts)&&!u.ended&&"MEDIA_EXPIRED"!==t&&"REPLAY"!==t&&u.duration&&u.currentTime<u.duration-o.Z6&&(u.emit("logger_next",t),c=!0),this._hasTriggerBufferThreshold=!1,u.emit("next",t),u.emit("playertypechange"),n)for(var g in n)l[g]=n[g];u.config.vid&&(l.vid=u.config.vid),l.duration>0&&(l.duration=0),u.config.duration&&(l.duration=u.config.duration),this._setDefinitionConfig(),this._setArgsFromConfig(),c&&this._setConfigDashType(),"NEXT"===t&&u.resetState&&u.resetState(),u.config.startTime=e,u.config.startTimeCache=e,n&&(u.config.DASHPlugin=n);var d=u.config.autoplay;this._pausedWhenExpiredRestart&&d&&(u.config.autoplay=!1,u.once("canplay",function(){setTimeout(function(){u.config.autoplay=d,u.pause()})})),this._syncParameters(),this.changeKernal(!0,!0,s),(i||u.config.autoplay)&&!this._pausedWhenExpiredRestart&&u.once("canplay",function(){if(u.video&&(u.config.autoplay||i)){var e=u.video.play();e&&e.catch(function(){})}}),this._pausedWhenExpiredRestart&&(this._pausedWhenExpiredRestart=!1)}},{key:"_replay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.player;this.config.replayReset?this.next(e,"REPLAY",void 0,!0):(t.currentTime=0,this._kernal&&this._kernal.replay&&this._kernal.replay())}},{key:"_setDefinitionConfig",value:function(){var e=this.player,t=this.config;if(e.config.definition){var n=e.config.definition,i=n.definitionText,r=n.defaultDefinition;i&&(t.definition=i),r&&(t.defaultDefinition=r)}}},{key:"startPlayHandler",value:function(e,t,n){var i=this.config;(i.dashOpts||i.mp4Opts)&&this._setStartTime(n,e,"NEXT"===t||"REPLAY"===t,!0)}},{key:"beforePlayerInit",value:function(){if(!this._hasExecuteBeforeInit)this._hasExecuteBeforeInit=!0}},{key:"afterCreate",value:function(){var e=this;this.steps=[];var t=this.player,n=this.config;t.isReady=!0,this._kernalType===b.DASH&&(t.vtype="DASH"),this._unbindPlayerProxyAttr(),r.BasePlugin.defineGetterOrSetter(t,T(this)),this._syncParameters(),t.config.nullUrlStart=!0,this._setDefinitionConfig(),(0,a.jl)().logMaxSize=n.logMaxSize,this._proxyPlayer(),this.initDashPlayer(t),this._setStartTimelineData(),this.on("xglog",function(n){if("firstFrame"===n.eventType){a.ZP.log("[xgplayer-encrypt]>>>>firstFrame ",e.playerConfig.vid,n.fvt,"stat",t.stat),e._hasFirstFramed=!0,e.setStartTimelineAttr("ffcost",n.fvt);var i,r,o=t.vtype===l.l0.DASH?null===(i=e._startTimelines)||void 0===i?void 0:i.reqtime:null===(r=e._startTimelines)||void 0===r?void 0:r.downgradetime;e.setStartTimelineAttr("fcost",u.Z.nowTime()-o)}}),this._bindEvents(),this.setStartTimelines(l.l1.BEFEORE_START,{message:"after create"})}},{key:"setStartTimelines",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._hasFirstFramed&&this._startTimelines){this._startTimelines.startstage=e,this._startTimelines.startmessage="".concat(l.sm[e]||"","-").concat((null==t?void 0:t.message)||"");var n=this._startTimelines.httpCode;this._startTimelines.httpCode=-1!==n?n:(null==t?void 0:t.httpCode)||-1,e===l.l1.PLAYER_ERROR&&(this._startTimelines.playerError=(null==t?void 0:t.message)||"")}}},{key:"_setStartTimelineData",value:function(){this._startTimelines={startstage:-1,startmessage:"",httpCode:-1,httpError:[],reqtime:-1,downgradetime:-1,fcost:-1,ffcost:-1,startbufferlength:-1,playerError:"",startdelta:-1,loadstarttime:-1,loadeddatatime:-1,loadstarttype:-1,loadeddatatype:-1,playtime:-1,playerstate:-1},this._hasFirstFramed=!1}},{key:"setStartTimelineAttr",value:function(e,t){this._startTimelines&&(this._startTimelines[e]=t)}},{key:"info",value:function(e){var t=this.player;_&&t.emit(_.STATS_INFO,e),e.add&&this.steps.push(e)}},{key:"resetStat",value:function(){var e=this.player;_&&e.emit(_.STATS_RESET)}},{key:"_syncParameters",value:function(){var e,t=this.config,n=this.playerConfig,i=t.vid||n.vid;t.vid=n.vid=i,n.autoBitrateOpts=t.autoBitrateOpts,null===(e=this.player.preloader)||void 0===e||e.addPlayingId(n.vid,this.player.playerId)}},{key:"_proxyPlayer",value:function(){var e=this,t=this.player,n=this.config;this._originStartInit=t._startInit,t.getPreloadInfos=this.getPreloadInfos.bind(this),t.useHooks("replay",function(t){e._replay()}),t.useHooks("play",function(){var n;e._playTime=u.Z.nowTime(),a.ZP.log(null==t||null===(n=t.config)||void 0===n?void 0:n.vid,"play",e._playTime)}),t.useHooks("pause",function(){var n;e._pauseTime=u.Z.nowTime(),a.ZP.log(null==t||null===(n=t.config)||void 0===n?void 0:n.vid,"puase",e._pauseTime)}),"function"==typeof this.player.playNext&&(k=this.player.playNext),this.player.playNext=function(){e.playNext.apply(e,arguments)},"function"==typeof this.player.resetState&&(this._originResetState=this.player.resetState,this.player.resetState=function(){e._originResetState.call(e.player);var i=e.player.isNetError;a.ZP.log("resetState",n.resetStateUpdrade,"isNetError",i),n.resetStateUpdrade&&"dash_mp4_2"===t.vtype&&(i?e._kernal._hasHandleError=!1:(e.config.defaultFormat="dash",t.hasStart=!0,e.changeKernal())),e.player.isNetError=!1})}},{key:"playNext",value:function(){for(var e=this.player,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=n[0],a=n[1],o=n[2],s=n[3];e.setConfig(r),this.next(a,o,r.DASHPlugin,s)}},{key:"_setKernalType",value:function(){var e=this.config,t=this.playerConfig;e.dashOpts||e.mp4Opts?e.dashOpts&&e.mp4Opts?this._kernalType=e.defaultFormat.toLowerCase():e.dashOpts?this._kernalType=b.DASH:this._kernalType=b.MP4:this._kernalType=b.VOID,this.config.useMSENotOpenDegrade&&parseInt((0,A.uS)(o.Hy)||"0")>=this.config.mseNotOpenDegradeCount&&(e.mp4Opts||t.downgradeUrl)&&(a.ZP.log("mse not opendegrade to mp4"),e.defaultFormat="mp4",this._kernalType=b.MP4)}},{key:"changeKernal",value:function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.player;this.destroyKernal(),this._setKernalType();var r=this._kernalType;this._pauseTime=-1,this._playTime=-1,this._hasPlayAbortRetry=!1,r===b.VOID?(i.isSrcVoid=!0,i.emit("playOptsVoid"),this.setStartTimelines(l.l1.BEFEORE_START,{message:"init playOptsVoid"}),t&&i.emit("nextEnded")):(i.isSrcVoid=!1,this._setStartTime("destroy",i.config.startTime,!0,!1),r===b.MP4?(this._kernal=new p.Z(this),i.vtype="dash_mp4"):r===b.DASH&&(this._kernal=new d.Z(this),i.vtype="DASH"),n&&(i.vtype=n),"dash_mp4_2"===i.vtype&&(this._startTimelines.downgradetime=u.Z.nowTime()),this.setStartTimelines(l.l1.BEFEORE_START,{message:"init no start"})),e&&this._kernal&&(this._kernal.start(),t&&this._kernal.executeReady())}},{key:"destroyKernal",value:function(){if(this._kernal){var e;a.ZP.log(null===(e=this.config)||void 0===e?void 0:e.vid,"destroyKernal type ".concat(this._kernalType)),this._kernal.destroy(),this._kernal=null}}},{key:"originStartInit",get:function(){return this._originStartInit}},{key:"_setArgsFromConfig",value:function(){var e=this.config;this._bufferThreshold=e.bufferThreshold,this.playFlag=!1,this.waitLevelStartTime=-1,this._waitAdjustTimeCnt=0}},{key:"setCurrentDefitionInfos",value:function(e,t){var n,r=t?t.fps:void 0;this._currentDefinition={definition:e,fps:r,item:t},!(null!==(n=this.player.abrInstance)&&void 0!==n&&n.isCurrentInAbr)&&(this.player.curDefinition=(0,i.Zj)({},t),this._kernalType===b.DASH&&this._kernal.setAudioDefinition())}},{key:"handleUrlExpire",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.config,r=this.player,a=r.paused,s=new Date().getTime()/1e3>=e.urlExpireTimestamp&&e.urlExpireTimestamp>0;if(s&&(n||!a)&&i.getServerTime)r.serverTimeDiffPromise=r.serverTimeDiffPromise||i.getServerTime().catch(function(){return 0}),r.serverTimeDiffPromise.then(function(n){if(n&&(r.serverTimeDiff=new Date().getTime()/1e3-n),new Date().getTime()/1e3>=e.urlExpireTimestamp+r.serverTimeDiff){e.urlExpireTimestamp=o.Lc;var i=new f.Z(y.wb.NETWORK_FORBIDDEN);t.emitExpireEvent(i)}});else if(s){var u=new f.Z(y.wb.NETWORK_FORBIDDEN);this.emitExpireEvent(u)}}},{key:"emitExpireEvent",value:function(e){var t=this.player,n=new Date().getTime()/1e3;this.emitExpireTimestamp?n-this.emitExpireTimestamp>o.vp&&(this.emitExpireTimestamp=n,t.emit("MEDIA_EXPIRED",e),this.info({msg:"MEDIA_EXPIRED"})):(this.emitExpireTimestamp=n,t.emit("MEDIA_EXPIRED",e),this.info({msg:"MEDIA_EXPIRED"}))}},{key:"_getCurDashType",value:function(){var e=g.Xb.getItem(o.WV),t=o.sp;return e===t.BACK?e:t.MAIN}},{key:"_setCurDashType",value:function(){this._initDashType=this._getCurDashType()}},{key:"_setConfigDashType",value:function(){this._setCurDashType();var e,t=null===(e=this.playerConfig)||void 0===e?void 0:e.vodLogOpts;t&&(t.currentDashType=this._initDashType)}},{key:"setCodeInfo",value:function(e){var t,n=null===(t=this.playerConfig)||void 0===t?void 0:t.vodLogOpts;"h265"===e&&(e="hevc");var i=h.$V[e],r=h.$V[h.d0.AVC],a=r.logCodeType,o=r.codecs;i&&(a=i.logCodeType,o=i.codecs),n&&(n.codec_type=a),this.menuCodeType=o,this.config&&(this.config.codecType=a)}},{key:"cacheSpeed",value:function(){try{var e=m.Z.historyAvspeed;e>0&&e!==1/0&&g.Xb.setItem(o.OU,e)}catch(e){}window.removeEventListener("beforeunload",this.cacheSpeed)}},{key:"unloadVideo",value:function(){var e=this.player;try{e.video&&e.video.src&&(e.video.removeAttribute("src"),e.video.load())}catch(e){}}},{key:"destroy",value:function(){var e;clearInterval(this._bufferCheckTimer),this.cacheSpeed(),this.destroyKernal(),this._unbindPlayerProxyAttr(),this.player.playNext=k,this.player.removeHooks("replay"),null===(e=this.player.preloader)||void 0===e||e.removePlayingId(this.player.playerId),this.off("seeking",this._onSeeking),this.off("waiting",this._onWaiting),this.off("playing",this._onPlaying),this.off("source_error",this._onSourceError),this.off("error",this._onSourceError),this.off(r.Events.LOAD_START,this._onLoadStart),this.off(r.Events.LOADED_DATA,this._onLoadData),this.off(r.Events.AUTOPLAY_STARTED,this._onPlayStarted),this.off("AbortError",this._onPlayAbort),this._originResetState&&(this.player.resetState=this._originResetState)}},{key:"_unbindPlayerProxyAttr",value:function(){var e=T(this),t=this.player;Object.keys(e).forEach(function(e){delete t[e]})}},{key:"_bindEvents",value:function(){this.on("playing",this._onPlaying),this.on("seeking",this._onSeeking),this.on("waiting",this._onWaiting),this.on("source_error",this._onSourceError),this.on("error",this._onSourceError),this.on(r.Events.LOAD_START,this._onLoadStart),this.on(r.Events.LOADED_DATA,this._onLoadData),this.on(r.Events.AUTOPLAY_STARTED,this._onPlayStarted),this.on("AbortError",this._onPlayAbort)}},{key:"getPreloadInfos",value:function(){return null}},{key:"getPreloadStat",value:function(){return{}}},{key:"_onBufferReachThreshold",value:function(){var e=this.player;if(e.video){for(var t=e.video.buffered,n=0,i=0,r=0;r<t.length&&(n=t.start(r),i=t.end(r),!(n<=e.video.currentTime)||!(e.video.currentTime<=i));r++);i-e.video.currentTime>=this._bufferThreshold&&!this._hasTriggerBufferThreshold&&(this._hasTriggerBufferThreshold=!0,e.emit("BUFFER_THRESHOLD",i-e.video.currentTime))}}},{key:"_startBufferCheck",value:function(){var e=this,t=this.player;this._bufferCheckTimer=setInterval(function(){if(!!t.video){var n=[];try{for(var i=0,r=t.video.buffered.length;i<r;i++)n.push([t.video.buffered.start(i),t.video.buffered.end(i)]);n.toString()!==e.lastBuffer&&(e.lastBuffer=n.toString(),e._onBufferReachThreshold())}catch(e){}}},200)}},{key:"_setStartTime",value:function(e,t,n,i){var r=this,a=this.player,o=this.playerConfig,s=this.config;if(t>0||i){var l=!1,c=function(){!l&&(l=!0,a.currentTime=t,o.startTime=0,n&&t>0&&a.emit("setStartTime"),"mp4"===s.defaultFormat&&r.setCodeInfo(h.d0.AVC))};u.Z.once(a,"canplay",c,e),u.Z.once(a,"playing",c,e)}}},{key:"preloadManager",get:function(){return this.player.preloader}},{key:"domain",get:function(){return this._cdnHost?this._cdnHost:null}},{key:"playerType",get:function(){return"dash"===this.config.defaultFormat?"dash":"dash_mp4_2"}},{key:"supportMenus",get:function(){var e="dash"===this.config.defaultFormat;return{speed:e,cdn:e,resolution:e}}},{key:"currentDefitionFromPlayer",get:function(){return this._currentDefinition}},{key:"abrInstance",get:function(){return this._kernal&&this._kernal.abrInstance?this._kernal.abrInstance:null}},{key:"menuCodeType",get:function(){return this._menuCodeType},set:function(e){var t=this.player;this._menuCodeType=e,null==t||t.emit("codecsupdate",e)}},{key:"stat",get:function(){var e=this.player;if(this._kernal&&!e.isSrcVoid){var t=this._kernal.getStat();return t.steps=this.steps.slice(0,Math.max(10,this.steps.length)),this.steps=[],e.video&&e.video.error&&(t.media={readyState:e.video.readyState,error:e.video.error.code,errorMsg:e.video.error.message}),t}return null}},{key:"loadURL",get:function(){return this._loadURL},set:function(e){this._loadURL=e;var t=u.Z.getHostFromUrl(e);this._cdnHost!==t&&(this._cdnHost=t,this.player&&this.player.emit("changeHost",t))}},{key:"onPreChangeDefinition",value:function(e,t){var n=this._kernal instanceof p.Z?t:e;return this._kernal.onPreChangeDefinition(n)}},{key:"isSuspendLoading",get:function(){var e;return(null===(e=this._kernal)||void 0===e?void 0:e.isSuspendLoading)||!1}},{key:"suspendLoading",value:function(){var e,t;null===(e=this._kernal)||void 0===e||null===(t=e.suspendLoading)||void 0===t||t.call(e)}},{key:"resumeLoading",value:function(){var e,t;null===(e=this._kernal)||void 0===e||null===(t=e.resumeLoading)||void 0===t||t.call(e)}}],[{key:"pluginName",get:function(){return"DASHPlugin"}},{key:"defaultConfig",get:function(){return C}},{key:"isEMESupported",value:function(){return(0,s.isEMESupported)()}},{key:"encryptUtils",get:function(){return s}}])}(c.q);Z.updateUnionInfo=v.XGSecretKey.updateUnionInfo,Z.generateEncryptInfo=v.XGSecretKey.generateEncryptInfo,Z.registerPreloader=c.q.registerPreloader},67743:function(e,t,n){n.d(t,{C:function(){return s},Z:function(){return l}});var i=n(35345);n(836654),n(511141),n(891555),n(206642),n(721911),n(429532),n(110617),n(927234),n(914613),n(271692),n(296702),n(828514),n(187562),n(166613),n(801402),n(862956),n(703327),n(573545),n(170399),n(544805),n(463724),n(279651),n(742611),n(874386);var r=n(262416),a=["module"],o="danger_d_speed";function s(e){var t=e.toString(16);if(t.length<=8)return{high:0,low:e};var n=parseInt(t.substr(0,t.length-8),16);return{high:n,low:parseInt(t.substr(t.length-8),16)}}var u={stall_penalty:11,switch_penalty:4,interval:1e3,startInterval:1e3,decodeUnderflowBuffer:1,decodeUnderflowMode:1,decodeUnderflowCount:1},l=(0,i.qH)(function e(t,n,a,o){var s=this,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{logger:function(){},openLog:!1};(0,i.PA)(this,e),this._wasmPromise=new r.XK,this._hasDeviceInfoChanged=!0,this.uuid=new Date().getTime().toString(36).slice(4),this._defaultMaxBitrate=0,this._underflowBitrate=0,this._minBitrate=1/0,this._isCurrentHDR=!1,this.config=t,this.segment_duration=o||5e3,this.logger=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];l.logger.apply(l,["abr(".concat(s.uuid,")::")].concat(t))},this.openLog=l.openLog,this.autoBitrateOpts=Object.assign({},u,t.autoBitrateOpts),this.stall_penalty=this.autoBitrateOpts.stall_penalty,this.switch_penalty=this.autoBitrateOpts.switch_penalty,this.interval=this.autoBitrateOpts.interval;var c=t.progressTimer||1e3,g=this.autoBitrateOpts.startInterval||c;this.initInterval=.8*g,this._preloadMethod=t.preloadmethod||0,this._videoWidth=0,this._videoHeight=0,this._maxDefinition=this.autoBitrateOpts.maxDefinition||null,this._underflowDefinition=this.autoBitrateOpts.underflowDefinition||null,this.updateBitrate(n),this.updateMediaInfos(a,!1)},[{key:"_onLoadWasm",value:function(){var e=this,t=this.autoBitrateOpts.module,n=this.autoBitrateOpts;n.module;var r=(0,i.Kd)(n,a),o=this.autoBitrateOpts.isClassic||!1;return t&&(o?this.module=new t((0,i.Zj)({promise:this._wasmPromise},r)):t(this.module={onRuntimeInitialized:function(){e._wasmPromise.resolve()}})),this._wasmPromise}},{key:"updateMediaInfos",value:function(e){var t=this,n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(this._heightToDefinitionConfig=new Map,this._bitrateToDefinitionConfig=new Map,this._definitionToDefitionConfig=new Map,!e){return}e.dynamic_video_list.forEach(function(e){null===(n=t._heightToDefinitionConfig)||void 0===n||n.set(e.height||e.vheight,e);var n,i,r,a=e.bandwidth||e.bitrate;a<t._minBitrate&&(t._minBitrate=a),null===(i=t._bitrateToDefinitionConfig)||void 0===i||i.set(a,e),e.definition&&(null===(r=t._definitionToDefitionConfig)||void 0===r||r.set(e.definition,e))}),this._maxDefinition&&(this._defaultMaxBitrate=this._getBitrate(this._maxDefinition)),this._underflowDefinition&&(this._underflowBitrate=this._getBitrate(this._underflowDefinition)),this.mediaInfos=e}},{key:"_getBitrate",value:function(e){var t;return(null===(t=this._definitionToDefitionConfig)||void 0===t||null===(t=t.get(e))||void 0===t?void 0:t.bandwidth)||-1}},{key:"transformMediaInfo",value:function(){if(this.setDebugModel(this.openLog),!!this.mediaInfos){this.logger("mediaInfos",this.mediaInfos);try{for(var e,t=[],n=this.mediaInfos.dynamic_video_list,i=0;i<n.length;i++){var r=n[i];if(!!r.isHDR===this._isCurrentHDR)t.push({stream_id:"s".concat(i),bandwidth:r.bitrate||r.bandwidth,width:r.vwidth||r.width,height:r.vheight||r.height,codec:r.codecs||r.codec_type||"h264",frame_rate:Number(r.fps)||-1,segment_duration:this.segment_duration,definition:r.qualityType,gearName:r.gearName})}var a=JSON.stringify({v_adaptation:t});null===(e=this.module)||void 0===e||e.ccall("parseMPD","null",["string"],[a])}catch(e){}}}},{key:"_getDefaultSpeed",value:function(e){var t=0,n=navigator.connection;if(n&&n.downlink)t=1024*n.downlink/8,this.logger("initSpeed connect",t);else try{t=parseFloat(r.Xb.getItem(o)||"")||0,this.logger("initSpeed connect",t)}catch(e){}return 0===t&&(t=e&&e.historyAvspeed||0,this.logger("initSpeed history",t)),t}},{key:"setDebugModel",value:function(e){var t,n;null===(t=this.module)||void 0===t||null===(n=t._setDebugModel)||void 0===n||n.call(t,e)}},{key:"updateBitrate",value:function(e){var t,n,i=this;this.bitrate=e,e>0&&(this.module?null===(t=(n=this.module).updateBitrate)||void 0===t||t.call(n,e):this.readyPromise().then(function(){var t,n;null===(t=i.module)||void 0===t||null===(n=t.updateBitrate)||void 0===n||n.call(t,e)}))}},{key:"getPreloadBitrate",value:function(){return null}},{key:"_updateDeviceInfo",value:function(e){try{if(this._hasDeviceInfoChanged){var t,n=window.devicePixelRatio||1;null===(t=this.module)||void 0===t||t._updateDeviceInfo(this._videoWidth||Number(this.config.width),this._videoHeight||Number(this.config.height),n,e||-1)}this._hasDeviceInfoChanged=!1}catch(e){}}},{key:"readyPromise",value:function(){return this._wasmPromise}}]);l.SPPED_CACHE=o},488598:function(e,t,n){n.d(t,{A:function(){return a},Z:function(){return o}});var i,r=n(858301);var a=((i=a||{})[i.UNKNOWN=0]="UNKNOWN",i[i.USER_SELECT=1]="USER_SELECT",i[i.SR=2]="SR",i[i.BUFFER_INFO_ONLY_ONE_ITEM=3]="BUFFER_INFO_ONLY_ONE_ITEM",i[i.BUFFER_INFO_TARGET_NOT_FOUND=4]="BUFFER_INFO_TARGET_NOT_FOUND",i[i.BUFFER_INFO_FIND_ADAPT_BITRATE=5]="BUFFER_INFO_FIND_ADAPT_BITRATE",i),o=(0,r.qH)(function e(){(0,r.PA)(this,e),this.type=0,this.reason=""})},865353:function(e,t,n){n.d(t,{Z:function(){return r}}),n(110617),n(675373),n(826893),n(927234);var i=n(551663);function r(){try{if(!(null!==i.Z&&void 0!==i.Z&&i.Z.open))return!1;var e=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}},44216:function(e,t,n){n.d(t,{_R:function(){return s},kW:function(){return o},l0:function(){return a}});var i,r=n(622109);var a=((i=a||{}).MP4="MP4",i.MP4_MSE_SOFT="MP4_MSE_SOFT",i.MP4_MSE="MP4_MSE",i.MP4_0="MP4_0",i.MP4_1="MP4_1",i.MP4_2="MP4_2",i.DASH="DASH",i.HLS="HLS",i),o="real_time_speed",s={CDN:"cdn",PCDN:"pcdn"},u=0,l=1,c=2,g=3,d=4,f=5,h=6,p=7,m=8,v=9;(0,r._x)((0,r._x)((0,r._x)((0,r._x)((0,r._x)((0,r._x)((0,r._x)((0,r._x)((0,r._x)((0,r._x)({},u,"before start"),l,"codec not support"),c,"start init destroy"),g,"no preload"),d,"close downgrade"),f,"init promise catch"),h,"player error"),p,"http error"),m,"mse error"),v,"destroy")},754926:function(e,t,n){n.d(t,{Z:function(){return a}}),n(511141),n(110617),n(914613),n(874386),n(882732),n(544943);var i="IWZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO3ZhciBlPXt9LHQ9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtmdW5jdGlvbiBhKHQscyl7ZVt0XT1zZXRUaW1lb3V0KChmdW5jdGlvbigpe3Bvc3RNZXNzYWdlKHtkYXRhOntmYWtlSWQ6dH19KSxhKHQscyl9KSxzKX1wb3N0TWVzc2FnZSh7ZXZlbnQ6InJlYWR5In0pLGFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLChmdW5jdGlvbihzKXt0cnl7dmFyIHI9cy5kYXRhLG89dm9pZCAwPT09cj97fTpyLGM9by5hY3Rpb24sbj1vLmZha2VJZCxpPW8udGltZTtzd2l0Y2goYyl7Y2FzZSJzZXRJbnRlcnZhbCI6YShuLGkpO2JyZWFrO2Nhc2UiY2xlYXJJbnRlcnZhbCI6Y2FzZSJjbGVhclRpbWVvdXQiOnQuY2FsbChlLG4pJiYoY2xlYXJUaW1lb3V0KGVbbl0pLGRlbGV0ZSBlW25dKTticmVhaztjYXNlInNldFRpbWVvdXQiOmVbbl09c2V0VGltZW91dCgoZnVuY3Rpb24oKXtwb3N0TWVzc2FnZSh7ZGF0YTp7ZmFrZUlkOm59fSksdC5jYWxsKGUsbikmJmRlbGV0ZSBlW25dfSksaSl9fWNhdGNoKGQpe3Bvc3RNZXNzYWdlKHtldmVudDoiZXJyb3IiLGRhdGE6e2Vycm9yOmR9fSl9fSkpfSgpOwo=",r="undefined"!=typeof window&&window.Blob&&new Blob([atob(i)],{type:"text/javascript;charset=utf-8"});function a(){var e;try{if(!(e=r&&(window.URL||window.webkitURL).createObjectURL(r)))throw"";return new Worker(e)}catch(e){return new Worker("data:application/javascript;base64,"+i)}finally{!("undefined"!=typeof window&&navigator.userAgent.indexOf("Trident/")>0)&&e&&(window.URL||window.webkitlRL).revokeObjectURL(e)}}},511052:function(e,t,n){n.d(t,{Z:function(){return i}});var i=(0,n(443001).p)("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgdmFyIGRlY29kZXIgPSBudWxsOwoKICB2YXIgZnJhbWVRdWV1ZSA9IFtdOwoKICB2YXIgcmVjZWl2ZUZyYW1lVGltZXIgPSAwOwoKICB2YXIgaGFzUmVjZWl2ZUZyYW1lID0gZmFsc2U7CgogIHNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CiAgICBzd2l0Y2ggKGUuZGF0YS5tc2cpIHsKICAgICAgY2FzZSAnY29uZmlndXJhdGlvbic6CiAgICAgICAgZGVjb2RlciA9IG5ldyBzZWxmLlZpZGVvRGVjb2Rlcih7CiAgICAgICAgICBvdXRwdXQ6IGZ1bmN0aW9uIChmcmFtZSkgewogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZGVjb2RlZCEnLCBkZWNvZGVyLmRlY29kZVF1ZXVlU2l6ZSwgZnJhbWVRdWV1ZS5sZW5ndGgpCgogICAgICAgICAgICBoYXNSZWNlaXZlRnJhbWUgPSB0cnVlOwoKICAgICAgICAgICAgaWYgKHJlY2VpdmVGcmFtZVRpbWVyKSB7CiAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHJlY2VpdmVGcmFtZVRpbWVyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgZiA9IGZyYW1lUXVldWUuc2hpZnQoKTsKICAgICAgICAgICAgaWYgKCFmKSB7CiAgICAgICAgICAgICAgZnJhbWUuY2xvc2UoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgICAgIHR5cGU6ICdERUNPREVEJywKICAgICAgICAgICAgICAgIHdpZHRoOiBmcmFtZS5kaXNwbGF5V2lkdGgsCiAgICAgICAgICAgICAgICBoZWlnaHQ6IGZyYW1lLmRpc3BsYXlIZWlnaHQsCiAgICAgICAgICAgICAgICBpbmZvOiBmLAogICAgICAgICAgICAgICAgYnVmZmVyOiBmcmFtZQogICAgICAgICAgICAgIH0sIFtmcmFtZV0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZGVjb2Rlci5kZWNvZGVRdWV1ZVNpemUgPT09IGZyYW1lUXVldWUubGVuZ3RoKSB7CiAgICAgICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAnQkFUQ0hfRklOSVNIX0ZMQUcnCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ1tXZWJjb2RlY1dvcmtlcl06JywgZSk7CiAgICAgICAgICAgIGlmIChlLm1lc3NhZ2UgPT09ICdDb2RlYyByZWNsYWltZWQgZHVlIHRvIGluYWN0aXZpdHkuJykgcmV0dXJuCiAgICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICAgIHR5cGU6ICdGQUlMRUQnLAogICAgICAgICAgICAgIG1lc3NhZ2U6IGUgJiYgZS5tZXNzYWdlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHNlbGYuVmlkZW9EZWNvZGVyLmlzQ29uZmlnU3VwcG9ydGVkKGUuZGF0YS5kYXRhKQogICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHN0YXR1cykgewogICAgICAgICAgICBpZiAoc3RhdHVzLnN1cHBvcnRlZCkgewogICAgICAgICAgICAgIGRlY29kZXIuY29uZmlndXJlKGUuZGF0YS5kYXRhKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW1dlYmNvZGVjV29ya2VyXTonLCAnaXNDb25maWdTdXBwb3J0ZWQnLCBzdGF0dXMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsgdHlwZTogJ0RFQ09ERVJfUkVBRFknIH0pOwoKICAgICAgICAgICAgLy8g5o6i5rWL6ZW/5pe26Ze05peg6Kej56CB5bin6L6T5Ye6LOmZjee6p+WIsHdhc20KICAgICAgICAgICAgcmVjZWl2ZUZyYW1lVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICBpZiAoaGFzUmVjZWl2ZUZyYW1lKSByZXR1cm4KICAgICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsgdHlwZTogJ0ZBSUxFRCcsIG1lc3NhZ2U6ICdubyBmcmFtZSBvdXRwdXQnIH0pOwogICAgICAgICAgICB9LCAyMDAwKTsKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgICAgdHlwZTogJ0ZBSUxFRCcsCiAgICAgICAgICAgICAgbWVzc2FnZTogZSAmJiBlLm1lc3NhZ2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICBicmVhawogICAgICBjYXNlICdkZWNvZGUnOgogICAgICAgIHZhciBkID0gZS5kYXRhLmRhdGE7CgogICAgICAgIHZhciBzYW1wbGVJbmZvID0gZS5kYXRhLmluZm87CgogICAgICAgIGZyYW1lUXVldWUucHVzaChzYW1wbGVJbmZvKTsKCiAgICAgICAgdmFyIGZyYW1lU2l6ZSA9IGQuYnl0ZUxlbmd0aCAtIDQ7CgogICAgICAgIHZhciBkdiA9IG5ldyBEYXRhVmlldyhuZXcgQXJyYXlCdWZmZXIoNCkpOwoKICAgICAgICBkdi5zZXRVaW50MzIoMCwgZnJhbWVTaXplLCBmYWxzZSk7CgogICAgICAgIGQuc2V0KG5ldyBVaW50OEFycmF5KGR2LmJ1ZmZlciksIDApOwoKICAgICAgICBpZiAoc2FtcGxlSW5mby5rZXlmcmFtZSkgewogICAgICAgICAgZGVjb2Rlci5mbHVzaCgpOwogICAgICAgIH0KCiAgICAgICAgdmFyIGNodW5rID0gbmV3IHNlbGYuRW5jb2RlZFZpZGVvQ2h1bmsoewogICAgICAgICAgdHlwZTogc2FtcGxlSW5mby5rZXlmcmFtZSA/ICdrZXknIDogJ2RlbHRhJywKICAgICAgICAgIHRpbWVzdGFtcDogc2FtcGxlSW5mby5wdHMsCiAgICAgICAgICBkYXRhOiBkCiAgICAgICAgfSk7CiAgICAgICAgZGVjb2Rlci5kZWNvZGUoY2h1bmspOwogICAgICAgIGJyZWFrCiAgICAgIGNhc2UgJ2Rlc3Ryb3knOgogICAgICAgIGlmIChkZWNvZGVyKSB7CiAgICAgICAgICBkZWNvZGVyLmZsdXNoKCk7CiAgICAgICAgICBkZWNvZGVyLmNsb3NlKCk7CiAgICAgICAgfQogICAgICAgIGNsZWFyVGltZW91dChyZWNlaXZlRnJhbWVUaW1lcik7CiAgICAgICAgYnJlYWsKICAgICAgY2FzZSAnY2hlY2tEZWNvZGUnOgogICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ0NIRUNLX1RPX0RFQ09ERScsCiAgICAgICAgICBkYXRhOiBNYXRoLmFicyhkZWNvZGVyLmRlY29kZVF1ZXVlU2l6ZSAtIGZyYW1lUXVldWUubGVuZ3RoKSA9PT0gMAogICAgICAgIH0pOwogICAgICAgIGJyZWFrCiAgICB9CiAgfSk7Cgp9KCkpOwoK",null,!1)},521419:function(e,t,n){n.d(t,{Z:function(){return i}});var i=(0,n(443001).p)("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyogZXNsaW50LWRpc2FibGUgbm8tZXZhbCAqLwogIC8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVmICovCgogIGZ1bmN0aW9uIHNoaW1JbXBvcnRTY3JpcHRzIChzcmMpIHsKICAgIHJldHVybiBmZXRjaChzcmMpCiAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICByZXR1cm4gcmVzLnRleHQoKQogICAgICB9KQogICAgICAudGhlbihmdW5jdGlvbiAodGV4dCkgewogICAgICAgIGV2YWwodGV4dCk7CiAgICAgICAgc2VsZi5Nb2R1bGUgPSBNb2R1bGU7CiAgICAgICAgc2VsZi5hZGRPblBvc3RSdW4gPSBhZGRPblBvc3RSdW47CiAgICAgIH0pCiAgfQoKICB2YXIgTUFYX1NUUkVBTV9CVUZGRVJfTEVOR1RIID0gMTAyNCAqIDEwMjQ7CiAgdmFyIGluaXRUcyA9IDA7CgogIHZhciBEZWNvZGVyID0gZnVuY3Rpb24gKHNlbGYpIHsKICAgIHRoaXMuaW5pdGVkID0gZmFsc2U7CiAgICB0aGlzLnNlbGYgPSBzZWxmOwogICAgdGhpcy5tZXRhID0gc2VsZi5tZXRhOwogICAgdGhpcy5pbmZvbGlzdCA9IFtdOwogICAgc2VsZi5wYXJfYnJvYWR3YXlPbkJyb2Fkd2F5SW5pdGVkID0gdGhpcy5icm9hZHdheU9uQnJvYWR3YXlJbml0ZWQuYmluZCh0aGlzKTsKICAgIHNlbGYucGFyX2Jyb2Fkd2F5T25QaWN0dXJlRGVjb2RlZCA9IHRoaXMuYnJvYWR3YXlPblBpY3R1cmVEZWNvZGVkLmJpbmQodGhpcyk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUudG9VOEFycmF5ID0gZnVuY3Rpb24gKHB0ciwgbGVuZ3RoKSB7CiAgICByZXR1cm4gTW9kdWxlLkhFQVBVOC5zdWJhcnJheShwdHIsIHB0ciArIGxlbmd0aCkKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkgewogICAgTW9kdWxlLl9icm9hZHdheUluaXQoKTsKICAgIHRoaXMuc3RyZWFtQnVmZmVyID0gdGhpcy50b1U4QXJyYXkoCiAgICAgIE1vZHVsZS5fYnJvYWR3YXlDcmVhdGVTdHJlYW0oTUFYX1NUUkVBTV9CVUZGRVJfTEVOR1RILCAwKSwgLy8gMDog5YWz6ZetIGZmbXBlZyBsb2csCiAgICAgIE1BWF9TVFJFQU1fQlVGRkVSX0xFTkdUSAogICAgKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5icm9hZHdheU9uUGljdHVyZURlY29kZWQgPSBmdW5jdGlvbiAoCiAgICBvZmZzZXQsCiAgICB3aWR0aCwKICAgIGhlaWdodCwKICAgIHlMaW5lc2l6ZSwKICAgIHV2TGluZXNpemUsCiAgICBpbmZvaWQsCiAgICBrZXlGcmFtZQogICkgewogICAgbGV0IGZpcnN0RnJhbWUgPSB0aGlzLmluZm9saXN0WzBdOwogICAgaWYgKGZpcnN0RnJhbWUgJiYgZmlyc3RGcmFtZS5rZXlmcmFtZSAmJiAha2V5RnJhbWUpIHJldHVybgoKICAgIGxldCBpbmZvID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5pbmZvbGlzdC5zaGlmdCgpKTsKICAgIGxldCB5Um93Y291bnQgPSBoZWlnaHQ7CiAgICBsZXQgdXZSb3djb3VudCA9IGhlaWdodCAvIDI7CiAgICBpZiAoCiAgICAgIHRoaXMubWV0YSAmJgogICAgICAodGhpcy5tZXRhLmNocm9tYUZvcm1hdCA9PT0gNDQ0IHx8IHRoaXMubWV0YS5jaHJvbWFGb3JtYXQgPT09IDQyMikKICAgICkgewogICAgICB1dlJvd2NvdW50ID0gaGVpZ2h0OwogICAgfQogICAgdmFyIGRhdGEgPSB0aGlzLnRvVThBcnJheShvZmZzZXQsIHlMaW5lc2l6ZSAqIHlSb3djb3VudCArIDIgKiAodXZMaW5lc2l6ZSAqIHV2Um93Y291bnQpKTsKICAgIHZhciBkYXRldGVtcCA9IG5ldyBVaW50OEFycmF5KGRhdGEubGVuZ3RoKTsKICAgIGRhdGV0ZW1wLnNldChkYXRhKTsKICAgIHZhciBidWZmZXIgPSBkYXRldGVtcC5idWZmZXI7CgogICAgdGhpcy5zZWxmLnBvc3RNZXNzYWdlKAogICAgICB7CiAgICAgICAgbXNnOiAnREVDT0RFRCcsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIHlMaW5lc2l6ZSwKICAgICAgICB1dkxpbmVzaXplLAogICAgICAgIGluZm8sCiAgICAgICAgYnVmZmVyCiAgICAgIH0sCiAgICAgIFtidWZmZXJdCiAgICApOwogIH07CgogIERlY29kZXIucHJvdG90eXBlLmJyb2Fkd2F5T25Ccm9hZHdheUluaXRlZCA9IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuaW5pdGVkID0gdHJ1ZTsKICAgIHZhciBjb3N0ID0gMDsKICAgIGlmIChpbml0VHMpIHsKICAgICAgY29zdCA9IHBlcmZvcm1hbmNlLm5vdygpIC0gaW5pdFRzOwogICAgfQogICAgdGhpcy5zZWxmLnBvc3RNZXNzYWdlKHsgbXNnOiAnREVDT0RFUl9SRUFEWScsIGNvc3QgfSk7CiAgfTsKCiAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlID0gZnVuY3Rpb24gKGRhdGEsIGluZm8pIHsKICAgIGlmIChpbmZvKSB7CiAgICAgIHRoaXMuaW5mb2xpc3QucHVzaChpbmZvKTsKICAgIH0KICAgIGlmIChpbmZvICYmIGluZm8ua2V5ZnJhbWUpIHsKICAgICAgdGhpcy5pbmZvbGlzdCA9IFtpbmZvXTsKICAgIH0KICAgIHRoaXMuc3RyZWFtQnVmZmVyLnNldChkYXRhKTsKICAgIE1vZHVsZS5fYnJvYWR3YXlQbGF5U3RyZWFtKGRhdGEubGVuZ3RoLCAwKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkgewogICAgTW9kdWxlLl9icm9hZHdheUV4aXQoKTsKICB9OwoKICBEZWNvZGVyLnByb3RvdHlwZS51cGRhdGVNZXRhID0gZnVuY3Rpb24gKG1ldGEpIHsKICAgIHRoaXMubWV0YSA9IG1ldGE7CiAgfTsKCiAgdmFyIGRlY29kZXI7CgogIGZ1bmN0aW9uIG9uUG9zdFJ1biAoKSB7CiAgICBkZWNvZGVyID0gbmV3IERlY29kZXIodGhpcyk7CiAgICBkZWNvZGVyLmluaXQoKTsKICB9CgogIHZhciBXQVNNX0NETl9QQVRIX1BSRUZJWCA9ICcnOwoKICBmdW5jdGlvbiBpbml0ICh1cmwpIHsKICAgIFdBU01fQ0ROX1BBVEhfUFJFRklYID0gdXJsLnNwbGl0KCcvJykuc2xpY2UoMCwgLTEpLmpvaW4oJy8nKTsKICAgIGluaXRUcyA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgdmFyIGlzRGVncmFkZSA9IC9hc20vLnRlc3QodXJsKTsKICAgIGlmICghZGVjb2RlcikgewogICAgICB2YXIgdGFzazsKICAgICAgaWYgKCFzZWxmLmltcG9ydFNjcmlwdHMpIHsKICAgICAgICB0YXNrID0gc2hpbUltcG9ydFNjcmlwdHModXJsKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0YXNrID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgaWYgKCFzZWxmLmNvbnNvbGUpIHsKICAgICAgICAgICAgc2VsZi5jb25zb2xlID0gewogICAgICAgICAgICAgIGxvZzogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgd2FybjogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgaW5mbzogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHt9CiAgICAgICAgICAgIH07CiAgICAgICAgICB9CiAgICAgICAgICB0cnkgewogICAgICAgICAgICBzZWxmLmltcG9ydFNjcmlwdHModXJsKTsKICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRhc2sKICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoaXNEZWdyYWRlKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhdXRvIGluc3RhbmNlIERlY29kZXIhJyk7CiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICBvblBvc3RSdW4uY2FsbChzZWxmKTsKICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHNlbGYKICAgICAgICAgICAgLm0oewogICAgICAgICAgICAgIGluc3RhbnRpYXRlV2FzbTogZnVuY3Rpb24gKGluZm8sIHJlY2VpdmVJbnN0YW5jZSkgewogICAgICAgICAgICAgICAgZmV0Y2goYCR7V0FTTV9DRE5fUEFUSF9QUkVGSVh9L2RlY29kZXIud2FzbS5qc2ApCiAgICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiByZXMuYXJyYXlCdWZmZXIoKSkKICAgICAgICAgICAgICAgICAgLnRoZW4oYnVmZmVyID0+IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gV2ViQXNzZW1ibHkuaW5zdGFudGlhdGUoYnVmZmVyLCBpbmZvKQogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlY2VpdmVJbnN0YW5jZShyZXN1bHQuaW5zdGFuY2UpCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKE1vZCkgewogICAgICAgICAgICAgIHNlbGYuTW9kdWxlID0gTW9kOwogICAgICAgICAgICAgIG9uUG9zdFJ1bi5jYWxsKHNlbGYpOwogICAgICAgICAgICB9KQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgbXNnOiAnSU5JVF9GQUlMRUQnLAogICAgICAgICAgICBsb2c6IGUubWVzc2FnZQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9CiAgfQoKICBzZWxmLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7CiAgICB2YXIgZGF0YSA9IGUuZGF0YTsKICAgIGlmICgoZGF0YS5tc2cgIT09ICdpbml0JyAmJiBkYXRhLm1zZyAhPT0gJ3ByZWxvYWQnKSAmJiAhZGVjb2RlcikgcmV0dXJuCiAgICBzd2l0Y2ggKGRhdGEubXNnKSB7CiAgICAgIGNhc2UgJ3ByZWxvYWQnOgogICAgICAgIGluaXQoZGF0YS51cmwpOwogICAgICAgIGJyZWFrCiAgICAgIGNhc2UgJ2luaXQnOgogICAgICAgIHNlbGYubWV0YSA9IGRhdGEubWV0YTsKICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgICAgIG1zZzogJ0xPRycsCiAgICAgICAgICBsb2c6ICd3b3JrZXIgaW5pdGVkJwogICAgICAgIH0pOwogICAgICAgIGluaXQoZGF0YS51cmwpOwogICAgICAgIGJyZWFrCiAgICAgIGNhc2UgJ3VwZGF0ZW1ldGEnOgogICAgICAgIHNlbGYubWV0YSA9IGRhdGEubWV0YTsKICAgICAgICBkZWNvZGVyLnVwZGF0ZU1ldGEoZGF0YS5tZXRhKTsKICAgICAgICBicmVhawogICAgICBjYXNlICdpbml0RGVjb2Rlcic6CiAgICAgICAgZGVjb2Rlci5kZWNvZGUoZGF0YS5kYXRhKTsKICAgICAgICBicmVhawogICAgICBjYXNlICdkZWNvZGUnOgogICAgICAgIGRlY29kZXIuZGVjb2RlKGRhdGEuZGF0YSwgZGF0YS5pbmZvKTsKICAgICAgICBicmVhawogICAgICBjYXNlICdmaW5pc2hfZmxhZyc6CiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7CiAgICAgICAgICBtc2c6ICdCQVRDSF9GSU5JU0hfRkxBRycKICAgICAgICB9KTsKICAgICAgICBicmVhawogICAgICBjYXNlICdkZXN0b3J5JzoKICAgICAgICBkZWNvZGVyLmRlc3Ryb3koKTsKICAgICAgICBicmVhawogICAgfQogIH07Cgp9KCkpOwoK",null,!1)},126196:function(e,t,n){n.d(t,{DO:function(){return d},Dd:function(){return f},HQ:function(){return l},J2:function(){return p},Vw:function(){return g},X2:function(){return u},mt:function(){return h},u$:function(){return c}}),n(721911);var i=n(761690),r=0,a=0,o=0,s=!1;function u(){r++}function l(){return r}function c(){a++}function g(){return a}function d(e){try{localStorage.setItem("xgv_dis",e),(2===e||3===e)&&localStorage.setItem("xgv_dist",new Date().getTime())}catch(e){}}function f(){s=!0}function h(){if(!0===(!!s||0!==(0,i.tT)().evaluateVVCount&&(r>=(0,i.tT)().evaluateVVCount&&(o=a/r,r=0,a=0),o>=(0,i.tT)().disabledByLowdecodePrecent&&(s=!0),s)))return!0;try{var e=localStorage.getItem("xgv_dis");if(!e)return!1;if("1"===e)return!0;if("2"===e){var t=localStorage.getItem("xgv_dist")||0;if(t=Number(t),(new Date().getTime()-t)/1e3<(0,i.tT)().disabledDuration)return!0;p()}if("3"===e){var n=localStorage.getItem("xgv_dist")||0;if(n=Number(n),(new Date().getTime()-n)/1e3<(0,i.tT)().longDisabledDuration)return!0;p()}}catch(e){}}function p(){localStorage.removeItem("xgv_dist"),localStorage.removeItem("xgv_dis")}},423829:function(e,t,n){n.d(t,{Z:function(){return T}}),n("223047");var i=n("83915"),r=n("874838"),a=n("758698"),o=n("569395"),s=n("284016"),u=n("812523"),l=n("151176"),c=n("53285"),g=n("344137"),d=n("116774"),f=n.n(d);n("836654"),n("110617"),n("675373"),n("891555"),n("464135"),n("511141"),n("792315"),n("329913"),n("868352"),n("17322"),n("63249"),n("950665"),n("180138"),n("911234"),n("387605"),n("936097"),n("786120"),n("339597"),n("877193"),n("391375"),n("632637"),n("645524"),n("800599"),n("69896"),n("660999"),n("12946"),n("416555"),n("747644"),n("404948"),n("789680"),n("742611");var h=n("675161"),p=n("540931"),m=n("905718"),v=n("73312"),y=n("634418");n("691842");var I=[-5504,-5248,-6016,-5760,-4480,-4224,-4992,-4736,-7552,-7296,-8064,-7808,-6528,-6272,-7040,-6784,-2752,-2624,-3008,-2880,-2240,-2112,-2496,-2368,-3776,-3648,-4032,-3904,-3264,-3136,-3520,-3392,-22016,-20992,-24064,-23040,-17920,-16896,-19968,-18944,-30208,-29184,-32256,-31232,-26112,-25088,-28160,-27136,-11008,-10496,-12032,-11520,-8960,-8448,-9984,-9472,-15104,-14592,-16128,-15616,-13056,-12544,-14080,-13568,-344,-328,-376,-360,-280,-264,-312,-296,-472,-456,-504,-488,-408,-392,-440,-424,-88,-72,-120,-104,-24,-8,-56,-40,-216,-200,-248,-232,-152,-136,-184,-168,-1376,-1312,-1504,-1440,-1120,-1056,-1248,-1184,-1888,-1824,-2016,-1952,-1632,-1568,-1760,-1696,-688,-656,-752,-720,-560,-528,-624,-592,-944,-912,-1008,-976,-816,-784,-880,-848,5504,5248,6016,5760,4480,4224,4992,4736,7552,7296,8064,7808,6528,6272,7040,6784,2752,2624,3008,2880,2240,2112,2496,2368,3776,3648,4032,3904,3264,3136,3520,3392,22016,20992,24064,23040,17920,16896,19968,18944,30208,29184,32256,31232,26112,25088,28160,27136,11008,10496,12032,11520,8960,8448,9984,9472,15104,14592,16128,15616,13056,12544,14080,13568,344,328,376,360,280,264,312,296,472,456,504,488,408,392,440,424,88,72,120,104,24,8,56,40,216,200,248,232,152,136,184,168,1376,1312,1504,1440,1120,1056,1248,1184,1888,1824,2016,1952,1632,1568,1760,1696,688,656,752,720,560,528,624,592,944,912,1008,976,816,784,880,848],C=[-32124,-31100,-30076,-29052,-28028,-27004,-25980,-24956,-23932,-22908,-21884,-20860,-19836,-18812,-17788,-16764,-15996,-15484,-14972,-14460,-13948,-13436,-12924,-12412,-11900,-11388,-10876,-10364,-9852,-9340,-8828,-8316,-7932,-7676,-7420,-7164,-6908,-6652,-6396,-6140,-5884,-5628,-5372,-5116,-4860,-4604,-4348,-4092,-3900,-3772,-3644,-3516,-3388,-3260,-3132,-3004,-2876,-2748,-2620,-2492,-2364,-2236,-2108,-1980,-1884,-1820,-1756,-1692,-1628,-1564,-1500,-1436,-1372,-1308,-1244,-1180,-1116,-1052,-988,-924,-876,-844,-812,-780,-748,-716,-684,-652,-620,-588,-556,-524,-492,-460,-428,-396,-372,-356,-340,-324,-308,-292,-276,-260,-244,-228,-212,-196,-180,-164,-148,-132,-120,-112,-104,-96,-88,-80,-72,-64,-56,-48,-40,-32,-24,-16,-8,0,32124,31100,30076,29052,28028,27004,25980,24956,23932,22908,21884,20860,19836,18812,17788,16764,15996,15484,14972,14460,13948,13436,12924,12412,11900,11388,10876,10364,9852,9340,8828,8316,7932,7676,7420,7164,6908,6652,6396,6140,5884,5628,5372,5116,4860,4604,4348,4092,3900,3772,3644,3516,3388,3260,3132,3004,2876,2748,2620,2492,2364,2236,2108,1980,1884,1820,1756,1692,1628,1564,1500,1436,1372,1308,1244,1180,1116,1052,988,924,876,844,812,780,748,716,684,652,620,588,556,524,492,460,428,396,372,356,340,324,308,292,276,260,244,228,212,196,180,164,148,132,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,0],A=new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]),_={decodeG711:function(e,t){if("g7110a"===t)return function(e){for(var t=new Uint8Array(2*e.length),n=0,i=0;n<e.length;){var r=I[e[n]];if(void 0===r)throw Error("can not decode g711 alaw data!");t[i]=255&r,t[i+1]=r>>8,n+=1,i+=2}return t}(e);if("g7110m"===t)return function(e){for(var t=new Uint8Array(2*e.length),n=0,i=0;n<e.length;){var r=C[e[n]];if(void 0===r)throw Error("can not decode g711 ulaw data!");t[i]=255&r,t[i+1]=r>>8,n+=1,i+=2}return t}(e);throw Error("no supported format=".concat(t," for g711"))},createAudioBufferFromPcm:function(e,t,n,i,r){for(var a=(l=t.byteLength,l/n/r),o=e.createBuffer(n,a,i),s=new DataView(t),u=0;u<n;u++){for(var l,c,g=o.getChannelData(u),d=void 0,f=0;f<a;f++){;d=s.getUint16(2*n*f+2*u,!0),g[f]=(c=d)>=32768?-(65536-c)/32768:c/32767}}return{audioBuffer:o,duration:a/i}},packageAACToAdts:function(e,t){var n,i,r,a,o,s,u,l,c,g=new Uint8Array(t.data.byteLength+7);var d=(n=e,i=t.data,r=n.sampleRateIndex,a=n.channelCount,o=n.config,s=r,r=(u=(7&o[0])<<1|o[1]>>>7)!==s?u:s,(l=new Uint8Array(7))[0]=255,l[1]=240,l[1]=1|l[1],l[2]=64,l[2]=l[2]|60&r<<2,l[2]=l[2]|1&a>>2,l[3]=192&a<<6,c=i.byteLength+7,l[3]=l[3]|3&c>>11,l[4]=255&c>>3,l[5]=224&c<<5,l[5]=31|l[5],l[6]=252,l);return g.set(d),g.set(t.data,7),g},concatAdts:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0,i=0,r=e.length;i<r;i++){if(!t||i%t!=0)n+=e[i].byteLength}for(var a=new Uint8Array(n),o=0,s=0,u=e.length;s<u;s++){if(!t||s%t!=0)a.set(e[s],o),o+=e[s].byteLength}return a},checkRefillFrame:function(e){var t=e[0].dts,n=e.filter(function(e){return e.dts===t}).length;if(!(n<=1))for(var i=0;i<n;i++)e[i].data=A}},b={INIT_AUDIO_ERR:"create new AudioContext error"},T=function(e){(0,u.Z)(C,e);var t,n,d,m,I=(t=C,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=(0,c.Z)(t);return e=n?Reflect.construct(i,arguments,(0,c.Z)(this).constructor):i.apply(this,arguments),(0,l.Z)(this,e)});function C(e,t){var n;return(0,r.Z)(this,C),n=I.call(this,e,t),(0,g.Z)((0,o.Z)(n),"doPause",n._doPause),n.TAG="AudioRender",n._timeRange=new v.Z((0,o.Z)(n)),n._lastTimeLineTime=0,n._sampleQueue=[],n._source=null,n._audioCanAutoplay=!0,n._lastBuffer=null,n._inDecoding=!1,n._endOfStream=!1,n._delay=0,n._isSourceBufferEnd=-1,n._onSourceBufferEnded=n._onSourceBufferEnded.bind((0,o.Z)(n)),n._initAudioCtx(e.volume||.6),n._bindEvents(),n}return(0,a.Z)(C,[{key:"baseDts",get:function(){return this._timeRange._baseDts}},{key:"currentTime",get:function(){return this._audioCtx?this._lastTimeLineTime+this._audioCtx.currentTime:0}},{key:"preloadTime",get:function(){return this.isLive?1:0}},{key:"timescale",get:function(){return 1e3}},{key:"buffered",get:function(){return this._timeRange.buffered}},{key:"ctxState",get:function(){return this._audioCtx.state}},{key:"audioCanAutoplay",get:function(){return this._audioCanAutoplay}},{key:"resume",value:function(){if(this._audioCtx&&"suspended"===this._audioCtx.state)return this._audioCtx.resume().catch(function(e){})}},{key:"canSeek",value:function(e){return this._timeRange.canSeek(e)}},{key:"_assembleErr",value:function(e){var t=Error(e);return t.code=3,t}},{key:"_emitTimelineEvents",value:function(e,t,n){var i,r;null===(i=this._parent)||void 0===i||null===(r=i.emit)||void 0===r||r.call(i,e,t,n)}},{key:"_initAudioCtx",value:function(e){var t=this;h.kg.log(this.TAG,"init audioCtx");var n=window.AudioContext||window.webkitAudioContext;if(this._audioCtx=new n,!this._audioCtx){h.kg.warn(this.TAG,"create webaudio error!"),setTimeout(function(){t._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.ERROR,t._assembleErr(b.INIT_AUDIO_ERR))});return}return this._gainNode=this._audioCtx.createGain(),this._gainNode.gain.value=e,this._gainNode.connect(this._audioCtx.destination),this._audioCanAutoplay="running"===this._audioCtx.state,h.kg.log(this.TAG,"webAudio state:",this._audioCtx.state),(0,y.ds)(),this._bindAudioCtxEvent(),this._audioCtx.suspend()}},{key:"_bindAudioCtxEvent",value:function(){var e=this;this._onStateChange=function(){e._audioCtx&&"running"===e._audioCtx.state&&e._ready&&e._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.PLAYING)},this._audioCtx.addEventListener("statechange",this._onStateChange)}},{key:"_bindEvents",value:function(){var e=this;(0,s.Z)((0,c.Z)(C.prototype),"_bindEvents",this).call(this),this._parent.on(p.ZP.DECODE_EVENTS.CHASE_AUDIO_FRAME,this._doChaseFrame.bind(this)),this._parent.on(p.ZP.TIMELINE.UPDATE_VOLUME,function(t){e._gainNode&&(e._gainNode.gain.value=isFinite(t)?t:1,e._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.VOLUME_CHANGE))}),this._parent.on(p.ZP.TIMELINE.END_OF_STREAM,function(){var t;e._endOfStream=!0,!e.noAudio&&!(null!==(t=e._timeRange)&&void 0!==t&&t.hasBuffer())&&(null==e||e._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.ENDED))})}},{key:"_appendChunk",value:function(e,t){if(!this.noAudio){!this._meta&&(this._meta=t,h.kg.warn(this.TAG,"audio set metadata",this._meta));var n=t.samples;if(n.length){if(this._sampleQueue=this._sampleQueue.concat(n),t.samples=[],"aac"===this._meta.codecType){if(this._inDecoding)return;this._decodeAACWrapper()}else this._decodeG711()}}}},{key:"_resetDts",value:function(e,t){"video"!==t&&this._timeRange.resetDts(e)}},{key:"_doPlay",value:function(){if(!this.noAudio&&!this._parent.seeking){if(!this._source&&this.currentTime){this._startRender();return}this.resume()}}},{key:"_doPause",value:function(){if(!this.noAudio)this._audioCtx.suspend()}},{key:"_reInitAudioCtx",value:function(e){var t=this;if(this._lastTimeLineTime=e,this._lastBuffer=null,this._lastAudioBufferInfo=null,this._delay=0,!(this._ready&&this._audioCtx.currentTime))return Promise.resolve();var n=this._gainNode.gain.value;return this._audioCtx.close().then(function(){return t._audioCtx.removeEventListener("statechange",t._onStateChange),t._audioCtx=null,t._source&&t._source.removeEventListener("ended",t._onSourceBufferEnded),t._source=null,t._initAudioCtx(n)})}},{key:"_doSeek",value:function(e){var t=this;this._reInitAudioCtx(e).then(function(){t._getAudioBuffer(!0)}).catch(function(e){})}},{key:"_doChaseFrame",value:function(e){var t=this,n=e.position,i=this._timeRange.deletePassed(n);i&&(h.kg.log(this.TAG,"_doChaseFrame","startTime:",i.start,"buffeLength:",this.buffered.end(0)-i.start),this._reInitAudioCtx(i.start).then(function(){t._startRender(),t._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.TIMEUPDATE)}).catch(function(e){}))}},{key:"_decodeAACWrapper",value:(d=(0,i.Z)(f().mark(function e(){var t,n,i,r,a,o,s,u,l;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._sampleQueue.length,n=this._sampleQueue[0],!((i=(this._sampleQueue[t-1].dts-n.dts)/this.timescale)<1)){e.next=6;break}return e.abrupt("return");case 6:for(s=0,r=parseInt(i/3-1)||1,a=parseInt(t/r),o=[];s<r;s++)s<r-1?o.push(this._sampleQueue.slice(s*a,(s+1)*a)):o.push(this._sampleQueue.slice(s*a));return this._sampleQueue=[],this._inDecoding=!0,e.prev=12,e.next=15,this._decodeCycle(o);case 15:!this._isLive&&(l=(u=this._timeRange._buffers)[u.length-1])&&this._emitTimelineEvents(p.ZP.TIMELINE.UPDATE_SEGMENT_END,l.end),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(12),this._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.ERROR,this._assembleErr("ERROR_MSG.DECODE_ERR:".concat(e.t0&&e.t0.message)));case 21:this._inDecoding=!1;case 22:case"end":return e.stop()}},e,this,[[12,18]])})),function(){return d.apply(this,arguments)})},{key:"_decodeCycle",value:(m=(0,i.Z)(f().mark(function e(t){var n;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.shift()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this._decodeAAC(n);case 5:return e.next=7,this._decodeCycle(t);case 7:case"end":return e.stop()}},e,this)})),function(e){return m.apply(this,arguments)})},{key:"_decodeAAC",value:function(e){var t=this,n=e[0],i=0;_.checkRefillFrame(e);var r=e.map(function(e){return _.packageAACToAdts(t._meta,e)}),a=_.concatAdts(r,0);return new Promise(function(e,r){var o=t._audioCtx.decodeAudioData(a.buffer,function(r){if(t._timeRange){if(t._lastAudioBufferInfo&&t.isLive){var a=t._lastAudioBufferInfo,o=a.dts+a.duration;(i=n.dts-o)>1&&(t._timeRange._duration+=i/1e3,h.kg.log(t.TAG,"_decodeAAC","audio data dts is not continue, last end dts:",o,",now start Dts:",n.dts,"delay:",i))}t._lastAudioBufferInfo={duration:Math.floor(1e3*r.duration),dts:n.dts};var s=t._timeRange.append(r,r.duration,n.dts,i/1e3);if(!t._ready){var u=.5>Math.abs(s+r.duration-t.currentTime);(t.isLive||!u)&&(t._ready=!0,h.kg.log(t.TAG,"_decodeAAC","set ready true start=",s),t.emit(p.ZP.AUDIO.AUDIO_READY,s))}t._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.PROGRESS),t._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.DURATION_CHANGE),e()}},r);o.catch&&o.catch(r)})}},{key:"_decodeG711",value:function(){var e=this._sampleQueue.length,t=this._sampleQueue[0];if(!((this._sampleQueue[e-1].dts-t.dts)/this.timescale<.5)){var n=new Uint8Array(this._sampleQueue.reduce(function(e,t){return e+=t.data.byteLength},0)),i=0,r=0;this._sampleQueue.forEach(function(e,t){0===t&&(i=e.dts),n.set(e.data,r),r+=e.data.byteLength}),this._sampleQueue=[];try{var a=this._meta,o=a.codecType,s=a.channelCount,u=a.sampleSize,l=a.sampleRate,c=_.decodeG711(n,o),g=_.createAudioBufferFromPcm(this._audioCtx,c.buffer,s,l,u/8),d=g.audioBuffer,f=g.duration,m=this._timeRange.append(d,f,i,0);!this._ready&&(this._ready=!0,h.kg.log(this.TAG,"_decodeG711","set ready true"),this.emit(p.ZP.AUDIO.AUDIO_READY,m)),this._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.PROGRESS),this._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.DURATION_CHANGE)}catch(e){this._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.ERROR,this._assembleErr("ERROR_MSG.DECODE_ERR:".concat(e&&e.message)))}}}},{key:"_onSourceBufferEnded",value:function(){this._isSourceBufferEnd=!0,h.kg.long&&h.kg.log(this.TAG,"source play end! currentTime:".concat(this.currentTime," , duration:").concat(this.duration)),this._startRender()}},{key:"_ajustSeekTime",value:function(e){var t=this._timeRange.getBuffer(e,0);t&&(h.kg.log(this.TAG,"ajust seek time to:",t.start),this._lastTimeLineTime=t.start)}},{key:"_getAudioBuffer",value:function(e){var t=this;if(this._timeRange){var n=this._timeRange.getBuffer(this._lastBuffer?this._lastBuffer.end:this.currentTime,0);if(!n){if((this._endOfStream||!this._isLive)&&this.currentTime-this.duration>-.5){this._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.TIMEUPDATE),this._emitTimelineEvents(p.ZP.TIMELINE.PLAY_EVENT,p.ZP.VIDEO_EVENTS.ENDED);return}this._ready=!1,this._audioCtx.suspend(),this.emit(p.ZP.AUDIO.AUDIO_WAITING),e&&(!this._onAudioReady&&(this._onAudioReady=function(e){t._ajustSeekTime(e)}),this.removeListener(p.ZP.AUDIO.AUDIO_READY,this._onAudioReady),this.once(p.ZP.AUDIO.AUDIO_READY,this._onAudioReady));return}if(e){this._ajustSeekTime(n.start),this.emit(p.ZP.AUDIO.AUDIO_READY);return}return n}}},{key:"_startRender",value:function(e){if(!this.noAudio){if("video"===e&&this.isLive&&this._ready&&!this._isSourceBufferEnd){this._doPlay();return}var t=this._getAudioBuffer();if(t){"suspended"===this._audioCtx.state&&(this._audioCtx.resume().catch(function(e){}),(0,y.fC)()),this._lastBuffer=t,this._source=null;var n=this._audioCtx.createBufferSource();n.buffer=t.source,n.loop=!1,this._source=n,n.addEventListener("ended",this._onSourceBufferEnded),n.connect(this._gainNode),t.delay&&t.delay>.001&&(this._delay+=t.delay),this.startDts=t.startDts;try{this._isSourceBufferEnd=!1,n.start()}catch(e){}t.startDts&&this._emitTimelineEvents(p.ZP.TIMELINE.SYNC_DTS,t.startDts)}}}},{key:"_destroy",value:function(){h.kg.log(this.TAG,"destroy audio..."),this._source&&this._source.removeEventListener("ended",this._onSourceBufferEnded),this._audioCtx&&"closed"!==this.ctxState&&this._audioCtx.close(),this._audioCtx=null,this._sampleQueue=null,this._timeRange=null,this._parent=null,this.removeAllListeners()}}]),C}(m.Z)},905718:function(e,t,n){n.d(t,{Z:function(){return g}}),n(223047);var i=n(874838),r=n(758698),a=n(812523),o=n(151176),s=n(53285),u=n(879146),l=n.n(u),c=n(540931),g=function(e){(0,a.Z)(l,e);var t,n,u=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=(0,s.Z)(t);return e=n?Reflect.construct(i,arguments,(0,s.Z)(this).constructor):i.apply(this,arguments),(0,o.Z)(this,e)});function l(e,t){var n;return(0,i.Z)(this,l),(n=u.call(this))._config=e,n._parent=t,n._meta=null,n._ready=!1,n._isLive=!0,n._innerDegrade=!1,n._singleTrack=-1,n}return(0,r.Z)(l,[{key:"analyse",get:function(){return this._parent.analyse}},{key:"isLive",get:function(){return this._isLive}},{key:"innerDegrade",get:function(){return this._innerDegrade}},{key:"noAudio",get:function(){return 1===this._singleTrack||2===this._singleTrack}},{key:"noVideo",get:function(){return 3===this._singleTrack}},{key:"duration",get:function(){return this._timeRange.duration},set:function(e){this._timeRange&&(this._timeRange.duration=e)}},{key:"_bindEvents",value:function(){var e=this;this._parent.on(c.ZP.TIMELINE.APPEND_CHUNKS,this._appendChunk.bind(this)),this._parent.on(c.ZP.TIMELINE.RESET_BASE_DTS,this._resetDts.bind(this)),this._parent.on(c.ZP.TIMELINE.START_RENDER,this._startRender.bind(this)),this._parent.on(c.ZP.TIMELINE.DO_PLAY,this._doPlay.bind(this)),this._parent.on(c.ZP.TIMELINE.DO_PAUSE,this._doPause.bind(this)),this._parent.on(c.ZP.TIMELINE.DO_SEEK,this._doSeek.bind(this)),this._parent.on(c.ZP.TIMELINE.DESTROY,this._destroy.bind(this)),this._parent.on(c.ZP.TIMELINE.CHASE_FRAME,this._doChaseFrame.bind(this)),this._parent.on(c.ZP.TIMELINE.SINGLE_TRACK,function(t){e._singleTrack=t}),this._parent.on(c.ZP.TIMELINE.SET_PLAY_MODE,function(t){e._isLive="LIVE"===t}),this._parent.on(c.ZP.TIMELINE.INNER_DEGRADE,function(){e._innerDegrade=!0}),this._parent.on(c.ZP.TIMELINE.SET_VIDEO_DURATION,function(t){e.duration=t})}}]),l}(l())},594461:function(e,t,n){n.d(t,{mf:function(){return d}});var i=n(83399),r=n(715146),a=n(854174),o=n(289006),s=n(630669),u=n(300491),l=n(445655),c=n(508745),g=n(879146),d=function(e){(0,i.XW)(g,e);var t,n=(0,i.WY)(g);function g(e){var t;return(0,i.PA)(this,g),t=n.call(this,e),(0,i._x)((0,i.Lc)(t),"type",a.t.FETCH),(0,i._x)((0,i.Lc)(t),"_queue",[]),(0,i._x)((0,i.Lc)(t),"_alive",[]),(0,i._x)((0,i.Lc)(t),"_currentTask",null),(0,i._x)((0,i.Lc)(t),"_finnalUrl",""),(0,i._x)((0,i.Lc)(t),"_config",void 0),t._config=(0,o.i)(e),(t._config.loaderType===a.t.XHR||!r.j.isSupported())&&(t.type=a.t.XHR),t.log=e.logger,t}return(0,i.qH)(g,[{key:"isFetch",value:function(){return this.type===a.t.FETCH}},{key:"load",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"!=typeof e&&e?n=e:n.url=e||n.url||this._config.url,(n=Object.assign({},this._config,n)).params&&(n.params=Object.assign({},n.params)),n.headers&&(0,u.PO)(n.headers)&&(n.headers=Object.assign({},n.headers)),n.body&&(0,u.PO)(n.body)&&(n.body=Object.assign({},n.body)),n.transformRequest&&(n=n.transformRequest(n)||n),n.logger=this.log;var i=new s.i(this.type,n);return i.loader.on(c.K.REAL_TIME_SPEED,function(e){t.emit(c.K.REAL_TIME_SPEED,e)}),this._queue.push(i),1===this._queue.length&&(!this._currentTask||!this._currentTask.running)&&this._processTask(),i.promise}},{key:"cancel",value:(t=(0,i.x)((0,i.l5)().mark(function e(){var t;return(0,i.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._queue.map(function(e){return e.cancel()}).concat(this._alive.map(function(e){return e.cancel()})),this._currentTask&&t.push(this._currentTask.cancel()),this._queue=[],this._alive=[],e.next=6,Promise.all(t);case 6:return e.next=8,(0,l._v)();case 8:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_processTask",value:function(){var e=this;if(this._currentTask=this._queue.shift(),!!this._currentTask){this._currentTask.alive&&this._alive.push(this._currentTask);var t=this._currentTask.exec().catch(function(e){});t&&"function"==typeof t.finally&&t.finally(function(){var t,n;null!==(t=e._currentTask)&&void 0!==t&&t.alive&&(null===(n=e._alive)||void 0===n?void 0:n.length)>0&&(e._alive=e._alive.filter(function(t){return t&&t!==e._currentTask})),e._processTask()})}}}],[{key:"isFetchSupport",value:function(){return r.j.isSupported()}}]),g}(n.n(g)())},444352:function(e,t,n){n.d(t,{mf:function(){return d}});var i=n(670537),r=n(137037),a=n(145594),o=n(785289),s=n(421808),u=n(715443),l=n(509370),c=n(913898),g=n(879146),d=function(e){(0,i.XW)(g,e);var t,n=(0,i.WY)(g);function g(e){var t;return(0,i.PA)(this,g),t=n.call(this,e),(0,i._x)((0,i.Lc)(t),"type",a.t.FETCH),(0,i._x)((0,i.Lc)(t),"_queue",[]),(0,i._x)((0,i.Lc)(t),"_alive",[]),(0,i._x)((0,i.Lc)(t),"_currentTask",null),(0,i._x)((0,i.Lc)(t),"_finnalUrl",""),(0,i._x)((0,i.Lc)(t),"_config",void 0),t._config=(0,o.i)(e),(t._config.loaderType===a.t.XHR||!r.j.isSupported())&&(t.type=a.t.XHR),t.log=e.logger,t}return(0,i.qH)(g,[{key:"isFetch",value:function(){return this.type===a.t.FETCH}},{key:"load",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"!=typeof e&&e?n=e:n.url=e||n.url||this._config.url,(n=Object.assign({},this._config,n)).params&&(n.params=Object.assign({},n.params)),n.headers&&(0,u.PO)(n.headers)&&(n.headers=Object.assign({},n.headers)),n.body&&(0,u.PO)(n.body)&&(n.body=Object.assign({},n.body)),n.transformRequest&&(n=n.transformRequest(n)||n),n.logger=this.log;var i=new s.i(this.type,n);return i.loader.on(c.K.REAL_TIME_SPEED,function(e){t.emit(c.K.REAL_TIME_SPEED,e)}),this._queue.push(i),1===this._queue.length&&(!this._currentTask||!this._currentTask.running)&&this._processTask(),i.promise}},{key:"cancel",value:(t=(0,i.x)((0,i.l5)().mark(function e(){var t;return(0,i.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._queue.map(function(e){return e.cancel()}).concat(this._alive.map(function(e){return e.cancel()})),this._currentTask&&t.push(this._currentTask.cancel()),this._queue=[],this._alive=[],e.next=6,Promise.all(t);case 6:return e.next=8,(0,l._v)();case 8:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_processTask",value:function(){var e=this;if(this._currentTask=this._queue.shift(),!!this._currentTask){this._currentTask.alive&&this._alive.push(this._currentTask);var t=this._currentTask.exec().catch(function(e){});t&&"function"==typeof t.finally&&t.finally(function(){var t,n;null!==(t=e._currentTask)&&void 0!==t&&t.alive&&(null===(n=e._alive)||void 0===n?void 0:n.length)>0&&(e._alive=e._alive.filter(function(t){return t&&t!==e._currentTask})),e._processTask()})}}}],[{key:"isFetchSupport",value:function(){return r.j.isSupported()}}]),g}(n.n(g)())},34133:function(e,t,n){n.d(t,{j:function(){return i}});var i="undefined"!=typeof window},773542:function(e,t,n){n.d(t,{G7:function(){return o},Gu:function(){return r},pl:function(){return u},rO:function(){return s}});var i=n(999486);function r(e){if(!!e&&null!==e[0]&&void 0!==e[0]&&(0!==e[0]||null!==e[1]&&void 0!==e[1])){var t="bytes="+e[0]+"-";return e[1]&&(t+=e[1]),t}}function a(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function o(e,t){if(e){if(!t)return e;var n,r=Object.keys(t).map(function(e){if(null!=(n=t[e]))return Array.isArray(n)?e+="[]":n=[n],n.map(function(t){return(0,i.J_)(t)?t=t.toISOString():(0,i.Kn)(t)&&(t=JSON.stringify(t)),"".concat(a(e),"=").concat(a(t))}).join("&")}).filter(Boolean).join("&");if(r){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}}function s(e,t,n,i,r,a,o,s,u,l,c){return r=null!=r?parseFloat(r):null,Number.isNaN(i=parseInt(i||"0",10))&&(i=0),{data:e,done:t,options:{range:u,vid:l,index:s,contentLength:i,age:r,startTime:a,firstByteTime:o,endTime:Date.now(),priOptions:c},response:n}}function u(e,t){return Math.round(8e3*e/t/1024)}},231211:function(e,t,n){n.d(t,{W:function(){return a}});var i=n(306492),r=n(301468),a=function(){function e(){(0,i.PA)(this,e)}return(0,i.qH)(e,null,[{key:"getRateIndexByRate",value:function(t){return e.FREQ.indexOf(t)}},{key:"parseADTS",value:function(t,n){for(var i,r,a=t.length,o=0;o+2<a&&(255!==t[o]||(246&t[o+1])!=240);){;o++}if(!(o>=a)){var s=o,u=[],l=(60&t[o+2])>>>2,c=e.FREQ[l];if(!c)throw Error("Invalid sampling index: ".concat(l));for(var g=((192&t[o+2])>>>6)+1,d=(1&t[o+2])<<2|(192&t[o+3])>>>6,f=e._getConfig(l,d,g),h=f.config,p=f.codec,m=0,v=e.getFrameDuration(c);o+7<a;){if(255!==t[o]||(246&t[o+1])!=240){o++;continue}if(r=(3&t[o+3])<<11|t[o+4]<<3|(224&t[o+5])>>5,a-o<r)break;i=(1&~t[o+1])*2,u.push({pts:n+m*v,data:t.subarray(o+7+i,o+r)}),m++,o+=r}return{skip:s,remaining:o>=a?void 0:t.subarray(o),frames:u,samplingFrequencyIndex:l,sampleRate:c,objectType:g,channelCount:d,codec:p,config:h,originCodec:"mp4a.40.".concat(g)}}}},{key:"parseAudioSpecificConfig",value:function(t){if(!!t.length){var n=t[0]>>>3,i=(7&t[0])<<1|t[1]>>>7,r=(120&t[1])>>>3,a=e.FREQ[i];if(a){var o=e._getConfig(i,r,n),s=o.config;return{samplingFrequencyIndex:i,sampleRate:a,objectType:n,channelCount:r,config:s,codec:o.codec,originCodec:"mp4a.40.".concat(n)}}}}},{key:"getFrameDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return 1024*t/e}},{key:"_getConfig",value:function(e,t,n){var i,a,o=[];return r.vU?e>=6?(i=5,a=e-3):(i=2,a=e):r.Dt?(i=2,a=e):(i=2===n||5===n?n:5,a=e,e>=6?a=e-3:1===t&&(i=2,a=e)),o[0]=i<<3,o[0]|=(14&e)>>1,o[1]=(1&e)<<7,o[1]|=t<<3,5===i&&(o[1]|=(14&a)>>1,o[2]=(1&a)<<7,o[2]|=8,o[3]=0),{config:o,codec:"mp4a.40.".concat(i)}}},{key:"getSilentFrame",value:function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t||3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}]),e}();(0,i._x)(a,"FREQ",[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350])},259296:function(e,t,n){n.d(t,{_:function(){return h}});var i=n(758772),r=n(535868),a=n(442718),o=n(282850),s=n(2619),u=n(765968),l=n(376882),c=n(299917),g=n(40201),d=n(303769),f=["stts","stsc","stsz","stco","co64","stss","ctts"],h=function(){function e(t,n,o,s){var l,c,d=this;if((0,i.PA)(this,e),(0,i._x)(this,"_videoSamples",[]),(0,i._x)(this,"_audioSamples",[]),(0,i._x)(this,"_lastRemainBuffer",[]),(0,i._x)(this,"_lastRemainBufferStartPos",0),(0,i._x)(this,"videoMaxFrameIdx",-1),(0,i._x)(this,"audioMaxFrameIdx",-1),this.videoTrack=new r.q,this.audioTrack=new a.W,this.metadataTrack=o||new u.m$,this.videoSegmnents=t,this.audioSegmnents=n,this.log=new g.Y("MP4Demuxer",!s||!s.openLog||!s.openLog),this.memoryOpt=null==s?void 0:s.memoryOpt,!this.memoryOpt&&(t&&t.forEach(function(e){var t;(t=d._videoSamples).push.apply(t,(0,i.u)(e.frames))}),n&&n.forEach(function(e){var t;(t=d._audioSamples).push.apply(t,(0,i.u)(e.frames))})),(null===(l=this.videoSegmnents)||void 0===l?void 0:l.length)>0){var f=this.videoSegmnents[this.videoSegmnents.length-1].frames;this.videoMaxFrameIdx=f[f.length-1].index}if((null===(c=this.audioSegmnents)||void 0===c?void 0:c.length)>0){var h=this.audioSegmnents[this.audioSegmnents.length-1].frames;this.audioMaxFrameIdx=h[h.length-1].index}}return(0,i.qH)(e,[{key:"parseSamples",value:function(e){if(!e)throw Error("moov is required");!this.videoTrack.codec&&!this.audioTrack.codec&&(c.I.moovToTrack(e,this.videoTrack,this.audioTrack),this.videoSenc=this.videoTrack.videoSenc,this.audioSenc=this.audioTrack.audioSenc,this.memoryOpt&&this.clearBoxEntries(e))}},{key:"demux",value:function(e,t,n,i,r){this.parseSamples(r);var a=this.videoTrack,u=this.audioTrack;a.samples=[],u.samples=[];var c={};if(n){var g,d,f,h,p=0;if(this.memoryOpt&&this.videoSegmnents&&!(c=this.getFramePosByIdx("video",n[0])))throw Error("cannot found video frame #".concat(n[0]));for(var m=c,v=m.frameIdx,y=m.segmentIdx,I=n[0],C=n[1];I<=C;I++){if(!this._videoSamples.length&&this.videoSegmnents){var A=this.getFrameInfo("video",y,v);g=A.sample,y=A.segmentIdx,v=A.frameIdx}else g=this._videoSamples[I];if(!g)throw Error("cannot found video frame #".concat(I));f=g.offset-t,d=e.subarray(f,f+g.size),(h=new o._("number"==typeof g.pts?g.pts:g.dts,g.dts)).duration=g.duration,h.gopId=g.gopId,g.keyframe&&h.setToKeyframe();for(var _=0,b=d.length-1;_<b;)p=(0,l.Bh)(d,_),_+=4,h.units.push(d.subarray(_,_+p)),_+=p;a.samples.push(h)}a.baseMediaDecodeTime=a.samples[0].dts}if(c={},i){if(this.memoryOpt&&this.audioSegmnents&&!(c=this.getFramePosByIdx("audio",i[0])))throw Error("cannot found video frame #".concat(i[0]));for(var T=c,k=T.frameIdx,Z=T.segmentIdx,S=i[0],E=i[1];S<=E;S++){if(!this._audioSamples.length&&this.audioSegmnents){var w=this.getFrameInfo("audio",Z,k);g=w.sample,Z=w.segmentIdx,k=w.frameIdx}else g=this._audioSamples[S];if(!g)throw Error("cannot found video frame #".concat(S));f=g.offset-t,d=e.subarray(f,f+g.size),u.samples.push(new s.X(g.dts,d,g.duration))}u.baseMediaDecodeTime=u.samples[0].dts}return{videoTrack:a,audioTrack:u,metadataTrack:this.metadataTrack}}},{key:"demuxPart",value:function(e,t,n,i,r,a,u,c){if(this.parseSamples(r),this.videoTrack.useEME=a,this.audioTrack.useEME=a,this._lastRemainBuffer&&this._lastRemainBuffer.byteLength>0&&t>this._lastRemainBufferStartPos&&t<=this._lastRemainBufferStartPos+this._lastRemainBuffer.byteLength){for(var g=0;g<20;)try{var d=this._lastRemainBuffer.subarray(0,t-this._lastRemainBufferStartPos),f=new Uint8Array(e.byteLength+d.byteLength);f.set(d,0),f.set(new Uint8Array(e),d.byteLength),e=f,t-=d.byteLength,this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0;break}catch(e){if(g<20)g++;else throw Error("new Uint8Array error:,"+e.errorMessage)}}var h=this.videoTrack,p=this.audioTrack;h.samples=[],p.samples=[],h.videoSenc=null,p.audioSenc=null,(null==n?void 0:n[1])>this.videoMaxFrameIdx&&this.videoMaxFrameIdx>0&&(n[1]=this.videoMaxFrameIdx),(null==i?void 0:i[1])>this.audioMaxFrameIdx&&this.audioMaxFrameIdx>0&&(i[1]=this.audioMaxFrameIdx);var m=0,v=0,y={},I=e.byteLength+t;if((null==n?void 0:n.length)>0){if(this.memoryOpt&&this.videoSegmnents&&!(y=this.getFramePosByIdx("video",n[0])))throw Error("cannot found video frame #".concat(n[0]));for(var C,A,_,b,T=y,k=T.frameIdx,Z=T.segmentIdx,S=n[0];S<=n[1];S++){if(!this._videoSamples.length&&this.videoSegmnents){var E=this.getFrameInfo("video",Z,k);C=E.sample,Z=E.segmentIdx,k=E.frameIdx}else C=this._videoSamples[S];if(!C)throw Error("cannot found video frame #".concat(S));if(this.memoryOpt&&C.offset+C.size>I)break;C.offset>=t&&C.offset+C.size<=I&&(m=(_=C.offset-t)+C.size,A=e.subarray(_,m),(b=new o._("number"==typeof C.pts?C.pts:C.dts,C.dts)).duration=C.duration,b.gopId=C.gopId,b.sampleOffset=C.index,C.keyframe&&b.setToKeyframe(),b.data=A,b.size=C.size,h.samples.push(b))}h.samples.length>0&&(h.gopId=h.samples[0].gopId,h.baseMediaDecodeTime=h.samples[0].dts,h.startPts=h.samples[0].pts/h.timescale,h.endPts=h.samples[h.samples.length-1].pts/h.timescale,h.startDts=h.samples[0].dts/h.timescale,h.endDts=h.samples[h.samples.length-1].dts/h.timescale,this.videoSenc&&(h.videoSenc=this.videoSenc.slice(h.samples[0].sampleOffset,h.samples[0].sampleOffset+h.samples.length),h.kidValue=u))}if((null==i?void 0:i.length)>0){if(this.memoryOpt&&this.audioSegmnents&&!(y=this.getFramePosByIdx("audio",i[0])))throw Error("cannot found video frame #".concat(i[0]));for(var w=y,x=w.frameIdx,R=w.segmentIdx,L=i[0];L<=i[1];L++){if(!this._audioSamples.length&&this.audioSegmnents){var V=this.getFrameInfo("audio",R,x);C=V.sample,R=V.segmentIdx,x=V.frameIdx}else C=this._audioSamples[L];if(!C)throw Error("cannot found video frame #".concat(L));if(this.memoryOpt&&C.offset+C.size>I)break;C.offset>=t&&C.offset+C.size<=I&&(v=(_=C.offset-t)+C.size,A=e.subarray(_,v),p.samples.push(new s.X(C.dts,A,C.duration,C.index)))}p.samples.length>0&&(p.gopId=p.samples[0].gopId||h.gopId,p.baseMediaDecodeTime=p.samples[0].dts,p.startPts=p.samples[0].pts/p.timescale,p.endPts=p.samples[p.samples.length-1].pts/p.timescale,this.audioSenc&&(p.audioSenc=this.audioSenc.slice(p.samples[0].sampleOffset,p.samples[0].sampleOffset+p.samples.length),p.kidValue=u))}this.decoderData(h,p,c);for(var B=0,N=0;N<h.samples.length;N++){for(var P=0,G=h.samples[N].data,O=G.length-1;P<O;)B=(0,l.Bh)(G,P),P+=4,h.samples[N].units.push(G.subarray(P,P+B)),P+=B}var D=Math.max(m,v);return this._lastRemainBuffer=e.subarray(D),this._lastRemainBuffer.byteLength>0?this._lastRemainBufferStartPos=t+e.byteLength-this._lastRemainBuffer.byteLength:this._lastRemainBufferStartPos=0,{videoTrack:h,audioTrack:p,metadataTrack:this.metadataTrack,lastRemainBufferInfo:{data:this._lastRemainBuffer,pos:this._lastRemainBufferStartPos}}}},{key:"setLastRemainBufferInfo",value:function(e,t){this._lastRemainBuffer=e,this._lastRemainBufferStartPos=t}},{key:"reset",value:function(){this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0,this.videoTrack.reset(),this.audioTrack.reset(),this.metadataTrack.reset()}},{key:"decoderData",value:function(e,t,n){!e.useEME&&!t.useEME&&d.Z.decoderAESCTRData(e,t,n)}},{key:"getFramePosByIdx",value:function(e,t){var n,i,r,a="video"===e?this.videoSegmnents:this.audioSegmnents;if(!a||!(null!=a&&a.length))return null;for(var o=0,s=0;s<a.length;s++)if(n=a[s].frames,t<=(null===(i=a[s].frames)||void 0===i?void 0:i[(null===(r=n)||void 0===r?void 0:r.length)-1].index)){o=s;break}return{frameIdx:n.findIndex(function(e){return e.index===t}),segmentIdx:o}}},{key:"getFrameInfo",value:function(e,t,n){var i,r,a,o,s="video"===e?this.videoSegmnents:this.audioSegmnents;return s?n<(null===(i=s[t])||void 0===i?void 0:null===(r=i.frames)||void 0===r?void 0:r.length)?{sample:null===(a=s[t])||void 0===a?void 0:a.frames[n],segmentIdx:t,frameIdx:n+1}:{sample:null===(o=s[t+1])||void 0===o?void 0:o.frames[0],segmentIdx:t+1,frameIdx:1}:{}}},{key:"clearBoxEntries",value:function(e){this.memoryOpt&&e.trak.forEach(function(e){f.forEach(function(t){var n=e.mdia.minf.stbl[t];n&&(n.entries&&(n.entries=null),n.entrySizes&&(n.entrySizes=null))})})}}],[{key:"probe",value:function(e){return c.I.probe(e)}}]),e}()},746511:function(e,t,n){n.d(t,{b:function(){return u}});var i=n(758772),r=n(693012),a=n(376882),o=n(476268),s=4294967295,u=function(){function e(){(0,i.PA)(this,e)}return(0,i.qH)(e,null,[{key:"box",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=8+(n=n.filter(Boolean)).reduce(function(e,t){return e+t.byteLength},0),a=new Uint8Array(r);a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=255&r,a.set(e,4);var o=8;return n.forEach(function(e){a.set(e,o),o+=e.byteLength}),a}},{key:"FullBox",value:function(t,n,i){for(var r=arguments.length,a=Array(r>3?r-3:0),o=3;o<r;o++)a[o-3]=arguments[o];return e.box.apply(e,[t,new Uint8Array([n,i>>16&255,i>>8&255,255&i])].concat(a))}},{key:"ftyp",value:function(t){return t.find(function(e){return e.type===r.Vc.VIDEO&&e.codecType===r._e.HEVC})?e.FTYPHEV1:e.FTYPAVC1}},{key:"initSegment",value:function(t){var n=e.ftyp(t);return(0,a.gJ)(n,e.moov(t))}},{key:"pssh",value:function(t){var n=new Uint8Array([1,0,0,0].concat([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75],[0,0,0,1],(0,a.Qc)(t.kid),[0,0,0,0]));return e.box(e.types.pssh,n)}},{key:"moov",value:function(t){if(!t[0].useEME||!t[0].encv&&!t[0].enca)return e.box.apply(e,[e.types.moov,e.mvhd(t[0].mvhdDurtion||t[0].duration,t[0].mvhdTimecale||t[0].timescale)].concat((0,i.u)(t.map(function(t){return e.trak(t)})),[e.mvex(t)]));!t[0].pssh&&(t[0].pssh={kid:t[0].kid});var n=this.pssh(t[0].pssh);return e.box.apply(e,[e.types.moov,e.mvhd(t[0].mvhdDurtion||t[0].duration,t[0].mvhdTimecale||t[0].timescale),e.mvex(t)].concat((0,i.u)(t.map(function(t){return e.trak(t)})),[n]))}},{key:"mvhd",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,255&n,t>>24&255,t>>16&255,t>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))}},{key:"trak",value:function(t){return e.box(e.types.trak,e.tkhd(t.id,t.tkhdDuration||0,t.width,t.height),e.mdia(t))}},{key:"tkhd",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,r>>8&255,255&r,0,0]))}},{key:"edts",value:function(t){return e.box(e.types.edts,e.elst(t))}},{key:"elst",value:function(t){t.entries;var n=t.entriesData,i=t.version;return e.FullBox(e.types.elst,i,0,n)}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.duration,t.timescale),e.hdlr(t.type),e.minf(t))}},{key:"mdhd",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,255&n,t>>24&255,t>>16&255,t>>8&255,255&t,85,196,0,0]))}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"minf",value:function(t){return e.box(e.types.minf,t.type===r.Vc.VIDEO?e.VMHD:e.SMHD,e.DINF,e.stbl(t))}},{key:"stbl",value:function(t){return t&&t.ext,e.box(e.types.stbl,e.stsd(t),e.STTS,(0,void 0),e.STSC,e.STSZ,e.STCO)}},{key:"stsd",value:function(t){var n;return n="audio"===t.type?t.useEME&&t.enca?e.enca(t):e.mp4a(t):t.useEME&&t.encv?e.encv(t):e.avc1hev1vvc1(t),e.box(e.types.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),n)}},{key:"enca",value:function(t){var n=t.enca.channelCount,i=t.enca.sampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,i>>8&255,255&i,0,0]),a=e.esds(t.config),o=e.sinf(t.enca);return e.box(e.types.enca,r,a,o)}},{key:"encv",value:function(t){var n,r,a=t.sps.length>0?t.sps[0]:[],o=t.pps.length>0?t.pps[0]:[],s=t.width,u=t.height,l=t.sarRatio[0],c=t.sarRatio[1],g=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,s>>8&255,255&s,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d=new Uint8Array((n=(r=[1,a[1],a[2],a[3],255,225,a.length>>>8&255,255&a.length]).concat.apply(r,(0,i.u)(a)).concat([1,o.length>>>8&255,255&o.length])).concat.apply(n,(0,i.u)(o))),f=new Uint8Array([0,0,88,57,0,15,200,192,0,4,86,72]),h=e.sinf(t.encv),p=new Uint8Array([l>>24,l>>16&255,l>>8&255,255&l,c>>24,c>>16&255,c>>8&255,255&c]);return e.box(e.types.encv,g,e.box(e.types.avcC,d),e.box(e.types.btrt,f),h,e.box(e.types.pasp,p))}},{key:"schi",value:function(t){var n=new Uint8Array([]),i=e.tenc(t);return e.box(e.types.schi,n,i)}},{key:"tenc",value:function(t){var n=new Uint8Array([0,0,0,0,0,0,255&t.default_IsEncrypted,255&t.default_IV_size].concat((0,a.Qc)(t.default_KID)));return e.box(e.types.tenc,n)}},{key:"sinf",value:function(t){var n=new Uint8Array([]),i=new Uint8Array([t.data_format.charCodeAt(0),t.data_format.charCodeAt(1),t.data_format.charCodeAt(2),t.data_format.charCodeAt(3)]),r=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]),a=e.schi(t);return e.box(e.types.sinf,n,e.box(e.types.frma,i),e.box(e.types.schm,r),a)}},{key:"avc1hev1vvc1",value:function(t){t.codecType===r._e.HEVC?(n=e.hvcC(t),i=e.types.hvc1):t.codecType===r._e.VVCC?(n=e.vvcC(t),i=e.types.bvc2):(n=e.avcC(t),i=e.types.avc1);var n,i,a=[new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,255&t.width,t.height>>8&255,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),n];return t.codecType===r._e.HEVC?a.push(e.box(e.types.fiel,new Uint8Array([1,0]))):t.sarRatio&&t.sarRatio.length>1&&a.push(e.pasp(t.sarRatio)),e.box.apply(e,[i].concat(a))}},{key:"avcC",value:function(t){var n,r,a,o=[],s=[];return t.sps.forEach(function(e){a=e.byteLength,o.push(a>>>8&255),o.push(255&a),o.push.apply(o,(0,i.u)(e))}),t.pps.forEach(function(e){a=e.byteLength,s.push(a>>>8&255),s.push(255&a),s.push.apply(s,(0,i.u)(e))}),e.box(e.types.avcC,new Uint8Array((n=(r=[1,o[3],o[4],o[5],255,224|t.sps.length]).concat.apply(r,o).concat([t.pps.length])).concat.apply(n,s)))}},{key:"vvcC",value:function(t){var n=t.vvcC;return e.box(e.types.bv2C,new Uint8Array(n))}},{key:"hvcC",value:function(t){var n,r=t.hvcC;if(r instanceof ArrayBuffer||r instanceof Uint8Array)return r;var a=t.vps,o=t.sps,s=t.pps;if(r){var u=r.generalProfileCompatibilityFlags,l=r.generalConstraintIndicatorFlags,c=(a.length&&1)+(o.length&&1)+(s.length&&1);n=[1,r.generalProfileSpace<<6|r.generalTierFlag<<5|r.generalProfileIdc,u>>>24,u>>>16,u>>>8,u,l[0],l[1],l[2],l[3],l[4],l[5],r.generalLevelIdc,240,0,252,252|r.chromaFormatIdc,248|r.bitDepthLumaMinus8,248|r.bitDepthChromaMinus8,0,0,r.numTemporalLayers<<3|r.temporalIdNested<<2|3,c];var g=function(e){var t;n.push(e.length>>8,e.length),(t=n).push.apply(t,(0,i.u)(e))};a.length&&(n.push(160,0,a.length),a.forEach(g)),o.length&&(n.push(161,0,o.length),o.forEach(g)),s.length&&(n.push(162,0,s.length),s.forEach(g))}else n=[1,1,96,0,0,0,144,0,0,0,0,0,93,240,0,252,253,248,248,0,0,15,3,160,0,1,0,24,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,153,152,9,161,0,1,0,45,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,160,2,128,128,45,22,89,153,164,147,43,154,128,128,128,130,0,0,3,0,2,0,0,3,0,50,16,162,0,1,0,7,68,1,193,114,180,98,64];return e.box(e.types.hvcC,new Uint8Array(n))}},{key:"pasp",value:function(t){var n=(0,i.ZQ)(t,2),r=n[0],a=n[1];return e.box(e.types.pasp,new Uint8Array([r>>24,r>>16&255,r>>8&255,255&r,a>>24,a>>16&255,a>>8&255,255&a]))}},{key:"mp4a",value:function(t){return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,t.sampleRate>>8&255,255&t.sampleRate,0,0]),t.config.length?e.esds(t.config):void 0)}},{key:"esds",value:function(t){var n=t.length;return e.box(e.types.esds,new Uint8Array([0,0,0,0,3,23+n,0,0,0,4,15+n,64,21,0,6,0,0,0,218,192,0,0,218,192,5].concat([n]).concat(t).concat([6,1,2])))}},{key:"mvex",value:function(t){return e.box.apply(e,[e.types.mvex].concat((0,i.u)(t.map(function(t){return e.trex(t.id)}))))}},{key:"trex",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trex1",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,2,0,0,0,0,0,0,1,0,0]))}},{key:"trex2",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,4,0,0,0,0,0,2,0,0,0]))}},{key:"moof",value:function(t){return e.box.apply(e,[e.types.moof,e.mfhd(t[0].samples?t[0].samples[0].gopId:0)].concat((0,i.u)(t.map(function(t){return e.traf(t)}))))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"traf",value:function(t){var n=e.tfhd(t.id),i=e.tfdt(t.baseMediaDecodeTime),r=0;if(t.isVideo&&t.videoSenc&&t.videoSenc.forEach(function(e){r+=8,e.subsamples&&e.subsamples.length&&(r+=2+6*e.subsamples.length)}),t.videoSencLength=r,t.useEME&&(t.isVideoEncryption||t.isAudioEncryption)){if(t.isVideoEncryption){if(t.isVideo){var a=e.saiz(t),o=e.saio(t),s=e.trun1(t),u=e.senc(t);return e.box(e.types.traf,n,i,a,o,s,u)}if(t.isAudioEncryption){var l=e.sbgp(),c=e.saiz(t),g=e.saio(t),d=e.senc(t),f=e.trun1(t);return e.box(e.types.traf,n,i,l,c,g,d,f)}var h=e.sbgp(),p=e.trun1(t);return e.box(e.types.traf,n,i,h,p)}else{if(t.isVideo){var m=e.trun1(t);return e.box(e.types.traf,n,i,m)}var v=e.sbgp(),y=e.saiz(t),I=e.saio(t),C=e.senc(t),A=e.trun1(t);return e.box(e.types.traf,n,i,v,y,I,C,A)}}var _=e.sdtp(t);return e.box(e.types.traf,n,i,_,e.trun(t.samples,_.byteLength+76))}},{key:"sdtp",value:function(t){var n=new o.Z;return t.samples.forEach(function(e){n.write(new Uint8Array(t.isVideo?[e.keyframe?32:16]:[16]))}),e.box(e.types.sdtp,this.extension(0,0),n.buffer)}},{key:"trun1",value:function(t){var n=new o.Z,i=o.Z.writeUint32(t.samples.length),r=null;if(t.isVideo){var a=t.videoSencLength;r=o.Z.writeUint32(76+16*t.samples.length+a+77),!t.isVideoEncryption&&t.isAudioEncryption&&(r=o.Z.writeUint32(76+16*t.samples.length+20))}else{var s=76+12*t.samples.length+52;t.isAudioEncryption&&(s=76+12*t.samples.length+8*t.audioSenc.length+105),r=o.Z.writeUint32(s)}return t.samples.forEach(function(e){n.write(o.Z.writeUint32(e.duration)),n.write(o.Z.writeUint32(e.size)),n.write(o.Z.writeUint32(e.keyframe?33554432:65536)),t.isVideo&&n.write(o.Z.writeUint32(e.cts?e.cts:0))}),e.box(e.types.trun,this.extension(0,t.flags),i,r,n.buffer)}},{key:"senc",value:function(t){var n=new o.Z,i=t.samples.length,r=t.isVideo?16:8,a=t.isVideo?2:0,s=[],u=0;return t.isVideo?(s=t.videoSenc,u=t.videoSencLength):s=t.audioSenc,u=u||r*i,n.write(o.Z.writeUint32(16+u),e.types.senc,this.extension(0,a)),n.write(o.Z.writeUint32(i)),s.forEach(function(e){for(var t=0;t<e.InitializationVector.length;t++)n.write(new Uint8Array([e.InitializationVector[t]]));e.subsamples&&e.subsamples.length&&(n.write(o.Z.writeUint16(e.subsamples.length)),e.subsamples.forEach(function(e){n.write(o.Z.writeUint16(e.BytesOfClearData)),n.write(o.Z.writeUint32(e.BytesOfProtectedData))}))}),n.buffer}},{key:"saio",value:function(t){var n=12*t.samples.length+141;!t.isVideo&&t.isAudioEncryption&&(n=149);var i=new Uint8Array([1,0,0,0,0,0,0,1,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,255&n]);return e.box(e.types.saio,i)}},{key:"saiz",value:function(t){var n=t.samples.length,i=new Uint8Array([0,0,0,0,16,n>>24&255,n>>16&255,n>>8&255,255&n]);return e.box(e.types.saiz,i)}},{key:"sbgp",value:function(){var t=new Uint8Array([114,111,108,108,0,0,0,1,0,0,1,25,0,0,0,1]);return e.box(e.types.sbgp,this.extension(0,0),t)}},{key:"extension",value:function(e,t){return new Uint8Array([e,t>>16&255,t>>8&255,255&t])}},{key:"tfhd",value:function(t){return e.box(e.types.tfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"tfdt",value:function(t){var n=Math.floor(t/(s+1)),i=Math.floor(t%(s+1));return e.box(e.types.tfdt,new Uint8Array([1,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i]))}},{key:"trun",value:function(t,n){var i=t.length,r=12+16*i;n+=8+r;var a=new Uint8Array(r);a.set([0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0);for(var o=0;o<i;o++){var s=t[o],u=s.duration,l=s.size,c=s.flag,g=void 0===c?{}:c,d=s.cts,f=void 0===d?0:d;a.set([u>>>24&255,u>>>16&255,u>>>8&255,255&u,l>>>24&255,l>>>16&255,l>>>8&255,255&l,g.isLeading<<2|(null===g.dependsOn||void 0===g.dependsOn?1:g.dependsOn),g.isDependedOn<<6|g.hasRedundancy<<4|g.paddingValue<<1|(null===g.isNonSyncSample||void 0===g.isNonSyncSample?1:g.isNonSyncSample),61440&g.degradationPriority,15&g.degradationPriority,f>>>24&255,f>>>16&255,f>>>8&255,255&f],12+16*o)}return e.box(e.types.trun,a)}},{key:"moovMP4",value:function(t){return e.box.apply(e,[e.types.moov,e.mvhd(t[0].duration,t[0].timescale)].concat((0,i.u)(t.map(function(t){return e.trackMP4(t)}))))}},{key:"trackMP4",value:function(t){return e.box(e.types.trak,e.tkhd(t.id,t.duration,t.width,t.height),e.mdiaMP4(t))}},{key:"mdiaMP4",value:function(t){return e.box(e.types.mdia,e.mdhd(t.duration,t.timescale),e.hdlr(t.type),e.minfMP4(t))}},{key:"minfMP4",value:function(t){return e.box(e.types.minf,t.type===r.Vc.VIDEO?e.VMHD:e.SMHD,e.DINF,e.stblMP4(t))}},{key:"stblMP4",value:function(t){var n=t.ext,i=[e.stsd(t),e.stts(n.stts),e.stsc(n.stsc),e.stsz(n.stsz),e.stco(n.stco)];return n.stss.length&&i.push(e.stss(n.stss)),n.ctts.length&&i.push(e.ctts(n.ctts)),e.box.apply(e,[e.types.stbl].concat(i))}},{key:"stts",value:function(t){var n=t.length,i=new Uint8Array(8*n),r=0;return t.forEach(function(e){var t=e.value,n=e.count;i.set([n>>24,n>>16&255,n>>8&255,255&n,t>>24,t>>16&255,t>>8&255,255&t],r),r+=8}),e.box(e.types.stts,(0,a.gJ)(new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n]),i))}},{key:"stsc",value:function(t){var n=t.length,i=new Uint8Array(12*n),r=0;return t.forEach(function(e){var t=e.firstChunk,n=e.samplesPerChunk,a=e.sampleDescIndex;i.set([t>>24,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a],r),r+=12}),e.box(e.types.stsc,(0,a.gJ)(new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n]),i))}},{key:"stsz",value:function(t){var n=t.length,i=new Uint8Array(4*n),r=0;return t.forEach(function(e){i.set([e>>24,e>>16&255,e>>8&255,255&e],r),r+=4}),e.box(e.types.stsz,(0,a.gJ)(new Uint8Array([0,0,0,0,0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n]),i))}},{key:"stco",value:function(t){var n=t.length,i=new Uint8Array(4*n),r=0;return t.forEach(function(e){i.set([e>>24,e>>16&255,e>>8&255,255&e],r),r+=4}),e.box(e.types.stco,(0,a.gJ)(new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n]),i))}},{key:"stss",value:function(t){var n=t.length,i=new Uint8Array(4*n),r=0;return t.forEach(function(e){i.set([e>>24,e>>16&255,e>>8&255,255&e],r),r+=4}),e.box(e.types.stss,(0,a.gJ)(new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n]),i))}},{key:"ctts",value:function(t){var n=t.length,i=new Uint8Array(8*n),r=0;return t.forEach(function(e){var t=e.value,n=e.count;i.set([n>>24,n>>16&255,n>>8&255,255&n,t>>24,t>>16&255,t>>8&255,255&t],r),r+=8}),e.box(e.types.ctts,(0,a.gJ)(new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n]),i))}},{key:"styp",value:function(){return e.box(e.types.styp,new Uint8Array([109,115,100,104,0,0,0,0,109,115,100,104,109,115,105,120]))}},{key:"sidx",value:function(t){var n=t.timescale,i=t.samples[0].duration,r=i*t.samples.length,a=t.samples[0].sampleOffset*i,o=8;t.samples.forEach(function(e){o+=e.size});var s=0;if(t.isVideo){var u,l=0;t.videoSenc&&(u=t.videoSenc),t.isVideo&&u.forEach(function(e){l+=8,e.subsamples&&e.subsamples.length&&(l+=2+6*e.subsamples.length)}),t.videoSencLength=l,s=o+141+16*t.samples.length+l,t.useEME&&t.isAudioEncryption&&!t.isVideoEncryption&&(s=o+16*t.samples.length+84)}else s=o+116+12*t.samples.length,t.useEME&&t.isAudioEncryption&&(s=o+169+12*t.samples.length+8*t.audioSenc.length);var c=new Uint8Array([0,0,0,0,0,0,0,255&t.id,n>>24&255,n>>16&255,n>>8&255,255&n,a>>24&255,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,1,0,s>>16&255,s>>8&255,255&s,r>>24&255,r>>16&255,r>>8&255,255&r,144,0,0,0]);return e.box(e.types.sidx,c)}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}}]),e}();(0,i._x)(u,"types",["avc1","avcC","hvc1","hvcC","dinf","dref","edts","elst","esds","ftyp","hdlr","mdat","mdhd","mdia","mfhd","minf","moof","moov","mp4a","mvex","mvhd","pasp","stbl","stco","stsc","stsd","stsz","stts","tfdt","tfhd","traf","trak","trex","tkhd","vmhd","smhd","ctts","stss","styp","pssh","sidx","sbgp","saiz","saio","senc","trun","encv","enca","sinf","btrt","frma","tenc","schm","schi","mehd","fiel","sdtp","bvc2","bv2C"].reduce(function(e,t){return e[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)],e},Object.create(null))),(0,i._x)(u,"HDLR_TYPES",{video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])}),(0,i._x)(u,"FTYPAVC1",u.box(u.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]))),(0,i._x)(u,"FTYPHEV1",u.box(u.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,104,101,118,49]))),(0,i._x)(u,"DINF",u.box(u.types.dinf,u.box(u.types.dref,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])))),(0,i._x)(u,"VMHD",u.box(u.types.vmhd,new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]))),(0,i._x)(u,"SMHD",u.box(u.types.smhd,new Uint8Array([0,0,0,0,0,0,0,0]))),(0,i._x)(u,"StblTable",new Uint8Array([0,0,0,0,0,0,0,0])),(0,i._x)(u,"STTS",u.box(u.types.stts,u.StblTable)),(0,i._x)(u,"STSC",u.box(u.types.stsc,u.StblTable)),(0,i._x)(u,"STSZ",u.box(u.types.stsz,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]))),(0,i._x)(u,"STCO",u.box(u.types.stco,u.StblTable))}}]);
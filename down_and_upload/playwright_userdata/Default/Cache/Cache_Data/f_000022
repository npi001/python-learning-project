/*! For license information please see player-6.9ac7150b.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).xss={})}(this,function(e){"use strict";var t=function(){return(t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function r(e,t,r){if(r||2==arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}var n=/[^a-zA-Z0-9\\_:.-]/gim,i=/</g,a=/>/g,o=/&#([a-zA-Z0-9]*);?/gim,s=/&quot;/g,u=/&colon;?/gim,c=/&newline;?/gim,l=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,f=/u\s*r\s*l\s*\(.*/gi,d=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,h=/"/g,p=function(e){return e.replace(i,"&lt;").replace(a,"&gt;")},v={indexOf:function(e,t){var r,n;for(r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return -1},forEach:function(e,t,r){var n,i;for(n=0,i=e.length;n<i;n++)t.call(r,e[n],n,e)},some:function(e,t,r){var n,i;for(n=0,i=e.length;n<i;n++)if(t.call(r,e[n],n,e))return!0;return!1},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},includes:function(e,t){if("string"==typeof e)return -1!==e.indexOf(t);for(var r=0;r<e.length;r++)if(e[r]===t)return!0;return!1},spaceIndex:function(e){var t=/\s|\n|\t/.exec(e);return t?t.index:-1},uniq:function(e){for(var t={},r=[],n=0;n<e.length;n++)t[e[n]]||(r.push(e[n]),t[e[n]]=!0);return r},from:function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t},keys:function(e){var t=[];for(var r in e)t.push(r);return t}};function g(e){return null==e}function y(e){var t;return'"'===(t=e)[0]&&'"'===t[t.length-1]||"'"===t[0]&&"'"===t[t.length-1]?e.substr(1,e.length-2):e}function _(e){var t,r,n,i,a,o,s,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",l=0;for(e=function(e){e=e.replace(/rn/g,"n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t+=String.fromCharCode(n):n>127&&n<2048?t+=String.fromCharCode(n>>6|192)+String.fromCharCode(63&n|128):t+=String.fromCharCode(n>>12|224)+String.fromCharCode(n>>6&63|128)+String.fromCharCode(63&n|128)}return t}(e);l<e.length;)i=(t=e.charCodeAt(l++))>>2,a=(3&t)<<4|(r=e.charCodeAt(l++))>>4,o=(15&r)<<2|(n=e.charCodeAt(l++))>>6,s=63&n,isNaN(r)?o=s=64:isNaN(n)&&(s=64),c=c+u.charAt(i)+u.charAt(a)+u.charAt(o)+u.charAt(s);return c}function m(e){var t,r,n,i,a,o,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");c<e.length;)t=s.indexOf(e.charAt(c++))<<2|(i=s.indexOf(e.charAt(c++)))>>4,r=(15&i)<<4|(a=s.indexOf(e.charAt(c++)))>>2,n=(3&a)<<6|(o=s.indexOf(e.charAt(c++))),u+=String.fromCharCode(t),64!==a&&(u+=String.fromCharCode(r)),64!==o&&(u+=String.fromCharCode(n));return function(e){for(var t="",r=0,n=0,i=0,a=0;r<e.length;)(n=e.charCodeAt(r))<128?(t+=String.fromCharCode(n),r++):n>191&&n<224?(t+=String.fromCharCode((31&n)<<6|63&(a=e.charCodeAt(r+1))),r+=2):(a=e.charCodeAt(r+1),t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&(i=e.charCodeAt(r+2))),r+=3);return t}(u)}function b(e,t,r){var n="",i=0,a=!1,o=!1,s=0,u=e.length,c="",l="";e:for(s=0;s<u;s++){var f=e.charAt(s);if(!1===a){if("<"===f){a=s;continue}}else if(!1===o){if("<"===f){n+=r(e.slice(i,s)),a=s,i=s;continue}if(">"===f||s===u-1){n+=r(e.slice(i,a)),c=function(e){var t,r=v.spaceIndex(e);return t=-1===r?e.slice(1,-1):e.slice(1,r+1),"/"===(t=v.trim(t).toLowerCase()).slice(0,1)&&(t=t.slice(1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),t}(l=e.slice(a,s+1)),n+=t(a,n.length,c,l,"</"===l.slice(0,2)),i=s+1,a=!1;continue}if('"'===f||"'"===f)for(var d=1,h=e.charAt(s-d);""===h.trim()||"="===h;){if("="===h){o=f;continue e}h=e.charAt(s-++d)}}else if(f===o){o=!1;continue}}return i<u&&(n+=r(e.substr(i))),n}function w(e,t){var r=0,i=0,a=[],o=!1,s=e.length;function u(e,r){if(!((e=(e=v.trim(e)).replace(n,"").toLowerCase()).length<1)){var i=t(e,r||"");i&&a.push(i)}}for(var c=0;c<s;c++){var l=e.charAt(c),f=void 0;if(!1!==o||"="!==l){if(!1===o||c!==i){if(/\s|\n|\t/.test(l)){if(e=e.replace(/\s|\n|\t/g," "),!1===o){if(-1===(f=function(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r)return"="===r?t:-1}return -1}(e,c))){u(v.trim(e.slice(r,c))),o=!1,r=c+1;continue}c=f-1;continue}if(-1===(f=function(e,t){for(;t>0;t--){var r=e[t];if(" "!==r)return"="===r?t:-1}return -1}(e,c-1))){u(o,y(v.trim(e.slice(r,c)))),o=!1,r=c+1;continue}}}else{if(-1===(f=e.indexOf(l,c+1)))break;u(o,v.trim(e.slice(i+1,f))),o=!1,r=(c=f)+1}}else o=e.slice(r,c),r=c+1,i='"'===e.charAt(r)||"'"===e.charAt(r)?r:function(e,t){for(;t<e.length;t++){var r=e[t];if(" "!==r)return"'"===r||'"'===r?t:-1}return -1}(e,c+1)}return r<e.length&&(!1===o?u(e.slice(r)):u(o,y(v.trim(e.slice(r))))),v.trim(a.join(" "))}function x(e,t,r){if(r=function(e){return e=function(e){for(var t="",r=0,n=e.length;r<n;r++)t+=32>e.charCodeAt(r)?" ":e.charAt(r);return v.trim(t)}(e=(e=(e=e.replace(s,'"')).replace(o,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))})).replace(u,":").replace(c," "))}(r),"href"===t||"src"===t){if("#"===(r=v.trim(r)))return"#";if("http://"!==r.substr(0,7)&&"https://"!==r.substr(0,8)&&"mailto:"!==r.substr(0,7)&&"tel:"!==r.substr(0,4)&&"data:image/"!==r.substr(0,11)&&"ftp://"!==r.substr(0,6)&&"./"!==r.substr(0,2)&&"../"!==r.substr(0,3)&&"#"!==r[0]&&"/"!==r[0])return""}else if("background"===t){if(l.lastIndex=0,l.test(r))return""}else if("style"===t&&(d.lastIndex=0,d.test(r)||(f.lastIndex=0,f.test(r)&&(l.lastIndex=0,l.test(r)))))return"";return r=function(e){return e=p(e=e.replace(h,"&quot;"))}(r)}var k=function(e){return"string"==typeof e?e.replace(/'/g,'"').replace('=""',"").replace(/\s+/g,"").toLowerCase():""},S=function(){function e(e){var t=function(e){var t={};for(var r in e)t[r]=e[r];return t}(e||{});t.stripIgnoreTag&&(t.onIgnoreTag,t.onIgnoreTag=function(){return""}),t.whiteList={},t.onTag=function(){},t.onTagAttr=function(){},t.onIgnoreTag=function(){},t.onIgnoreTagAttr=function(){},t.safeAttrValue=x,t.escapeHtml=p,this.options=Object.assign(t,e)}return e.prototype.process=function(e){if(!(e=(e=e||"").toString()))return"";var t,r,n,i,a,o,s=this.options,u=s.whiteList,c=s.onTag,l=s.onIgnoreTag,f=s.onTagAttr,d=s.onIgnoreTagAttr,h=s.safeAttrValue,p=s.escapeHtml;s.stripBlankChar&&(e=(t=(t=e.split("")).filter(function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)})).join("")),s.allowCommentTag||(e=function(e){for(var t="",r=0;r<e.length;){var n=e.indexOf("\x3c!--",r);if(-1===n){t+=e.slice(r);break}t+=e.slice(r,n);var i=e.indexOf("--\x3e",n);if(-1===i)break;r=i+3}return t}(e));var g=!1;s.stripIgnoreTagBody&&(r=s.stripIgnoreTagBody,"function"!=typeof(n=l)&&(n=function(){}),i=!Array.isArray(r),a=[],o=!1,l=(g={onIgnoreTag:function(e,t,s){var u;if(u=e,i||-1!==v.indexOf(r,u)){if(s.isClosing){var c="[/removed]",l=s.position+c.length;return a.push([!1!==o?o:s.position,l]),o=!1,c}return o||(o=s.position),"[removed]"}return n(e,t,s)},remove:function(e){var t="",r=0;return v.forEach(a,function(n){t+=e.slice(r,n[0]),r=n[1]}),t+=e.slice(r)}}).onIgnoreTag);var y=b(e,function(e,t,r,n,i){var a={sourcePosition:e,position:t,isClosing:i,isWhite:Object.prototype.hasOwnProperty.call(u,r)},o=c(r,n,a);if(null!=o)return o;if(a.isWhite){if(a.isClosing)return"</".concat(r,">");var s=function(e){var t=v.spaceIndex(e);if(-1===t)return{html:"",closing:"/"===e[e.length-2]};var r="/"===(e=v.trim(e.slice(t+1,-1)))[e.length-1];return r&&(e=v.trim(e.slice(0,-1))),{html:e,closing:r}}(n),g=u[r],y=w(s.html,function(e,t){var n=-1!==v.indexOf(g,e),i=f(r,e,t,n);return null==i?n?(t=h(r,e,t,null))?"".concat(e,'="').concat(t,'"'):e:null==(i=d(r,e,t,n))?void 0:i:i});return n="<".concat(r),y&&(n+=" ".concat(y)),s.closing&&(n+=" /"),n+=">"}return null==(o=l(r,n,a))?p(n):o},p);return g&&(y=g.remove(y)),y},e}(),B=Function("\nvar _checkXSS = function (it) {\n  return it && it.Math == Math && it;\n};\nreturn _checkXSS(typeof globalThis === 'object' && globalThis) ||\n_checkXSS(typeof window === 'object' && window) ||\n_checkXSS(typeof self === 'object' && self) ||\n_checkXSS(typeof global === 'object' && global) ||\nFunction('return this')();\n")(),I=new(function(){function e(){var e=this;this.batchData=[],this.uniqKeys=new Set,this.timeout=2e3,this.lock=!1,this.getSlardarBid=function(){var t,r,n="douyin_web";if(!v.includes(n,"bid"))return n;if(e.config&&e.config.bid)return e.config.bid;if(B&&B._xssBid)return B._xssBid;if(B&&B.slardar&&"function"==typeof B.slardar.config){var i=(B.slardar.config()||{}).bid;if(i)return i}if(B&&B.Slardar&&"function"==typeof B.Slardar.config){var a=(B.Slardar.config()||{}).bid;if(a)return a}return(null===(r=null===(t=null==B?void 0:B.Slardar)||void 0===t?void 0:t._baseParams)||void 0===r?void 0:r.bid)||"argus"},this.getConfigRegion=function(){var t;return v.includes("cn","region")?e.config&&e.config.region?e.config.region:((null===(t=null==B?void 0:B.gfdatav1)||void 0===t?void 0:t.region)||"cn").toLowerCase():"cn"},this.gerReportUrl=function(){var t={cn:m("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boe:m("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),ttp:m("aHR0cHM6Ly9tb24udXMudGlrdG9rdi5jb20vbW9uaXRvcl9icm93c2VyL2NvbGxlY3QvYmF0Y2gvc2VjdXJpdHkvP2JpZD0="),va:m("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),maliva:m("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),sg:m("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boei18n:m("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9")}[e.getConfigRegion()];if(t)return t+e.getSlardarBid()}}return e.prototype.setConfig=function(e){this.config=e},e.prototype.upload=function(){var e=this,t=this.gerReportUrl();!this.lock&&t&&0!==this.batchData.length&&(this.lock=!0,setTimeout(function(){var r=e.batchData.slice(0,100);e.batchData=e.batchData.slice(100),B.fetch(t,{method:"post",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}}).catch(function(e){}),e.lock=!1,e.upload()},this.timeout))},e.prototype.generateKey=function(e){return e.collectKey?[e.collectMode,e.collectKey].join("___"):""},e.prototype.push=function(e){this.batchData.push(e),this.upload()},e.prototype.report=function(e){var t=this.generateKey(e);if(B.fetch&&e.collectKey){var r="object"==typeof window?window.location.href:"SSR";e.documentUrl=r;var n={age:Math.floor(Date.now()),type:"xss",url:r,body:e,"user-agent":""};"enforce"===e.disposition&&"SSR"!==r||(n.url=t),"SSR"===r&&(n.url="SSR___".concat(n.url),n.body.ssr=!0),this.push(n)}},e}()),L=function(e){for(var t=0,r=function(r){Array.isArray(e[r])?0===e[r].length?delete e[r]:(e[r]=v.from(v.uniq(e[r])),t+=e[r].length):0===v.keys(e[r]).length?delete e[r]:v.keys(e[r]).forEach(function(n){e[r][n]=v.from(v.uniq(e[r][n])),t+=e[r][n].length})},n=0,i=v.keys(e);n<i.length;n++)r(i[n]);return{count:t,ret:e}};function A(e,t){return I.setConfig(t),new S(t).process(e)}function C(e){var t,r=(t=/\s|\n|\t/.exec(e))?t.index:-1;if(-1===r)return{html:"",closing:"/"===e[e.length-2]};var n="/"===(e=e.slice(r+1,-1).trim())[e.length-1];return n&&(e=e.slice(0,-1).trim()),{html:e,closing:n}}var P=function(e){return -1===(e=(e=(e=(e=e.replace(/&colon;/gi,":")).replace(/&tab;/gi,"")).replace(/&newline;/gi,"")).replace(/(\t|\n|\r)/g,"")).indexOf("&#")?e.trim().toLowerCase():e.trim().replace(/&#(?:(x)([0-9a-f]+)|([0-9]+));?/gi,function(e,t,r,n){return String.fromCharCode(t?parseInt(r,16):parseInt(n))}).replace(/(\t|\n|\r)/g,"").toLowerCase()};function T(e,t){if(void 0===e&&(e=""),"string"!=typeof e)return!0;if(e=P(e),v.includes(e,"base64")&&!function(e){if(""===e||""===e.trim())return!0;try{return!v.includes(e,"data:text/html;base64")}catch(e){return!0}}(e))return t&&t("data:text/html;base64"),!1;var r=["expression(","behavior:","view-source:"];if(v.some(r,function(t){return -1!==e.indexOf(t)}))return v.forEach(r,function(r){-1!==e.indexOf(r)&&t&&t(r)}),!1;var n=["data:application","data:javascript","data:text/html","data:texthtml"];if(v.some(n,function(t){return -1!==e.indexOf(t)}))return v.forEach(n,function(r){-1!==e.indexOf(r)&&t&&t(r)}),!1;if(e.indexOf("javascript:")>0)return t&&t("javascript:"),!1;if(/^javascript:/i.test(e)){var i=e.slice(11).replace(/\s/g,"").trim();return!!v.some(["void","void(0)","void0","false","undefined",";"],function(e){return e===i})||(t&&t("javascript:"),!1)}return!0}var O=function(e,t){var r,n,i="<%= isSaveValidUrl =>";if("string"!=typeof e||(n=Number("<%= urlLimit =>"),void 0!==r&&(n=r),"NaN"!==e.toString()&&-1!==n&&e.length>=n)||T(e,t))return e;try{if(!0===(i=JSON.parse(i))||"true"===i){var a=new URL(e);return a.origin+a.pathname}}catch(e){}return"#"};function R(e,t,n){if(void 0===e&&(e=""),void 0===t&&(t=[]),"string"!=typeof e)return!0;if(!T(e=P(e)))return!1;var i,a={url:(i=e.match(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/)||[])[0],scheme:i[1],slash:i[2],host:i[3],port:i[4],path:i[5],query:i[6],hash:i[7]},o=a.scheme,s=a.host;return n?!!n(e):!(!o||!s)&&(!v.includes(["http","https","file"],o)||("object"==typeof window&&window&&(t=r(r([],t,!0),[location.host],!1)),v.some(t,function(e){return!!(e instanceof RegExp&&e.test(s))||e===s})))}var D={a:["target","title","spellcheck","rel"],canvas:[],abbr:["title"],address:[],area:["shape","coords","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:["dir"],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["alt","title","width","height","decoding"],ins:["datetime"],li:[],mark:[],nav:[],ol:["start"],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],delete:[],form:[],strong:[],mask:["maskunits","x","y","width","height","fill"],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],wbr:[],video:["autoplay","controls","loop","preload","height","width"],svg:["viewBox","version","xmlns","fill","width","height","stroke","stroke-width","style"],path:["d","fill","opacity","stroke","p-id","fill-rule","clip-rule","stroke-width","stroke-linecap","stroke-linejoin","fill-opacity","mask"],rect:["x","y","width","height","fill","stroke","rx"],g:[]},j={collect:null,initCollect:function(){this.collect={whiteList:{},filterProtocol:[]}},removeCollect:function(){var e=L(this.collect),t=e.count,r=e.ret;return this.collect=null,{collectKey:0===t?null:JSON.stringify(r),collectMode:"white"}},onIgnoreTagAttr:function(e,t,n){return e&&v.indexOf(["href","src"],t)>-1?j.domainWhiteList&&Array.isArray(j.domainWhiteList)&&j.domainWhiteList.length>0&&!R(n,r([],j.domainWhiteList,!0))?"":"".concat(t,'="').concat(O(n,function(e){var t;null===(t=j.collect)||void 0===t||t.filterProtocol.push(e)}),'"'):e&&(v.indexOf(["style","class","id"],t)>-1||t.indexOf("data-")>-1)?"".concat(t,'="').concat(n,'"'):(j.collect.whiteList[e]=j.collect.whiteList[e]||[],void j.collect.whiteList[e].push(t))},onIgnoreTag:function(e,t){if("style"===e)return t;b(t,function(e,t,r,n){w(C(n).html.replace("/",""),function(e){j.collect.whiteList[r]=j.collect.whiteList[r]||[],j.collect.whiteList[r].push(e)})},p)},whiteList:D,mergeWhiteList:function(e){for(var t,r={},n=0,i=v.keys(D);n<i.length;n++)r[t=i[n]]=v.from(D[t]);for(var a=0,o=v.keys(e);a<o.length;a++)r[t=o[a]]=t in D?D[t].concat(e[t]):v.from(e[t]);return r},setWhiteList:function(e){for(var t=0,r=v.keys(e);t<r.length;t++){var n=r[t];this.whiteList[n]=n in D?D[n].concat(e[n]):v.from(e[n])}}};try{var E={},U="merge";v.includes(U,"override")&&(j.whiteList=E.whiteList),v.includes(U,"merge")&&j.setWhiteList(E.whiteList)}catch(e){}var M=function(e,t){for(var r={},n=0,i=v.keys(e);n<i.length;n++){var a=i[n];Array.isArray(e[a])?r[a]=v.from(e[a]):r[a]=M({},e[a])}for(var o=0,s=v.keys(t);o<s.length;o++)(a=s[o])in e?Array.isArray(e[a])?r[a]=e[a].concat(t[a]):r[a]=M(e[a],t[a]):Array.isArray(t[a])?r[a]=v.from(t[a]):r[a]=M({},t[a]);return r},N={blackList:{a:["folder"],meta:["content"],iframe:["srcdoc"],input:["pattern"],vmlframe:["xmlns"]},blackTags:["script","xml","embed","isindex","object","base","set","handler","animate","payload","import"],blackAttrs:["charset","ns","namespace","formaction","xlink:href","xmlns:xlink","handler","repeat","repeat-start","repeat-end"],blackAttrRegExps:[/^on/],filterList:{param:["value"],video:["poster"],form:["action"]},filterAttrs:["href","src","background","style","dynsrc","lowsrc","content"]};try{var F={};F.blackAttrRegExps&&(F.blackAttrRegExps=F.blackAttrRegExps.map(function(e){return new RegExp(e.toString().slice(1,e.toString().length-1))}));var Z="merge";v.includes(Z,"override")&&(N=F),v.includes(Z,"merge")&&(N=M(N,F))}catch(e){}var q={mode:"black",whiteList:{},blackConfig:N,collect:null,initCollect:function(){q.collect={blackList:{},blackTags:[],blackAttrs:[],blackAttrRegExps:[],filterAttrs:[],filterList:{},filterProtocol:[]}},removeCollect:function(){var e=L(q.collect),t=e.count,r=e.ret;return q.collect=null,{collectKey:0===t?null:JSON.stringify(r),collectMode:"black"}},onIgnoreTag:function(e,t){var r;if(!v.includes(N.blackTags,e))return b(t,function(e,t,r,n,i){if(-1!==r.indexOf("/"))return p(n);if(i)return"</".concat(r,">");var a=C(n),o=w(a.html,function(e,t){var n,i=0;if(N.blackList[r]&&v.includes(N.blackList[r],e)&&(q.collect.blackList[r]=q.collect.blackList[r]||[],q.collect.blackList[r].push(e),i++),N.blackAttrRegExps.length&&N.blackAttrRegExps.some(function(t){return t.test(e)})&&v.forEach(N.blackAttrRegExps,function(t){t.test(e)&&(q.collect.blackAttrRegExps.push("".concat(t.toString(),"->").concat(e)),i++)}),N.blackAttrs.length&&v.includes(N.blackAttrs,e)&&(N.blackAttrs.push(e),i++),!i){if(N.filterList&&N.filterList[r]&&v.includes(N.filterList[r],e)){var a=O(t,function(e){var t;null===(t=q.collect)||void 0===t||t.filterProtocol.push(e)});return a!==t&&(q.collect.filterList[r]=q.collect.filterList[r]||[],q.collect.filterList[r].push(e)),t?"".concat(e,"='").concat(a,"'"):e}return N.filterAttrs&&v.includes(N.filterAttrs,e)?((a=O(t,function(e){var t;null===(t=q.collect)||void 0===t||t.filterProtocol.push(e)}))!==t&&(null===(n=q.collect)||void 0===n||n.filterAttrs.push(e)),t?"".concat(e,"='").concat(a,"'"):e):t?"".concat(e,"='").concat(t,"'"):e}});return n="<".concat(r),o&&(n+=" ".concat(o)),a.closing&&(n+=" /"),n+=">"},p);null===(r=q.collect)||void 0===r||r.blackTags.push(e)}},H=function(e){var t=e.reportOnly,r=void 0===t||t,n=e.block;return r&&"all"===r?"report":("string"==typeof r&&("true"===r&&(r=!0),"false"===r&&(r=!1)),n?"enforce":r?"report":"enforce")},W=function(e){return function(r,n,i){if(!r||"string"!=typeof r)return r;var a=n;e===A&&(a=j).initCollect();var o=e(r,a);if(k(o)===k(r))return r;if(!i)return o;var s=i.logType,u=H(i),c=a.removeCollect();return I.report(t(t({type:s,disposition:u},c),{sourceText:_(r),filterText:_(o)})),"enforce"===u?o:r}},V=W(function(e,t){return void 0===t&&(t={}),t&&t.whiteList||(t.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}),new S(t).process(e)}),K=W(A),z=function(e,t,r){var n=[],i=O(e,function(e){n.push(e)});if(i===e)return e;n=v.from(v.uniq(n));var a=t||r||{};if(!a)return i;var o=a.logType,s=H(r);return I.report({type:o,disposition:s,collectKey:n.join("___"),collectData:JSON.stringify(n),collectMode:"black",sourceText:_(e),filterText:_(i)}),"enforce"===s?i:e},X=B._xssProject||{},Y=B.xssNamespace||{},J="3.0.26",G={FilterXSS:S,version:J,webpackPluginVersion:"<%= webpackPluginVersion =>",reportOnly:"<%= reportOnly =>",filterXSS:V,_filterXSS:K,filterUrl:z,Config:j,BlackConfig:q,project:X,setProjectName:function(e){X[e]=this,B._xssProjectName=e}};Y.douyin_web=G,B.xssNamespace=Y,B.Math&&!B.Math.xssNamespace&&(B.Math.xssNamespace=Y),X[J]=G,B.globalThis=B,B.getFilterXss=function(){return void 0!==this._xssProjectName?this._xssProject[this._xssProjectName]:G},B.xss=G,B.isSafeUrl=R,B.isSafeDomain=R,B.isSafeProtocol=T,B._xssProject=X,B._xssProjectName&&(X[B._xssProjectName]=G);var Q=G.setProjectName.bind(G);e.BlackConfig=q,e.Config=j,e.FilterXSS=S,e._filterXSS=K,e.filterUrl=z,e.filterXSS=V,e.isSafeDomain=R,e.isSafeProtocol=T,e.isSafeUrl=R,e.project=X,e.setProjectName=Q,e.setXssNamespace=function(e){var t=e.appId,r=e.bid,n=e.region;Y[t]=G;j.bid=r,j.region=n,j.enabled=!0},e.xssNamespace=Y,Object.defineProperty(e,"__esModule",{value:!0})});"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["13385"],{746071:function(e,t,r){r.r(t)},908767:function(e,t,r){r.d(t,{f:function(){return u}});var n=r(452006),i=r(262416),a=r(879146),o=r(298028),s=r(382800),u=function(e){function t(e){var r;return(0,n.PA)(this,t),(r=(0,n.$w)(this,t)).onVisibleChange=function(){var e=r.masterTimer||r.workerTimer;r.stop(),e&&r.start()},r.options=e,document.addEventListener("visibilitychange",r.onVisibleChange),r}return(0,n.XW)(t,e),(0,n.qH)(t,[{key:"start",value:function(){var e=this,t=this.options,r=t.timerInWorker,n=t.frequency,a=function(){try{(e.masterTimer||e.workerTimer)&&e.emit(o.sW)}catch(e){}};this.stop(),r&&"undefined"!=typeof Worker&&document.hidden?this.workerTimer=(0,i.Ic)(a,1e3*n,!0):(this.masterTimer=new s.B(a),this.masterTimer.tickEvery(n))}},{key:"stop",value:function(){this.workerTimer&&((0,i.vI)(this.workerTimer),this.workerTimer=void 0),this.masterTimer&&(this.masterTimer.stop(),this.masterTimer=void 0)}},{key:"destroy",value:function(){this.removeAllListeners(),document.removeEventListener("visibilitychange",this.onVisibleChange),this.stop()}}])}(a.EventEmitter)},957201:function(e,t,r){r.r(t),r.d(t,{Mp4Preloader:function(){return i.Dh},default:function(){return n.Z}});var n=r(579806),i=r(185236)},231986:function(e,t,r){r.d(t,{E0:function(){return h},G9:function(){return d},Gb:function(){return l},Hs:function(){return c},KI:function(){return s},pU:function(){return f},qK:function(){return u},u8:function(){return o},yx:function(){return a}});var n=r(452006);r(819875),r(602157),r(511141),r(469577),r(98601),r(110617),r(826893),r(110006),r(792315),r(329913),r(868352),r(17322),r(63249),r(950665),r(180138),r(911234),r(387605),r(936097),r(786120),r(339597),r(877193),r(391375),r(486201),r(632637),r(645524),r(800599),r(69896),r(660999),r(12946),r(416555),r(747644),r(404948),r(789680);function i(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/");return t>0||r>0}function a(){return/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)}function o(){var e=window.chrome,t=window.navigator,r=t.vendor,n=void 0!==window.opr,i=t.userAgent.indexOf("Edge")>-1;return t.userAgent.match("CriOS")||null!=e&&"Google Inc."===r&&!1===n&&!1===i}function s(){var e,t,r,n,o,s,u,c,l;return!!navigator.requestMediaKeySystemAccess&&(e=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/);if(e&&e[1]){var t=parseInt(e[1],10);if(t>0)return t}return null}(),t=a(),r=i(),u=(n=navigator.mimeTypes,o=navigator.userAgent,s=!1,n&&o.indexOf("Chrome")>1&&(s=Object.keys(n).some(function(e){return!!(n[e].type&&n[e].type.indexOf("360")>-1||n[e].type&&n[e].type.indexOf("application/vnd.chromium.remoting-viewer")>-1||n[e].description&&n[e].description.indexOf("360")>-1)||!1})),s&&(null===e||e<=100)),c=navigator.userAgent.indexOf("Firefox")>0,l=navigator.userAgent.indexOf("Edge")>0,!t&&!r&&!u&&!c&&!l)}function u(){try{if(("undefined"==typeof WebAssembly?"undefined":(0,n.Ac)(WebAssembly))==="object"&&"function"==typeof WebAssembly.instantiate){var e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e) instanceof WebAssembly.Instance}}catch(e){}return!1}function c(){if("undefined"==typeof self)return!1;var e=function(){if("undefined"!=typeof self)return self.MediaSource||self.WebKitMediaSource}(),t=!!e&&"function"==typeof e.isTypeSupported;return t&&void 0===self.MediaSource&&(self.MediaSource=e),t}function l(){return c()&&u()&&!i()}function f(){return u()&&!i()}function d(){return"undefined"!=typeof MediaSource&&!!MediaSource.isTypeSupported&&(MediaSource.isTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.3.E.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.4.10.L120.90"'))}function h(){return"undefined"!=typeof MediaSource&&!!MediaSource.isTypeSupported&&MediaSource.isTypeSupported("video/mp4;codecs=bvc2.1.6.L93.B0")}},51814:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(452006);r(110617),r(675373);var i=(0,n.qH)(function e(){(0,n.PA)(this,e);var t,r,i=new Promise(function(e,n){t=e,r=n});return i.resolve=function(e){t(e),i.state="fulfilled"},i.reject=function(e){r(e),i.state="rejected",i.isBreak="DESTROYED"===e},i.state="pending",i},[{key:"resolve",value:function(e){}},{key:"reject",value:function(e){}}])},21976:function(e,t,r){r.d(t,{$V:function(){return o},Ww:function(){return s},d0:function(){return a}});var n=r(22450);r(98601);var i=(0,n.qH)(function e(t,r,i,a,o,s){(0,n.PA)(this,e),this.type=t,this.codecs=r,this.visualEntryBox=i,this.configurationBox=a,this.types=o,this.logCodeType=s}),a={AVC:"avc",AV1:"av1",HEVC:"hevc",H265:"h265",H264:"h264",BYTEVC1:"bytevc1",H266:"h266",BYTEVC2:"bytevc2",BVC2:"bvc2"},o=(0,n._x)((0,n._x)((0,n._x)((0,n._x)((0,n._x)((0,n._x)({},a.AVC,new i("avc","avc1.64001E","avc1","avcC",["h264"],"h264")),a.AV1,new i("av1","av01.0.08M.08","av01","av1C",["av1"],"av1")),a.HEVC,new i("hevc","hev1.1.6.L120.90","hvc1","hvcC",["h265"],"h265")),a.BYTEVC1,new i("hevc","hev1.1.6.L120.90","hvc1","hvcC",["bytevc1","h265"],"h265")),a.BVC2,new i("bvc2","bvc2.1.6.L93.B0","bvc2","bvc2",["h266"],"h266")),a.BYTEVC2,new i("bvc2","bvc2.1.6.L93.B0","bvc2","bvc2",["bytevc2","h266"],"h266"));function s(e){for(var t=Object.keys(o),r=0;r<t.length;r++){var n=t[r];if(o[n].codecs===e)return n}return null}},180893:function(e,t,r){r.d(t,{Z:function(){return b},d:function(){return y}});var n=r(22450);r(836654),r(511141),r(464135),r(499953),r(469577),r(429532),r(98601),r(110617),r(675373),r(914613),r(792315),r(329913),r(868352),r(17322),r(63249),r(950665),r(180138),r(911234),r(387605),r(936097),r(786120),r(339597),r(877193),r(391375),r(632637),r(645524),r(800599),r(69896),r(660999),r(12946),r(416555),r(747644),r(404948),r(789680),r(874386);var i=r(382541),a=r(869835),o=r(669141),s=r(805229),u=r(749517),c=r(262416),l=r(810815),f=r(696452),d=r.n(f),h=r(546041),p=r(258817),v=r(126609);function g(e){if(window.Headers&&e instanceof Headers){var t,r={},i=(0,n.sf)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;r[a[0]]=a[1]}}catch(e){i.e(e)}finally{i.f()}return r}return e}var y={loaderCount:1,loaderType:i.t.FETCH,onProcessMinLen:5120,enableDynamicMinLen:!0};function _(e,t){if(e.length>0){for(var r=0,n=!0,i=0;i<e.length;i++){var a=e[i];if(a>t){n=!1;break}if((r+=a)/e.length>t&&(n=!1),!n)return!1}}return!0}var m=0,b=function(){var e,t,r,f,b,w;function x(e,t){var r=this,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",c=!(arguments.length>3)||void 0===arguments[3]||arguments[3];(0,n.PA)(this,x),d()(this),this._config=Object.assign({},y,(0,n.Zj)({responseType:"arraybuffer"},e)),this._needPreloadCache=c,this._loaderCount=1,this._config.loaderCount>1,this._loaderType=this._config.loaderType||i.t.FETCH,this._enableDynamicMinLen=this._config.enableDynamicMinLen,this._preloadManager=t,e.openLog&&a.Y.enable(),this._videoLoaders=[],this._audioLoaders=[],this._videoIdx=0,this._audioIdx=0;for(var l=0;l<this._loaderCount;l++){var f=new a.Y("".concat(u,"VideoLoader_").concat(l,"_").concat(this._config.vid),this._config.vid),h=new a.Y("".concat(u,"AudioLoader_").concat(l,"_").concat(this._config.vid),this._config.vid),p=new o.mf((0,n.Zj)((0,n.Zj)({},this._config),{},{logger:f,loaderType:this._loaderType})),v=new o.mf((0,n.Zj)((0,n.Zj)({},this._config),{},{logger:h,loaderType:this._loaderType}));this._videoLoaders.push(p),this._audioLoaders.push(v),this._videoSpeeds=[],p.on(s.K.REAL_TIME_SPEED,function(e){m=e.speed,r._cacheSpeed(e)}),v.on(s.K.REAL_TIME_SPEED,function(e){m=e.speed,r._cacheSpeed(e)}),this._videoReqCosts=[]}this._moofVideoLoader=new o.mf((0,n.Zj)((0,n.Zj)({},this._config),{},{loaderType:this._loaderType})),this._moofAudioLoader=new o.mf((0,n.Zj)((0,n.Zj)({},this._config),{},{loaderType:this._loaderType})),this._isSupportUrlRange="fetch"===this._loaderType,this._preloadCacheDatas={},this._reqCost={cdn:{count:0,avg:0},pcdn:{count:0,avg:0}}}return(0,n.qH)(x,[{key:"_cacheProgress",value:function(e,t){var r=t[e];if(r&&r.range&&r.done){var i=p.Z.generateRequestUniqueKey((0,n.Zj)((0,n.Zj)({},r.extData),{},{range:r.range}));if(!i)return;this._preloadCacheDatas[i]={duration:r.extData.segmentDuration,vtype:h.l0.DASH,res:r.data.buffer,mediaType:e,memory:r.data.byteLength,range:r.range,fileId:r.extData.fileId,rangeEnd:r.extData.rangeEnd,rangeStart:r.extData.rangeStart},u.ZP.log("cacheProgress",i,JSON.stringify(this._preloadCacheDatas[i]))}}},{key:"cachePreloadData",value:(e=(0,n.x)((0,n.l5)().mark(function e(t,r){var i,a,o;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.vid){e.next=2;break}return e.abrupt("return");case 2:if(this._cacheProgress("video",r),this._cacheProgress("audio",r),t.vtype=v.Z.vtype,i=Object.keys(this._preloadCacheDatas).length,!(this._preloadManager&&i>0)){e.next=11;break}return e.next=9,this._preloadManager.getItem(t,!0);case 9:(a=e.sent)?(o=Object.assign({},a,this._preloadCacheDatas),o=p.Z.combinePreloadData(o),this._preloadManager.setItem(t,o,!0)):this._preloadManager.setItem(t,this._preloadCacheDatas,!0);case 11:this._preloadCacheDatas={};case 12:case"end":return e.stop()}},e,this)})),function(t,r){return e.apply(this,arguments)})},{key:"isSupportedProgress",value:function(){return 1===this._loaderCount&&"fetch"===this._loaderType}},{key:"_addCost",value:function(e){this._videoReqCosts.push(e),this._videoReqCosts.length>3&&this._videoReqCosts.shift()}},{key:"_addVideoSpeed",value:function(e){this._videoSpeeds.push(e),this._videoSpeeds.length>3&&this._videoSpeeds.shift()}},{key:"checkProgressSatisfied",value:function(e){var t=!1;if(navigator.connection&&navigator.connection.downlink)return t=!0,!(5*e/(1e6*navigator.connection.downlink)>4)&&!0;if(!_(this._videoReqCosts,4))return!1;var r=this._videoSpeeds.map(function(t){return 5e3*t/e});if(!_(r,4))return!1;if(!t&&0===r.length)try{try{var n=parseFloat(c.Xb.getItem(l.OU))||0;if(0===n||5e3*n/e>4)return!1}catch(e){}}catch(e){}return!0}},{key:"_cacheSpeed",value:function(e){var t,r=e.speed;x.historySpeed.length>=20&&x.historySpeed.shift(),x.historySpeed.push(r),this.emit(s.K.REAL_TIME_SPEED,(0,n.Zj)({speed:r,type:(null==e||null===(t=e.priOptions)||void 0===t?void 0:t.type)||l._R.CDN},e))}},{key:"_calCostTime",value:function(e,t){var r=this._reqCost[e?"pcdn":"cdn"];t<3*r.avg&&(r.count++,r.avg=(r.avg*(r.count-1)+t)/r.count)}},{key:"getReqCost",value:function(e){var t=this._reqCost[e];return(null==t?void 0:t.avg)||0}},{key:"load",value:(t=(0,n.x)((0,n.l5)().mark(function e(t,r,i,a){var o,s,c,f,d,y,_,m,b,w,x,k,S,B,I,L,A,C,P,T,O,R,D,j,E,U,M=arguments;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=M.length>4&&void 0!==M[4]&&M[4],s=M.length>5&&void 0!==M[5]?M[5]:null,c=M.length>6&&void 0!==M[6]?M[6]:null,f=M.length>7&&void 0!==M[7]?M[7]:null,d=M.length>8&&void 0!==M[8]?M[8]:null,a.vtype=h.l0.DASH,a.isPreload=o,a.range=i,y={start:a.start,end:a.end,bandwidth:a.bandwidth||a.bitrate,sequence:a.idx,fps:a.fps,mediaType:t,selectedIdx:a.selectedIdx,definition:a.definition,range:i.concat(),startRaw:a.startRaw,endRaw:a.endRaw},_=this._config.onProcessMinLen,this._enableDynamicMinLen&&y.bandwidth&&s&&(m=0===a.start?.5:1,_=Math.floor(y.bandwidth*m/8)),!(this._preloadManager&&a.checkPreload)){e.next=25;break}if(b=p.Z.nowTime(),w=null,!this._preloadManager.supportSync()){e.next=18;break}w=this._preloadManager.getPreLoadDataSync(a),e.next=21;break;case 18:return e.next=20,this._preloadManager.getPreLoadData(a);case 20:w=e.sent;case 21:if(!(w&&w.res instanceof ArrayBuffer)){e.next=25;break}return u.ZP.log("changeState preload hit cache",w.cacheKey,"cost",p.Z.nowTime()-b,"ms","isPreload",o),s&&s(w.res,!0,{range:i,fromCache:!0},null,a),e.abrupt("return",{res:w.res,headers:w.headers,status:w.status,fromCache:!0,selectedIdx:a.selectedIdx,extData:y,orgDefinition:w.orgDefinition,cacheKey:w.cacheKey,duration:w.duration});case 25:if(x=a.isPCDN,k=(!s||this._isSupportUrlRange)&&(this._config.useUrlRange||a.useUrlRange||!1)&&!x,S=r,k&&i&&i.length>1&&(S="".concat(r+(r.split("?")[1]?"&":"?"),"range=").concat(i[0],"-").concat(i[1])),(!i||0===i.length||k)&&(i=void 0),B=performance.now(),u.ZP.log(this._config.vid,"load res start:",JSON.stringify(a),"startTime",B,"userUrlRange",k,"onProgress",!!s,"onProcessMinLen",_),e.prev=33,L=this._getLoader(t,a)){e.next=37;break}return e.abrupt("return");case 37:return A=this._config.headers||{},C=a.reqOptions||{},e.next=41,L.load(S,(0,n.Zj)({range:i,onProgress:s,selectedIdx:a.selectedIdx,sequence:a.idx,initSegment:a.initSegment,onProcessMinLen:_,onCancel:c,timeout:f,onTimeout:d,headers:x?Object.assign({},A,{"X-Origin-Server-Host":a.cdnHost}):A,priOptions:{type:x?l._R.PCDN:l._R.CDN,extData:a}},C));case 41:if(P=e.sent){e.next=44;break}return e.abrupt("return",null);case 44:return"video"===t&&this._addCost((performance.now()-B)/1e3),T=P.data,O=P.response,R={res:T instanceof Uint8Array?T.buffer:T,headers:g(O.headers),status:O.status,duration:a.end-a.start||0,memory:T.byteLength,vtype:v.Z.vtype,mediaType:t,costTime:0,range:i,isInitSegment:a.initSegment,fileId:a.fileId},D=performance.now()-B,u.ZP.log("load res finish: ",JSON.stringify(a),"cost time",D,"ms","range",null===(I=R.headers)||void 0===I?void 0:I["content-range"]),this._calCostTime(x,D),a.checkPreload&&!T.done&&this._needPreloadCache&&(j=p.Z.generateRequestUniqueKey(a),this._preloadCacheDatas[j]=R),e.abrupt("return",(0,n.Zj)((0,n.Zj)({},R),{},{extData:y,selectedIdx:a.selectedIdx,isPCDN:x,costTime:D,url:r}));case 54:return e.prev=54,e.t0=e.catch(33),u.ZP.log("loader error",{msg:e.t0.message}),e.abrupt("return",{res:"error",status:null===(E=e.t0.response)||void 0===E?void 0:E.status,header:g(null===(U=e.t0.response)||void 0===U?void 0:U.headers),error:e.t0,isPCDN:x,url:S,bitrate:a.bandwidth||y.bandwidth,costTime:-1});case 58:case"end":return e.stop()}},e,this,[[33,54]])})),function(e,r,n,i){return t.apply(this,arguments)})},{key:"_getLoader",value:function(e,t){var r="video"===e;if(t.moof)return r?this._moofVideoLoader:this._moofAudioLoader;if(t.initSegment){var n=r?this._moofVideoLoader:this._moofAudioLoader;if(n&&null!==n._currentTask)return n}if(r){var i=this._videoLoaders[this._videoIdx];return this._videoIdx++,this._videoIdx>=this._videoLoaders.length&&(this._videoIdx=0),i}var a=this._audioLoaders[this._audioIdx];return this._audioIdx++,this._audioIdx>=this._audioLoaders.length&&(this._audioIdx=0),a}},{key:"cancel",value:(r=(0,n.x)((0,n.l5)().mark(function e(t){var r;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return r="video"===t?this._videoLoaders:this._audioLoaders,e.next=4,this.cancelLoaders(r);case 4:e.next=10;break;case 6:return e.next=8,this.cancelLoaders(this._audioLoaders);case 8:return e.next=10,this.cancelLoaders(this._videoLoaders);case 10:if(!this._moofVideoLoader){e.next=13;break}return e.next=13,this._moofVideoLoader.cancel();case 13:if(!this._moofAudioLoader){e.next=16;break}return e.next=16,this._moofAudioLoader.cancel();case 16:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"cancelLoaders",value:(f=(0,n.x)((0,n.l5)().mark(function e(t){var r,i,a;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=(0,n.sf)(t),e.prev=1,r.s();case 3:if((i=r.n()).done){e.next=9;break}return a=i.value,e.next=7,a.cancel();case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),r.e(e.t0);case 14:return e.prev=14,r.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])})),function(e){return f.apply(this,arguments)})},{key:"getCurrentTask",value:function(e){var t="video"===e,r=t?this._moofVideoLoader:this._moofAudioLoader,n=t?this._videoLoaders[0]:this._audioLoaders[0];return(null==r?void 0:r._currentTask)||(null==n?void 0:n._currentTask)}},{key:"cancelTasks",value:(b=(0,n.x)((0,n.l5)().mark(function e(t){var r,i,a,o,s=arguments;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>1&&void 0!==s[1]&&s[1],a=(i="video"===t)?this._moofVideoLoader:this._moofAudioLoader,o=i?this._videoLoaders[0]:this._audioLoaders[0],!a){e.next=7;break}return e.next=7,this._filterTask(a,r);case 7:if(!o){e.next=10;break}return e.next=10,this._filterTask(o,r);case 10:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)})},{key:"_filterTask",value:(w=(0,n.x)((0,n.l5)().mark(function e(t,r){var i,a,o,s,u,c,l,f;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(i=[],a=t._queue,r&&t._currentTask&&i.push(t._currentTask.cancel()),o=a.length-1;o>-1;o--)l=null===(s=(c=a[o]).priOptions)||void 0===s||null===(s=s.extData)||void 0===s?void 0:s.isInitSegment,f=null===(u=c.priOptions)||void 0===u||null===(u=u.extData)||void 0===u?void 0:u.isSlice,!(l||f)&&(i.push(c.cancel()),a.splice(o,1));return e.next=6,Promise.all(i);case 6:case"end":return e.stop()}},e)})),function(e,t){return w.apply(this,arguments)})},{key:"destroy",value:function(){this.cancel();for(var e=0;e<this._videoLoaders.length;e++){var t=this._videoLoaders[e];t&&t.removeAllListeners();var r=this._audioLoaders[e];r&&r.removeAllListeners()}this._moofAudioLoader&&this._moofAudioLoader.removeAllListeners(),this._moofVideoLoader&&this._moofVideoLoader.removeAllListeners(),this._audioLoaders=[],this._videoLoaders=[]}}],[{key:"currentSpeed",get:function(){return m}},{key:"historyAvspeed",get:function(){var e=x.historySpeed.reduce(function(e,t){return e+t},0);return 0===x.historySpeed.length?0:e/x.historySpeed.length}}])}();b.historySpeed=[]},126609:function(e,t,r){r.d(t,{Z:function(){return g}});var n=r(22450);r(836654),r(269707),r(691842),r(511141),r(464135),r(891555),r(499953),r(469577),r(429532),r(98601),r(110617),r(304095),r(675373),r(914613),r(742611),r(874386);var i=r(246451),a=r(288950),o=r(546041),s=r(262416),u=r(382541),c=r(118608),l=r(180893),f=r(258817),d=r(906579),h=r(749517),p=r(119106),v=r(720556),g=function(e){var t,r,a,d,g,y,_;function m(e,t){var r;return(0,n.PA)(this,m),(r=(0,n.$w)(this,m,[e,t]))._loader=new l.Z({loaderCount:1,loaderType:u.t.XHR},e,"preloader",t.needPreloadCache),r._loader.on(o.kW,function(t){if((null==t?void 0:t.len)>0){var n,i,a=(null==t||null===(n=t.priOptions)||void 0===n?void 0:n.type)||o._R.CDN,s=Math.round(8e3*t.len/t.time/1024),u=null==t?void 0:t.priOptions.extData,c=u.cacheKey,l=null===(i=r._pendingItem)||void 0===i?void 0:i.duration,f={vid:u.vid,loadType:a,size:t.len,speed:s,cacheKey:c,vtype:o.l0.DASH,duration:l,bitrate:u.bitrate,range:t.range,mediaType:u.mediaType,format:o.l0.DASH,segmentDuration:null==u?void 0:u.segmentDuration};e.bwEventEmit(f)}}),r.options=t,r._pendingTask=null,r}return(0,n.XW)(m,e),(0,n.qH)(m,[{key:"_setItem",value:(t=(0,n.x)((0,n.l5)().mark(function e(t,r){var i,a;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.vtype=o.l0.DASH,e.next=3,this.preloadManager.getItem(t,!0);case 3:(i=e.sent)?(a=Object.assign({},i,r),a=f.Z.combinePreloadData(a),this.preloadManager.setItem(t,a,!0)):this.preloadManager.setItem(t,r,!0);case 5:case"end":return e.stop()}},e,this)})),function(e,r){return t.apply(this,arguments)})},{key:"_processItemUrl",value:function(e){this.preloadManager.preProcessUrl&&(e.main_url=this.preloadManager.preProcessUrl(e.main_url).url,e.backup_url_1=this.preloadManager.preProcessUrl(e.backup_url_1).url,e.fallback_url=this.preloadManager.preProcessUrl(e.fallback_url).url)}},{key:"_getDashContext",value:function(e){var t=this,r=e.payload;if("TOP"===e.playInfoType){var n={dashOpts:e.payload};(0,p.NK)(n),r=n.dashOpts.dynamic_video}if(Array.isArray(r)){var i={dashOpts:{Data:e,dynamic_video:e}};(0,p.LY)(i),r=i.dashOpts.dynamic_video}return r.dynamic_video_list&&r.dynamic_video_list.forEach(function(e){e.bitrate=e.real_bitrate||e.bitrate,t._processItemUrl(e)}),r.dynamic_audio_list&&r.dynamic_audio_list.forEach(function(e){e.bitrate=e.real_bitrate||e.bitrate,t._processItemUrl(e)}),{dynamic_video:r}}},{key:"_getStartContext",value:function(){return{mediaInfos:{dynamic_video_list:[],dynamic_audio_list:[]},vtype:"",video:{segments:[]},audio:{segments:[]}}}},{key:"_cacheInitSegments",value:(r=(0,n.x)((0,n.l5)().mark(function e(t,r,i,a){var o,s,u,c,l,f,d;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.mediaList.video||[],s=t.mediaList.audio||[],u=[],s&&s.length>0&&(c=this.makeInitBaseSegemntRequest(t,r.duration,"audio",s.selectedIdx,void 0,r.vid),u.push(c)),o&&o.length>0&&(l=this._calVideoItemIdx(o,a.bandwidth)||0,f=o[l].definition,d=this.makeInitBaseSegemntRequest(t,r.duration,"video",l,f,r.vid),u.push(d)),e.next=7,Promise.all(u);case 7:e.sent.forEach(function(e){"video"===e.data.mediaType&&(e.data.orgDefinition=a.orgDefinition),i[e.key]=e.data});case 9:case"end":return e.stop()}},e,this)})),function(e,t,n,i){return r.apply(this,arguments)})},{key:"start",value:(a=(0,n.x)((0,n.l5)().mark(function e(t,r){var i,a,o,u,l,f,d,g,y,_,m,b,w,x,k,S,B,I,L,A,C,P,T,O,R,D,j,E,U,M,N,F,Z,q,H,W,V,K,z,X,Y,J,G,Q,$,ee,et,er,en,ei,ea=this;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(i=Promise.withResolvers()).resolve,o=i.promise,u={},this._pendingTask={resolve:a,data:t,map:u},l=new s.XK,f=this._getDashContext(t),d=new c.Z("anytext",f,this),g=this._getStartContext(),y=function(){g.mediaInfos.dynamic_video_list=d.mediaList.video||[],g.mediaInfos.dynamic_audio_list=d.mediaList.audio||[],l.resolve(g)},d.once("ready",y),d.init(),e.next=12,l;case 12:if(this._pendingTask){e.next=16;break}return _=this.isStepWise(),a({remove:!_}),e.abrupt("return",o);case 16:if(m=new s.XK,b=g.mediaInfos,w=this._getIdx(b.dynamic_video_list,r||t.defaultDefinition),x=b.dynamic_video_list[w]||b.dynamic_video_list[0],b.dynamic_video_list[w]&&d.mediaList.audio&&b.dynamic_audio_list.length>0&&(d.mediaList.video.selectedIdx=w,-1===(k=(0,p.Ft)(d.mediaList.video,d.mediaList.audio))&&(k=0),h.ZP.log("audio definition preload",k),d.mediaList.audio.selectedIdx=k),t.dashType=d.dashType,!(null!==(en=this.options)&&void 0!==en&&null!==(en=en.pcdnConfig)&&void 0!==en&&en.openPreloadPCDN&&null!==(ei=this.options)&&void 0!==ei&&null!==(ei=ei.pcdnConfig)&&void 0!==ei&&ei.openDASHPreloadPCDN&&"segment_template"!==d.dashType)){e.next=38;break}if(S=this.options.pcdnConfig,!((B=f.dynamic_video.dynamic_video_list.filter(function(e){return e.definition===x.definition}))&&B.length>0)){e.next=38;break}if(L=(I=B[0]).duration,A=I.uri,this._pcdn?this._pcdn.updateConfig("video",{vid:A,duration:L}):(C={pcdnConfig:S},this._pcdn=new v.Z({config:C,isOpenPCDN:!0,videoDuration:L,uri:A},null)),!b.dynamic_video_list[w]){e.next=32;break}return!x.bitrate&&(x.bitrate=x.bandwidth),e.next=32,this._pcdn.openPCDNForce(x.bitrate||x.bandwidth,(0,n.Zj)({mediaType:"video"},x));case 32:if(!(d.mediaList.audio&&b.dynamic_audio_list.length>0)){e.next=38;break}return!(T=(P=d.mediaList.audio)[P.selectedIdx]).bitrate&&(T.bitrate=T.bandwidth),e.next=38,this._pcdn.openPCDNForce(T.bitrate||T.bandwidth,(0,n.Zj)({mediaType:"audio"},T));case 38:if(this._pendingItem=x,!this._pendingItem.duration&&(this._pendingItem.duration=t.duration),O={bandwidth:x.bitrate||x.bandwidth,time:t.startTime||0,orgDefinition:x.orgDefinition,hasSegmentRange:!1},R=[],D=this.isStepWise(),e.prev=43,M=void 0===t.video||(null===(j=t.video.segments)||void 0===j?void 0:j.length)===0,void 0===t.stepIdx&&(t.stepIdx=0),void 0===t.steps&&(t.steps=[0]),!D&&(t.steps=[0]),!(0===t.stepIdx||M)){e.next=71;break}if("segment_template"!==d.dashType){e.next=54;break}this._calRequests(d,O,m,t,!0),m.resolve(),e.next=69;break;case 54:if(0!==t.stepIdx){e.next=68;break}if(q=!1,(null==(H=d.mediaList)||null===(N=H.video)||void 0===N?void 0:N.length)>0&&(null==H||null===(F=H.audio)||void 0===F?void 0:F.length)>0&&(q=H.video[H.video.selectedIdx].firstMoofMdatRange&&H.audio[H.audio.selectedIdx].firstMoofMdatRange),!(!D&&q&&null!==(Z=this.options)&&void 0!==Z&&Z.useSegmentRange)){e.next=63;break}t.hasSegmentRange=!0,this._requestAcc(d,O,m,t),e.next=66;break;case 63:return e.next=65,this._cacheInitSegments(d,t,u,O);case 65:this._calRequests(d,O,m,t);case 66:e.next=69;break;case 68:m.resolve([]);case 69:e.next=72;break;case 71:m.resolve([]);case 72:return e.next=74,m;case 74:if(R=e.sent,0===(W=D?t.stepIdx:0)&&this._setItem(t,u),this._pendingTask){e.next=80;break}return a({remove:!D}),e.abrupt("return",o);case 80:D&&(z=t.steps.length,z<(X=Math.max(null===(V=t.video)||void 0===V?void 0:V.segments.length,null===(K=t.audio)||void 0===K?void 0:K.segments.length))&&(J=Array(X-z).fill(1),(Y=t.steps).push.apply(Y,(0,n.u)(J)))),G=[null===(E=t.video)||void 0===E?void 0:E.segments[W],null===(U=t.audio)||void 0===U?void 0:U.segments[W]],Q=(R||[]).concat(G).filter(function(e){return!!e}),$=[],ee=(0,n.sf)(Q),e.prev=85,er=(0,n.l5)().mark(function e(){var r,i,a,o,s;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=(r=et.value).url,a=r.range,o=r.extData,s=ea._getData(i,a,o).then(function(e){"video"===e.mediaType&&(e.orgDefinition=O.orgDefinition),!e.fromCache&&(u[o.cacheKey]=e,h.ZP.log("prelaoder setItem",t,u),ea._setItem(t,u))}),$.push(s);case 4:case"end":return e.stop()}},e)}),ee.s();case 88:if((et=ee.n()).done){e.next=92;break}return e.delegateYield(er(),"t0",90);case 90:e.next=88;break;case 92:e.next=97;break;case 94:e.prev=94,e.t1=e.catch(85),ee.e(e.t1);case 97:return e.prev=97,ee.f(),e.finish(97);case 100:return e.next=102,Promise.all($);case 102:e.next=107;break;case 104:e.prev=104,e.t2=e.catch(43);case 107:return e.prev=107,a({remove:!D}),e.finish(107);case 110:return this._pendingTask=null,e.abrupt("return",o);case 112:case"end":return e.stop()}},e,this,[[43,104,107,110],[85,94,97,100]])})),function(e,t){return a.apply(this,arguments)})},{key:"isStepWise",value:function(){var e=this.options.openStepwiseType;return this.stepwise&&(void 0===e||e.toUpperCase()===o.l0.DASH)}},{key:"_getIdx",value:function(e,t){var r=0;return e.forEach(function(e,n){e.definition===t&&(r=n)}),r}},{key:"_calRequests",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=[],o=t.bandwidth,s=e.mediaList.video||[],u=e.mediaList.audio||[],c=n.vid,l=e.videoCodecType;if(u&&u.length>0){var f=u.selectedIdx;u[f].codec_type=l;var d=this._calUrls(u[f],"audio",c,null,i,n);a=a.concat(d)}if(s&&s.length>0){var h=this._calVideoItemIdx(s,o)||0,p=s[h];p.codec_type=l;var v=this._calUrls(p,"video",c,p.definition,i,n);a=a.concat(v)}a.length,r.resolve(a)}},{key:"_getSplitGopRange",value:function(e,t,r){var i=e.segment,a=i.range;if(!e.isStep){var o=i.range[1],s=i.range[0];return{allRangeItems:[{item:i,range:a,segmentDuration:i.endRaw-i.startRaw,rangeEnd:o,rangeStart:s}],newSteps:t}}var u=[],c=[],l,f=(0,n.sf)(t);try{for(f.s();!(l=f.n()).done;){var d=l.value;if(d>=i.endRaw){c.push(i.endRaw);break}c.push(d)}}catch(e){f.e(e)}finally{f.f()}var p=void 0===this.options.needfixSizeSegment||this.options.needfixSizeSegment;p&&c.length>0&&c[c.length-1]<i.endRaw&&(c.push(i.endRaw),h.ZP.log("repload change steps"));for(var v=a[0],g=0,y=c.length,_=i.range[1],m=0;m<c.length;m++){var b,w=c[m],x=v,k=p?g===c.length-1:w>=i.endRaw,S=Math.floor(w*r/8)+a[0]+1,B=k?null===(b=i.range)||void 0===b?void 0:b[1]:S-1;v=B+1;var I=B>=_;if(a=[x,I?_:B],x>=B)break;u.push({item:i,range:a,segmentDuration:I?i.endRaw:w,rangeEnd:i.range[1],rangeStart:i.range[0]}),g++}return g<y&&c.splice(g,y-g),{allRangeItems:u,newSteps:c}}},{key:"_recalcSteps",value:function(e,t){var r=0,i=!1,a=[],o,s=(0,n.sf)(t);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=e[r],l=e[e.length-1],f=u.endRaw;if(u.startRaw<=c&&l<f&&!i)for(;r<e.length;)a.push({stepTime:e[r],segment:u,isStep:!0}),r++;else for(;r<e.length;){var d=e[r],h=e[r+1];if(d<u.endRaw&&h<u.endRaw)r++;else{r++,a.push({stepTime:u.endRaw,isStep:!1,segment:u}),i=!0;break}}if(r>=e.length)break}}catch(e){s.e(e)}finally{s.f()}return a}},{key:"_getRange",value:function(e,t){var r=e.mediaSegments,i=t.steps.map(function(e){return e+0}),a=this._recalcSteps(i,r),o=[],s="segment_template"===t.dashType;if((null===(c=t.steps)||void 0===c?void 0:c.length)>0&&(null===(l=t.steps)||void 0===l?void 0:l[0])>0&&!s){if(a[0].isStep){var u=this._getSplitGopRange(a[0],t.steps,e.bandwidth).allRangeItems;o.push.apply(o,(0,n.u)(u))}else{var c,l,f,d=(0,n.sf)(a);try{for(d.s();!(f=d.n()).done;){var h=f.value,p=this._getSplitGopRange(h,t.steps,e.bandwidth).allRangeItems;o.push.apply(o,(0,n.u)(p))}}catch(e){d.e(e)}finally{d.f()}}}else{var v=a[0].segment,g=v.range,y=v.range[0],_=v.range[1];o.push({item:v,range:g,segmentDuration:v.endRaw-v.startRaw,rangeEnd:_,rangeStart:y})}return o}},{key:"_calUrls",value:function(e,t,r,i,a,o){var s=[];if(e){var u=e.avg_bitrate||e.bandwidth||e.bitrate,c=m.vtype;!o[t]&&(o[t]={initSegment:null,segments:[]});var l=o[t];if(a){var d,h,p=[null===(d=e.initSegmentRange)||void 0===d?void 0:d[0],null===(h=e.sidxRange)||void 0===h?void 0:h[1]],v={url:e.initSegment,range:p,extData:{cacheKey:f.Z.generateRequestUniqueKey({vid:r,mediaType:t,codecType:e.codec_type,vtype:c,bitrate:u,fileId:e.fileId,range:p,definition:i}),vid:r,vtype:c,isInitSegment:!0,mediaType:t,useUrlRange:f.Z.validateUrlRange(this.options.url_range_domains,e.initSegment),codecType:e.codec_type,range:p,bitrate:u,segmentDuration:0,checkPreload:!0}};s.push(v),l.initSegment=v}var g=[];if(o.hasSegmentRange){var y=e.firstMoofMdatRange[0],_=e.firstMoofMdatRange[1];g=[{item:{start:0,end:7,url:e.initSegment},range:[y,_],segmentDuration:7,rangeEnd:_,rangeStart:y}]}else g=this._getRange(e,o);var b,w=(0,n.sf)(g);try{for(w.s();!(b=w.n()).done;){var x=b.value,k=x.item,S=x.range,B=x.segmentDuration,I=x.rangeEnd,L=x.rangeStart,A=f.Z.generateRequestUniqueKey({vid:r,mediaType:t,codecType:e.codec_type,vtype:c,start:k.start,end:k.end,definition:i,bitrate:u,fileId:e.fileId,range:S});l.segments.push({url:k.url,range:S,extData:{cacheKey:A,vid:r,vtype:c,isInitSegment:!1,mediaType:t,useUrlRange:f.Z.validateUrlRange(this.options.url_range_domains,k.url),codecType:e.codec_type,range:S,bitrate:u,segmentDuration:B,checkPreload:!0,rangeEnd:I,rangeStart:L,fileId:e.fileId}})}}catch(e){w.e(e)}finally{w.f()}}return s}},{key:"_requestAcc",value:function(e,t,r,n){this._calRequests(e,t,r,n,!0)}},{key:"_calStartEnd",value:function(e,t){for(var r=-1,n=0;n<e.length;n++){var i=e[n],a=t||0;if(i.start>=a&&a<i.end){r=n;break}}return -1===r&&(r=0),r}},{key:"_calVideoItemIdx",value:function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n&&n.bandwidth===t)return r}return null}},{key:"_getData",value:(d=(0,n.x)((0,n.l5)().mark(function e(t,r,i){var a,o,s,u,c,l,f,d,p,v,g;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=t,this._pcdn&&(s=i.mediaType,u=i.bitrate,(c=this._pcdn.selectedPCDN(s,!1,u))&&(t=c,i.isPCDN=!0,h.ZP.log("preload _pcdn",c,i.mediaType,i.bitrate))),i.reqOptions=this.getRequestOption(null===(a=this._pendingTask)||void 0===a?void 0:a.data.reqOptions),e.next=6,this._loader.load(i.mediaType,t,r,i,!0);case 6:if(l=e.sent,!(i.isPCDN&&"error"===l.res)){e.next=13;break}return i.isPCDN=!1,e.next=11,this._loader.load(i.mediaType,o,r,i,!0);case 11:l=e.sent;case 13:return d=(f=l).res,p=f.headers,v=f.status,g=f.fromCache,e.abrupt("return",{res:d,headers:p,status:v,fromCache:g,memory:d.byteLength,vtype:m.vtype,mediaType:i.mediaType,duration:i.segmentDuration,orgDefinition:void 0,range:r,rangeEnd:i.rangeEnd,rangeStart:i.rangeStart,fileId:i.fileId});case 17:return e.prev=17,e.t0=e.catch(0),e.abrupt("return",{res:null});case 21:case"end":return e.stop()}},e,this,[[0,17]])})),function(e,t,r){return d.apply(this,arguments)})},{key:"makeInitBaseSegemntRequest",value:function(e,t,r,n,i,a){var o=this,u=new s.XK,c=e.mediaList[r][n],l=[c.initSegmentRange[0],c.sidxRange[1]],d=c.initSegment,h=e.videoCodecType,p=c.avg_bitrate||c.bandwidth||c.bitrate,v=m.vtype,g={checkPreload:!0,mediaType:r,vid:a,definition:i,useUrlRange:!1,timeout:-1,isInitSegment:!0,bitrate:p,codecType:h,fileId:c.fileId,cacheKey:f.Z.generateRequestUniqueKey({vid:a,codecType:h,mediaType:r,definition:i,vtype:v,bitrate:p,fileId:c.fileId,range:l})};return this._getData(d,l,g).then(function(i){var s=i.res;s&&"error"!==s?o.handleInitData(s,l,c.sidxRange).then(function(o){if(o.sidxSegmentRes&&e.getSidx(o.sidxSegmentRes,r,n,t),f.Z.validateFragment(o.initSegmentRes,l)){var s=Object.assign({},i,{vid:a,mediaType:r,isInitSegment:!0,vtype:v});u.resolve({key:g.cacheKey,data:s})}else u.reject({mediaType:r,index:n,initSegmentRange:l,url:d,rejected:!0})}).catch(function(){u.reject({mediaType:r,index:n,initSegmentRange:l,url:d,rejected:!0})}):u.reject({mediaType:r,index:n,initSegmentRange:l,url:d,rejected:!0})}).catch(function(){u.reject({mediaType:r,index:n,initSegmentRange:l,url:d,rejected:!0})}),u}},{key:"handleInitData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=new s.XK;if(e instanceof ArrayBuffer){var i=0===t.length?e:e.slice(t[0],t[1]+1),a=null===r?null:e.slice(r[0],r[1]+1);n.resolve({initSegmentRes:i,sidxSegmentRes:a})}return n}},{key:"cancel",value:(g=(0,n.x)((0,n.l5)().mark(function e(){var t,r,i,a;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._loader){e.next=3;break}return e.next=3,this._loader.cancel();case 3:this._pendingTask&&(r=(t=this._pendingTask).data,i=t.map,a=this.isStepWise(),this._pendingTask.resolve({remove:!a}),Object.values(i).length>0&&this._setItem(r,i),this._pendingTask=null);case 4:case"end":return e.stop()}},e,this)})),function(){return g.apply(this,arguments)})},{key:"getPreLoadDataSync",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=f.Z.generateRequestUniqueKey(e),i=this.preloadManager.getItemSync(e,t),a=this.preloadManager.getLoadInfoAndDelete(r);return(0,n.Zj)((0,n.Zj)({cacheKey:r},i),{},{loadInfo:a})}},{key:"getPreLoadData",value:(y=(0,n.x)((0,n.l5)().mark(function e(t){var r,i,a,o,s=arguments;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]&&s[1],i=f.Z.generateRequestUniqueKey(t),e.next=4,this.preloadManager.getItem(t,r);case 4:return a=e.sent,o=this.preloadManager.getLoadInfoAndDelete(i),e.abrupt("return",(0,n.Zj)((0,n.Zj)({cacheKey:i},a),{},{loadInfo:o}));case 7:case"end":return e.stop()}},e,this)})),function(e){return y.apply(this,arguments)})},{key:"destroy",value:(_=(0,n.x)((0,n.l5)().mark(function e(){var t;return(0,n.l5)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:null===(t=this._loader)||void 0===t||t.destroy(),this._loader=null,this._pcdn&&(this._pcdn=null);case 3:case"end":return e.stop()}},e,this)})),function(){return _.apply(this,arguments)})},{key:"parseKey",value:function(e){var t,r,a=(0,n.sf)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=i.s.parseKey(o);"audio"===s.mediaType?s.hasAudio=!0:(s.hasVideo=!0,t=Object.assign({},t,s))}}catch(e){a.e(e)}finally{a.f()}return t}},{key:"taskInProgress",get:function(){return!!this._pendingTask.resolve&&!!this._pendingTask.data}}],[{key:"vtype",get:function(){return o.l0.DASH}},{key:"isUniqueCache",value:function(e){return!!e&&(4===Object.keys(e).length||!1)}},{key:"generateUniqueKey",value:function(e){return f.Z.generateRequestUniqueKey(e)}}])}(a.d);g.encryptUtils=d},35345:function(e,t,r){function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{$w:function(){return i},Kd:function(){return h},PA:function(){return a},XW:function(){return c},Zj:function(){return d},qH:function(){return s},u:function(){return v}});function i(e,t,r){return t=u(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,l()?Reflect.construct(t,r||[],u(e).constructor):t.apply(e,r))}function a(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(l=function(){return!!e})()}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach(function(t){var n,i,a;n=e,i=t,a=r[t],(i=g(i))in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function h(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&({}).propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}},668060:function(e,t,r){r.d(t,{N:function(){return a}});var n=r(574933);r(836654),r(691842),r(910795),r(511141),r(464135),r(981168),r(469577),r(429532),r(98601),r(110617),r(250440),r(769308),r(329913),r(868352),r(17322),r(63249),r(950665),r(180138),r(911234),r(387605),r(936097),r(786120),r(339597),r(877193),r(391375),r(632637),r(645524),r(800599),r(69896),r(660999),r(12946),r(416555),r(747644),r(404948),r(789680);var i={buffer:60,bbaControl:!1,bbaControl_2:!1,highLevel:15,lowLevel:7,bolaControl:!1,abrAgloType:0,hurryBuffer:-1,dangerBuffer:-1,safeBuffer:-1,safeThreshold:-1,safeFactor:.9,dangerFactor:.8,minSafeFactor:.7,minDangerFactor:.4,safeFactorChange:.05,dangerFactorChange:.1,rebufferDegrade:0,safeUpgrade:0,safeRebufferDegrade:0,hurryForseLowest:0,maxPlaySpeed:1,screen_factor:-1},a=(0,n.qH)(function e(t){(0,n.PA)(this,e),this._playInfo={playbackRate:1,maxCacheTimeAudio:0,maxCacheTimeVideo:0,buffer:0,downloadSpeed:0,seekState:0,currentTime:0,stallState:0,segmentBufferEnd:0},this._sortedMediaInfos={v_adaptation:[]},this.HEAP32=new Int32Array(7),this._debugMode=!1,this._currentBitrateIdx=-1,this._lastpredictTime=0,this._algoArg={buffer:60,bbaControl:!1,highLevel:15,lowLevel:7,bolaControl:!0,limitFirstUpSwitch:-1,limitFirstDownSwitch:-1,limitUpSwitchAfterUpSwitch:-1,limitUpSwitchAfterDownSwitch:-1,minUpSwitchPosition:-1,minDownSwitchPosition:-1,maxUpSwitchCount:-1,maxDownSwitchCount:-1,maxSwitchCount:-1,maxUpSwitchLevel:-1,maxDownSwitchLevel:-1,downSwitchType:-1,debugMode:0,debug_mode_3_interval:3,debug_mode_4_interval:10,libra_abr_version:0,max_debug_mode_2_change:0,abrAgloType:0,hurryBuffer:-1,dangerBuffer:-1,safeBuffer:-1,safeThreshold:-1,safeFactor:.9,dangerFactor:.8,minSafeFactor:.7,minDangerFactor:.4,safeFactorChange:.05,dangerFactorChange:.1,rebufferDegrade:0,safeUpgrade:0,safeRebufferDegrade:0,hurryForseLowest:0,maxPlaySpeed:1,screen_factor:-1},this._seekState=0,this._isSeekedPredict=!1,this._stat={buffer:0,target_birate:0,b_seek:!1,is_upper:!1,bitrate_list:"",video_quality_list:"",num_abr_call:0,download_position:-1,calc_bitrate:-1,change_level:-1,last_level:-1,target_level:-1,last_bitrate:-1,diff_download_position:-1,diff_buffer:-1,abr_time:-1,diff_abr_time:-1,hit_limitbitrate:0,dangerFactor:-1,safeFactor:-1,abrDownloadSpeed:0,hitSrRule:0,last_video_quality:-1,target_video_quality:-1,screen_factor:-1},this.numAbrCall=0,this.upSwitchCount=0,this.downSwitchCount=0,this.lastUpSwitch=-1,this.lastDownSwitch=-1,this.downloadPosition=-1,this.gopSize=-1,this._cacheBitrate=-1,this._prevDownloadPosition=-1,this._prevBuffer=-1,this._prevCurrentPosition=-1,this._abrStartTime=0,this._prevAbrStartTime=0,this._firstLevelIdx=0,this._dropFrameCount=0,this._currentDropFrameRate=0,this._maxBitrate=-1,this._isCurrentSafeBuffer=!1,this._hasSafeRebufferDegrade=!1,this._config=t,this._algoArg=Object.assign({},i,t.algoArg),this.onRuntimeInitialized(),this._dangerFactor=this._algoArg.dangerFactor,this._safeFactor=this._algoArg.safeFactor,this._maxSafeFactor=this._safeFactor,this._maxDangerFactor=this._dangerFactor},[{key:"onRuntimeInitialized",value:function(){this._config.promise.resolve()}},{key:"_setDebugModel",value:function(e){this._debugMode=e}},{key:"_logger",value:function(){if(this._debugMode){for(var e,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];console&&(e=console).log.apply(e,["SAlgo"].concat(r))}}},{key:"_getPreloadBitrate",value:function(e){return null}},{key:"_updateDeviceInfo",value:function(e,t,r,n){this._videoHeight=t,this._videoWidth=e,this._devicePixelRatio=r,this._fps=n}},{key:"_updateSeekInfo",value:function(e){this._seekState=e,this._isSeekedPredict=!0}},{key:"_updateBufferInfo",value:function(e,t,r,n,i,a,o,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:-1;this._playInfo={playbackRate:e,maxCacheTimeAudio:t,maxCacheTimeVideo:r,buffer:n,downloadSpeed:a,seekState:o,currentTime:s,stallState:u,segmentBufferEnd:i},this._maxBitrate=c}},{key:"updateDropFrame",value:function(e){this._currentDropFrameRate=e}},{key:"_updateSwitchInfo",value:function(e,t,r,n,i,a){}},{key:"_getPredictedBitrate",value:function(){var e=0,t=this._getMethodName();if(!t)return this.HEAP32[e]=-1,this._logger("abr method not found"),e;if(-1===this._currentBitrateIdx){this._logger("getPredictedBitrate _cacheBitrate",this._cacheBitrate);for(var r=this._sortedMediaInfos.v_adaptation,n=0;n<r.length;n++)if(r[n].bandwidth===this._cacheBitrate){this._currentBitrateIdx=n,this._firstLevelIdx=n;break}}-1===this._currentBitrateIdx&&(this._currentBitrateIdx=0,this._firstLevelIdx=0,this._logger("getPredictedBitrate fix idx")),0===this._abrStartTime&&(this._abrStartTime=performance.now());var i=this._algoArg,a=i.bbaControl,o=i.bbaControl_2,s=i.libra_abr_version,u=i.bolaControl;if(a||o&&1>=s||u){var c=this[t]().predictedBitrate;this.HEAP32[e]=c}else this.HEAP32[e]=0;return e++,this.HEAP32[e]=0,e++,this.HEAP32[e]=0,0}},{key:"_getMethodName",value:function(){var e="";return(this._algoArg.bbaControl||this._algoArg.bbaControl_2)&&(e="_getBitrateBBA"),this._algoArg.bolaControl&&(e="_getBitrateBOLA"),e}},{key:"_getBitrateBOLA",value:function(){return{predictedBitrate:0,predictSpeed:0}}},{key:"_doBufferControl",value:function(e,t){var r=this._algoArg,n=r.highLevel,i=r.lowLevel,a=-1;if(e>=n)this._currentBitrateIdx=t.length-1,a=t[this._currentBitrateIdx].bandwidth;else if(e<=i)this._currentBitrateIdx=0,a=t[this._currentBitrateIdx].bandwidth;else{var o=t[t.length-1].bandwidth-t[0].bandwidth,s=o/(n-i)*(e-i)+t[0].bandwidth;a=s;for(var u=t.length-1;u>-1;u--)if(s>=t[u].bandwidth){this._currentBitrateIdx=u;break}s>=t[t.length-1].bandwidth?this._currentBitrateIdx=t.length-1:s<=t[0].bandwidth&&(this._currentBitrateIdx=0),this._logger("bola mid",this._currentBitrateIdx,s,"chose",t[this._currentBitrateIdx].bandwidth)}return{calc_bitrate:a}}},{key:"_getCalcPlayrate",value:function(){return Math.min(Math.max(this._playInfo.playbackRate,1),this._algoArg.maxPlaySpeed)}},{key:"_filterIndexByBitrate",value:function(e,t){var r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];e/=r?this._getCalcPlayrate():1;var n=!1,i=0;if(e>t[t.length-1].bandwidth)i=t.length-1;else{for(var a=0;a<t.length;a++)if(t[a].bandwidth>=e){n=!0,(i=a)>0&&r&&(i-=1);break}!n&&(i=0)}return this._logger("filterIndexByBitrate",i,"hasFound",n),i}},{key:"_doSpeedBufferControl",value:function(e,t){var r=-1,n=this._playInfo.downloadSpeed,i=this._algoArg,a=i.hurryBuffer,o=i.dangerBuffer,s=i.safeBuffer,u=i.safeThreshold,c=i.hurryForseLowest,l=i.safeUpgrade,f=i.dangerFactorChange,d=i.safeFactorChange,h=this._currentBitrateIdx;if(this._isCurrentSafeBuffer=!1,0===n)r=-1,this._currentBitrateIdx=Math.min(h,this._firstLevelIdx),this._logger("SpeedBuffer 0, firstLevel",this._firstLevelIdx,"prev",h);else{var p=n*this._dangerFactor*8e3,v=n*this._safeFactor*8e3;if(e<a){if(r=p,0!==c)this._currentBitrateIdx=0;else{var g=this._filterIndexByBitrate(r,t);this._currentBitrateIdx=Math.max(0,Math.min(g-1,h))}}else if(a<=e&&e<o){r=p;var y=this._filterIndexByBitrate(r,t);this._currentBitrateIdx=Math.min(y,h)}else o<=e&&e<s?(r=v,this._currentBitrateIdx=this._filterIndexByBitrate(r,t)):s<=e&&(this._isCurrentSafeBuffer=!0,r=this._hasSafeRebufferDegrade?v:v*(1+(e-u)/this.gopSize),this._currentBitrateIdx=this._filterIndexByBitrate(r,t),l&&(this._dangerFactor+=f,this._safeFactor+=d),this._dangerFactor>this._maxDangerFactor&&(this._dangerFactor=this._maxDangerFactor),this._safeFactor>this._maxSafeFactor&&(this._safeFactor=this._maxSafeFactor))}return{calc_bitrate:r}}},{key:"_doSizeLimitControl",value:function(e){var t=this._algoArg.screen_factor;if(t>0&&this._videoHeight>0&&this._videoWidth>0){var r=this._currentBitrateIdx,n=e[r],i=this._videoWidth*t,a=this._videoHeight*t;if(n.width>i&&n.height>a){var o=e.concat();o.sort(function(e,t){return e.width<t.width?-1:1});for(var s=-1,u=0;u<o.length;u++)if(o[u].width>i&&o[u].height>a){s=u,this._logger("SizeLimitControl _currentBitrateIdx",u,"prev",r);break}if(s>-1){for(var c=o.filter(function(e){return e.width===o[s].width&&e.height===o[s].height}),l=-1,f=0;f<c.length;f++)c[f].bandwidth>l&&(l=c[f].bandwidth);l>-1&&(this._currentBitrateIdx=this._filterIndexByBitrate(l,e,!1),this._logger("SizeLimitControl maxBitrate",this._currentBitrateIdx,"prev",r))}}}}},{key:"_doLimitControl",value:function(e,t,r,n){var i=this._algoArg,a=i.limitFirstUpSwitch,o=i.limitFirstDownSwitch,s=i.minUpSwitchPosition,u=i.minDownSwitchPosition,c=i.maxUpSwitchLevel,l=i.maxDownSwitchLevel,f=i.maxUpSwitchCount,d=i.maxDownSwitchCount,h=i.maxSwitchCount,p=i.limitUpSwitchAfterUpSwitch,v=i.limitUpSwitchAfterDownSwitch,g=i.downSwitchType,y=i.debugMode,_=this._currentBitrateIdx>e,m=this._currentBitrateIdx<e;if(a>0&&this.numAbrCall<a&&_&&(this._currentBitrateIdx=e,this._logger("".concat(a,", callTimes"),this.numAbrCall)),o>0&&this.numAbrCall<o&&m&&(this._currentBitrateIdx=e,this._logger("".concat(o,", callTimes"),this.numAbrCall)),_&&s>=0&&this.downloadPosition>0&&this.downloadPosition<s&&(this._currentBitrateIdx=e,this._logger("minUp, minUpSwitchPosition",s,"downloadPos",this.downloadPosition)),m&&u>=0&&this.downloadPosition>0&&this.downloadPosition<u&&(this._currentBitrateIdx=e,this._logger("minDown, minDownSwitchPosition",u,"downloadPos",this.downloadPosition)),c>=0&&this._currentBitrateIdx-e>c&&(this._currentBitrateIdx=e+c,this._logger(", maxUpSwitchLevel",c)),l>=0&&e-this._currentBitrateIdx>l&&(this._currentBitrateIdx=e-l,this._logger(", maxDownSwitchLevel",l)),f>=0&&this.upSwitchCount>=f&&_&&(this._currentBitrateIdx=e,this._logger(", maxUpSwitchCount",f)),d>=0&&this.downSwitchCount>=d&&m&&(this._currentBitrateIdx=e,this._logger(", maxDownSwitchCount",d)),h>=0&&this.upSwitchCount+this.downSwitchCount>=h&&(this._currentBitrateIdx=e,this._logger(", maxSwitchCount",h)),_&&(p>=0&&this.lastDownSwitch>=0&&this.numAbrCall-this.lastDownSwitch<=p&&(this._currentBitrateIdx=e,this._logger("")),v>=0&&this.lastDownSwitch>=0&&this.numAbrCall-this.lastDownSwitch<=v&&(this._currentBitrateIdx=e,this._logger(""))),this._currentBitrateIdx==e-1){var b=r[e].bandwidth;1==g?b=(r[e].bandwidth+r[e-1].bandwidth)/2:2==g&&(b=r[e-1].bandwidth),this._logger(", downSwitchThreshold",b,"downSwitchType",g,"calc_bitrate",t),t>b&&(this._currentBitrateIdx=e)}var w=!1;if(this._maxBitrate>0&&r[this._currentBitrateIdx].bandwidth>=this._maxBitrate&&(this._currentBitrateIdx=n.length-1,w=!0),y>0&&!w&&(1==y||2==y||3==y||4==y)&&n.length>=2){var x=this._algoArg,k=x.max_debug_mode_2_change,S=x.debug_mode_3_interval,B=x.debug_mode_4_interval;if(this._firstLevelIdx>0){if((1==y||2==y||3==y)&&((1==y||2==y)&&(this._currentBitrateIdx=this._firstLevelIdx-(this.numAbrCall+1)%2),3==y&&1==(this.numAbrCall+1)%S&&(this._currentBitrateIdx=this._currentBitrateIdx===this._firstLevelIdx?this._firstLevelIdx-1:this._firstLevelIdx)),4==y){var I=(this.numAbrCall+B)%B;(0===I||1===I)&&(this._currentBitrateIdx=this._firstLevelIdx-(1-I))}}else this._currentBitrateIdx=0;this.numAbrCall>=k&&2==y&&(this._currentBitrateIdx=e)}return{hitLimitBitrate:w}}},{key:"_doReport",value:function(e,t,r,n,i,a,o,s,u){var c=-1===this._prevBuffer?-1:e-this._prevBuffer;this._prevBuffer=e,this._playInfo.segmentBufferEnd>0?this.downloadPosition=this._playInfo.segmentBufferEnd:this.downloadPosition=this.gopSize>0?this.gopSize:-1;var l=this.downloadPosition-this._prevDownloadPosition;-1===this._prevDownloadPosition&&(l=-1e4),this._prevDownloadPosition=this.downloadPosition,this._stat={buffer:e,target_birate:n,b_seek:this._isSeekedPredict,is_upper:i<this._currentBitrateIdx,bitrate_list:JSON.stringify(r.map(function(e){return e.bandwidth})),video_quality_list:JSON.stringify(r.map(function(e){return e.definition})),num_abr_call:this.numAbrCall,calc_bitrate:a,change_level:Math.abs(this._currentBitrateIdx-i),last_level:i,target_level:this._currentBitrateIdx,last_bitrate:t[i].bandwidth,download_position:this.downloadPosition,diff_download_position:l,diff_buffer:c,abr_time:0===this._prevAbrStartTime?0:(s-this._abrStartTime)/1e3,diff_abr_time:0===this._prevAbrStartTime?0:(s-this._prevAbrStartTime)/1e3,hit_limitbitrate:o?1:0,dangerFactor:this._dangerFactor,safeFactor:this._safeFactor,abrDownloadSpeed:8e3*this._playInfo.downloadSpeed,hitSrRule:u,last_video_quality:r[i].definition,target_video_quality:r[this._currentBitrateIdx].definition,screen_factor:this._algoArg.screen_factor},this._prevAbrStartTime=s,this._isSeekedPredict=!1,i<this._currentBitrateIdx&&(this.lastUpSwitch=this.numAbrCall,this.upSwitchCount++),i>this._currentBitrateIdx&&(this.lastDownSwitch=this.numAbrCall,this.downSwitchCount++),this.numAbrCall++}},{key:"_getBitrateBBA",value:function(){var e=this,t=0,r=0,n=this._algoArg,i=n.abrAgloType,a=n.getTargetSrName,o=n.isOpenSr,s=performance.now(),u=this._playInfo.buffer,c=this._sortedMediaInfos.v_adaptation,l=this._sortedMediaInfos.v_adaptation.filter(function(t){return!(e._maxBitrate>0)||t.bandwidth<=e._maxBitrate});this._logger("mediaBuffer",u);var f=this._currentBitrateIdx,d=-1;1===i&&(d=this._doSpeedBufferControl(u,l).calc_bitrate),0===i&&(d=this._doBufferControl(u,l).calc_bitrate);var h=this._doLimitControl(f,d,c,l).hitLimitBitrate;this._doSizeLimitControl(l);var p=0;if(o&&a&&"function"==typeof a){var v=a(l[this._currentBitrateIdx].gearName),g=l[this._currentBitrateIdx].bandwidth;if(v)for(var y=l.length-1;y>-1;y--){var _=l[y];if(_.gearName.includes(v)&&_.bandwidth<g){this._currentBitrateIdx=y,p=2,this._logger("hitSrRule 2");break}}}return t=l[this._currentBitrateIdx].bandwidth,r=0,this._doReport(u,c,l,t,f,d,h,s,p),{predictedBitrate:t,predictSpeed:r}}},{key:"_free",value:function(){}},{key:"ccall",value:function(e,t,r,n){this["_"+e](n)}},{key:"_parseMPD",value:function(){var e=JSON.parse(arguments.length<=0?void 0:arguments[0]);this._sortedMediaInfos=e,this._sortedMediaInfos.v_adaptation.sort(function(e,t){return e.bandwidth-t.bandwidth}),this._logger("MPD",this._sortedMediaInfos)}},{key:"updateSegmentDuration",value:function(e){this.gopSize=e}},{key:"updateBitrate",value:function(e){this._cacheBitrate=e}},{key:"getStat",value:function(){return this._stat}},{key:"updateWaitingState",value:function(e){if(e){var t=this._algoArg,r=t.minDangerFactor,n=t.dangerFactorChange,i=t.safeRebufferDegrade,a=t.safeFactorChange,o=t.minSafeFactor;t.rebufferDegrade&&(this._dangerFactor-=n,this._dangerFactor<=r&&(this._dangerFactor=r),this._safeFactor-=a,this._safeFactor<=o&&(this._safeFactor=o)),this._isCurrentSafeBuffer&&0!==i&&(this._hasSafeRebufferDegrade=!0)}}},{key:"setMatchSuperResolution",value:function(e){"function"==typeof e&&(this._algoArg.matchSuperResolution=e)}},{key:"setGetTargetSrName",value:function(e){"function"==typeof e&&(this._algoArg.getTargetSrName=e)}}])},258578:function(e,t,r){r.d(t,{_:function(){return c}});var n=r(858301),i=r(488598),a=r(156144),o=r(429421),s=r(825305),u=("undefined"==typeof window?"undefined":(0,n.Ac)(window))==="object"&&window.playerBitrateSelectorRuler?window.playerBitrateSelectorRuler:new s.$;("undefined"==typeof window?"undefined":(0,n.Ac)(window))==="object"&&!window.playerBitrateSelectorRuler&&(window.playerBitrateSelectorRuler=u);var c=(0,n.qH)(function e(t,r){var i=this;(0,n.PA)(this,e),(0,n._x)(this,"analysis",void 0),(0,n._x)(this,"_onEnded",function(){i._updateInfo()}),(0,n._x)(this,"_onPlayNext",function(){i._updateInfo()}),this._rule=u,this._player=t,t&&(this._playingInfo=new o.m(t.video)),this._bindEvent(),u.setConfig(r),this._selectAlgType=r.selectAlgType},[{key:"select",value:function(e,t,r){var n,o=r.degFactor;if(!!e.length){var s=e[0].duration||0;1===e.length&&(n=e[0],this.analysis&&(this.analysis.type=i.A.BUFFER_INFO_ONLY_ONE_ITEM));var c=0;return!n&&((c=this.getTargetBitrate(s,e,o))?(n=(0,a.v2)(e,c,this._selectAlgType),this.analysis&&(this.analysis.type=i.A.BUFFER_INFO_FIND_ADAPT_BITRATE,this.analysis.reason=JSON.stringify({selectAlgType:this._selectAlgType,targetBitRate:c}))):(n=e[0],this.analysis&&(this.analysis.type=i.A.BUFFER_INFO_TARGET_NOT_FOUND,this.analysis.reason=JSON.stringify({duration:s,itemsLen:e.length,ruleQueueLen:u.queue.length}))),n._targetBitrate=c),u.resetCurrent(),u.setCurrent({bitrate:n.bitrate,_xgOrgBitrate:n._xgOrgBitrate,duration:s}),this._playingInfo&&this._playingInfo.enable(),n}}},{key:"_bindEvent",value:function(){if(!this._player)return this._player;this._player.on("ended",this._onEnded),this._player.on("playnext",this._onPlayNext)}},{key:"getTargetBitrate",value:function(e,t,r){var n=u.getTargetBitrate(e,t);return r&&"factor"===r.degradeBitrateType&&"bitrate"===r.factorType&&(n*=r.value),n}},{key:"destroy",value:function(){if(this._endPlay(),!!this._player)this._playingInfo.destroy(),this._player.off("ended",this._onEnded),this._player.off("playnext",this._onPlayNext)}},{key:"_updateInfo",value:function(){this._playingInfo.endPlay();var e=this._playingInfo.getInfo();this._playingInfo.resetInfo(),u.setCurrent({downloadDuration:e.downloadDuration||u.getCurrent().duration,startBufferTime:e.startBufferTime,endBufferTime:e.endBufferTime,pausedTime:e.pausedTime,stalledTime:e.stalledTime,leaveWithBlock:e.leaveWithBlock}),this._prevPlayInfo=u.getCurrent(),u.calcAndReset()}},{key:"_endPlay",value:function(){this._updateInfo(),this._playingInfo.disable()}}])},156144:function(e,t,r){function n(e){return Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g)[0]}function i(e,t){var r=[];return e.forEach(function(e){(!e.mediaType||e.mediaType===t)&&r.push(e)}),r}r.d(t,{QS:function(){return o},VX:function(){return i},kM:function(){return n},v2:function(){return a}}),r(836654),r(110617),r(826893),r(927234),r(110006),r(742611);function a(e,t,r){return r?1===r?function(e,t){if(!e)return null;for(var r=-1,n=0;n<e.length;n++)if(e[n]&&e[n]._xgOrgBitrate&&t>=e[n]._xgOrgBitrate){r=n;break}return r<0?null:e[r]}(e,t):void 0:function(e,t){if(!e)return null;var r,n=1/0;return(e.forEach(function(e){var i=Math.abs(e._xgOrgBitrate-t);n>i&&(r=e,n=i)}),r)?r:null}(e,t)}function o(e,t){return e.forEach(function(e){e[t]?e._xgOrgBitrate=e[t]:e.bitrate&&(e._xgOrgBitrate=e.bitrate)}),e}},280223:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(893050);r(836654),r(47513),r(98601),r(110617),r(675373);var i=r(349674);let a=(0,n.qH)(function e(){(0,n.PA)(this,e)},[{key:"_initStorage",value:function(e){var t=e.name,r=e.storeName,i="".concat(t,"_").concat(r);return this.key=i,(!window[i]||"object"!==(0,n.Ac)(window[i]))&&(window[i]={}),this.store=window[i],Promise.resolve()}},{key:"getItem",value:function(e,t){var r=this.store[e];return void 0===r&&(r=null),this._internalPromise(t,r)}},{key:"getItemSync",value:function(e,t){var r=this.store[e];return void 0===r&&(r=null),t&&t(r),r}},{key:"setItem",value:function(e,t,r){return this.store[e]=t,this._internalPromise(r)}},{key:"removeItem",value:function(e,t){return delete this.store[e],this._internalPromise(t)}},{key:"clear",value:function(e){return this.store={},window[this.key]={},this._internalPromise(e)}},{key:"length",value:function(e){var t=Object.keys(this.store).length;return this._internalPromise(e,t)}},{key:"_internalPromise",value:function(e,t){var r=t?Promise.resolve(t):Promise.resolve();return(0,i.Z)(r,e),r}},{key:"all",value:function(e){for(var t=[],r=Object.keys(this.store),n=0;n<r.length;n++){var i=r[n];t.push({key:i,value:this.store[i]})}return this._internalPromise(e,t)}},{key:"probeSupport",value:function(){return!0}}])},410652:function(e,t,r){r.d(t,{Z:function(){return s}});var n=r(893050);r(511141),r(206642),r(110617),r(304095),r(914613),r(271692),r(296702),r(828514),r(187562),r(166613),r(801402),r(862956),r(703327),r(573545),r(170399),r(544805),r(463724),r(279651),r(874386);var i=r(995214),a=["vid","loadType","size","speed","cacheKey","vtype","duration","bitrate"],o=0,s=(0,n.qH)(function e(t){var r=this;(0,n.PA)(this,e),this._preload_bandwith_map=new Map,this._usepreload_info=new Map,this._pcdn_info_map=new Map,this._updateRealTimeSpeed=function(e){o=e.speed,r.emit(i.kW,e)},this._manager=t},[{key:"setPreloadBandwidth",value:function(e,t){this._preload_bandwith_map.set(e,t)}},{key:"getPreloadBandwidth",value:function(e){return this._preload_bandwith_map.get(e)}},{key:"_updateLoadInfo",value:function(e,t,r){var n=this._pcdn_info_map.get(e);n||(n={}),!n[t]&&(n[t]={},n[t].loadLen=0),n[t].loadLen=n[t].loadLen+r,this._pcdn_info_map.set(e,n)}},{key:"getLoadInfoAndDelete",value:function(e){var t=this._pcdn_info_map.get(e);return this._pcdn_info_map.delete(e),t}},{key:"getPreloadUnuseInfo",value:function(){var e={},t,r=(0,n.sf)(this._preload_bandwith_map);try{for(r.s();!(t=r.n()).done;){var i=(0,n.ZQ)(t.value,2),a=i[0],o=i[1];if(this._usepreload_info.get(a))this._preload_bandwith_map.delete(a);else{var s=a.split("#"),u=s.length>0?s[0]:a;e[u]?(e[u].bw+=o.bw||0,e[u].pbw+=o.pbw||0):e[u]={vid:u,bw:o.bw||0,pbw:o.pbw||0,bitrate:o.bitrate||0,duration:o.duration||0}}}}catch(e){r.e(e)}finally{r.f()}return Object.values(e)}},{key:"bwEventEmit",value:function(e){var t=e.vid,r=e.loadType,o=e.size,s=e.speed,u=e.cacheKey,c=e.vtype,l=e.duration,f=e.bitrate,d=(0,n.Kd)(e,a),h=this.getPreloadBandwidth(u)||{bw:0,pbw:0,vid:t,duration:l,bitrate:f};r&&r!==i._R.CDN?(h.pbw=h.pbw+o,this.emit("prf_data_size",(0,n.Zj)({vid:t,task_type:2,pcdn_size:o,pcdn_speed:s,vtype:c,bitrate:f,duration:l},d))):(h.bw=h.bw+o,this.emit("prf_data_size",(0,n.Zj)({vid:t,task_type:2,cdn_size:o,cdn_speed:s,vtype:c,duration:l,bitrate:f},d))),this.setPreloadBandwidth(u,h),this._updateRealTimeSpeed({speed:s,type:r||i._R.CDN}),this._updateLoadInfo(u,r,o)}},{key:"setUsePreloadInfo",value:function(e,t){this._usepreload_info.set(e,t)}},{key:"realTimeSpeed",get:function(){return o}},{key:"emit",value:function(e,t){var r;null===(r=this._manager)||void 0===r||r.emit(e,t)}},{key:"destroy",value:function(){this._preload_bandwith_map=new Map,this._usepreload_info=new Map,this._pcdn_info_map=new Map,this._manager=null}}])},383640:function(e,t,r){r.d(t,{q:function(){return u}});var n,i=r(42787),a=r(734123),o=r(976968),s=r(546041),u=function(e){function t(e){(0,i.PA)(this,t);var r,a=(r=(0,i.$w)(this,t,[e])).player,o=r.playerConfig;return r.playerId=a.playerId,r.codecType=o.codecType?o.codecType.toLowerCase():s.u7.H264,r.bizType=a.bizType="number"==typeof o.bizType?o.bizType:s.Ye.Normal,o.vtype&&(r.vtype=o.vtype.toUpperCase()),n&&(a.preloader=n),r}return(0,i.XW)(t,e),(0,i.qH)(t,[{key:"softDecode",get:function(){var e;return(null===(e=this.playerConfig)||void 0===e?void 0:e.mediaType)==="xg-video"}}],[{key:"registerPreloader",value:function(e){if(!!e)n=e,o.w.getInstance().findAll(function(e){return!e.config.isLive&&(e.preloader=n),!1})}}])}(a.BasePlugin)},443001:function(e,t,r){r.d(t,{p:function(){return n}});function n(e,t,r){var n;return function(i){var a,o,s,u,c,l,f;return new Worker(n=n||(a=e,o=t,s=r,u=void 0===o?null:o,l=(c=function(e,t){var r=atob(e);if(t){for(var n=new Uint8Array(r.length),i=0,a=r.length;i<a;++i)n[i]=r.charCodeAt(i);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return r}(a,void 0!==s&&s)).indexOf("\n",10)+1,f=new Blob([c.substring(l)+(u?"//# sourceMappingURL="+u:"")],{type:"application/javascript"}),URL.createObjectURL(f)),i)}}},73312:function(e,t,r){r.d(t,{Z:function(){return o}});var n=r(874838),i=r(758698);r(836654),r(691842),r(981168),r(891555);var a=r(675161),o=function(){function e(t){(0,n.Z)(this,e),this.TAG="AudioTimeRange",this._parent=t,this._buffers=[],this._duration=0,this._baseDts=0,this._lastBuffer=null}return(0,i.Z)(e,[{key:"isLive",get:function(){return this._parent.isLive}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration=e}},{key:"buffered",get:function(){var e=this;if(this.isLive)return{length:this._duration?1:0,start:function(){return 0},end:function(){return e._duration}};var t=this._mergeBufferRanges();return{length:t.length,start:function(e){var r=t[e];return r?r.start:0},end:function(e){var r=t[e];return r?r.end:1/0}}}},{key:"resetDts",value:function(e){this._baseDts=e}},{key:"_transitionSamples",value:function(e){for(var t=e.numberOfChannels,r=e.length,n=0;n<t;n++){for(var i=e.getChannelData(n),a=0;a<512;a++)i[a]=i[a]*a/512;for(var o=r-512;o<r;o++)i[o]=i[o]*(r-o)/512}}},{key:"append",value:function(e,t,r,n){-1===this._baseDts&&(this._baseDts=r),this._transitionSamples(e);var i=(r-this._baseDts)/1e3,o=i+t,s={start:i,end:o,startDts:r,source:e,duration:t,delay:n};return(a.kg.log(this.TAG,"add new buffer range, startDts:".concat(r,", [").concat(s.start," , ").concat(s.end,"]")),this._buffers.filter(function(e){return e.start===i}).length)?void 0:(this._buffers.push(s),this.isLive&&(this._duration=o),s.start)}},{key:"deletePassed",value:function(e){return this._buffers=this._buffers.filter(function(t){return t.start>=e}),this._buffers[0]}},{key:"canSeek",value:function(e){var t=this._buffers[this._buffers.length-1];return!!t&&!(t.start<e)&&!0}},{key:"_mergeBufferRanges",value:function(){var e=this._buffers.slice().sort(function(e,t){return e.start>t.start?1:-1}),t=e.length,r=[];if(!t)return r;for(var n={start:e[0].start,end:e[0].end},i=1;i<t;i++){var a=e[i];.5>Math.abs(n.end-a.start)?n.end=a.end:(r.push(n),n={start:a.start,end:a.end})}return r.push(n),r}},{key:"getBuffer",value:function(e){if(this.isLive)return this._buffers.shift();var t=this._buffers.filter(function(t){return t.start<e+.5&&t.end>e+.5})[0];return(a.kg.log(this.TAG,"get audio buffer , currentTime:".concat(e," ,buffer:[").concat(t&&t.start," , ").concat(t&&t.end,"]")),0!==e||t)?t:this._buffers[0]}},{key:"hasBuffer",value:function(){var e;return!!(null!==(e=this._buffers)&&void 0!==e&&e.length)}}]),e}()},675161:function(e,t,r){r.d(t,{Je:function(){return u},Mv:function(){return s},kg:function(){return o}});var n=r(684042),i=r(874838),a=r(758698);r(826893),r(691842),r(836654),r(511141),r(110617),r(792315),r(329913),r(868352),r(17322),r(63249),r(950665),r(180138),r(911234),r(387605),r(936097),r(786120),r(339597),r(877193),r(391375),r(632637),r(645524),r(800599),r(69896),r(660999),r(12946),r(416555),r(747644),r(404948),r(789680),r(675373);var o=new(function(){function e(){var t=this;(0,i.Z)(this,e);try{var r=/xgd=(\d)/.exec(document.cookie);this._status=!!r,this._level=r&&r[1]}catch(e){this._status=!1}["group","groupEnd","log","warn","error"].forEach(function(e){t[e]=function(r,i,a,o,s,u,c,l,f,d){if(t._status){var h,p=[i,a,o,s,u,c,l,f,d].filter(function(e){return void 0!==e});(h=console)[e].apply(h,["["+r+"]:"].concat((0,n.Z)(p)))}}})}return(0,a.Z)(e,[{key:"enable",get:function(){return this._status}},{key:"long",get:function(){return"2"===this._level}}]),e}());function s(e,t){if(e&&t){var r=new Uint8Array(e.byteLength+t.byteLength+11);r[0]=1,r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=255,r[5]=225;var n=6;return r.set(new Uint8Array([e.byteLength>>>8&255,255&e.byteLength]),n),n+=2,r.set(e,n),r[n+=e.byteLength]=1,n++,r.set(new Uint8Array([t.byteLength>>>8&255,255&t.byteLength]),n),n+=2,r.set(t,n),r}}function u(){var e,t,r=new Promise(function(r,n){e=r,t=n});return r.resolve=e,r.reject=t,r}},752578:function(e,t,r){r.d(t,{l:function(){return a}});var n=r(874838),i=r(758698);r(110617);var a=function(){function e(){(0,n.Z)(this,e)}return(0,i.Z)(e,null,[{key:"start",value:function(e){return!e||!e.length||1===e.length&&e.end(0)-e.start(0)<1e-6||1===e.length&&0>e.start(0)?0:e.start(0)}},{key:"end",value:function(e){return!e||!e.length||1===e.length&&e.end(0)-e.start(0)<1e-6?0:e.end(e.length-1)}},{key:"get",value:function(e){if(e)try{return e.buffered}catch(e){}}},{key:"buffers",value:function(e,t){if(!e||!e.length)return[];for(var r=[],n=0,i=e.length;n<i;n++){var a=r.length;if(a&&t){var o=r[a-1],s=o[1];if(e.start(n)-s<=t){var u=e.end(n);u>s&&(o[1]=u)}else r.push([e.start(n),e.end(n)])}else r.push([e.start(n),e.end(n)])}return r}},{key:"length",value:function(e){return e&&e.length?e.reduce(function(e,t){return e+(t[1]-t[0])},0):0}},{key:"info",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t||!t.length)return{start:0,end:0,buffers:[]};for(var i=0,a=0,o=0,s=0,u=0,c=0,l=0,f=e.buffers(t,n),d=0,h=f.length;d<h;d++){var p=f[d];if(r+n>=p[0]&&r<p[1])i=p[0],a=p[1],o=d;else if(r+n<p[0]){s=p[0],u=p[1];break}else r+n>p[1]&&(c=p[0],l=p[1])}return{start:i,end:a,index:o,buffers:f,nextStart:s,nextEnd:u,prevStart:c,prevEnd:l,currentTime:r,behind:r-i,remaining:a?a-r:0,length:e.length&&e.length(f)}}}]),e}()},841921:function(e,t,r){r.d(t,{l:function(){return i}});var n=r(83399),i=function(){function e(){(0,n.PA)(this,e)}return(0,n.qH)(e,null,[{key:"start",value:function(e){return!e||!e.length||1===e.length&&e.end(0)-e.start(0)<1e-6||1===e.length&&0>e.start(0)?0:e.start(0)}},{key:"end",value:function(e){return!e||!e.length||1===e.length&&e.end(0)-e.start(0)<1e-6?0:e.end(e.length-1)}},{key:"get",value:function(e){if(e)try{return e.buffered}catch(e){}}},{key:"buffers",value:function(e,t){if(!e||!e.length)return[];for(var r=[],n=0,i=e.length;n<i;n++){var a=r.length;if(a&&t){var o=r[a-1],s=o[1];if(e.start(n)-s<=t){var u=e.end(n);u>s&&(o[1]=u)}else r.push([e.start(n),e.end(n)])}else r.push([e.start(n),e.end(n)])}return r}},{key:"totalLength",value:function(e){return e&&e.length?e.reduce(function(e,t){return e+(t[1]-t[0])},0):0}},{key:"info",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t||!t.length)return{start:0,end:0,buffers:[]};for(var i=0,a=0,o=0,s=0,u=0,c=0,l=0,f=e.buffers(t,n),d=0,h=f.length;d<h;d++){var p=f[d];if(r+n>=p[0]&&r<=p[1])i=p[0],a=p[1],o=d;else if(r+n<p[0]){s=p[0],u=p[1];break}else r+n>p[1]&&(c=p[0],l=p[1])}return{start:i,end:a,index:o,buffers:f,nextStart:s,nextEnd:u,prevStart:c,prevEnd:l,currentTime:r,behind:r-i,remaining:a?a-r:0,length:e.totalLength&&e.totalLength(f)}}}]),e}()},854174:function(e,t,r){r.d(t,{U:function(){return i},t:function(){return n}});var n={FETCH:"fetch",XHR:"xhr"},i={ARRAY_BUFFER:"arraybuffer",TEXT:"text",JSON:"json"}},670537:function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){d(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function a(){a=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,i){var a=Object.create((t&&t.prototype instanceof h?t:h).prototype);return n(a,"_invoke",{value:function(e,t,r){var n="suspendedStart";return function(i,a){if("executing"===n)throw Error("Generator is already running");if("completed"===n){if("throw"===i)throw a;return I()}for(r.method=i,r.arg=a;;){var o=r.delegate;if(o){var s=function e(t,r){var n=r.method,i=t.iterator[n];if(void 0===i)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=void 0,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=TypeError("The iterator does not provide a '"+n+"' method")),d;var a=f(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var o=a.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,d):o:(r.method="throw",r.arg=TypeError("iterator result is not an object"),r.delegate=null,d)}(o,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=f(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(e,r,new S(i||[]))}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var d={};function h(){}function p(){}function v(){}var g={};c(g,o,function(){return this});var y=Object.getPrototypeOf,_=y&&y(y(B([])));_&&_!==t&&r.call(_,o)&&(g=_);var m=v.prototype=h.prototype=Object.create(g);function b(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function w(e,t){var i;n(this,"_invoke",{value:function(n,a){function o(){return new t(function(i,o){!function n(i,a,o,s){var u=f(e[i],e,a);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==typeof l&&r.call(l,"__await")?t.resolve(l.__await).then(function(e){n("next",e,o,s)},function(e){n("throw",e,o,s)}):t.resolve(l).then(function(e){c.value=e,o(c)},function(e){return n("throw",e,o,s)})}s(u.arg)}(n,a,i,o)})}return i=i?i.then(o,o):o()}})}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function B(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:I}}function I(){return{value:void 0,done:!0}}return p.prototype=v,n(m,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:p,configurable:!0}),p.displayName=c(v,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,u,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,s,function(){return this}),e.AsyncIterator=w,e.async=function(t,r,n,i,a){void 0===a&&(a=Promise);var o=new w(l(t,r,n,i),a);return e.isGeneratorFunction(r)?o:o.next().then(function(e){return e.done?e.value:o.next()})},b(m),c(m,u,"Generator"),c(m,o,function(){return this}),c(m,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=B,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return o.type="throw",o.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),k(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;k(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:B(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,r,n,i,a,o){try{var s=e[a](o),u=s.value}catch(e){r(e);return}s.done?t(u):Promise.resolve(u).then(n,i)}function u(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var a=e.apply(t,r);function o(e){s(a,n,i,o,u,"next",e)}function u(e){s(a,n,i,o,u,"throw",e)}o(void 0)})}}function c(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B(n.key),n)}}function f(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t,r){return(t=B(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function y(e,t,r){return(y=g()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&v(i,r.prototype),i}).apply(null,arguments)}r.d(t,{Ac:function(){return o},IP:function(){return p},Kd:function(){return m},Lc:function(){return b},PA:function(){return c},U2:function(){return x},WY:function(){return w},XW:function(){return h},Zj:function(){return i},_x:function(){return d},l5:function(){return a},qH:function(){return f},sf:function(){return S},wm:function(){return _},x:function(){return u}});function _(e){var t="function"==typeof Map?new Map:void 0;return(_=function(e){var r;if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return y(e,arguments,p(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),v(n,e)})(e)}function m(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++){if(r=a[n],!(t.indexOf(r)>=0))Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}}return i}function b(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){var t=g();return function(){var r,n=p(e);return r=t?Reflect.construct(n,arguments,p(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return b(e)}(this,r)}}function x(){return(x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function S(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return k(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(e,t)}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{!o&&null!=r.return&&r.return()}finally{if(s)throw a}}}}function B(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}},314765:function(e,t,r){r.d(t,{C:function(){return a}});var n=r(768947),i=r(382541),a=function(e){(0,n.XW)(r,e);var t=(0,n.WY)(r);function r(e,a,o,s){var u;return(0,n.PA)(this,r),u=t.call(this,s),(0,n._x)((0,n.Lc)(u),"retryCount",0),(0,n._x)((0,n.Lc)(u),"isTimeout",!1),(0,n._x)((0,n.Lc)(u),"loaderType",i.t.FETCH),(0,n._x)((0,n.Lc)(u),"startTime",0),(0,n._x)((0,n.Lc)(u),"endTime",0),(0,n._x)((0,n.Lc)(u),"options",{}),u.url=e,u.request=a,u.response=o,u}return(0,n.qH)(r)}((0,n.wm)(Error))},193143:function(e,t,r){r.d(t,{i:function(){return o}});var n=r(306492),i=r(939112),a=function(){function e(t){(0,n.PA)(this,e),this._buffer=t,this._offset=0,this._heldBits=0,this._numHeldBits=0}return(0,n.qH)(e,[{key:"readUint8",value:function(){return this._buffer[this._offset++]}},{key:"readUint16",value:function(){return this._buffer[this._offset++]<<8|this._buffer[this._offset++]}},{key:"readUint32",value:function(){return this._buffer[this._offset++]<<24|this._buffer[this._offset++]<<16|this._buffer[this._offset++]<<8|this._buffer[this._offset++]}},{key:"readUint8Array",value:function(e){var t=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,t}},{key:"streamRead1Bytes",value:function(){this._heldBits=this.readUint8(),this._numHeldBits=8}},{key:"streamRead2Bytes",value:function(){this._heldBits=this.readUint16(),this._numHeldBits=16}},{key:"extractBits",value:function(e){var t=this._heldBits>>this._numHeldBits-e&(1<<e)-1;return this._numHeldBits-=e,t}}]),e}(),o=function(){function e(){(0,n.PA)(this,e)}return(0,n.qH)(e,null,[{key:"parseVVCDecoderConfigurationRecord",value:function(t){var r,n,i,o,s,u,c,l,f=new a(t),d=f.readUint8();f.streamRead1Bytes(),f.extractBits(5);var h=f.extractBits(2)+1,p=f.extractBits(1),v={};p&&(f.streamRead2Bytes(),o=f.extractBits(2),s=f.extractBits(3),n=f.extractBits(3),i=f.extractBits(2),f.extractBits(6),v=e.parseVVCPTLRecord(f,n),r=f.readUint16(),u=f.readUint16(),c=f.readUint16(),l=f.readUint16());for(var g=f.readUint8(),y=[],_=[],m=[],b=null,w=0;w<g;w++){f.streamRead1Bytes(),f.extractBits(1),f.extractBits(2);var x=f.extractBits(5),k=1;13!==x&&12!==x&&(k=f.readUint16());for(var S=0;S<k;S++){var B=f.readUint16();switch(x){case 14:y.push(f.readUint8Array(B));break;case 15:var I=f.readUint8Array(B);!b&&(b=e.parseSPS(e.removeEPB(I))),_.push(I);break;case 16:m.push(f.readUint8Array(B))}}}return{data:t,configurationVersion:d,codec:"bvc2.1.6.L93.B0",nalUnitSize:h,ptlPresentFlag:p,olsIdx:r,numSublayers:n,constantFrameRate:i,chromaFormatIdc:o,bitDepthLumaMinus8:s,ptlRecord:v,width:u,height:c,sampleRate:l,numOfArrays:g,vps:y,sps:_,pps:m,spsParsed:b}}},{key:"parseVVCPTLRecord",value:function(e,t){e.streamRead2Bytes(),e.extractBits(2);var r=e.extractBits(6),n=e.extractBits(7),i=e.extractBits(1),a=e.readUint8();e.streamRead1Bytes();var o=e.extractBits(1),s=e.extractBits(1),u=new Uint8Array(r);if(r){for(var c=0;c<r-1;c++){var l=e.extractBits(6);e.streamRead1Bytes();var f=e.extractBits(2);u[c]=l<<2|f}u[r-1]=e.extractBits(6)}else e.extractBits(6);var d=[];if(t>1){e.streamRead1Bytes();for(var h=0,p=t-2;p>=0;--p)h|=e.extractBits(1)<<p;for(var v=t;v<=8&&t>1;++v)e.extractBits(1);for(var g=t-2;g>=0;--g)h&1<<g&&(d[g]=e.readUint8())}var y=e.readUint8(),_=[];if(y)for(var m=0;m<y;m++)_.push(e.readUint32());return{generalProfileIdc:n,generalTierFlag:i,generalLevelIdc:a,ptlFrameOnlyConstraintFlag:o,ptlMultilayerEnabledFlag:s,generalConstraintInfo:u,subLayerLevelIdc:d,generalSubProfileIdc:_,ptlNumSubProfiles:y,numBytesConstraintInfo:r}}},{key:"getAvccNals",value:function(e){for(var t=[];e.position<e.length-4;){var r=e.dataview.getInt32(e.dataview.position);if(e.length-e.position>=r){var n=e.buffer.slice(e.position,e.position+4);e.skip(4);var i=new Uint8Array(e.buffer.slice(e.position,e.position+r));e.skip(r),t.push({header:n,body:i});continue}break}return t}},{key:"analyseNal",value:function(e){var t=(248&e.body[1])>>3;switch(e.type=t,t){case 23:case 24:break;case 7:case 8:e.key=!0;break;case 14:e.vps=!0;break;case 15:e.sps=!0;break;case 16:e.pps=!0;break;case 17:e.aps=!0}}},{key:"removeEPB",value:function(e){for(var t=e.byteLength,r=[],n=1;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(r.push(n+2),n+=2):n++;if(!r.length)return e;var i=t-r.length,a=new Uint8Array(i),o=0;for(n=0;n<i;o++,n++)o===r[0]&&(o++,r.shift()),a[n]=e[o];return a}},{key:"parseVps",value:function(){}},{key:"parseSPS",value:function(t){var r=new i.Z(t);r.readUByte(),r.readUByte(),r.skipBits(4);var n=r.readBits(4),a=r.readBits(3),o=r.readBits(2),s=420;o<=3&&(s=[0,420,422,444][o]),r.readBits(2),r.readBits(1);var u=e._parseProfileTierLevel(r,1,a);r.readBits(1),r.readBits(1)&&r.readBits(1);var c=r.readUEG();return{width:c,height:r.readUEG(),spsMaxSubLayerMinus1:a,spsVideoParameterSetId:n,chromaFormatIdc:o,chromaFormat:s,ptlInfo:u}}},{key:"_parseProfileTierLevel",value:function(t,r,n){var i,a=t.readBits(7),o=t.readBits(1),s=t.readBits(8),u=t.readBits(1),c=t.readBits(1);r&&(i=e._parseGeneralConstraintsInfo(t));for(var l=n-1,f=[],d=[],h=[],p=l;p>=0;--p)f[p]=t.readBits(1);for(;!t.byteAligned();)t.readBits(1);for(var v=l;v>=0;--v)f[v]&&(d[v]=t.readUByte());if(r){for(var g=t.readUByte(),y=0;y<g;y++)h[y]=t.readBits(32)}return{generalProfileIdc:a,generalTierFlag:o,generalLevelIdc:s,ptlFrameOnlyConstraintFlag:u,ptlMultilayerEnabledFlag:c,ptlSublayerLevelPresentFlags:f,ptlSublayerLevelIdcs:d,ptlSubProfileIdcs:h,gciInfo:i}}},{key:"_parseGeneralConstraintsInfo",value:function(e){var t=e.readBits(1);if(t){e.skipBits(71);var r=e.readBits(8);r&&e.skipBits(r)}var n=8-e.bitsPos()%8;return e.skipBits(n),{gciPresentFlag:t}}}]),e}()},294747:function(e,t,r){r.d(t,{W:function(){return a}});var n=r(306492),i=r(170792),a=function(){function e(){(0,n.PA)(this,e),(0,n._x)(this,"id",2),(0,n._x)(this,"type",i.Vc.AUDIO),(0,n._x)(this,"codecType",i.yQ.AAC),(0,n._x)(this,"pid",-1),(0,n._x)(this,"codec",""),(0,n._x)(this,"sequenceNumber",0),(0,n._x)(this,"sampleDuration",0),(0,n._x)(this,"timescale",0),(0,n._x)(this,"formatTimescale",0),(0,n._x)(this,"baseMediaDecodeTime",0),(0,n._x)(this,"duration",0),(0,n._x)(this,"warnings",[]),(0,n._x)(this,"samples",[]),(0,n._x)(this,"baseDts",0),(0,n._x)(this,"sampleSize",16),(0,n._x)(this,"sampleRate",0),(0,n._x)(this,"channelCount",0),(0,n._x)(this,"objectType",0),(0,n._x)(this,"sampleRateIndex",0),(0,n._x)(this,"config",[]),(0,n._x)(this,"present",!1),(0,n._x)(this,"isVideoEncryption",!1),(0,n._x)(this,"isAudioEncryption",!1),(0,n._x)(this,"kid",null),(0,n._x)(this,"ext",void 0)}return(0,n.qH)(e,[{key:"reset",value:function(){this.sequenceNumber=0,this.timescale=0,this.sampleDuration=0,this.sampleRate=0,this.channelCount=0,this.baseMediaDecodeTime=0,this.present=!1,this.pid=-1,this.codec="",this.samples=[],this.config=[],this.warnings=[]}},{key:"exist",value:function(){return!!(this.sampleRate&&this.channelCount&&this.codec&&this.codecType===i.yQ.AAC)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isAudioEncryption}}]),e}()},707884:function(e,t,r){r.d(t,{i:function(){return o}});var n=r(758772),i=r(718863),a=function(){function e(t){(0,n.PA)(this,e),this._buffer=t,this._offset=0,this._heldBits=0,this._numHeldBits=0}return(0,n.qH)(e,[{key:"readUint8",value:function(){return this._buffer[this._offset++]}},{key:"readUint16",value:function(){return this._buffer[this._offset++]<<8|this._buffer[this._offset++]}},{key:"readUint32",value:function(){return this._buffer[this._offset++]<<24|this._buffer[this._offset++]<<16|this._buffer[this._offset++]<<8|this._buffer[this._offset++]}},{key:"readUint8Array",value:function(e){var t=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,t}},{key:"streamRead1Bytes",value:function(){this._heldBits=this.readUint8(),this._numHeldBits=8}},{key:"streamRead2Bytes",value:function(){this._heldBits=this.readUint16(),this._numHeldBits=16}},{key:"extractBits",value:function(e){var t=this._heldBits>>this._numHeldBits-e&(1<<e)-1;return this._numHeldBits-=e,t}}]),e}(),o=function(){function e(){(0,n.PA)(this,e)}return(0,n.qH)(e,null,[{key:"parseVVCDecoderConfigurationRecord",value:function(t){var r,n,i,o,s,u,c,l,f=new a(t),d=f.readUint8();f.streamRead1Bytes(),f.extractBits(5);var h=f.extractBits(2)+1,p=f.extractBits(1),v={};p&&(f.streamRead2Bytes(),o=f.extractBits(2),s=f.extractBits(3),n=f.extractBits(3),i=f.extractBits(2),f.extractBits(6),v=e.parseVVCPTLRecord(f,n),r=f.readUint16(),u=f.readUint16(),c=f.readUint16(),l=f.readUint16());for(var g=f.readUint8(),y=[],_=[],m=[],b=null,w=0;w<g;w++){f.streamRead1Bytes(),f.extractBits(1),f.extractBits(2);var x=f.extractBits(5),k=1;13!==x&&12!==x&&(k=f.readUint16());for(var S=0;S<k;S++){var B=f.readUint16();switch(x){case 14:y.push(f.readUint8Array(B));break;case 15:var I=f.readUint8Array(B);!b&&(b=e.parseSPS(e.removeEPB(I))),_.push(I);break;case 16:m.push(f.readUint8Array(B))}}}return{data:t,configurationVersion:d,codec:"bvc2.1.6.L93.B0",nalUnitSize:h,ptlPresentFlag:p,olsIdx:r,numSublayers:n,constantFrameRate:i,chromaFormatIdc:o,bitDepthLumaMinus8:s,ptlRecord:v,width:u,height:c,sampleRate:l,numOfArrays:g,vps:y,sps:_,pps:m,spsParsed:b}}},{key:"parseVVCPTLRecord",value:function(e,t){e.streamRead2Bytes(),e.extractBits(2);var r=e.extractBits(6),n=e.extractBits(7),i=e.extractBits(1),a=e.readUint8();e.streamRead1Bytes();var o=e.extractBits(1),s=e.extractBits(1),u=new Uint8Array(r);if(r){for(var c=0;c<r-1;c++){var l=e.extractBits(6);e.streamRead1Bytes();var f=e.extractBits(2);u[c]=l<<2|f}u[r-1]=e.extractBits(6)}else e.extractBits(6);var d=[];if(t>1){e.streamRead1Bytes();for(var h=0,p=t-2;p>=0;--p)h|=e.extractBits(1)<<p;for(var v=t;v<=8&&t>1;++v)e.extractBits(1);for(var g=t-2;g>=0;--g)h&1<<g&&(d[g]=e.readUint8())}var y=e.readUint8(),_=[];if(y)for(var m=0;m<y;m++)_.push(e.readUint32());return{generalProfileIdc:n,generalTierFlag:i,generalLevelIdc:a,ptlFrameOnlyConstraintFlag:o,ptlMultilayerEnabledFlag:s,generalConstraintInfo:u,subLayerLevelIdc:d,generalSubProfileIdc:_,ptlNumSubProfiles:y,numBytesConstraintInfo:r}}},{key:"getAvccNals",value:function(e){for(var t=[];e.position<e.length-4;){var r=e.dataview.getInt32(e.dataview.position);if(e.length-e.position>=r){var n=e.buffer.slice(e.position,e.position+4);e.skip(4);var i=new Uint8Array(e.buffer.slice(e.position,e.position+r));e.skip(r),t.push({header:n,body:i});continue}break}return t}},{key:"analyseNal",value:function(e){var t=(248&e.body[1])>>3;switch(e.type=t,t){case 23:case 24:break;case 7:case 8:e.key=!0;break;case 14:e.vps=!0;break;case 15:e.sps=!0;break;case 16:e.pps=!0;break;case 17:e.aps=!0}}},{key:"removeEPB",value:function(e){for(var t=e.byteLength,r=[],n=1;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(r.push(n+2),n+=2):n++;if(!r.length)return e;var i=t-r.length,a=new Uint8Array(i),o=0;for(n=0;n<i;o++,n++)o===r[0]&&(o++,r.shift()),a[n]=e[o];return a}},{key:"parseVps",value:function(){}},{key:"parseSPS",value:function(t){var r=new i.Z(t);r.readUByte(),r.readUByte(),r.skipBits(4);var n=r.readBits(4),a=r.readBits(3),o=r.readBits(2),s=420;o<=3&&(s=[0,420,422,444][o]),r.readBits(2),r.readBits(1);var u=e._parseProfileTierLevel(r,1,a);r.readBits(1),r.readBits(1)&&r.readBits(1);var c=r.readUEG();return{width:c,height:r.readUEG(),spsMaxSubLayerMinus1:a,spsVideoParameterSetId:n,chromaFormatIdc:o,chromaFormat:s,ptlInfo:u}}},{key:"_parseProfileTierLevel",value:function(t,r,n){var i,a=t.readBits(7),o=t.readBits(1),s=t.readBits(8),u=t.readBits(1),c=t.readBits(1);r&&(i=e._parseGeneralConstraintsInfo(t));for(var l=n-1,f=[],d=[],h=[],p=l;p>=0;--p)f[p]=t.readBits(1);for(;!t.byteAligned();)t.readBits(1);for(var v=l;v>=0;--v)f[v]&&(d[v]=t.readUByte());if(r){for(var g=t.readUByte(),y=0;y<g;y++)h[y]=t.readBits(32)}return{generalProfileIdc:a,generalTierFlag:o,generalLevelIdc:s,ptlFrameOnlyConstraintFlag:u,ptlMultilayerEnabledFlag:c,ptlSublayerLevelPresentFlags:f,ptlSublayerLevelIdcs:d,ptlSubProfileIdcs:h,gciInfo:i}}},{key:"_parseGeneralConstraintsInfo",value:function(e){var t=e.readBits(1);if(t){e.skipBits(71);var r=e.readBits(8);r&&e.skipBits(r)}var n=8-e.bitsPos()%8;return e.skipBits(n),{gciPresentFlag:t}}}]),e}()},765968:function(e,t,r){r.d(t,{m$:function(){return a}});var n=r(758772),i=r(693012),a=function(){function e(){(0,n.PA)(this,e),(0,n._x)(this,"id",3),(0,n._x)(this,"type",i.Vc.METADATA),(0,n._x)(this,"timescale",0),(0,n._x)(this,"flvScriptSamples",[]),(0,n._x)(this,"seiSamples",[])}return(0,n.qH)(e,[{key:"exist",value:function(){return!!((this.flvScriptSamples.length||this.seiSamples.length)&&this.timescale)}},{key:"reset",value:function(){this.timescale=0,this.flvScriptSamples=[],this.seiSamples=[]}},{key:"hasSample",value:function(){return!!(this.flvScriptSamples.length||this.seiSamples.length)}}]),e}()}}]);
"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["21773"],{909723:function(e,l,t){e.exports=t.p+"media/blackBg_big.b7bedc994a938699.png"},488556:function(e,l,t){t.d(l,{Q:function(){return I},Y:function(){return C}});var o=t(134761),i=t(520739),n=t(878389);t(268917),t(874386);var r=t(88648),a=t(496349),d=t(746864),u=t(35730),s=t(497730),c=t(256277),v=t(247872),m=t(697239),f=t(64957),_=t(831202),h=t(249877),p=t(497681),g=t(585068);let{WHALE_CUT_HEADER:w}=a,I=new class e{get(e){let{userId:l,maxCursor:t,count:o,locateItemId:i,whaleCutToken:n=""}=e,r=`${l}_${t}_${o}_${i}_${n}`;return this.store.get(r)}getOverFull(){return this.cacheKeyList.length>this.cacheSize}set(e,l){let{userId:t,maxCursor:o,count:i,locateItemId:n,whaleCutToken:r=""}=e,a=`${t}_${o}_${i}_${n}_${r}`;this.store.set(a,l),this.cacheKeyList.push(a),this.getOverFull()&&this.clearCache()}clearCache(){let e=this.cacheKeyList.length-this.cacheSize;for(let l=0;l<e;l++){let e=this.cacheKeyList.shift();e&&this.store.delete(e)}}constructor(){(0,o._)(this,"store",new Map),(0,o._)(this,"cacheKeyList",[]),(0,o._)(this,"cacheSize",5)}},C=e=>{var l;let{awemeInfo:t,isShow:o,authorCardLoginGuide:a,isNeedLoginGuideSense:C,isLogin:y,abtestData:S}=e,k=null==t?void 0:null===(l=t.authorInfo)||void 0===l?void 0:l.secUid,T=null==t?void 0:t.awemeId,b=(0,r.useRef)(0),N=(0,r.useRef)(0),L=(0,r.useRef)({list:[],isInit:!0}),E=(0,r.useRef)(!0),x=(0,r.useRef)(!1),A=(0,r.useRef)(!1),P=(0,r.useRef)({}),R=(0,r.useRef)(!1),M=async e=>{var l,r,M,V,F,j,D,B,W,U,O,Z,H;let{dir:K,curList:$}=e,z=e=>e.filter(e=>{var l,t;return(!(null==e?void 0:null===(l=e.tag)||void 0===l?void 0:l.inReviewing)||!((null==e?void 0:null===(t=e.tag)||void 0===t?void 0:t.isStory)||e.awemeType===d.e.Note))&&!$.find(l=>l.awemeId===e.awemeId)}).map(e=>(0,n._)((0,i._)({},e),{itemId:e.awemeId})),G=[],q=0,Q=!0,X=0,Y="",J=!0;if(L.current.isInit){let e={userId:k,maxCursor:"after"===K?N.current:b.current,count:24,locateItemId:T,whaleCutToken:null===(l=P.current)||void 0===l?void 0:l.whaleCutToken},i=I.get(e);!i&&(i=(0,m.fetchUserPost)(e));let{data:n,maxCursor:a,hasMore:v,statusCode:p,logPb:C,whaleInfo:D,notLoginModule:B}=await i;(null==D?void 0:D.whaleDecisionCustom)===w&&!y&&(x.current=!0);let{actionClose:W}=(0,g.jb)(u.LocalStorageKeys.AuthorBlock);if((0,g.A_)({effectiveTime:null==S?void 0:null===(r=S.authorBlock)||void 0===r?void 0:r.effective_time,type:null==S?void 0:null===(M=S.authorBlock)||void 0===M?void 0:M.type,abtestData:S,isLogin:y})&&!W&&!y&&(A.current=!0),0===X){let e=n;B&&B.guideLoginTipExist&&(R.current=!0,e=[{awemeId:s.P.NoLoginVideoGuide,awemeType:d.e.NoLoginVideoGuide,name:B.guideLoginTipText,desc:B.guideLoginTipDesc,video:{cover:B.guideLoginTipCover},authorInfo:{uid:null==n?void 0:null===(F=n[0])||void 0===F?void 0:null===(V=F.authorInfo)||void 0===V?void 0:V.uid}},...n]);let l=z(e||[]),t=l.find(e=>e.awemeId===T);G=l,q=a,Q=!!v,X=p,Y=C,N.current=a,P.current={whaleCutToken:null==D?void 0:D.whaleCutToken},(t||x.current||A.current)&&(J=!1,E.current=!1,q=0),L.current={list:l,isInit:!1}}if(J){let e=await (0,m.fetchUserLocatePost)({createTime:(0,f.QE)(t.createTime)?t.createTime:1e3*t.createTime,userId:k,locateItemId:T,cursor:(null===(j=L.current.list[L.current.list.length-1])||void 0===j?void 0:j.createTime)*1e3||a}),l=o&&!(0,c.gc)(t)&&!(0,c.Jt)(t);if(e.statusCode===h.j.Success){let t=z(e.data||[]);t.find(e=>e.awemeId===T)?(G=t,Q=!!e.hasMore,Y=e.logPb,X=e.statusCode,q=e.maxCursor,N.current=Math.min(N.current,e.maxCursor),b.current=e.minCursor):l&&_.oe.event.info({name:_.Mo.AuthorCardLocateFail,report:{awemeId:T,authorUid:k,logId:e.logPb,statusCode:e.statusCode}})}}L.current.isInit=!1}else{if(!E.current&&"before"===K)return{data:G,maxCursor:q,hasMore:Q,statusCode:X,logPb:Y};let{data:e,forwardHasMore:l,maxCursor:t,minCursor:o=0,hasMore:i,statusCode:n,logPb:r,whaleInfo:a}=await (0,m.fetchUserPost)({userId:k,maxCursor:"after"===K?N.current:b.current,count:20,locateItemId:T,forwardAnchorCursor:"after"===K?void 0:b.current,whaleCutToken:null===(D=P.current)||void 0===D?void 0:D.whaleCutToken,forwardEndCursor:"after"===K?void 0:(null===(B=L.current.list[L.current.list.length-1])||void 0===B?void 0:B.createTime)*1e3||new Date().getTime()+5*v.s2});if((null==a?void 0:a.whaleDecisionCustom)===w&&!y&&(x.current=!0),0===X){if(G=z(e||[]),Q=!!i,X=n,Y=r,P.current={whaleCutToken:null==a?void 0:a.whaleCutToken},"after"===K)q=t,N.current=t;else if(b.current=o||((0,f.QE)(null===(W=$[0])||void 0===W?void 0:W.createTime)?null===(U=$[0])||void 0===U?void 0:U.createTime:(null===(O=$[0])||void 0===O?void 0:O.createTime)*1e3),q=l?1:0,!l||R.current&&b.current<N.current){let l=null===(Z=L.current)||void 0===Z?void 0:Z.list;null===(H=e.forEach)||void 0===H||H.call(e,e=>{!l.find(l=>l.awemeId===e.awemeId)&&l.push(e)}),G=z(l||[]),E.current=!0}}}let ee={data:G,maxCursor:q,hasMore:Q,statusCode:X,logPb:Y,disableFetch:x.current};return"force_login"===a&&C?(0,p.t3)(ee):ee};return{fetchLocateList:M,cleatFetchParms:()=>{N.current=0,b.current=0,L.current.list=[],P.current={}},notLoginVideoGuideRef:R}}},511324:function(e,l,t){var o=t(544933);l.Z=new o.h({recommendVideoToast:{eventName:"recommend_video_toast",params:{group_id:"",author_id:"",action_type:"",relation_tag:0,enter_from:"",enter_method:"",label_related_action:"",label_text:"",like_cnt:0,follow_cnt:0,mutual_cnt:0,friend_user_id:"",recommend_range:"mutual"}},cancelRecommendVideo:{eventName:"cancel_recommend_video",params:{group_id:"",author_id:"",action_type:"",relation_tag:0,enter_from:"",enter_method:"",recommend_range:"mutual"}},friendsWatchingShow:{eventName:"friends_watching_show",params:{group_id:"",author_id:"",enter_from:"",is_friend_watching:0,like_cnt:0,follow_cnt:0,mutual_cnt:0,friend_user_id:"",recommend_user_relation:"",recommend_user_app_list:""}},fromDiscoverLabel:{eventName:"from_discover_label",params:{group_id:"",author_id:"",action_type:"",enter_from:""}}})},981551:function(e,l,t){t.d(l,{J:function(){return f}}),t(874386),t(250440);var o=t(88648),i=t(877639),n=t.n(i),r=t(147613),a=t(330746),d=t(637005),u=t(782442),s=t(506467),c=t(879550),v=t(507217),m=t(903868);let f=e=>{let{EventListener:l,refContainerStatus:t,isClientMiniWin:i,abtestData:f}=e,{pipWindow:_}=(0,m.Iq)(e=>{let{pipWindow:l}=e;return{pipWindow:l}}),h=(0,o.useRef)(!1),p=(0,o.useRef)(null),g=(0,o.useRef)([]),w=(0,o.useRef)(null),I=(0,o.useRef)(null),C=(0,o.useRef)((0,a.vU)()?120:0),y=(0,o.useRef)(0),S=(0,o.useRef)("unknown"),k=(0,o.useCallback)((e,l)=>{let t=0,o=e.slice(Math.max(e.length-l,1));for(let e=0;e<o.length;e++)t+=o[e];return Math.ceil(t/l)},[]),T=(0,o.useCallback)(()=>{d.emit(d.EVENT.swiperVideo)},[]),b=(0,o.useCallback)(e=>{var t,o,i,n,r,a,d,s,c,m;T(),null==e||null===(t=e.preventDefault)||void 0===t||t.call(e),p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{var e,l;g.current=[],(null==f?void 0:null===(l=f.swiperOptimize)||void 0===l?void 0:null===(e=l.wheel)||void 0===e?void 0:e.logic)&&(I.current=!1,S.current="unknown")},400);let _=new Date().getTime(),h=e.wheelDelta||-e.deltaY||-e.detail,b=Math.max(-1,Math.min(1,h));(null==f?void 0:null===(i=f.swiperOptimize)||void 0===i?void 0:null===(o=i.wheel)||void 0===o?void 0:o.logic)&&(y.current!==b&&(g.current=[]),y.current=b);let N=void 0!==e.wheelDeltaX||void 0!==e.deltaX,L=Math.abs(e.wheelDeltaX)<Math.abs(e.wheelDelta)||Math.abs(e.deltaX)<Math.abs(e.deltaY)||!N,E=C.current+Math.abs(h);if(g.current=[...g.current,E],(null==f?void 0:null===(r=f.swiperOptimize)||void 0===r?void 0:null===(n=r.wheel)||void 0===n?void 0:n.logic)&&("unknown"===S.current&&(S.current=E>50?"mouse":"touch"),g.current.length>2)){let e=g.current[g.current.length-2],l=g.current[g.current.length-1],t=g.current[g.current.length-3];e>l&&e>t?g.current[g.current.length-2]=Math.max(l,t)+1:e<l&&e<t&&(g.current[g.current.length-2]=Math.min(l,t)-1)}let x=_-w.current;w.current=_,x>400&&1===g.current.length&&(g.current=[,,].fill(g.current[0]),I.current=!1);let A=null!==(m=null==f?void 0:null===(d=f.swiperOptimize)||void 0===d?void 0:null===(a=d.wheel)||void 0===a?void 0:a.windowsize)&&void 0!==m?m:20,P=(null==f?void 0:null===(c=f.swiperOptimize)||void 0===c?void 0:null===(s=c.wheel)||void 0===s?void 0:s.logic)&&"mouse"===S.current?A/2:A,R=k(g.current,P),M=R>k(g.current,2*P);M&&!I.current&&L&&((0,u.Vv)(v.PagingType.scroll),b<0?l.emit("changeNext",{from:"scroll"}):l.emit("changePrev",{from:"scroll"}),I.current=!0),!M&&I.current&&L&&(I.current=!1)},[l,f]);return(0,o.useEffect)(()=>{if(l){let e=(0,d.emitterListen)(l,"sliderMove",T);return()=>{null==e||e()}}},[l]),(0,o.useEffect)(()=>{if(t)return null==t||t.addEventListener("wheel",b),()=>{null==t||t.removeEventListener("wheel",b)}},[t,b]),(0,o.useEffect)(()=>{if(_)return null==_||_.addEventListener("wheel",b),()=>{null==_||_.removeEventListener("wheel",b)}},[_,b]),(0,r.o)(()=>{var e,t,o,r,a;let m=i?[s.bf.ArrowUp.keyCode]:[s.bf.ArrowUp.keyCode,s.bf.W.keyCode],_=i?[s.bf.ArrowDown.keyCode]:[s.bf.ArrowDown.keyCode,s.bf.S.keyCode],p=e=>{var t,o,i,n,r,a,d,f;if(e.nativeEvent||(null===(t=u.Le.getConfig(u.gI.IsInModalVideo))||void 0===t?void 0:t.isInModal)||(null===(o=u.Le.getConfig(u.gI.PlayerShortcutConf))||void 0===o?void 0:o.pausePlayControlShortcut)||(null==e?void 0:null===(i=e.target)||void 0===i?void 0:i.contentEditable)==="true"||h.current)return;let p=e;(null===(n=e.data)||void 0===n?void 0:n.type)==="KEY_DOWN"&&(null===(r=e.data)||void 0===r?void 0:r.data)&&(p=null===(a=e.data)||void 0===a?void 0:a.data);let g=u.Le.getConfig(u.gI.DisableNextPre);!m.includes(p.keyCode)||p.shiftKey||g&&p.keyCode===s.bf.ArrowUp.keyCode?_.includes(p.keyCode)&&!p.shiftKey&&(!g||p.keyCode!==s.bf.ArrowDown.keyCode)&&((0,u.Vv)(v.PagingType.hotkey),c.p.postTask({task:()=>{l.emit("changeNext",{from:"keyboard"})},priority:"user-blocking",immediate:(null===(f=u.Le.getConfig(u.gI.AbtestData))||void 0===f?void 0:f.longtask)!==1})):((0,u.Vv)(v.PagingType.hotkey),c.p.postTask({task:()=>{l.emit("changePrev",{from:"keyboard"})},priority:"user-blocking",immediate:(null===(d=u.Le.getConfig(u.gI.AbtestData))||void 0===d?void 0:d.longtask)!==1}))},g=(null==f?void 0:null===(t=f.swiperOptimize)||void 0===t?void 0:null===(e=t.keydown)||void 0===e?void 0:e.logic)?p:n()(p,null!==(a=null==f?void 0:null===(r=f.swiperOptimize)||void 0===r?void 0:null===(o=r.keydown)||void 0===o?void 0:o.delay)&&void 0!==a?a:500,{leading:!0,trailing:!1});document.addEventListener("keydown",g),window.addEventListener("message",g);let w=d.listen(d.EVENT.showLoginPanel,e=>{h.current=e});return()=>{document.removeEventListener("keydown",g),window.removeEventListener("message",g),w()}},[i,l,f]),null}},323037:function(e,l,t){t.d(l,{z:function(){return k}}),t("874386");var o=t("563097"),i=t("88648"),n=t("746864"),r=t("669201"),a=t("713097"),d=t.n(a),u=t("823685"),s=t("909723"),c=t("190889"),v=t("138593");let m=e=>{let{isActive:l,isRenderInSSR:t,awemeInfo:r,abtestData:a,className:m}=e,f=(0,i.useMemo)(()=>{var e,l,t,o;return a.searchSuspenseFetch===u.SearchSuspenseFetch.StreamWithBlackBg?s:r.awemeType===n.e.Note?null===(o=r.images)||void 0===o?void 0:null===(t=o[0])||void 0===t?void 0:null===(l=t.urlList)||void 0===l?void 0:l[0]:null===(e=r.video)||void 0===e?void 0:e.originCover},[r,a]);return(0,o.jsxs)("div",{className:d()(c.default.staticImgBackground,m,"HideInLynxClassName"),children:[(0,o.jsx)("img",{src:f,className:d()(c.default.videoCover,{[c.default.blackVideoCover]:a.searchSuspenseFetch===u.SearchSuspenseFetch.StreamWithBlackBg})}),(0,o.jsx)(v.T3,{className:c.default.playerImgBackground,isRenderInSSR:t,awemeInfo:r,elementtiming:"lcp_ele",abtestData:a,fetchPriority:"auto",priorityServerBackupBg:!1})]})};var f=t("439837"),_=t.n(f),h=t("577603"),p=t.n(h),g=t("236758"),w=t("457822"),I=t("520739"),C=t("878389");let y=(0,i.forwardRef)((e,l)=>(0,o.jsx)("svg",(0,C._)((0,I._)({width:32,height:32,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:(0,o.jsx)("path",{d:"M23.5 15.134a1 1 0 0 1 0 1.732l-11.25 6.495a1 1 0 0 1-1.5-.866V9.505a1 1 0 0 1 1.5-.866l11.25 6.495z",fill:"#fff"})})));_().extend(p());let S=e=>{let{isActive:l,progress:t,time:n,abtestData:r,enableEnterDetail:a}=e,u=(0,i.useMemo)(()=>_().duration(Math.round(n/1e3),"seconds").format("mm:ss"),[n]);return(0,o.jsxs)("div",{className:d()(w.default.staticControls),children:[t&&(0,o.jsx)("div",{className:w.default.progress}),(0,o.jsxs)("div",{className:w.default.innerControls,children:[(0,o.jsxs)("div",{className:w.default.leftGrid,children:[(0,o.jsx)(y,{}),n>0&&(0,o.jsxs)("div",{className:w.default.time,children:[(0,o.jsx)("span",{children:"00:00"}),(0,o.jsx)("span",{className:w.default.timeSeparator,children:"/"}),(0,o.jsx)("span",{children:u})]})]}),a&&(0,o.jsxs)("div",{className:w.default.rightGrid,children:[(0,o.jsx)("div",{className:w.default.desc,children:"详情"}),(0,o.jsx)("div",{className:w.default.detailSvg,children:(0,o.jsx)(g.Z,{width:6,height:9,viewBox:"0 0 6 9"})})]})]})]})},k=e=>{var l,t,a;let{isActive:d,isRenderInSSR:u,awemeInfo:s,player:c,abtestData:v,className:f}=e,[_,h]=(0,i.useState)(!1),p=(null==s?void 0:s.awemeType)===n.e.Note,g=(null==s?void 0:null===(l=s.images)||void 0===l?void 0:l.length)===1&&(null==s?void 0:null===(a=s.images)||void 0===a?void 0:null===(t=a[0])||void 0===t?void 0:t.clipType)===r.NJ.LivePhoto;return(0,i.useEffect)(()=>{h(!0)},[]),(0,o.jsxs)(o.Fragment,{children:[!_&&(0,o.jsx)(m,{isActive:d,isRenderInSSR:u,awemeInfo:s,abtestData:v,className:f}),(!c||!d)&&(0,o.jsx)(S,{isActive:d,progress:!(p&&g),time:s.video.duration,abtestData:v})]})}},307362:function(e,l,t){t.d(l,{T:function(){return d}}),t(874386);var o=t(88648),i=t(720359),n=t(658065),r=t(32167),a=t(794593);let d=e=>{let{awemeInfo:l,isLogin:t,isActive:d,onOpenCard:u}=e,[s,c]=(0,o.useState)(!1),[v,m]=(0,o.useState)(""),[f,_]=(0,o.useState)(null),h=(0,i.d)(l),p=e=>{if("anchor"===e){var l,t,o;a.Z.report("pc_feed_label_click",{action:"close",enter_from:(0,n.yW)(),player_enter_from:(0,r.mo)(),group_id:null===(l=h.current)||void 0===l?void 0:l.awemeId,author_id:String(null!==(o=null===(t=h.current)||void 0===t?void 0:t.authorUserId)&&void 0!==o?o:""),label_type:null==f?void 0:f.activityName,activity_id:null==f?void 0:f.schema})}c(!1)},g=(0,o.useCallback)((e,l)=>{var t,o,i;c(!0),m(e),_(l),u(),a.Z.report("pc_feed_label_click",{action:"open",enter_from:(0,n.yW)(),player_enter_from:(0,r.mo)(),group_id:null===(t=h.current)||void 0===t?void 0:t.awemeId,author_id:String(null!==(i=null===(o=h.current)||void 0===o?void 0:o.authorUserId)&&void 0!==i?i:""),label_type:null==l?void 0:l.activityName,activity_id:null==l?void 0:l.schema})},[]);return(0,o.useEffect)(()=>{!d&&c(!1)},[d]),{isShowActivityCard:s,closeActivityCard:p,openActivityCard:g,activityName:v,anchorData:f,onActivityCardClick:(e,l)=>{s?p("anchor"):g(e,l)}}}},185791:function(e,l,t){t.d(l,{x:function(){return f}});var o=t(520739),i=t(368200);t(874386),t(675373);var n=t(88648),r=t(734123),a=t(746864),d=t(637005),u=t(658065),s=t(63976),c=t(422784);let v="",m=null,f=e=>{var l;let{awemeInfo:t,enablePreload:f,player:_}=e,[h,p]=(0,n.useState)((null==t?void 0:null===(l=t.stats)||void 0===l?void 0:l.commentCount)||0);(0,n.useEffect)(()=>{var e;p((null==t?void 0:null===(e=t.stats)||void 0===e?void 0:e.commentCount)||0)},[t]);let g=(0,n.useCallback)(async function(e,l,o,i,n,r){let d=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=null==t?void 0:t.awemeId,c=`${u}-0-${l}-${e}-${n}-${o}`;if(v===c&&m)return m;let f=await (0,s.iq)({awemeId:null==t?void 0:t.awemeId,cursor:e,count:l,itemType:(null==t?void 0:t.awemeType)===a.e.XgVideo?1:0,fetchType:o,cancleFunc:i,cid:n,whaleCutToken:r});return d&&f&&(v=c,m=f),f},[null==t?void 0:t.awemeId]),w=(0,n.useCallback)((e,l,o,i)=>(0,s.rs)({awemeId:null==t?void 0:t.awemeId,commentId:e,cursor:l,count:o,itemType:(null==t?void 0:t.awemeType)===a.e.XgVideo?1:0,whaleCutToken:i}),[null==t?void 0:t.awemeId]),I=(0,n.useCallback)(function(){let{cursor:e=0,count:l,needPage:o=!0,ctx:i=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.Yp)({cursor:e,count:l,needPage:o,ctx:i,groupId:null==t?void 0:t.awemeId})},[null==t?void 0:t.awemeId]),C=(0,n.useCallback)(function(){let{cid:e,diggType:l,level:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.y6)({awemeId:null==t?void 0:t.awemeId,cid:e,diggType:l,itemType:(null==t?void 0:t.awemeType)===a.e.XgVideo?1:0,level:o})},[null==t?void 0:t.awemeId]),y=(0,n.useCallback)(function(){let{cid:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.YF)({cid:e})},[]);return{globalCommentCount:h,updateGlobalCommentCount:p,fetchComment:g,fetchReply:w,fetchCommentMention:I,publishCommentItem:(0,n.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var l,n,{text:a,textExtra:v,replyId:m,replyToReplyId:f,commentSendCelltime:h,commentVideoCelltime:p}=e,g=(0,i._)(e,["text","textExtra","replyId","replyToReplyId","commentSendCelltime","commentVideoCelltime"]);let w=await (0,s.uo)((0,o._)({awemeId:null==t?void 0:t.awemeId,text:a,textExtra:v,replyId:m,replyToReplyId:f,commentVideoCelltime:p,commentSendCelltime:h},g));return!w.statusCode&&(d.emit(d.EVENT.showClientDownloadGuide,{isShow:!0,type:"comment",text:"及时接收互动消息通知"}),null==_||_.emit(r.Events.USER_ACTION,{action:"comment"}),c.Z.sendLog("post_comment_finish",{enter_from:(0,u.yW)(),group_id:null==t?void 0:t.awemeId,comment_panel_position:"sidebar",comment_id:(null==w?void 0:null===(l=w.comment)||void 0===l?void 0:l.cid)||"",comment_category:(null==w?void 0:null===(n=w.comment)||void 0===n?void 0:n.replyId)==="0"?"original":"reply",play_current_time:Math.floor((null==_?void 0:_.currentTime)||0)})),w},[null==t?void 0:t.awemeId,_]),deleteCommentItem:y,diggCommentItem:C}}},587526:function(e,l,t){t.d(l,{U:function(){return s}}),t(250440),t(675373);var o=t(116253),i=t(79307),n=t(480596),r=t(823685),a=t(227266);let d=(0,a.fF)("CommentPreload"),u=[r.CommentAIPreloadStatus.CommentPreloadHighThreshold,r.CommentAIPreloadStatus.CommentPreloadLowThreshold,r.CommentAIPreloadStatus.CommentPreloadAll],s=e=>{let{isModal:l,awemeInfo:s,isActive:c,fetchComment:v,player:m,commentpreloadAbStatus:f,adCommentpreloadAbStatus:_,scene:h,showSideCard:p,abtestData:g,abUseSimpleNN:w,abVid:I}=e;(0,o.b)(async()=>{if(!!(u.includes(f)&&h===i.lT.Recommend&&!1===l&&!0===c&&(null==m?void 0:m.currentTime)>=0&&!1===p)&&((null==s?void 0:s.isAds)!==!0||!![r.AdCommentAIPreloadStatus.AdCommentPreloadHighThreshold,r.AdCommentAIPreloadStatus.AdCommentPreloadLowThreshold].includes(_))&&"undefined"!=typeof WebAssembly)try{let e=()=>{let e=(null==g?void 0:g.commentRenderOptimize)===2?10:20;v(0,e,"user",{current:null},"",void 0,!0)},l=!(null==s?void 0:s.isAds)&&w,{Pylon:o,EScene:i,EBiz:u}=await t.e("74770").then(t.bind(t,198991)),c=new o({biz:u.DOUYIN_WEB_RECOMMEND}),h=f===r.CommentAIPreloadStatus.CommentPreloadHighThreshold?n.TccKey.CommentPreloadHighThreshold:n.TccKey.CommentPreloadLowThreshold;_===r.AdCommentAIPreloadStatus.AdCommentPreloadHighThreshold?h=n.TccKey.AdCommentPreloadHighThreshold:_===r.AdCommentAIPreloadStatus.AdCommentPreloadLowThreshold&&(h=n.TccKey.AdCommentPreloadLowThreshold),l&&(h=n.TccKey.clientAIOptimizeConfig);let p=await (0,a.aW)(h),C=c.createStrategyEngine({abConfig:p,scene:i.COMMENT});C.setThresholdCallback(async()=>{var t,o,n,r,u,v,f,_;if(a.cy.getPreloadCache(a.mM.COMMENT_BTN_CLICKED))return;let{package:h="",engine_config:g={}}=null!==(f=p.preload_ml)&&void 0!==f?f:{},w=await c.createEngine({scene:i.COMMENT,modelUrl:h,inputs:null==g?void 0:g.inputs,outputs:null==g?void 0:g.outputs,runTime:l?"simplenn":"bytenn"}),y=1e3*((null==m?void 0:m.currentTime)||0),S=w.inference({features:{videoPlayTime:y}}),k=C.hitThresholdValue(S),T=null==p?void 0:null===(t=p.preload_ml)||void 0===t?void 0:t.package,b=null==p?void 0:null===(u=p.preload_ml)||void 0===u?void 0:null===(r=u.output)||void 0===r?void 0:null===(n=r[0])||void 0===n?void 0:null===(o=n.args)||void 0===o?void 0:o[0],N=null!==(_=w.getFeatureVector({features:{scene:i.COMMENT,videoPlayTime:y}}))&&void 0!==_?_:[];if((0,a.zo)(S,k,a.vV.COMMENT_PRELOAD,T,b,N,0,I),d("comment-ret:",S,",hit:",k,", nickname:",null==s?void 0:null===(v=s.authorInfo)||void 0===v?void 0:v.nickname,", playTime: ",y),k){e();return}})}catch(e){d("comment inference error: ",e)}},[c,m])}},123407:function(e,l,t){t.d(l,{Cu:function(){return c},nW:function(){return v}});var o=t(520739),i=t(878389);t(874386);var n=t(88648),r=t(337499);t(35730);var a=t(782442),d=t(637005);t(555106),t(744121),t(597321),t(631493);var u=t(151681);let s=e=>({[r.L.Author]:r.t.Author,[r.L.Mix]:r.t.Mix,[r.L.Series]:r.t.Series,[r.L.Search]:r.t.Search,[r.L.CollectFolder]:r.t.CollectFolder,[r.L.Collection]:r.t.Collection,[r.L.Hot]:r.t.Hot,[r.L.Related]:r.t.Related,[r.L.Search]:r.t.Search,[r.L.Record]:r.t.Record,[r.L.Like]:r.t.Like})[e],c=e=>({[r.t.Author]:r.L.Author,[r.t.Mix]:r.L.Mix,[r.t.Series]:r.L.Series,[r.t.Search]:r.L.Search,[r.t.CollectFolder]:r.L.CollectFolder,[r.t.Collection]:r.L.Collection,[r.t.Hot]:r.L.Hot,[r.t.Related]:r.L.Related,[r.t.Like]:r.L.Like,[r.t.Record]:r.L.Record})[e],v=e=>{let{defaultTab:l,isActive:t,stopAutoPlay:c,awemeInfo:v,abtestData:m,showSideCard:f}=e,{awemeFeed:_}=(0,u.j)(),[h,p]=(0,n.useState)(l),[g,w]=(0,n.useState)(s(h)),[I,C]=(0,n.useState)(()=>{if(s(h))return{[s(h)]:v}}),y=(0,n.useRef)(l),S=(0,n.useRef)(!1);y.current=h;let k=(0,n.useCallback)(e=>{let{tab:l,from:t}=e;if(y.current=l,_.dispatch("cardType",l),void 0!==s(l)&&_.dispatch("feedType",l),p(e=>{var o;return null===(o=a.Le.getConfig(a.gI.IsInLookMiniModal))||void 0===o||o.isInMiniModal,e!==l&&"auto"!==t&&(null==c||c()),l}),l!==r.L.Comment&&d.emit(d.EVENT.changeTab,l),l){let e=a.Le.getConfig(a.gI.PlayerCardInfo);a.Le.setConfig(a.gI.PlayerCardInfo,{isActive:!0,videoCardType:l!==r.L.Comment?l:null==e?void 0:e.videoCardType,expandCardType:l})}},[c]);return(0,n.useEffect)(()=>{t&&l&&p(l)},[t]),(0,n.useEffect)(()=>{h&&w(e=>{if(h===r.L.Comment)return(!(null==m?void 0:m.slideOptimize)||f)&&C(l=>(0,i._)((0,o._)({},l),{[e]:v})),e;let l=s(h);return l!==e?l:((!(null==m?void 0:m.slideOptimize)||f)&&C(l=>(0,i._)((0,o._)({},l),{[e]:v})),e)})},[h,v,f]),(0,n.useEffect)(()=>{var e;let l=null===(e=a.Le.getConfig(a.gI.IsInLookMiniModal))||void 0===e?void 0:e.isInMiniModal;l&&(S.current=l),t&&a.Le.setConfig(a.gI.IsInMixCard,!1)},[h,t]),{curTab:h,curTabRef:y,changeTab:k,curVideoFeed:s(h)||g,lastVideoFeedAweme:I}}},155087:function(e,l,t){t.d(l,{Y:function(){return _}}),t(874386);var o=t(88648),i=t(371260),n=t(256277),r=t(325982),a=t(147613),d=t(919780),u=t(28237),s=t(602394),c=t(637005),v=t(77726),m=t(945977),f=t(358003);let _=e=>{let{isActive:l,onOpenCard:t,isLogin:_,accountParentEl:h,awemeInfo:p,onLoginSuccess:g,onCloseCard:w,abtestData:I,toast:C}=e,[y,S]=(0,o.useState)(!1),k=(0,o.useRef)(!1),T=(0,o.useMemo)(()=>(0,i.o4)(p),[p]),b=(0,o.useMemo)(()=>(0,n.Rx)(p),[p]),[N,L]=(0,o.useState)(!1),E=(0,o.useRef)(!1),x=(0,o.useRef)(!0),A=(0,o.useCallback)(e=>{let{from:l}=e||{};L("automatic"===l),!E.current&&"automatic"!==l&&(E.current=!0,c.emit(c.EVENT.videoStopPlayNext,{openSideCard:!0}));let o=()=>{S(!0),(0,v.B1)({tag:"ecom_load_start"}),null==t||t(),T&&(0,r.E)("detail_show",{tag:"landing_ad",value:b.creative_id,log_extra:b.log_extra})};if(_)o();else{var i,n;(0,f.default)({success:async()=>{null==g||g(),o()},headerText:"登录后即可查看商品详情",enterMethod:"product_entrance_click",next:`https://${null===(n=window)||void 0===n?void 0:null===(i=n.location)||void 0===i?void 0:i.host}`},h)}},[S,_,h,t,b,T]);(0,a.o)(()=>{let e=c.listen(c.EVENT.openAdSideCard,e=>{let t=(null==e?void 0:e.from)!=="automatic"||!k.current;if(l&&T&&t){var o,i;let l=null==b?void 0:null===(o=b.lynx_components)||void 0===o?void 0:o.find(e=>(null==e?void 0:e.lynx_type)===d.AD_FEED_TYPE);if(!(null==l?void 0:null===(i=l.lynx_raw_data)||void 0===i?void 0:i.open_url)&&!(null==b?void 0:b.open_url)&&(0,n.Gu)(p)){C?C("广告链接获取失败，请跳过"):s.F.info("广告链接获取失败，请跳过"),(0,r.E)("load_failed",{tag:(0,m.f)(),value:b.creative_id,log_extra:b.log_extra});return}A({from:null==e?void 0:e.from}),(null==e?void 0:e.from)==="automatic"&&(0,r.E)("realtime_click",{tag:(0,m.f)(),value:null==b?void 0:b.creative_id,log_extra:null==b?void 0:b.log_extra,refer:"enter"})}});return()=>e()},[l,p,_,A,b,T]);let P=(0,o.useCallback)(e=>{let{action:l}=e||{};"manual"===l&&(k.current=!0),S(!1),x.current=!1,E.current&&(E.current=!1,c.emit(c.EVENT.videoRemoveStopPlayNext,{openSideCard:!0})),T&&(0,r.E)("close",{tag:(0,m.f)(),value:b.creative_id,log_extra:b.log_extra,content:"ad_detail"}),null==w||w()},[S,T,b,w]);return(0,o.useEffect)(()=>{!l&&y&&P()},[l]),(0,o.useEffect)(()=>{!(0,u.n)(p)&&y&&P()},[p]),{isShowShopDetailSideCard:y,isAutoOpen:N,closeShopDetailCard:P,openShopDetailCard:A,isFirstLoad:x.current}}},711054:function(e,l,t){t.d(l,{B:function(){return v}});var o=t(520739),i=t(878389),n=t(88648),r=t(337499),a=t(79307),d=t(637005),u=t(782442),s=t(63976),c=t(185791);let v=e=>{let{awemeInfo:l,customProps:t,reportParams:v,fullScreenTarget:m,tab:f,showSideCard:_,player:h,scrollElRef:p,followStatus:g,handleCommentClick:w,isShowRelatedCard:I,isActive:C,isUpperFeed:y=!1,globalIsCommentTrayPushGuideShow:S,globalCommentTrayPushGuideType:k,setCommentTrayPushGuideTypeFunc:T,setIsCommentTrayPushGuideShowFunc:b,onSearchTextClick:N,scene:L}=e,{abtestData:E,userContext:x,insertCommentId:A,tab:P}=t||{},{userInfo:R,dispatch:M}=x||{};(0,n.useEffect)(()=>{var e,l;let t;if(!C)return;I&&(t=setTimeout(()=>d.emit(d.EVENT.feedVideoCardLocateCurrentVideo),0));let{isShow:n,isModal:a,tab:s}=u.Le.getConfig(u.gI.IsSidebarShow)||{},c=(null===(e=u.Le.getConfig(u.gI.IsInLookMiniModal))||void 0===e?void 0:e.isInMiniModal)||!1,v=(null===(l=u.Le.getConfig(u.gI.IsInModalVideo))||void 0===l?void 0:l.isInModal)||!1,m=a!==(v||c)?{tab:s,isShow:void 0}:{tab:s,isShow:n};return u.Le.setConfig(u.gI.IsSidebarShow,{isShow:I,tab:f,isModal:v||c,lastStatus:(0,i._)((0,o._)({},m),{isModal:a})}),d.emit(d.EVENT.changeVideoSideBar,{isShowRelatedCard:I,isShowComment:f===r.L.Comment,lastStatus:m}),()=>{clearTimeout(t)}},[I,f]);let V=(0,n.useMemo)(()=>({awemeInfo:l,sense:"slider_video",onCloseClick:()=>{},onCollapseClick:()=>{},userContext:x,abtestData:E,changeLoginStatus:()=>{M({type:"updateUserInfo"})},logParams:v}),[l,x,M,v,E]),{fetchComment:F,fetchReply:j,fetchCommentMention:D,deleteCommentItem:B,publishCommentItem:W,diggCommentItem:U}=(0,c.x)({awemeInfo:l,player:h});return{authorConfig:V,commentConfig:{abtestData:E,fullScreenTarget:m,isDetail:!1,isShowComment:f===r.L.Comment&&_,total:0,onCloseCommentClick:w,awemeInfo:l,awemelogPb:null==l?void 0:l.logPb,userInfo:R,scrollContainerEl:null==p?void 0:p.current,player:h,shortcutMode:null==E?void 0:E.shortcutMode,fetchComment:F,fetchReply:j,fetchEmoticonGif:s.D2,fetchCommentMetionList:D,diggCommentItem:U,deleteCommentItem:B,puhlishCommentItem:W,count:(null==E?void 0:E.commentRenderOptimize)===2?10:20,defaultommentList:[],defaultCursor:0,defaultHotsoonHasMoreRef:0,defaultHasMore:!0,defaultStatusCode:0,defaultCommentId:y?"":A,isNeedCommentInput:!0,changeLoginStatus:()=>{M({type:"updateUserInfo"})},reportExtraParams:(0,i._)((0,o._)({},v),{relation:String(g)}),dispatch:M,globalIsCommentTrayPushGuideShow:S,globalCommentTrayPushGuideType:k,setCommentTrayPushGuideTypeFunc:T,setIsCommentTrayPushGuideShowFunc:b,tab:P,onSearchTextClick:N,isSearch:L===a.lT.Search}}}},386531:function(e,l,t){t.d(l,{Z:function(){return ow}});var o=t("520739"),i=t("563097"),n=t("88648"),r=t("878389"),a=t("368200");t("675373"),t("250440"),t("874386"),t("338172"),t("179133"),t("826893");var d=t("465571"),u=t("713097"),s=t.n(u),c=t("338426"),v=t("128231"),m=t.n(v),f=t("222406"),_=t("784492"),h=t("909543"),p=t("734123"),g=t("79307"),w=t("702726"),I=t("337499"),C=t("452894"),y=t("256277"),S=t("701523"),k=t("606604"),T=t("807294"),b=t("746864"),N=t("147613"),L=t("371260"),E=t("505732"),x=t("114981"),A=t("17750"),P=t("524214"),R=t("317914"),M=t("697239"),V=t("32167"),F=t("637005"),j=t("30321"),D=t("387787"),B=t("367366"),W=t("782442"),U=t("349998"),O=t("44905"),Z=t("658065"),H=t("161045"),K=t("250486"),$=t("330746"),z=t("782563"),G=t("375944"),q=t("734017"),Q=t("208987"),X=t("900674"),Y=t("801021"),J=t("32192"),ee=t("379877"),el=t("744121"),et=t("682445"),eo=t("205457");let ei=(0,c.ZP)(()=>Promise.all([t.e("66135"),t.e("28251"),t.e("99965"),t.e("37490")]).then(t.bind(t,335346)),{ssr:!1}),en=(0,c.ZP)(()=>Promise.all([t.e("66135"),t.e("28251"),t.e("99965"),t.e("37490")]).then(t.bind(t,84576)),{ssr:!1}),er=e=>{let{children:l,className:t,componentName:o}=e;return(0,i.jsx)("div",{id:"videoSideCard",className:s()(et.default.sideBar,et.default.sideBarDefaultWidth,"isDark","dark",t),onWheel:e=>e.stopPropagation(),ref:e=>{(0,$.G6)()&&e&&!e.onwheel&&(e.onwheel=e=>{e.stopPropagation()})},children:(0,i.jsx)(eo.k,{componentName:o,children:l})})};var ea=n.memo(e=>{let{abtestData:l,awemeInfo:t,userInfo:o,isClientMiniWin:n,isWebMiniWin:r,isActive:a,player:d,douPlusCtr:u,sodaCtr:c}=e;return(0,i.jsxs)(i.Fragment,{children:[u.isShow&&(0,i.jsx)(er,{className:s()({[et.default.displayNone]:n}),componentName:"DouPlusCard",children:(0,i.jsx)(ei,{awemeInfo:t,userInfo:o,close:u.close,entranceSeq:u.seq})}),c.isShow&&(0,i.jsx)(er,{className:s()({[et.default.displayNone]:n}),componentName:"SodaCard",children:(0,i.jsx)(en,{abtestData:l,awemeInfo:t,player:d,isActive:a,isMiniWin:r||n,close:c.close})})]})}),ed=t("439087"),eu=t("52533"),es=t("288867"),ec=t("422784"),ev=t("516599"),em=t("366334"),ef=t("433188"),e_=t("151681"),eh=t("903868");let ep=e=>{let{scene:l,originAwemeInfo:t,canUseListenFeed:o,isActive:i}=e,[r,a]=(0,n.useState)(0),[d,u]=(0,n.useState)([t]),s=(0,n.useRef)(1),c=(0,n.useRef)(!1),v=(0,n.useRef)(0),m=(0,n.useRef)(null),{awemeFeed:f}=(0,e_.j)(),{isListenVideoMiniWin:h}=(0,eh.Iq)(e=>{let{isListenVideoMiniWin:l}=e;return{isListenVideoMiniWin:l}});return(0,_.Z)(()=>{!h&&(u([t]),a(0),v.current=0,s.current=1,f.dispatch({listenPrevAwemeInfo:null,listenNextAwemeInfo:null}),m.current=null,c.current=!1)},[h]),(0,n.useEffect)(()=>{if(!!h&&!!o&&!!i)(async()=>{if(4>=Math.abs(d.length-r)&&!c.current){c.current=!0;let e=await (0,em.v6)({count:10,refreshIndex:s.current,scene:l});if(c.current=!1,0===e.statusCode&&0!==e.awemeList.length)s.current+=1,u(l=>{let t=e.awemeList.filter(e=>(0,ef.P)(e)).filter(e=>!l.find(l=>l.awemeId===e.awemeId));return 1===l.length&&(f.dispatch({listenNextAwemeInfo:t[0]}),m.current=t[0]),[...l,...t]})}})()},[h,i]),{listenVideoFeedIndex:r,changeListenVideoFeedIndex:(0,n.useCallback)(async e=>{let{newIndex:t,changeMode:o}=e,i=async e=>{if(4>=Math.abs(d.length-e)&&!c.current){c.current=!0;let e=await (0,em.v6)({count:10,refreshIndex:s.current,scene:l});if(c.current=!1,0===e.statusCode&&0!==e.awemeList.length)s.current+=1,u(l=>{let t=e.awemeList.filter(e=>(0,ef.P)(e)).filter(e=>!l.find(l=>l.awemeId===e.awemeId)),o=[...l,...t];return v.current===l.length-1&&!m.current&&(f.dispatch({listenNextAwemeInfo:o[v.current+1]||null,listenPrevAwemeInfo:o[v.current-1]||null}),m.current=o[v.current+1]||null),o})}};if(void 0!==t){f.dispatch({listenPrevAwemeInfo:d[t-1]||null,listenNextAwemeInfo:d[t+1]||null}),a(t),v.current=t,await i(t);return}"incr"===o?a(e=>{let l=Math.min(e+1,d.length-1);return v.current=l,i(l),f.dispatch({listenPrevAwemeInfo:d[l-1]||null,listenNextAwemeInfo:d[l+1]||null}),m.current=d[l+1]||null,l}):"decr"===o&&a(e=>{let l=Math.max(e-1,0);return v.current=l,f.dispatch({listenPrevAwemeInfo:d[l-1]||null,listenNextAwemeInfo:d[l+1]||null}),m.current=d[l+1]||null,l})},[a,d,f])}},eg=e=>{let{player:l,abTestData:t,awemeInfo:o,chapterScrollElRef:i,topLevelSidebar:r,activateCard:a,resetClosingShopRef:d,isActive:u,isInnerFeed:s}=e,[c,v]=(0,n.useState)(-1),[m,f]=(0,n.useState)(!1),_=(0,n.useRef)(""),h=(0,n.useRef)(!0),p=null==o?void 0:o.chapterInfo,g=e=>{null==e||e.stopPropagation()};return(0,n.useEffect)(()=>{if((null==l?void 0:l.on)&&(null==p?void 0:p.status)){let e=e=>{var l;let t=(null!==(l=e.currentTime)&&void 0!==l?l:0)*1e3,{list:o}=p,i=o.map(e=>e.timestamp),n=-1;for(let e=0;e<i.length;e++)t>=i[e]&&(n=e);v(n)};return l.on("timeupdate",e),()=>{l.off("timeupdate",e)}}},[l,t,p]),(0,n.useEffect)(()=>{let e=s&&_.current!==(null==o?void 0:o.awemeId);if(i.current||e){var l;return null===(l=i.current)||void 0===l||l.addEventListener("wheel",g),()=>{var e;null===(e=i.current)||void 0===e||e.removeEventListener("wheel",g)}}},[i,u,o,s]),(0,n.useEffect)(()=>{if(s&&_.current!==(null==o?void 0:o.awemeId)){var e;f(!1),_.current=null!==(e=null==o?void 0:o.awemeId)&&void 0!==e?e:""}},[o,s]),{chapterProgress:c,chapterSliderShow:m,setChapterSliderShow:f,triggerChapterSliderShow:()=>{if(!!h.current){if(h.current=!1,setTimeout(()=>{h.current=!0},500),m&&"sidebar"===r){a("chapterSidebar");return}!m&&d(),f(!m)}}}};var ew=t("447298"),eI=t("871415"),eC=t("301061"),ey=t("860684");let eS=e=>{let l=(0,ey.n)(),{onPlayer:t}=e;return(0,n.useEffect)(()=>{l&&(null==t||t(l))},[l]),null};var ek=t("613063"),eT=t.n(ek),eb=t("877639"),eN=t.n(eb),eL=t("256229"),eE=t("227266"),ex=t("667519");let eA=e=>{var l,t,o;let{originAwemeInfo:i,player:r,toast:a,isActive:d,isLast:u,modalEnterFrom:s,handleNextOnLast:c,handleOuterPlayNext:v,handleOuterPlayPrev:f,handlePrev:h,handleNext:p,isInnerFeedCondition:w,scene:C,abtestData:y,canUseListenFeed:S,changeListenVideoFeedIndex:k}=e,{isListenVideoMiniWin:T,fullScreenQuestionVars:b}=(0,eh.Iq)(e=>{let{isListenVideoMiniWin:l,fullScreenQuestionVars:t}=e;return{isListenVideoMiniWin:l,fullScreenQuestionVars:t}}),[N,L]=(0,n.useState)(i),{awemeFeed:E}=(0,e_.j)(),[x,A]=(0,n.useState)(null),[P,R]=(0,n.useState)(null),[M,V]=(0,n.useState)(null),[j,D]=(0,n.useState)(null),B=(0,n.useMemo)(()=>{var e,l,t;return null!==(t=null==y?void 0:null===(l=y.swiperOptimizeThrottle)||void 0===l?void 0:null===(e=l.basic)||void 0===e?void 0:e.delay)&&void 0!==t?t:400},[y]);(0,n.useEffect)(()=>{var e;if((null==y?void 0:null===(e=y.authorOptimize)||void 0===e?void 0:e.render)&&!d)return;let l=E.subscribe("prevAwemeInfo",e=>{A(e)}),t=E.subscribe("nextAwemeInfo",e=>{R(e)}),o=E.subscribe("listenPrevAwemeInfo",e=>{V(e)}),i=E.subscribe("listenNextAwemeInfo",e=>{D(e)});return()=>{o(),i(),l(),t()}},[d]);let[U,O]=(0,n.useState)((null==i?void 0:null===(l=i.logParams)||void 0===l?void 0:l.enter_from)||""),Z=(0,n.useRef)({});(0,n.useEffect)(()=>{var e,l,t,o;((null==N?void 0:N.awemeId)!==(null==i?void 0:i.awemeId)||(null==N?void 0:null===(e=N.authorInfo)||void 0===e?void 0:e.uid)!==(null==i?void 0:null===(l=i.authorInfo)||void 0===l?void 0:l.uid)||(null==N?void 0:null===(t=N.authorInfo)||void 0===t?void 0:t.roomId)!==(null==i?void 0:null===(o=i.authorInfo)||void 0===o?void 0:o.roomId))&&L(i)},[i,w]);let H=null!=w?w:i.awemeId!==N.awemeId;W.Le.setConfig(W.gI.IsInnerFeed,H);let K=(0,n.useCallback)(e=>{var l,t,o,n;let{inComingAwemeInfo:r,card:a}=e;if(a){let e=W.Le.getConfig(W.gI.PlayerCardInfo);W.Le.setConfig(W.gI.PlayerCardInfo,{isActive:(null==r?void 0:r.awemeId)===(null==i?void 0:i.awemeId)||d,videoCardType:a!==I.L.Comment?a:null==e?void 0:e.videoCardType,expandCardType:"chat"===a?null==e?void 0:e.expandCardType:a})}if((null==r?void 0:r.awemeId)!==(null==N?void 0:N.awemeId)||(null==r?void 0:null===(l=r.seriesInfo)||void 0===l?void 0:l.seriesId)!==(null==N?void 0:null===(t=N.seriesInfo)||void 0===t?void 0:t.seriesId)||(null==r?void 0:null===(o=r.authorInfo)||void 0===o?void 0:o.uid)!==(null==N?void 0:null===(n=N.authorInfo)||void 0===n?void 0:n.uid)||"im"===s)eT()(r,"logPb",(null==r?void 0:r.scrollLogPb)||(null==r?void 0:r.logPb)),L(e=>(E.dispatch("innerFeedAwemeInfo",r),O(l=>{var t,o,i,n,a;return(null===(t=r.logParams)||void 0===t?void 0:t.enter_from)?r.logParams.enter_from:"author_compilation_card"===l&&(null===(o=e.mixInfo)||void 0===o?void 0:o.mixId)!==(null===(i=r.mixInfo)||void 0===i?void 0:i.mixId)||"author_playlet_card"===l&&(null===(n=e.seriesInfo)||void 0===n?void 0:n.seriesId)!==(null===(a=r.seriesInfo)||void 0===a?void 0:a.seriesId)?"":l}),r)),setTimeout(()=>{F.emit(F.EVENT.feedVideoCardLocateCurrentVideo)})},[N,null==i?void 0:i.awemeId,r,y]);(0,_.Z)(()=>{d&&F.emit(F.EVENT.videoChange)},[N,d]),(0,_.Z)(()=>{!H&&W.Le.setConfig(W.gI.PlayerCardInfo,null)},[H]),(0,_.Z)(()=>{d&&r&&(r.replayed=!1,C===g.lT.Recommend&&!w&&(0,eE.Ci)())},[N,d,r]);let $=e=>{var l,t,o,i;if(!d||(null!==(o=(0,el.OB)())&&void 0!==o?o:null===(t=window)||void 0===t?void 0:null===(l=t.__QUICK_PLAYER)||void 0===l?void 0:l.playerId)!==(null==r?void 0:r.playerId)||ex.f.playNextInterceptor(b))return;let n=null==e?void 0:e.from;(0,eL.Y3)(n);let s=()=>{F.emit(F.EVENT.reportPlayNext,{clickFrom:n})};if(H||C===g.lT.Search){let e=null===(i=W.Le.getConfig(W.gI.PlayerCardInfo))||void 0===i?void 0:i.videoCardType,l=new Map([[I.L.Related,"该视频暂无更多相关作品"],[I.L.Music,"该音乐暂无更多相关作品"],[I.L.Topic,"该话题暂无更多相关作品"],[I.L.Mix,"暂无更多作品"],[I.L.Author,"该作者已无更多作品"],[I.L.Comment,"暂无更多作品"],[I.L.CollectFolder,"暂无更多作品"],[I.L.Search,"暂无更多搜索结果"],[I.L.Like,"暂无更多作品"],[I.L.Collection,"暂无更多作品"],[I.L.Record,"暂无更多作品"]]),t=new Map([[I.L.Related,"暂时无法切换，可查看其他相关视频"],[I.L.Music,"暂时无法切换，可查看其他音乐视频"],[I.L.Topic,"暂时无法切换，可查看其他话题视频"],[I.L.Mix,"暂时无法切换"],[I.L.Author,"暂时无法切换，可查看作者的其他视频"],[I.L.Comment,"暂时无法切换"],[I.L.CollectFolder,"暂时无法切换"],[I.L.Search,"暂时无法切换，请在「搜索结果」中选择"],[I.L.Like,"暂时无法切换"],[I.L.Collection,"暂时无法切换"],[I.L.Record,"暂时无法切换"]]);if(P)K({inComingAwemeInfo:P,card:e}),("scroll"===n||"keyboard"===n||"auto"===n||T&&"click_button"===n)&&s();else if("auto"===n)r&&(r.isReplay=!0,r.replay(),r.replayed=!0);else if(null===P){let l=t.get(e);l&&a(l)}else{let t=l.get(e);t&&a(t)}}else T&&!H&&S?j&&(L(j),k({changeMode:"incr"}),("scroll"===n||"keyboard"===n||"auto"===n||"click_button"===n)&&s()):(u&&(null==c||c()),v(e),u&&(null==e?void 0:e.from)==="auto"&&r&&(r.isReplay=!0,r.replay(),r.replayed=!0));null==p||p()},z=(0,n.useCallback)((null==y?void 0:null===(t=y.swiperOptimizeThrottle)||void 0===t?void 0:t.basic.logic)?eN()($,B,{leading:!0,trailing:!1}):m()($,B,{leading:!0,trailing:!1}),[y,B,j,P,r,d,c,H,u,v,T,k,S,b]),G=e=>{if(!d||ex.f.playPrevInterceptor(b))return;let l=null==e?void 0:e.from,t=()=>{F.emit(F.EVENT.reportPlayPrev,{clickFrom:l})};if((0,eL.Y3)(l),H){var o;let e=null===(o=W.Le.getConfig(W.gI.PlayerCardInfo))||void 0===o?void 0:o.videoCardType,i=new Map([[I.L.Related,"暂时无法切换，可查看其他相关视频"],[I.L.Music,"暂时无法切换，可查看其他音乐视频"],[I.L.Topic,"暂时无法切换，可查看其他话题视频"],[I.L.Mix,"暂无无法切换"],[I.L.Author,"暂时无法切换，可查看作者的其他视频"],[I.L.Search,"暂无无法切换"]]);if(x)K({inComingAwemeInfo:x,card:e}),("scroll"===l||"keyboard"===l||"auto"===l||T&&"click_button"===l)&&t();else if(null===x){let l=i.get(e);l&&a(l)}}else T&&!H&&S?M&&(L(M),k({changeMode:"decr"}),("scroll"===l||"keyboard"===l||"auto"===l||"click_button"===l)&&t()):setTimeout(()=>null==f?void 0:f(e),0);null==h||h()},q=(0,n.useCallback)((null==y?void 0:null===(o=y.swiperOptimizeThrottle)||void 0===o?void 0:o.basic.logic)?eN()(G,B,{leading:!0,trailing:!1}):m()(G,B,{leading:!0,trailing:!1}),[y,B,M,x,d,H,f,k,T,S,b]);return{listenFeedPrevAwemeInfo:M,listenFeedNextAwemeInfo:j,awemeInfo:N,enterFrom:U,updateAwemeInfo:K,changePrevVideo:q,changeNextVideo:z,nextAwemeInfo:P,prevAwemeInfo:x,isInnerFeed:H,updateLogParams:(0,n.useCallback)(e=>{let{logParams:l}=e;Z.current=l},[])}};var eP=t("20157"),eR=t("155714");let eM=e=>{let{abtestData:l,isModal:t,awemeInfo:o,isActive:i,fetchAuthorPost:r,player:a,scene:d}=e,[u,s]=(0,n.useState)(0);return(0,n.useEffect)(()=>{var e,n,a;if(!(!(0,$.km)(80)&&(0,$.i7)())||!i||t||d!==g.lT.Recommend||(null===(e=l.smartDataTrackConfig)||void 0===e?void 0:e.scene)!==eP.P.AUTHOR_CARD_PRELOAD||0!==u||(null==o?void 0:o.isAds))return;let c=null===(n=(0,eR.lZ)())||void 0===n?void 0:n.getSceneByName(eP.P.AUTHOR_CARD_PRELOAD);if(c){let e=setTimeout(async()=>{var e;null==c||null===(e=c.inference(null==o?void 0:o.awemeId))||void 0===e||e.then(e=>{e&&(s(2),r(o),s(3))})},null===(a=l.authorCardPreload)||void 0===a?void 0:a.wait_time);return()=>{clearTimeout(e),e=null}}},[i,d,l,t]),{preloadStatus:u}};t("950331"),t("268917");var eV=t("669201"),eF=t("507217"),ej=t("122691"),eD=t("788418"),eB=t("102337"),eW=t("993287");let eU=e=>{var l,t;let{showRelateVideo:o=eV.TP.ShowSideCarOnly}=(null==e?void 0:null===(t=e.webRawData)||void 0===t?void 0:null===(l=t.CTR)||void 0===l?void 0:l.recommendScore)||{};return o===eV.TP.ShowSideCarOnly},eO=e=>{let{awemeInfo:l,scene:t,modalEnterFrom:o,filterData:i,currentVideoFeedRef:r,lastVideoFeedAwemeRef:a,outFeedItem:d,isInnerFeed:u,abtestData:s}=e,c=[],{normalList:v,relatedBlockedByRecommendScore:m}=(0,n.useMemo)(()=>{var e,i,n,c,v,m,f,_;let h=[I.L.Comment],p=!1;if((null==l?void 0:l.awemeType)!==(null==eF?void 0:b.e.XgVideo)&&!(0,y.Jt)(l)&&!(0,y.gc)(l)&&h.unshift(I.L.Author),"collection_folder"===o)h.unshift(I.L.CollectFolder);(null==s?void 0:s.aiNoteV2)===2&&(null==l?void 0:l.awemeType)!==(null==eF?void 0:b.e.XgVideo)&&!(0,y.Jt)(l)&&!(0,y.gc)(l)&&h.unshift(I.L.VideoDetail);let w=[g.lT.Recommend,g.lT.Follow,g.lT.Topic].includes(t),k=t===g.lT.Modal&&![C.a.Im,C.a.Search,C.a.GeneralSearch].includes(o),T=[y.Jt,y.gc,y.Kf,ej.L,eD.A,eB.u,S.p,eW.hj,L.o4];return(w||k)&&T.every(e=>!e(l))&&(!u||(null==d?void 0:d.awemeId)===l.awemeId&&T.every(e=>!e(d))||(null===(i=a.current)||void 0===i?void 0:null===(e=i[I.t.Related])||void 0===e?void 0:e.awemeId)===l.awemeId||r.current===I.t.Related)&&(eU(u?d:l)?h.push(I.L.Related):p=!0),(null==l?void 0:null===(n=l.mixInfo)||void 0===n?void 0:n.mixId)&&!(null==l?void 0:null===(c=l.seriesInfo)||void 0===c?void 0:c.seriesId)&&h.push(I.L.Mix),(null==l?void 0:null===(v=l.seriesInfo)||void 0===v?void 0:v.seriesId)&&h.push(I.L.Series),(null==l?void 0:l.hotList)&&(null==l?void 0:null===(m=l.hotList)||void 0===m?void 0:m.rank)!==51&&(null==l?void 0:null===(f=l.hotList)||void 0===f?void 0:f.type)!==2&&h.push(I.L.Hot),(null==l?void 0:l.videoAbstract)&&[2,3].includes(null==l?void 0:null===(_=l.videoAbstract)||void 0===_?void 0:_.displayType)&&(t===g.lT.Search||g.lT.Modal===t&&[C.a.GeneralSearch,C.a.Search].includes(o)&&!u)&&h.push(I.L.AbstractList),{normalList:h,relatedBlockedByRecommendScore:p}},[l,o,t,r.current,d,u,a.current]);return[g.lT.Recommend,g.lT.Follow,g.lT.Friend,g.lT.Modal,g.lT.Topic,g.lT.Search].includes(t)&&(c=v),{showRelatedTabList:(0,n.useMemo)(()=>i?i(c):c,[c.join(","),i]),relatedBlockedByRecommendScore:m}},eZ=e=>{let{awemeInfo:l,clickedCard:t,isActive:o,withCtr:i=!0}=e;return(0,n.useEffect)(()=>{let e=W.Le.getConfig(W.gI.PlayerCardInfo);return t&&W.Le.setConfig(W.gI.PlayerCardInfo,{isActive:o,videoCardType:t!==I.L.Comment?t:null==e?void 0:e.videoCardType,expandCardType:t}),()=>{W.Le.setConfig(W.gI.PlayerCardInfo,null)}},[]),{defaultCard:(0,n.useMemo)(()=>t?t:l?i&&l.awemeType===b.e.XgVideo?I.L.Related:I.L.Author:I.L.Author,[l,i,t])}};var eH=t("948375");let eK=e=>{let{isShow:l,player:t,isActive:o,awemeInfo:i,abtestData:r}=e,a=(0,n.useRef)(!1),d=(0,n.useRef)(()=>{});d.current=(0,n.useCallback)(()=>{a.current&&(setTimeout(()=>{F.emit(F.EVENT.videoRemoveStopPlayNext)}),a.current=!1)},[t]);let u=(0,eH.Z)(()=>{t&&o&&t.duration-t.currentTime>0&&t.duration-t.currentTime<=5&&!a.current&&l&&(null==i?void 0:i.awemeType)!==b.e.Note&&(F.emit(F.EVENT.videoStopPlayNext),a.current=!0,t.once(p.Events.ENDED,d.current))});return(0,n.useEffect)(()=>{if(l)return()=>{d.current()}},[l]),(0,n.useEffect)(()=>{if(i)return()=>{d.current()}},[i]),{stopAutoPlay:u}};var e$=t("123407");let ez=e=>{let{awemeInfo:l,onAwemeInfoChange:t}=e;(0,n.useEffect)(()=>{var e;(null===(e=W.Le.getConfig(W.gI.IsInModalVideo))||void 0===e?void 0:e.isInModal)&&F.emit(F.EVENT.livePause)},[]),(0,n.useEffect)(()=>{null==t||t({awemeInfo:l})},[l])},eG=e=>{let{curTab:l,awemeInfo:t,isActive:o,abtestData:i,modalAwemeInfo:r}=e,{setSlideVideoTab:a}=(0,n.useContext)(Q.C);(0,n.useEffect)(()=>{o&&(null==a||a(l))},[l,o,null==r?void 0:r.awemeId])},eq=e=>{let{onChangeAwemeInfo:l}=e,t=(0,eH.Z)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I.L.Author;return l({inComingAwemeInfo:e,card:t})});return{handleAuthorVideoChange:t,handleOtherVideoChange:(0,n.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I.L.Related;l({inComingAwemeInfo:e,card:t})},[l])}};var eQ=t("185791"),eX=t("587526"),eY=t("28237"),eJ=t("919780"),e0=t("598467"),e1=t("55426"),e2=t("150566"),e3=t("94126"),e7=t("56733"),e8=t("881155"),e5=t("901414");let e6=e=>{let{awemeInfo:l,logParams:t={},originAwemeInfo:i,tagId:a,expandCard:d,curCard:u="",isInnerFeedCondition:s=!1,searchSideCardProps:c,modalEnterFrom:v}=e,m=(0,n.useRef)(t),f=(0,n.useMemo)(()=>{var e,t,o;return null!==(o=null===(t=W.Le.getConfig(W.gI.UnLookVideos))||void 0===t?void 0:null===(e=t[null==l?void 0:l.awemeId])||void 0===e?void 0:e.status)&&void 0!==o?o:""},[l]);return(0,n.useEffect)(()=>{var e,n,_,h,p,g,w,S,T,N,L,E,x,A,P,R,M,V,F,j,D,B,O,H,K,$,z,G,q,Q;let X=null==t?void 0:t.enter_from,Y="";""!==u&&(Y=u===d&&"comment"!==u?"1":"0");let J={};if((0,eY.n)(l)){let e=(null==l?void 0:null===(K=l.anchorInfo)||void 0===K?void 0:null===(H=K.extra)||void 0===H?void 0:H[0])||{};J={anchor_product_comment_cnt:e.comment_count,anchor_product_category_id:e.front_category_id,anchor_product_price:e.price,anchor_product_sales:e.sales}}let ee=(0,r._)((0,o._)((0,r._)((0,o._)((0,r._)((0,o._)({enter_from:null!==($=t.enter_from)&&void 0!==$?$:(0,Z.yW)(),web_rid:null==l?void 0:null===(_=l.authorInfo)||void 0===_?void 0:null===(n=_.roomData)||void 0===n?void 0:null===(e=n.owner)||void 0===e?void 0:e.web_rid},t),{is_card_expand:Y,from_group_id:null!==(z=t.from_group_id)&&void 0!==z?z:null==i?void 0:i.awemeId,music_id:null==l?void 0:null===(h=l.music)||void 0===h?void 0:h.mid,compilation_id:null==l?void 0:null===(p=l.mixInfo)||void 0===p?void 0:p.mixId,tag_id:a,from_xigua:(null==l?void 0:l.awemeType)===b.e.XgVideo?1:0,insert_task_id:(null==l?void 0:l.libfinsertTaskId)||"0",boost_task_id:(null==l?void 0:l.boostTaskId)||"",enter_from_merge:null!==(G=t.enter_from_merge)&&void 0!==G?G:(0,Z.yW)(),search_params:null==l?void 0:l.searchLogParams,from_video_id:W.Le.getConfig(W.gI.PageEnterFromVideoID),is_seen:v===C.a.FollowAuthorModal&&""===f?1:f,is_update:(null===(g=W.Le.getConfig(W.gI.UnLookVideos))||void 0===g?void 0:g[null==l?void 0:l.awemeId])?1:0,post_time:(0,e1.MH)(1e3*l.createTime),is_from_skylight:null!==(q=null==t?void 0:t.is_from_skylight)&&void 0!==q?q:0}),(0,U.t)()),{is_co_publish:(null==l?void 0:null===(S=l.cooperationInfo)||void 0===S?void 0:null===(w=S.cooperationCreators)||void 0===w?void 0:w.length)>1?1:0,co_publish_author_list:null==l?void 0:null===(L=l.cooperationInfo)||void 0===L?void 0:null===(N=L.cooperationCreators)||void 0===N?void 0:null===(T=N.filter(e=>e.roleId!==eF.CooperationRoleId.Author))||void 0===T?void 0:T.map(e=>`${e.uid}_${null==e?void 0:e.roleId}`),cid:null===(E=(0,y.Rx)(l))||void 0===E?void 0:E.creative_id,if_qianchuan_ad:(0,y.nT)(l)===k.Z9.Live||(0,y.nT)(l)===k.Z9.ShopVideo?1:0,ad_type:(0,y.nT)(l),brand_ad_type:eJ.AD_LOG_MAP[null==l?void 0:null===(A=l.webRawData)||void 0===A?void 0:null===(x=A.brandAd)||void 0===x?void 0:x.brand_type]}),(null==l?void 0:l.logParams)||{},J),{playlet_id:null==l?void 0:null===(P=l.seriesInfo)||void 0===P?void 0:P.seriesId,is_trailer:(null==l?void 0:null===(M=l.chargeInfo)||void 0===M?void 0:null===(R=M.preview_config)||void 0===R?void 0:R.is_preview)?1:0,module:decodeURIComponent((0,e2.Rs)("module")||""),payment_status:(0,e8.wQ)(l),episode_rank:(null==l?void 0:null===(V=l.seriesInfo)||void 0===V?void 0:V.currentEpisode)||(null==l?void 0:null===(F=l.mixInfo)||void 0===F?void 0:F.currentEpisode)||0,episode_id:String((null==l?void 0:null===(j=l.seriesInfo)||void 0===j?void 0:j.currentEpisode)||(null==l?void 0:null===(D=l.mixInfo)||void 0===D?void 0:D.currentEpisode)||0),is_charge_content:(null==l?void 0:null===(B=l.chargeInfo)||void 0===B?void 0:B.is_charge_content)?1:0,is_hard_ad:(0,y.Jt)(l)?(0,y.Gu)(l)?1:0:void 0,is_ting_window:e5.e.activeScene===e0.d.ListenVideo?1:0,is_from_aweme_search_engine:(0,e3.V)()?1:0}),el=[I.L.Author,I.L.Hot,I.L.Mix,I.L.Music,I.L.Related,I.L.Topic,I.L.AwemeRelated,I.L.Search,I.L.History,I.L.Like,I.L.CollectFolder,I.L.Collection,I.L.Handpick];if(null!=s?s:(null==i?void 0:i.awemeId)!==(null==l?void 0:l.awemeId)){if(el.includes(u))X=u;else{if(u===I.L.Comment){let e=W.Le.getConfig(W.gI.PlayerCardInfo),l=W.Le.getConfig(W.gI.CurLookCard);X=(null==l?void 0:l.curCard)?null==l?void 0:l.curCard:(null==e?void 0:e.isActive)&&(null==e?void 0:e.videoCardType)?null==e?void 0:e.videoCardType:null==t?void 0:t.enter_from}m.current=(0,o._)({},ee)}}(null==c?void 0:c.scene)&&(null==i?void 0:i.awemeId)!==(null==l?void 0:l.awemeId)&&!s&&(X=(0,e7.V)(null==c?void 0:c.scene,l,null==t?void 0:null===(Q=t.search_params)||void 0===Q?void 0:Q.token_type),W.Le.setConfig(W.gI.PlayerCardInfo,{videoCardType:X,expandCardType:X,isActive:!0})),(null==l?void 0:null===(O=l.logParams)||void 0===O?void 0:O.enter_from)?m.current=(0,r._)((0,o._)({},ee),{enter_from:l.logParams.enter_from}):X?m.current=(0,r._)((0,o._)({},ee),{enter_from:X}):m.current=(0,o._)({},ee)},[t,u,d,l,i,a,f,s]),{reportParams:m.current}},e4=e=>{let{isActive:l,player:t,showSideCard:o}=e,[i,r]=(0,n.useState)(!1),a=(0,n.useRef)(!1);return(0,n.useEffect)(()=>{var e,i;let n;a.current?l&&o&&r(!0):n=setTimeout(()=>{l&&o&&r(!0)},3e3);let d=()=>{a.current=!0,clearTimeout(n),o&&r(!0)};return null==t||null===(e=t.on)||void 0===e||e.call(t,p.Events.CANPLAY,d),null==t||null===(i=t.once)||void 0===i||i.call(t,p.Events.TIME_UPDATE,d),()=>{var e,l;null==t||null===(e=t.off)||void 0===e||e.call(t,p.Events.CANPLAY,d),null==t||null===(l=t.off)||void 0===l||l.call(t,p.Events.TIME_UPDATE,d),clearTimeout(n)}},[t,l,o]),{hasRelatedCardShown:i}};var e9=t("307362"),le=t("567754"),ll=t("358003"),lt=t("42589");let lo=e=>{let{awemeInfo:l,abtestData:t,isActive:o,isLogin:i,onOpenCard:r,accountParentEl:a,onLoginSuccess:d,isInnerFeed:u}=e,s=(null==t?void 0:t.aiNoteV2)===1||(null==t?void 0:t.aiNoteV2)===2,[c,v]=(0,n.useState)(!1),[m,f]=(0,n.useState)(!1),[p,g]=(0,n.useState)(),w=e=>{let{aiNoteEnterMethod:l,onLoginSuccess:t,onLoginCancel:o}=e,n=()=>{l&&g(l),r(),f(!0),v(!0)};if(i)n();else{var u,s;(0,ll.default)({success:async()=>{null==d||d(),n(),null==t||t()},onClose:()=>{f(!1),null==o||o()},headerText:"登录后即可使用AI笔记",enterMethod:"ai_search_card_click",next:`https://${null===(s=window)||void 0===s?void 0:null===(u=s.location)||void 0===u?void 0:u.host}`},a)}},I=(0,n.useCallback)(()=>{if(!!o)F.emit(F.EVENT.closeAiNoteCard,{awemeId:null==l?void 0:l.awemeId}),f(!1)},[null==l?void 0:l.awemeId,o]),C=(0,n.useCallback)(e=>{m?I():w(e)},[m,w]);(0,n.useEffect)(()=>()=>{I()},[]),(0,n.useEffect)(()=>{!o&&(F.emit(F.EVENT.closeAiNoteCard,{awemeId:null==l?void 0:l.awemeId}),f(!1))},[o,null==l?void 0:l.awemeId]),(0,_.Z)(()=>{!u&&I()},[u]),(0,N.o)(()=>{let e=F.listen(F.EVENT.openAiNoteCard,e=>{if((null==e?void 0:e.awemeId)===(null==l?void 0:l.awemeId)&&!!o)w(e)}),t=F.listen(F.EVENT.toggleAiNoteCard,e=>{if((null==e?void 0:e.awemeId)===(null==l?void 0:l.awemeId)&&!!o)C(e)});return()=>{e(),t()}},[o,l,i,d,a,r]);let{pathname:S,search:k}=(0,h.a)();return{isShowAiCard:m,closeAiCard:I,renderAiCard:c,aiNoteProps:{enterMethod:p},isAiNoteUseable:(0,n.useMemo)(()=>{var e;if(!l||(0,$.km)(78)||[b.e.LiveCard,b.e.Note].includes(l.awemeType)||(0,y.Jt)(l)||(0,y.Kf)(l)||"video_detail"===(0,Z.yW)())return!1;let{showTab:t}=le.parse(k);return"/user/self"===S&&"ai_note"===t||s&&(null==l?void 0:null===(e=l.douyinPcVideoExtra)||void 0===e?void 0:e.aiNoteV2)===1},[l,s])}},li=e=>{let{awemeInfo:l,isActive:t,isLogin:o,onOpenCard:i,accountParentEl:r,onLoginSuccess:a,isInnerFeed:d,isAiNoteCardShow:u,globalIsShowAiCard:s,setGlobalIsShowAiCard:c,setHasDefaultShowAiCard:v,otherCardIsOpen:m,aiCardIsPined:f,abtestData:_,aiSearchIsDefaultShow:h}=e,p=(null==_?void 0:_.aiNoteV2)===1||(null==_?void 0:_.aiNoteV2)===2,g=t&&p,[w,I]=(0,n.useState)(g),[C,y]=(0,n.useState)(!1),{aiEntryVisible:S}=(0,lt.$)({isLogin:o,awemeInfo:l,checkAiNote:!1}),k=!!o&&(c&&S?s:C),T=c&&S?c:y,b=(0,n.useCallback)(e=>{T(e),e&&(null==v||v(!0))},[T,v]);(0,n.useEffect)(()=>{g&&I(!0)},[g]);let L=(0,n.useRef)(!1),[E,x]=(0,n.useState)(h?Y.jE.AutoShow:void 0),[A,P]=(0,n.useState)("bottom_bar"!==E&&"bottom_bar_mention"!==E),[R,M]=(0,n.useState)("");(0,n.useEffect)(()=>{!L.current&&P("bottom_bar"!==E&&"bottom_bar_mention"!==E)},[E]);let V=e=>{let{from:l,word:t,onLoginSuccess:n,onLoginCancel:d}=e,u=()=>{l&&x(l),t&&M(t),i(),b(!0),L.current=!0};if(o)u();else{var s,c;(0,ll.default)({success:async()=>{null==a||a(),u(),null==n||n()},onClose:()=>{b(!1),null==d||d()},headerText:"登录后即可使用问问AI",enterMethod:"ai_search_card_click",next:`https://${null===(c=window)||void 0===c?void 0:null===(s=c.location)||void 0===s?void 0:s.host}`},r)}},j=()=>{if(!!t)b(!1)},D=(0,n.useCallback)(l=>{if(f&&m){V(e);return}k&&!u?j():V(l)},[k,u,V,m,f]);return(0,N.o)(()=>F.listen(F.EVENT.aiSearchEntranceVisibleChange,e=>{if((null==e?void 0:e.awemeId)===(null==l?void 0:l.awemeId)&&!!t)P(null==e?void 0:e.visible)}),[l,t]),(0,N.o)(()=>{let e=F.listen(F.EVENT.openAiSearchCard,e=>{if((null==e?void 0:e.awemeId)===(null==l?void 0:l.awemeId)&&!!t)V(e)}),o=F.listen(F.EVENT.toggleAiSearchCard,e=>{if((null==e?void 0:e.awemeId)===(null==l?void 0:l.awemeId)&&!!t)D(e)}),i=F.listen(F.EVENT.renderAiSearchCard,e=>{if((null==e?void 0:e.awemeId)===(null==l?void 0:l.awemeId)&&!!t)x(null==e?void 0:e.from)});return()=>{e(),o(),i()}},[t,l,o,a,r,i]),{isShowAiCard:k,closeAiCard:j,renderAiCard:w,openAiCard:V,aiSearchProps:{keyword:R,entryFrom:E,isColdStart:A}}};var ln=t("480596"),lr=t("598053"),la=t("325982"),ld=t("842517"),lu=t("945977"),ls=t("176638");let lc=e=>{let{awemeInfo:l,userInfo:t,onOpenCard:o,isActive:i,onCloseAdCard:r,abtestData:a,toast:d,isFirst:u,isUpperFeed:s,changeSplashAdStatus:c}=e,v=(0,n.useRef)(ln.TCC_DEFAULT_VALUE_MAP.get(ln.TccKey.AdConfig)),[m,f]=(0,n.useState)(!1),_=(0,n.useRef)(!1),h=(0,n.useRef)(!1);(0,n.useEffect)(()=>{_.current=!1,h.current=!1,f(!1)},[l]),(0,n.useEffect)(()=>{let e=!1;return(async()=>{let l=await lr.get({key:ln.TccKey.AdConfig,defaultValue:ln.TCC_DEFAULT_VALUE_MAP.get(ln.TccKey.AdConfig)});!e&&(v.current=l)})(),()=>{e=!0}},[]);let p=(0,n.useCallback)(e=>{let{from:l}=e||{};"closeIcon"===l&&(_.current=!0),h.current&&(h.current=!1,F.emit(F.EVENT.videoRemoveStopPlayNext,{openSideCard:!0})),f(!1),null==r||r()},[r]),g=(0,n.useCallback)(e=>{var i,n,r,a;let{from:u}=e||{},s=(0,y.Rx)(l),c=(0,y.BD)(l);if("automatic"!==u&&!h.current&&(h.current=!0,F.emit(F.EVENT.videoStopPlayNext,{openSideCard:!0})),"keyboard"===u&&(0,la.E)("realtime_click",{tag:(0,lu.f)(),value:null==s?void 0:s.creative_id,log_extra:null==s?void 0:s.log_extra,refer:"enter"}),(0,L.o4)(l))return;if((0,eW.hj)(l)){if(F.emit(F.EVENT.videoPause,"SliderVideo_openAdCard"),(null==c?void 0:null===(n=c.lynx_raw_data)||void 0===n?void 0:n.open_url)||(null==s?void 0:s.open_url)){let e=(0,eW.at)({rawAdData:s,extraParams:{enter_from_merge:"web_homepage_hot",enter_method:"web_video_commercialize",action_type:"click",group_id:l.awemeId,request_id:l.logPb}});window.open(e,(0,ls.f)()?"_self":"_blank")}else d?d("广告链接获取失败，请跳过"):ev.F.info("广告链接获取失败，请跳过"),(0,la.E)("load_failed",{tag:(0,lu.f)(),value:s.creative_id,log_extra:s.log_extra});return}if((0,ej.L)(l)||(0,eB.u)(l)){(null==c?void 0:null===(r=c.lynx_raw_data)||void 0===r?void 0:r.web_url)?(f(!0),null==o||o({isAuto:"automatic"===u}),(0,la.E)("detail_show",{tag:"landing_ad",value:s.creative_id,log_extra:s.log_extra})):(d?d("广告链接获取失败，请跳过"):ev.F.info("广告链接获取失败，请跳过"),(0,la.E)("load_failed",{tag:(0,lu.f)(),value:null==s?void 0:s.creative_id,log_extra:null==s?void 0:s.log_extra}));return}let m=!1;if(null==c?void 0:null===(i=c.lynx_raw_data)||void 0===i?void 0:i.web_url){if(!(null===(a=v.current)||void 0===a?void 0:a.openInSidebarCondition.siteTypes.includes(s.site_type))||(0,z.DT)()){if("automatic"!==u){let e=(0,ld.J2)({awemeInfo:l,userInfo:t});m=!0,window.open(e,(0,ls.f)()?"_self":"_blank")}}else f(!0),m=!0,null==o||o({isAuto:"automatic"===u})}else d?d("广告链接获取失败，请跳过"):ev.F.info("广告链接获取失败，请跳过"),(0,la.E)("load_failed",{tag:(0,lu.f)(),value:null==s?void 0:s.creative_id,log_extra:null==s?void 0:s.log_extra});m&&(0,la.E)("detail_show",{tag:"landing_ad",value:s.creative_id,log_extra:s.log_extra})},[l,t,o,a]);return(0,N.o)(()=>F.listen(F.EVENT.openAdSideCard,e=>{if(i){(null==e?void 0:e.from)==="automatic"&&_.current||g({from:null==e?void 0:e.from});let t=(0,y.Rx)(l);(null==e?void 0:e.from)==="keyboard"&&(0,la.E)("slide",{tag:(0,lu.f)(),value:t.creative_id,log_extra:t.log_extra})}}),[i,g,l]),(0,n.useEffect)(()=>{u&&!s&&i&&(null==c||c((0,S.p)(l)?k.QB.Fullscreen:k.QB.Normal))},[]),(0,n.useEffect)(()=>{i?(!u&&(null==c||c(k.QB.Normal)),h.current=!1):f(!1)},[i]),{closeAdCard:p,openAdCard:g,isShowAdCard:m,isAdAweme:(0,y.Jt)(l)}},lv=e=>{let{onOpenCard:l,awemeInfo:t,isInnerFeed:o,isActive:i}=e,[r,a]=(0,n.useState)(!1),d=()=>{a(!1)};return(0,n.useEffect)(()=>{o&&d()},[o]),(0,n.useEffect)(()=>{!i&&d()},[i]),{isShowRecommendWhiteTagSideCard:r,openRecommendWhiteTagSideCard:()=>{a(!0),null==l||l()},closeRecommendWhiteTagSideCard:d}};var lm=t("574138");let lf=e=>{let{awemeInfo:l,isActive:t,isLogin:o,onOpenCard:i,accountParentEl:r,onLoginSuccess:a,isInnerFeed:d,globalIsShowAiCard:u,setGlobalIsShowAiCard:s,setHasDefaultShowAiCard:c,otherCardIsOpen:v,aiCardIsPined:m,abtestData:f,aiSearchIsDefaultShow:_}=e,h=(null==f?void 0:f.aiNoteV2)===1||(null==f?void 0:f.aiNoteV2)===2,p=t&&!h,[g,w]=(0,n.useState)(p),{aiEntryVisible:I}=(0,lt.$)({isLogin:o,awemeInfo:l}),[C,y]=(0,n.useState)(!1),S=!!o&&(s&&I?u:C),k=s&&I?s:y,T=(0,n.useCallback)(e=>{k(e),e&&(null==c||c(!0))},[k,c]);(0,n.useEffect)(()=>{p&&w(!0)},[p]);let b=(0,n.useRef)(!1),[L,E]=(0,n.useState)(_?Y.jE.AutoShow:void 0),[x,A]=(0,n.useState)(""),P=["bottom_bar","bottom_bar_mention","comment_related_search_ai_search","comment_named_entity_search_ai_search"],[R,M]=(0,n.useState)(!P.includes(L||"")),[V,j]=(0,n.useState)(),[D,B]=(0,n.useState)(""),[W,U]=(0,n.useState)(lm.X.Search);(0,n.useEffect)(()=>{!b.current&&M(!P.includes(L||""))},[L]),(0,n.useEffect)(()=>{W===lm.X.Note&&E(void 0)},[W]);let O=e=>{let{tab:l,from:t,word:n,cid:d,aiNoteEnterMethod:u,onLoginSuccess:s,onLoginCancel:c}=e,v=()=>{d&&A(d),t&&E(t),n&&B(n),l&&U(l),u&&j(u),i(),T(!0),l===lm.X.Search&&(b.current=!0)};if(o)v();else{var m,f;(0,ll.default)({success:async()=>{null==a||a(),v(),null==s||s()},onClose:()=>{T(!1),null==c||c()},headerText:"登录后即可使用问问AI",enterMethod:"ai_search_card_click",next:`https://${null===(f=window)||void 0===f?void 0:null===(m=f.location)||void 0===m?void 0:m.host}`},r)}},Z=()=>{if(!!t)T(!1)},H=(0,n.useCallback)(e=>{let{tab:l,aiNoteEnterMethod:t}=e;if(m&&v){O(e);return}S?l?W===l?Z():(U(l),j(t)):Z():O(e)},[S,W,O,v,m]);return(0,N.o)(()=>F.listen(F.EVENT.aiSearchEntranceVisibleChange,e=>{if((null==e?void 0:e.awemeId)===(null==l?void 0:l.awemeId)&&!!t)M(null==e?void 0:e.visible)}),[l,t]),(0,N.o)(()=>{let e=F.listen(F.EVENT.openAiCard,e=>{if(h){(null==e?void 0:e.tab)===lm.X.Note?F.emit(F.EVENT.openAiNoteCard,e):F.emit(F.EVENT.openAiSearchCard,e);return}if((null==e?void 0:e.awemeId)===(null==l?void 0:l.awemeId)&&!!t)O(e)}),o=F.listen(F.EVENT.toggleAiCard,e=>{if(h){(null==e?void 0:e.tab)===lm.X.Note?F.emit(F.EVENT.toggleAiNoteCard,e):F.emit(F.EVENT.toggleAiSearchCard,e);return}if((null==e?void 0:e.awemeId)===(null==l?void 0:l.awemeId)&&!!t)H(e)}),i=F.listen(F.EVENT.renderAiCard,e=>{if(h){F.emit(F.EVENT.renderAiSearchCard,e);return}if((null==e?void 0:e.awemeId)===(null==l?void 0:l.awemeId)&&!!t)E(null==e?void 0:e.from),(null==e?void 0:e.cid)&&A(null==e?void 0:e.cid)});return()=>{e(),o(),i()}},[h,t,l,o,a,r,i]),{renderAiCard:g,isShowAiCard:S,closeAiCard:Z,activeAiCardTab:W,setActiveAiCardTab:U,setAiNoteEnterMethod:j,aiSearchEntryFrom:L,aiSearchKeyword:D,aiNoteEnterMethod:V,isColdStart:R,conversationId:x,openAiCard:O}},l_=e=>{let{awemeInfo:l,abtestData:t}=e,{renderAiCard:o,isShowAiCard:i,closeAiCard:r,activeAiCardTab:a,setActiveAiCardTab:d,setAiNoteEnterMethod:u,aiSearchEntryFrom:s,aiSearchKeyword:c,aiNoteEnterMethod:v,isColdStart:m,conversationId:f,openAiCard:_}=lf(e),{pathname:p,search:g}=(0,h.a)();return{isShowAiCard:i,closeAiCard:r,renderAiCard:o,activeAiCardTab:a,setActiveAiCardTab:d,setAiNoteEnterMethod:u,aiSearchProps:{keyword:c,entryFrom:s,isColdStart:m,conversationId:f},aiNoteProps:{enterMethod:v},isAiNoteUseable:(0,n.useMemo)(()=>{var e;if(!l||(0,$.km)(78)||[b.e.LiveCard,b.e.Note].includes(l.awemeType)||(0,y.Jt)(l)||(0,y.Kf)(l)||"video_detail"===(0,Z.yW)())return!1;let{showTab:t}=le.parse(g);return"/user/self"===p&&"ai_note"===t||(null==l?void 0:null===(e=l.douyinPcVideoExtra)||void 0===e?void 0:e.aiNote)===1},[l]),openAiCard:_}},lh=e=>{let{aiCardElRef:l,isShowAiCard:t}=e;(0,n.useEffect)(()=>{var e,t,o,i;let n=e=>{null==e||e.stopPropagation(),F.emit(F.EVENT.globalEventPrevented)},r=e=>{null==e||e.stopPropagation(),F.emit(F.EVENT.globalEventPrevented)};return null===(e=l.current)||void 0===e||e.addEventListener("wheel",n),null===(t=l.current)||void 0===t||t.addEventListener("mousedown",r),null===(o=l.current)||void 0===o||o.addEventListener("pointerdown",r),null===(i=l.current)||void 0===i||i.addEventListener("touchstart",r),()=>{var e,t,o,i;null===(e=l.current)||void 0===e||e.removeEventListener("wheel",n),null===(t=l.current)||void 0===t||t.removeEventListener("mousedown",r),null===(o=l.current)||void 0===o||o.removeEventListener("pointerdown",r),null===(i=l.current)||void 0===i||i.removeEventListener("touchstart",r)}},[l.current,t])};var lp=t("155087");let lg=e=>{let{awemeInfo:l,isActive:t,abtestData:o,isInnerFeed:i,onOpenCard:r}=e,[a,d]=(0,n.useState)(!1),u=()=>{d(!1),F.emit(F.EVENT.closeVideoInfoSideCard,{awemeId:null==l?void 0:l.awemeId})};return(0,N.o)(()=>{var e;if(!isInLiveChildRoute(null===(e=location)||void 0===e?void 0:e.pathname))return F.listen(F.EVENT.openVideoInfoSideCard,e=>{if((null==e?void 0:e.awemeId)===(null==l?void 0:l.awemeId)&&!!t)d(!0),null==r||r()})},[l,t,r]),(0,N.o)(()=>{var e;if(!isInLiveChildRoute(null===(e=location)||void 0===e?void 0:e.pathname))return F.listen(F.EVENT.closeVideoInfoSideCard,e=>{if((null==e?void 0:e.awemeId)===(null==l?void 0:l.awemeId)&&!!t)d(!1)})},[l,t]),(0,n.useEffect)(()=>()=>{u()},[]),(0,n.useEffect)(()=>{i&&u()},[i]),(0,n.useEffect)(()=>{!t&&u()},[t]),{closeVideoInfoSideCard:u,isShowVideoInfoSideCard:a}},lw=e=>{let{showSideCard:l,isActive:t,originAwemeInfo:o,showRelatedTabList:i,slideVideoTab:r,changeTab:a,isUpperFeed:d,defaultLandingTab:u,handleShowSidebar:s,logParams:c,searchFrom:v}=e,m=(0,n.useRef)(!u),f=(0,n.useRef)(!1),_=(0,n.useMemo)(()=>{if(t){if(l){var e;return(null==i?void 0:null===(e=i.includes)||void 0===e?void 0:e.call(i,r))?r:i[0]}if(u)return i[0]}},[t,l,u,i[0],i[1],i[2],i[3],i[4]]);return(0,N.o)(()=>{!f.current&&!(0,y.Jt)(o)&&t&&_&&!d&&!m.current&&u&&(setTimeout(()=>{if(s(!0,{from:"auto"}),a({tab:u,from:"auto"}),u===I.L.AbstractList){var e;w.logInstance.sendLog("enterVideoCardTab",{type:u,enter_method:"video_abstract_text"===v?"click_video_abstract":"click_card_entrance",enter_from_merge:(0,V.vM)(),enter_from:null!==(e=null==c?void 0:c.enter_from)&&void 0!==e?e:(0,V.mo)(),tab_name:(null==c?void 0:c.tab_name)||(0,q.zD)(),module_name:null==c?void 0:c.module_name})}}),m.current=!0)},[_,o,t,c,v]),{openSpecificTab:(0,n.useCallback)(e=>{f.current=!0,s(!0),a({tab:e});let l=setTimeout(()=>{f.current=!1,clearTimeout(l)},3e3)},[s,a])}};var lI=t("87733");let lC=e=>{let{awemeInfo:l,slideOptimize:t}=e,[o,i]=(0,n.useState)((0,lI.g)(l));return(0,n.useEffect)(()=>{t||i((0,lI.g)(l))},[l]),{hotData:o}},ly=e=>{let{player:l,isActive:t,isNext:o,showSideCard:i,abtestData:r,keepAlive:a=!1}=e,[d,u]=(0,n.useState)(!1),s=(0,n.useRef)(!1);return(0,n.useEffect)(()=>{if(i){if(t&&l){if(l.isPlaying||l.currentTime>0)u(!0),s.current=!0;else{let e=setTimeout(()=>{u(!0),s.current=!0},3e3),t=()=>{clearTimeout(e),u(!0),s.current=!0};return l.once(p.Events.AUTOPLAY_STARTED,t),()=>{l.off(p.Events.AUTOPLAY_STARTED,t),clearTimeout(e)}}}else t||!d||a?!d&&u(!0):u(!1)}},[l,t,r,i,a]),{delaySideCardShow:d,setDelaySideCardShow:u}},lS=e=>{let{scene:l,awemeInfo:t,toast:i,reportParams:a={},curCard:d,isShowSideBar:u,showRelatedTabList:s,handleRelated:c}=e,v=(0,n.useCallback)(e=>{let{clickMethod:l,awemeInfo:t}=e||{};c({tab:I.L.Author,clickMethod:null!=l?l:"click_icon",awemeInfo:t})},[c]),m=(0,n.useCallback)(e=>{let{clickMethod:l,awemeInfo:t}=e||{};c({tab:I.L.Mix,clickMethod:null!=l?l:"click_feed_bar",awemeInfo:t})},[c]),f=(0,n.useCallback)(e=>{let{clickMethod:l,awemeInfo:t}=e||{};c({tab:I.L.Series,clickMethod:null!=l?l:"click_feed_bar",awemeInfo:t})},[c]),_=(0,n.useCallback)((e,n)=>{var s,c,m,f,_,h,p,w;let{to_user_id:C,is_co_publish:S,co_publish_author_list:k}=(0,ec.m)(t)||{};if((null==t?void 0:t.awemeType)===b.e.XgVideo){ec.Z.sendLog("clickAuthorHead",(0,o._)({click_from:(null==n?void 0:n.clickMethod)||"head",action:"",urlParamList:["previous_page"],author_id:null==t?void 0:null===(f=t.authorInfo)||void 0===f?void 0:f.uid,group_id:null==t?void 0:t.awemeId,log_pb:null==t?void 0:t.logPb,enter_from:(0,V.mo)(),is_full_screen:(0,B.r)()?"1":"0",from_follow_list:(null===(_=W.Le.getConfig(W.gI.FromFollowList))||void 0===_?void 0:_.tag)?"1":"0"},(0,U.t)(),a)),(null==t?void 0:t.awemeType)===b.e.XgVideo&&F.emit(F.EVENT.videoPause,"SliderVideo_clickAuthorHead_cover");return}if((0,y.Jt)(t)){if(l===g.lT.Recommend||l===g.lT.Modal&&"discover"===(0,V.vM)()){null==e||null===(p=e.preventDefault)||void 0===p||p.call(e),F.emit(F.EVENT.openAdSideCard);let l=(0,y.Rx)(t);(0,la.E)("realtime_click",{tag:(0,lu.f)(),value:null==l?void 0:l.creative_id,log_extra:null==l?void 0:l.log_extra,refer:"source"});return}if((0,y.gc)(t)){null==e||null===(h=e.preventDefault)||void 0===h||h.call(e),i?i("广告视频不支持此功能"):ev.F.info("广告视频不支持此功能");return}}if((0,y.gc)(t)){null==e||null===(w=e.preventDefault)||void 0===w||w.call(e),ev.F.info("广告视频不支持此功能");return}return null==e||null===(s=e.preventDefault)||void 0===s||s.call(e),ec.Z.sendLog("clickAuthorHead",(0,r._)((0,o._)((0,r._)((0,o._)({click_from:(null==n?void 0:n.clickMethod)||"head",urlParamList:["previous_page"],author_id:null==t?void 0:null===(c=t.authorInfo)||void 0===c?void 0:c.uid,group_id:null==t?void 0:t.awemeId,log_pb:null==t?void 0:t.logPb,enter_from:(0,V.mo)(),is_full_screen:(0,B.r)()?"1":"0",from_follow_list:(null===(m=W.Le.getConfig(W.gI.FromFollowList))||void 0===m?void 0:m.tag)?"1":"0"},a),{action:u&&d===I.L.Author?"close":"open"}),(0,U.t)()),{to_user_id:C,is_co_publish:S,co_publish_author_list:k})),null==v||v(n),!0},[t,a,d,v,u]),h=(0,n.useCallback)((e,l)=>{var t,o;return s.includes(I.L.Related)?(c({tab:I.L.Related,clickMethod:null!==(o=l.clickMethod)&&void 0!==o?o:"click_feed_bar",awemeInfo:l.awemeInfo}),!0):(null==e||null===(t=e.preventDefault)||void 0===t||t.call(e),i?i("暂无相关推荐"):ev.F.info("暂无相关推荐"),!1)},[c,s,i]),p=(0,n.useCallback)(e=>{let{clickMethod:l,awemeInfo:t}=e||{};h(null,{awemeInfo:t,clickMethod:l})},[h]);return{onAvatarClick:_,onRelatedClick:h,handleAvatarClick:v,handleMixClick:m,handleSeriesClick:f,handleHotClick:()=>{c({tab:I.L.Hot,clickMethod:"click_feed_bar"})},handleRelatedClick:p}},lk=e=>{let{player:l,isActive:t,isOuter:o,scene:i}=e;(0,n.useEffect)(()=>{let e;return l&&t&&i===g.lT.Recommend&&(()=>{if(o){var e;(null===(e=W.Le.getConfig(W.gI.IsInLookMiniModal))||void 0===e?void 0:e.isInMiniModal)&&setTimeout(()=>{var e;null===(e=l.pause)||void 0===e||e.call(l),l.config.autoplay=!1,l.autoplay=!1},20)}})(),()=>{clearTimeout(e)}},[l,t])};var lT=t("59726"),lb=t("54517"),lN=t("631493");let lL=e=>{let{isUpperFeed:l,awemeInfo:t,scrollElRef:o,swiper:i,isActive:r,changeNextVideo:a,changePrevVideo:d,player:u,onFullScreen:s,onCssFullScreen:c,onFullScreenrestore:v,onChangeMinWindows:m,onCanPlay:f,onPlay:h,onEnterVideo:p,onLeaveVideo:w,onVideoTitleClick:I,feedCssFullScreen:C,modalEnterFrom:y}=e,S=(0,eH.Z)(e.onTriggerModalPlayerClose),[k,T]=(0,n.useState)(!1),b=null!=C?C:k,[L,E]=(0,n.useState)(!1),{isFullscreen:x}=(0,lT.$)(),A=(0,n.useRef)(c);A.current=c,(0,n.useEffect)(()=>{let e=e=>{null==e||e.stopPropagation(),F.emit(F.EVENT.globalEventPrevented)},l=e=>{null==e||e.stopPropagation(),F.emit(F.EVENT.globalEventPrevented)};if(o.current){var t,i,n,a;null===(t=o.current)||void 0===t||t.addEventListener("wheel",e),null===(i=o.current)||void 0===i||i.addEventListener("mousedown",l),null===(n=o.current)||void 0===n||n.addEventListener("pointerdown",l),null===(a=o.current)||void 0===a||a.addEventListener("touchstart",l)}let d=F.listen(F.EVENT.pageFullScreen,e=>{if(!r)return;let{fullScreen:l}=e;T(e=>null!=l?l:!e)});return()=>{var t,i,n,r;null===(t=o.current)||void 0===t||t.removeEventListener("wheel",e),null===(i=o.current)||void 0===i||i.removeEventListener("mousedown",l),null===(n=o.current)||void 0===n||n.removeEventListener("pointerdown",l),null===(r=o.current)||void 0===r||r.removeEventListener("touchstart",l),null==d||d()}},[o,u,r]),(0,N.o)(()=>{if(r&&i)try{let e=(0,F.emitterListen)(i,"changeNext",function(){for(var e,l,t,o,i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];if((null==n?void 0:null===(e=n[0])||void 0===e?void 0:e.triggerFrom)!=="ai_search"&&(null==n?void 0:null===(l=n[0])||void 0===l?void 0:l.triggerFrom)!=="ai_extension"&&(null==n?void 0:null===(t=n[0])||void 0===t?void 0:t.triggerFrom)!=="activity"||(null==n?void 0:null===(o=n[0])||void 0===o?void 0:o.triggerFrom)===y)(0,lb.i0)(lb.CK.User),a(...n)}),l=(0,F.emitterListen)(i,"changePrev",function(){for(var e,l,t,o,i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];if((null==n?void 0:null===(e=n[0])||void 0===e?void 0:e.triggerFrom)!=="ai_search"&&(null==n?void 0:null===(l=n[0])||void 0===l?void 0:l.triggerFrom)!=="ai_extension"&&(null==n?void 0:null===(t=n[0])||void 0===t?void 0:t.triggerFrom)!=="activity"||(null==n?void 0:null===(o=n[0])||void 0===o?void 0:o.triggerFrom)===y)(0,lb.i0)(lb.CK.User),d(...n)});return()=>{try{null==e||e(),null==l||l()}catch(e){}}}catch(e){}},[r,i,a,d]),(0,_.Z)(()=>{r&&!(b||x)&&(null==v||v())},[x,b]),(0,_.Z)(()=>{r&&(x?null==s||s(!0):null==s||s(!1))},[x]),(0,_.Z)(()=>{if(r){var e,l;b?null===(e=A.current)||void 0===e||e.call(A,!0):null===(l=A.current)||void 0===l||l.call(A,!1)}},[b]),(0,n.useEffect)(()=>{let e=F.listen(F.EVENT.triggerModalPlayerClose,S);return()=>{null==e||e()}},[S]),(0,N.o)(()=>{let e=F.listen(F.EVENT.changeMinWindows,e=>{let l=lN.s.getPlayersByScene(g.lT.Modal).length>0;if(lN.s.getPlayerScene(null==u?void 0:u.playerId)!==g.lT.Modal&&l)return;let{isMiniWin:t}=e||{};E(t),null==m||m(t)});return()=>e()},[m,u]);let P=(0,n.useRef)(f);P.current=f,(0,n.useEffect)(()=>{if(u&&r){var e;let l=()=>{var e;null===(e=P.current)||void 0===e||e.call(P)};return null===(e=u.once)||void 0===e||e.call(u,"canplay",l),()=>{var e;null===(e=u.off)||void 0===e||e.call(u,"canplay",l)}}},[u,r,l]);let R=(0,n.useRef)(h);return R.current=h,(0,n.useEffect)(()=>{if(u){let e=()=>{var e;null===(e=R.current)||void 0===e||e.call(R)};return u.on("play",e),()=>{u.off("play",e)}}},[u]),(0,_.Z)(()=>{r&&(null==p||p()),!r&&(null==w||w())},[r]),(0,n.useEffect)(()=>{let e=F.listen(F.EVENT.videoTitleClick,e=>{let{awemeId:l,playerId:o}=e;if((null==t?void 0:t.awemeId)===l&&(null==u?void 0:u.playerId)===o)null==I||I()});return()=>{null==e||e()}},[t,u,I]),{isCssFullScreen:b,isFullScreen:x,isMiniWin:L}};var lE=t("235248"),lx=t("767927");let lA=e=>{let{isActive:l,awemeInfo:t,isNext:o,scene:i,isUpperFeed:r=!1,smoothInner:a=!1,modalEnterFrom:d}=e,u=(0,lE.t)();(0,lx.t)(function(){var e;let o=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!o)l&&!(null==u?void 0:null===(e=u.current)||void 0===e?void 0:e.isRecoveryFromChild)&&F.emit(F.EVENT.postCurVideoInfo,{awemeId:null==t?void 0:t.awemeId,groupId:null==t?void 0:t.groupId,scene:i,suggestWords:null==t?void 0:t.suggestWords,modalEnterFrom:d,isRecovery:!0})}),(0,n.useEffect)(()=>{if(t&&i!==g.lT.Search){if(!r||!!a)l?(F.emit(F.EVENT.postCurVideoInfo,{awemeId:null==t?void 0:t.awemeId,groupId:null==t?void 0:t.groupId,scene:i,suggestWords:null==t?void 0:t.suggestWords,modalEnterFrom:d}),!W.Le.getConfig(W.gI.FirstFeedVideoSearchInfo)&&W.Le.setConfig(W.gI.FirstFeedVideoSearchInfo,{awemeId:null==t?void 0:t.awemeId,groupId:null==t?void 0:t.groupId,scene:i,suggestWords:null==t?void 0:t.suggestWords,modalEnterFrom:d})):o&&F.emit(F.EVENT.postCurVideoInfo,{awemeId:null==t?void 0:t.awemeId,groupId:null==t?void 0:t.groupId,scene:i,suggestWords:null==t?void 0:t.suggestWords,preload:!0,modalEnterFrom:d})}},[t,l,i,o])};var lP=t("711054");let lR=e=>{let{isActive:l,isUpperFeed:t,modalAwemeInfo:o,showSideCard:i,isCommonCardShow:r,isShowAiCard:a,abtestData:d,scene:u}=e,s=(0,n.useRef)(!0);(0,n.useEffect)(()=>{if(s.current){s.current=!1;return}l&&F.emit(F.EVENT.sideCardShowChange,{isUpperFeed:t,isModalAwemeShow:!!o,isShow:i||r||a})},[i,r,a,t,l,null==o?void 0:o.awemeId])};var lM=t("907831"),lV=t.n(lM);let lF=e=>{let{curTab:l,awemeInfo:t,handleChangeVideo:i,handleCooperationAvatarClick:a,reportParams:d,isShowVideoCard:u}=e,s=(0,n.useRef)(!1),c=(0,n.useCallback)(e=>{var i,n;s.current=!0,null==a||a(e);let{to_user_id:c,is_co_publish:v,co_publish_author_list:m}=(0,ec.m)(e)||{};ec.Z.sendLog("clickAuthorHead",(0,r._)((0,o._)((0,r._)((0,o._)({click_from:"click_co_author_head",urlParamList:["previous_page"],author_id:null==e?void 0:null===(i=e.authorInfo)||void 0===i?void 0:i.uid,group_id:null==t?void 0:t.awemeId,log_pb:null==t?void 0:t.logPb,is_full_screen:(0,B.r)()?"1":"0",from_follow_list:(null===(n=W.Le.getConfig(W.gI.FromFollowList))||void 0===n?void 0:n.tag)?"1":"0"},d),{action:u&&l===I.L.Author?"close":"open"}),(0,U.t)()),{to_user_id:c,is_co_publish:v,co_publish_author_list:m})),F.emit(F.EVENT.feedVideoCardLocateCurrentVideo,{offsetHeight:0,scrollBehavior:"smooth"})},[a,t,l,u,d]);return(0,n.useEffect)(()=>{if(void 0!==t.authorInfo.roleId&&t.authorInfo.roleId!==eF.CooperationRoleId.Author&&[I.L.Mix,I.L.Hot].includes(l)){var e,o;let l=lV()(t),n=null==l?void 0:null===(o=l.cooperationInfo)||void 0===o?void 0:null===(e=o.cooperationCreators)||void 0===e?void 0:e.filter(e=>e.roleId===eF.CooperationRoleId.Author)[0];n&&(l.authorInfo=n),null==i||i(l)}},[l]),{onCooperationAvatarClick:c,changeIsInCooperation:e=>{s.current=e},isInCooperation:s.current}};t("897860"),t("110006"),t("284961");var lj=t("309931"),lD=t("35730"),lB=t("555106"),lW=t("211143"),lU=t("101879"),lO=t("616520"),lZ=t("810534"),lH=t("239910"),lK=t("394561"),l$=t("981551");let lz="undefined"!=typeof window?n.useLayoutEffect:n.useEffect,lG="slide-mode-0",lq=()=>{let e=parseInt(lG.match(/\d+$/)[0]);e++,lG=lG.replace(/\d+$/,e)},lQ=()=>{let e=parseInt(lG.match(/\d+$/)[0]);e--,lG=lG.replace(/\d+$/,e)},lX=e=>{var l,t,a;let{close:d,clickedCard:u,customProps:c,isEnterByFullScreen:v=!1,modalEnterFrom:m,currentAwemeInfo:f,isClientMiniWin:_,relatedSmooth:h}=e,{tab:p,userContext:w}=c||{},{userInfo:I}=w,[C,y]=(0,n.useState)({}),{isCssFullScreen:S,isFullScreen:k,isSelf:T}=(0,n.useContext)(Q.C),[b,L]=(0,n.useState)(!1),E=(0,n.useRef)(lG),x=(0,n.useRef)(null),A=(0,n.useRef)(null),P=(0,n.useRef)(null),R=(0,n.useRef)("click_screen");(0,n.useEffect)(()=>(F.emit(F.EVENT.InnerFeedReady,E.current),lq(),()=>{F.emit(F.EVENT.InnerFeedExit,E.current),lQ()}),[]);let M=(0,n.useCallback)(e=>{e.target===x.current&&(R.current="click_screen",L(!0))},[]),V=(0,n.useCallback)(()=>{y({width:"100%",height:"100%"})},[]);return((0,n.useEffect)(()=>{var e;V();let l=(0,el.OB)(),t=lN.s.getPlayer(l);return null==t||null===(e=t.pause)||void 0===e||e.call(t),(0,el.wS)(l,!1),()=>{if((0,el.wS)(l,!0),setTimeout(()=>{var e;F.emit(F.EVENT.syncInteraction),null==t||null===(e=t.play)||void 0===e||e.call(t)}),W.Le.getConfig(W.gI.IsInMixCard)){let e=Number((0,lB.$o)(lD.LocalStorageKeys.PLAYER_NEXT_AUTOPLAY)),l=W.Le.getConfig(W.gI.AutoPlayChanged);!(null==l?void 0:l.changed)&&(null==l?void 0:l.autoEmit)&&e&&((0,lB.qQ)(lD.LocalStorageKeys.PLAYER_NEXT_AUTOPLAY,"0"),F.emit(F.EVENT.changeInnerAutoPlay,2),W.Le.setConfig(W.gI.InnerAutoPlay,null),W.Le.setConfig(W.gI.AutoPlayChanged,{autoEmit:!1})),W.Le.setConfig(W.gI.IsInMixCard,!1)}}},[V]),lz(()=>(W.Le.setConfig(W.gI.SlideStartTime,{slideStartTime:0}),W.Le.setConfig(W.gI.IsInLookMiniModal,{isInMiniModal:!0}),()=>{W.Le.setConfig(W.gI.IsInLookMiniModal,{isInMiniModal:!1})}),[]),(0,n.useEffect)(()=>{let e=()=>{if(b){var l,t,o;null==d||d(R.current,null===(t=P.current)||void 0===t?void 0:null===(l=t.getCurTab)||void 0===l?void 0:l.call(t)),null===(o=A.current)||void 0===o||o.removeEventListener("animationend",e)}};if(b){var l,t;null==d||d(R.current,null===(t=P.current)||void 0===t?void 0:null===(l=t.getCurTab)||void 0===l?void 0:l.call(t))}let o=F.listen(F.EVENT.sendImUserMsg,()=>{var e,l;null==d||d(R.current,null===(l=P.current)||void 0===l?void 0:null===(e=l.getCurTab)||void 0===e?void 0:e.call(l))}),i=A.current;return i.addEventListener("animationend",e),()=>{i.removeEventListener("animationend",e),o()}},[S,k,b,d,_]),(0,N.o)(()=>{let e=e=>{if(e.shiftKey||e.metaKey||e.ctrlKey)return;let l=W.Le.getConfig(W.gI.DisableExit);if("Escape"===e.code&&(!S||p===g.lT.Modal)&&!k&&!_&&!l){var t,o;return e.preventDefault(),e.returnValue=!1,null==d||d("esc",null===(o=P.current)||void 0===o?void 0:null===(t=o.getCurTab)||void 0===t?void 0:t.call(o)),!1}};return lW.k.bind("Escape",e),()=>{lW.k.remove("Escape",e)}},[S,k,_,d]),(0,n.useEffect)(()=>{if(S)return y({}),()=>{V()}},[S]),(0,n.useEffect)(()=>{if(k)return y({}),()=>{V()}},[k]),(0,n.useEffect)(()=>{if(_)return y({}),()=>{V()}},[_]),(0,n.useEffect)(()=>{if(!v&&p!==g.lT.Modal){var e,l,t;F.emit(F.EVENT.pageFullScreen,{fullScreen:!0,playerId:null===(t=P.current)||void 0===t?void 0:null===(l=t.getPlayer)||void 0===l?void 0:null===(e=l.call(t))||void 0===e?void 0:e.playerId,clickMethod:"inner_player",fromAuthorCard:!0})}},[]),h)?null:(0,i.jsxs)(lK.T6,{onMaskClick:()=>{R.current="click_screen",L(!0)},className:s()(lZ.default.screenMaskContainer),children:[(0,i.jsxs)("div",{className:lZ.default.container,ref:x,onClick:M,children:[!_&&(0,i.jsx)(lH.N,{positionFixed:!0,exitTextProps:{getCurrentTab:()=>{var e,l;return(null==P?void 0:null===(l=P.current)||void 0===l?void 0:null===(e=l.getCurTab)||void 0===e?void 0:e.call(l))||u},modalEnterFrom:m,isSelf:T,uidEquals:(null==f?void 0:null===(l=f.authorInfo)||void 0===l?void 0:l.uid)===(null==I?void 0:null===(t=I.info)||void 0===t?void 0:t.uid),awemeInfo:f},onHandleReturn:()=>{var e,l;R.current="click_button",null==d||d(R.current,null===(l=P.current)||void 0===l?void 0:null===(e=l.getCurTab)||void 0===e?void 0:e.call(l))}}),(0,i.jsx)("div",{className:lZ.default.videoContainer,ref:A,style:{height:"100%"},children:(0,i.jsx)(op,(0,r._)((0,o._)({},e),{style:C,isUpperFeed:!0,isMultiInstanceScene:!1,className:lZ.default.modalContainer,close:d,ref:P,swiper:null!==(a=null==e?void 0:e.swiper)&&void 0!==a?a:F.commonEvent}))})]}),p===g.lT.Search&&x.current&&(0,i.jsx)(l$.J,{EventListener:F.commonEvent,refContainerStatus:x.current})]})},lY=e=>{let l=(0,n.useRef)(document.createElement("div")),t=(0,n.useRef)(!1);return(0,n.useEffect)(()=>{let e=Array.from(document.querySelectorAll('.sliderVideo[data-e2e="feed-active-video"]')),o=e[e.length-1]||document.body,i=document.querySelector(".searchUpperFeedContainer")||o,n=document.getElementById("upperFeedContainer")||(0,lU.t)()||o,r=(0,lO.En)()?i:n;return null==r||r.appendChild(l.current),()=>{var e,o,i;(null===(e=l.current)||void 0===e?void 0:e.parentNode)&&(null===(i=l.current)||void 0===i||null===(o=i.remove)||void 0===o||o.call(i)),l.current=null,t.current=!0}},[]),(0,lj.createPortal)((0,i.jsx)(lX,(0,r._)((0,o._)({},e),{close:function(){for(var o,i,n,r,a,d=arguments.length,u=Array(d),s=0;s<d;s++)u[s]=arguments[s];(null===(o=l.current)||void 0===o?void 0:o.parentNode)&&(null===(a=l.current)||void 0===a||a.remove()),null==e||null===(i=e.close)||void 0===i||i.call(e,...u),F.emit(null==F?void 0:null===(n=F.EVENT)||void 0===n?void 0:n.clarityRel,{exitInner:!0}),F.emit(null==F?void 0:null===(r=F.EVENT)||void 0===r?void 0:r.quitInnerFeed,!0),t.current=!0}})),l.current)};var lJ=e=>(0,i.jsx)(lY,(0,o._)({},e)),l0=t("614908"),l1=t("372468");let l2=(0,n.forwardRef)((e,l)=>(0,i.jsxs)("svg",(0,r._)((0,o._)({width:24,height:24,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:[(0,i.jsx)("path",{d:"M7.978 8.5H14a4.5 4.5 0 0 1 4.5 4.5v0a4.5 4.5 0 0 1-4.5 4.5H7.5",stroke:"#222",strokeWidth:2,strokeLinecap:"round"}),(0,i.jsx)("path",{d:"M8.5 5.5l-3 3 3 3",stroke:"#222",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})]})));var l3=t("667554");let l7=e=>{let{width:l=24,height:t=24,className:n}=e;return(0,i.jsx)(l3.A,(0,r._)((0,o._)({},e),{width:l,height:t,src:l2,id:"svg_icon_revoke",defaultWidth:24,defaultHeight:24,viewBox:"0 0 24 24",className:n}))},l8=e=>{let{onRevokeDislike:l,isActive:t=!1}=e;return(0,n.useEffect)(()=>{t&&ec.Z.sendLog("dislikeRecallShow")},[t]),(0,i.jsxs)("div",{className:l1.default.dislikePanel,children:[(0,i.jsx)("span",{className:l1.default.text,children:"你已对该视频不感兴趣"}),(0,i.jsxs)("div",{className:l1.default.revokeBtn,onClick:()=>{null==l||l(),ec.Z.sendLog("dislikeRecallClick")},children:[(0,i.jsx)(l7,{className:l1.default.revokeIcon}),(0,i.jsx)("span",{className:l1.default.revokeText,children:"撤销"})]})]})};var l5=t("323037"),l6=t("474932"),l4=t("597321");let l9=ev.F.info.bind(ev.F),te=e=>{let{awemeInfo:l,reportExtraParams:t,onDislikeSuccess:i,onDislikeError:r,initIsDislike:a,toast:d=l9,player:u}=e,[s,c]=(0,n.useState)(null!=a&&a);(0,n.useLayoutEffect)(()=>{void 0!==a&&c(a)},[a]);let v=(0,n.useRef)(),m=(0,eH.Z)(async function(){var e,n,a,s;let{clickMethod:m,reportExtraParams:f}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clickMethod:"icon"};if((0,y.Jt)(l)){null==u||u.emit(l4.B.AdDislike,{onAddDislikeSuccess:()=>{null==i||i(),v.current=setTimeout(()=>{c(!0)},2500)}});return}let{statusCode:_,errMsg:h}=await (0,l6.w)(null==l?void 0:l.awemeId),p=(null===(e=W.Le.getConfig(W.gI.WallPaperIds))||void 0===e?void 0:e.includes(null==l?void 0:l.awemeId))?1:0;0===_?(null==d||d("操作成功，将减少此类视频出现"),w.logInstance.sendLog("dislike",(0,o._)({urlParamList:["previous_page"],enter_from:(0,V.mo)(),author_id:null==l?void 0:null===(n=l.authorInfo)||void 0===n?void 0:n.uid,group_id:null==l?void 0:l.awemeId,log_pb:null==l?void 0:l.logPb,is_full_screen:(0,B.r)()?"1":"0",tab_name:(0,q.zD)()||(0,e2.Rs)("tab_name")||"",click_method:m,from_follow_list:(null===(a=W.Le.getConfig(W.gI.FromFollowList))||void 0===a?void 0:a.tag)?"1":"0",aweme_type:null==l?void 0:l.awemeType,is_insert_wallpaper:p,item_duration_ms:(null==l?void 0:null===(s=l.video)||void 0===s?void 0:s.duration)||0,play_current_time:Math.floor((null==u?void 0:u.currentTime)||0)},f,t)),null==i||i(),v.current=setTimeout(()=>{c(!0)},2500)):(null==d||d(h),null==r||r(h)),p&&(0,lB.qQ)(lD.LocalStorageKeys.WallPaper,{disappear:!0})}),f=(0,eH.Z)(async()=>{let{statusCode:e}=await (0,l6.m)(null==l?void 0:l.awemeId);0===e&&c(!1)});return(0,n.useEffect)(()=>()=>{var e;((null===(e=W.Le.getConfig(W.gI.AbtestData))||void 0===e?void 0:e.useCache)!==1||v.current)&&clearTimeout(v.current)},[]),{dislike:m,revokeDislike:f,isDislike:s}},tl=e=>{let{abtestData:l,scene:t,isModal:o,awemeInfo:i,dislikeIdList:n=new Set,deleteCurrentSwiper:r,videoToast:a,uuid:d,player:u}=e;g.lT.Recommend,(0,y.Jt)(i);let{isDislike:s,dislike:c,revokeDislike:v}=te({awemeInfo:i,toast:e=>{a(e)},onDislikeSuccess:()=>{null==r||r(),W.Le.setConfig(W.gI.SlideStartTime,{slideStartTime:Date.now(),slideFrom:"dislike"})},initIsDislike:n.has(i.awemeId),player:u});return{isDislikePanelVisible:!1,dislike:c,revokeDislike:v,isPermanentDislikeBtn:!1,disableShortCut:!1,isAdapterMiniHeightWithDislikeBtn:!1}};var tt=t("687297"),to=t("506467"),ti=t("262658"),tn=t("391298"),tr=t("986576"),ta=t("946934"),td=t("156795"),tu=t("253754"),ts=t("189070"),tc=t("739808");let tv=e=>{let{userInfo:l,abtestData:t,fullScreenTarget:o,awemeInfo:r}=e,a=(0,z.DT)()&&(0,tt.y)((0,z.FJ)().awemePcClient,">=","5.4.0"),{handleHiddenLog:d}=(0,tu.s)(),{supportAiTop1:u}=(0,eh.Iq)(e=>{let{supportAiTop1:l}=e;return{supportAiTop1:l}}),c=(0,tc.V1)();(0,n.useEffect)(()=>{F.emit(F.EVENT.postCurVideoInfo,{awemeId:null==r?void 0:r.awemeId,groupId:null==r?void 0:r.groupId,scene:g.lT.InnerUpper,suggestWords:null==r?void 0:r.suggestWords})},[r]);let v=e=>d(e),m=e=>{let{text:l}=e.currentTarget.dataset;return d(l)},f=(e,l)=>{if("Enter"===(0,to.CS)(e))return d(l)};return(0,i.jsx)("div",{className:s()(ti.default.searchCt,"isDark",a&&ti.default.searchCtNew),children:(()=>{if((null==t?void 0:t.aiSearchAiInput)&&(null==t?void 0:t.aiSearchInputMiddleNew)&&u&&!c)return(0,i.jsx)(tn.AiSearchBar,{customProps:{isInnerUpper:!0},userInfo:l,abTestData:t,onSearchClick:v,onHistoryClick:m,onInputKeyDown:f,playerProps:{awemeInfo:r,scene:g.lT.InnerUpper},fullScreenTarget:o});if(!(null==t?void 0:t.aiSearchAiInput)&&(null==t?void 0:t.aiSearchInputMiddleNew)&&u&&!c)return(0,i.jsx)(tr.E1,{customProps:{isInnerUpper:!0},userInfo:l,abTestData:t,onSearchClick:v,onHistoryClick:m,onInputKeyDown:f,playerProps:{awemeInfo:r,scene:g.lT.InnerUpper}});if((null==t?void 0:t.aiSearchAiInput)&&!(null==t?void 0:t.aiSearchInputMiddleNew)&&u&&!c)return(0,i.jsx)(ta.E1,{customProps:{isInnerUpper:!0},userInfo:l,abTestData:t,onSearchClick:v,onHistoryClick:m,onInputKeyDown:f,playerProps:{awemeInfo:r,scene:g.lT.InnerUpper},fullScreenTarget:o});else return(0,i.jsx)(td.SearchBar,{customProps:{isInnerUpper:!0},userInfo:l,abTestData:t,onSearchClick:v,onHistoryClick:m,onInputKeyDown:f,playerProps:{awemeInfo:r,scene:g.lT.InnerUpper}})})()})},tm=e=>{let[l,t]=(0,n.useState)(!0);return((0,ts.kO)({callback(){t(!0)},useIdleCallback:!(0,$.b_)(),isActive:!0,timeout:1e3,immediately:!(0,$.b_)()}),l)?(0,i.jsx)(tv,(0,o._)({},e)):null};var tf=t("138593"),t_=t("544933");let th=new t_.h({prf_slider_modal_video:{eventName:"prf_slider_modal_video",params:{fps:0,duration:0,scene:"",jank:0,jank_duration:0,bjank:0,bjank_duration:0,tab:""}}}),tp=1e3/24*2,tg=1e3/24*3,tw=()=>{var e,l;return(null===(l=performance)||void 0===l?void 0:null===(e=l.now)||void 0===e?void 0:e.call(l))||Date.now()||0},tI=function(){},tC=e=>{let{sidebarHidden:l,chapterSidebarHidden:t,bottomLevelSidebar:o,setBottomLevelSidebar:i,topLevelSidebar:r,setTopLevelSidebar:a}=e;return(0,n.useEffect)(()=>{if(l&&t){i(void 0),a(void 0);return}l||t?(a(void 0),i(l?"chapterSidebar":"sidebar")):a("sidebar"===o?"chapterSidebar":"sidebar")},[l,t]),{isTopLevelSidebar:"sidebar"===r,isTopLevelChapterSidebar:"chapterSidebar"===r,isBottomLevelSidebar:"sidebar"===o,isBottomLevelChapterSidebar:"chapterSidebar"===o}};t("981168");var ty=t("823685"),tS=t("541493");let tk=e=>{try{let l=JSON.parse(e);return(null==l?void 0:l.query_type)==="ai"}catch(e){return!1}},tT=function(e){var l;let{needFoldText:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{needFoldText:!1},o=null==e?void 0:null===(l=e.suggestWords)||void 0===l?void 0:l.filter(e=>e.scene===eV.gQ.FeedBottomRec),i=[],n=[];return null==o||o.forEach(e=>{let{words:l=[],hintText:o}=e,r=(null==l?void 0:l.length)||0;l.forEach((e,l)=>{let{word:a,info:d}=e;if(!a)return null;tk(d)||localStorage.getItem("isAiSearchForceTrue")?n.push({index:l,type:g.WZ.AiSearch,title:t?`${o}`:`${o}：${a}`,word:a,hintText:o,searchWord:e,wordsNum:r,itemClassName:s()(tS.default.relatedSearch),textClassName:s()(tS.default.relatedSearchText)}):i.push({index:l,type:g.WZ.RelatedSearch,title:t?`${o}`:`${o}：${a}`,word:a,hintText:o,searchWord:e,wordsNum:r,itemClassName:s()(tS.default.relatedSearch),textClassName:s()(tS.default.relatedSearchText)})})}),{relatedSearchFeedBars:i,aiSearchFeedBars:n,hasSearchFeedBar:!!((null==i?void 0:i.length)||(null==n?void 0:n.length))}},tb=e=>{var l;let{withCtr:t,awemeInfo:o,showRelatedTabList:i,abtestData:n,recommendScore:r={}}=e,{showHot:a,showMix:d,showAiSearch:u,showRelateSearch:s}=r,c=!t||(null==n?void 0:n.searchUseCtr)!==1||!!u,v=!t||(null==n?void 0:n.searchUseCtr)!==1||!!s;return[{isShow:(!t||(null==n?void 0:n.searchUseCtr)!==1||!!d)&&!!(null==o?void 0:null===(l=o.seriesInfo)||void 0===l?void 0:l.seriesId),priority:d,feedBarTag:g.WZ.Series,cardTab:I.L.Series},{isShow:!t||!!d,priority:d,feedBarTag:g.WZ.Mix,cardTab:I.L.Mix},{isShow:!t||!!a,priority:a,feedBarTag:g.WZ.Hot,cardTab:I.L.Hot},{isShow:n.sortWebrecFeed!==ty.CommonSwitch.On||c,priority:n.sortWebrecFeed===ty.CommonSwitch.On?u:s,feedBarTag:g.WZ.AiSearch},{isShow:v,priority:s,feedBarTag:g.WZ.RelatedSearch}].filter(e=>{let{cardTab:l,feedBarTag:t,isShow:o}=e;return o&&(i.includes(l)||t===g.WZ.RelatedSearch||t===g.WZ.AiSearch)}).sort((e,l)=>l.priority-e.priority).map(e=>{let{feedBarTag:l}=e;return l})},tN=e=>{var l,t;let{showRelatedTabList:o,awemeInfo:i,scene:n,abtestData:r}=e||{},a=(null==i?void 0:null===(t=i.webRawData)||void 0===t?void 0:null===(l=t.CTR)||void 0===l?void 0:l.recommendScore)||{},d=n===g.lT.Recommend,u=i.awemeType===b.e.XgVideo,s=i.awemeType===b.e.Normal,c=i.awemeType===b.e.Note,{hasSearchFeedBar:v}=tT(i),m=(null==r?void 0:r.searchUseCtr)===1||n===g.lT.Friend||a.showRelateSearch;return u?[]:d||s?tb({withCtr:!0,awemeInfo:i,showRelatedTabList:o,abtestData:r,recommendScore:a}):c&&v&&!m?[g.WZ.RelatedSearch,g.WZ.AiSearch]:[]},tL=e=>{let{showRelatedTabList:l,awemeInfo:t,scene:o,abtestData:i}=e||{},n=o===g.lT.Recommend,r=t.awemeType===b.e.XgVideo,a=t.awemeType===b.e.Normal,d=t.awemeType===b.e.Note,{hasSearchFeedBar:u}=tT(t);return n&&!r||a?tb({withCtr:!1,awemeInfo:t,showRelatedTabList:l,abtestData:i}):d&&u?[g.WZ.RelatedSearch,g.WZ.AiSearch]:[]},tE=e=>{let{awemeInfo:l,showRelatedTabList:t=[],withCtr:o=!0,scene:i,abtestData:r,originAwemeInfo:a,actions:d,canShowMixCard:u=!1,canShowSeriesCard:c=!1,canShowRelatedSearchFeedBar:v=!1,isShowSideBar:m,isInnerFeed:f}=e,_=(0,n.useMemo)(()=>l?o?tN({awemeInfo:l,showRelatedTabList:t,scene:i,abtestData:r}):tL({awemeInfo:l,showRelatedTabList:t,scene:i,abtestData:r}):[],[l,t,o,i,r]);return{videoTags:(0,n.useMemo)(()=>{var e,t,o,i,n,a,m,h,p,w,I,C,y,S,k,T,b;let N=[];if(u&&(null==l?void 0:null===(e=l.mixInfo)||void 0===e?void 0:e.status)!==-1){let e=`合集：${null==l?void 0:null===(a=l.mixInfo)||void 0===a?void 0:a.mixName}`;N.push({type:g.WZ.Mix,title:e,onClick:e=>{var l;return null===(l=d.handleMixClick)||void 0===l?void 0:l.call(d,e)},itemClassName:s()(tS.default.mix),textClassName:s()(tS.default.mixText)})}if(c&&(null==l?void 0:null===(t=l.seriesInfo)||void 0===t?void 0:t.status)!==-1){let e=`${null==l?void 0:null===(m=l.seriesInfo)||void 0===m?void 0:m.seriesName}`;N.push({type:g.WZ.Series,title:e,onClick:e=>{var l;return null===(l=d.handleSeriesClick)||void 0===l?void 0:l.call(d,e)},itemClassName:s()(tS.default.mix),textClassName:s()(tS.default.mixText)})}if((null==l?void 0:null===(o=l.hotList)||void 0===o?void 0:o.title)&&(null==l?void 0:null===(i=l.hotList)||void 0===i?void 0:i.rank)!==51&&(null==l?void 0:null===(n=l.hotList)||void 0===n?void 0:n.type)!==2){let e=(null==l?void 0:null===(h=l.hotList)||void 0===h?void 0:h.rank)?`${null==l?void 0:null===(p=l.hotList)||void 0===p?void 0:p.header}TOP${null==l?void 0:null===(w=l.hotList)||void 0===w?void 0:w.rank}： ${null==l?void 0:null===(I=l.hotList)||void 0===I?void 0:I.title}`:`置顶热榜：${null==l?void 0:null===(C=l.hotList)||void 0===C?void 0:C.title}`;N.push({type:g.WZ.Hot,title:e,customProps:{trending_topic:null==l?void 0:null===(y=l.hotList)||void 0===y?void 0:y.title,first_tag_name:null==l?void 0:null===(S=l.hotList)||void 0===S?void 0:S.header,top:null==l?void 0:null===(k=l.hotList)||void 0===k?void 0:k.rank},onClick:d.handleHotClick,itemClassName:(null==l?void 0:null===(T=l.hotList)||void 0===T?void 0:T.rank)?s()(tS.default.rankHot):s()(tS.default.hot),textClassName:(null==l?void 0:null===(b=l.hotList)||void 0===b?void 0:b.rank)?s()(tS.default.rankHotText):s()(tS.default.hotText)})}if(v){let{relatedSearchFeedBars:e,aiSearchFeedBars:t}=tT(l,{needFoldText:!1});N.push(...t,...e)}return f?N.filter(e=>e.type===g.WZ.RelatedSearch||e.type===g.WZ.AiSearch):r.sortWebrecFeed===ty.CommonSwitch.On?N.filter(e=>{let{type:l}=e;return _.includes(l)}).sort((e,l)=>_.indexOf(e.type)-_.indexOf(l.type)):N.filter(e=>{let{type:l}=e;return _.includes(l)})},[_,a,l,d,u,v,m,f,r])}};var tx=t("149250"),tA=t("767548"),tP=t("14108"),tR=t("885314"),tM=t("110843");let tV=(0,n.forwardRef)((e,l)=>(0,i.jsx)("svg",(0,r._)((0,o._)({xmlns:"http://www.w3.org/2000/svg",width:36,height:36,fill:"none",ref:l},e),{children:(0,i.jsx)("path",{d:"M22.133 23.776a1.342 1.342 0 1 0 1.898-1.898l-4.112-4.113 4.112-4.112a1.342 1.342 0 1 0-1.898-1.898l-4.112 4.112-4.113-4.112a1.342 1.342 0 1 0-1.898 1.898l4.113 4.112-4.113 4.113a1.342 1.342 0 0 0 1.898 1.898l4.113-4.113 4.112 4.113z",fill:"#fff",fillOpacity:".34"})}))),tF=(0,n.forwardRef)((e,l)=>(0,i.jsx)("svg",(0,r._)((0,o._)({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",ref:l},e),{children:(0,i.jsx)("path",{d:"M14.787 13.997a2.322 2.322 0 0 1-2.157 1.463H5.785V5.816l3.857-4.115a1.42 1.42 0 0 1 2-.072.92.92 0 0 1 .2.333c.053.14.08.275.08.403 0 .163-.022.325-.064.483l-.02.075-.688 2.893h4.114c.709 0 1.283.574 1.283 1.283v1.366c0 .737-.14 1.466-.412 2.15l-1.348 3.381zM4.731 5.817v9.643H3.317c-.71 0-1.286-.576-1.286-1.286V7.102c0-.71.576-1.285 1.286-1.285h1.414z",fill:"#fff"})}))),tj=(0,n.forwardRef)((e,l)=>(0,i.jsx)("svg",(0,r._)((0,o._)({xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none",ref:l},e),{children:(0,i.jsx)("path",{d:"M3.803 9.864a.75.75 0 0 1 0-1.061L6.606 6 3.803 3.197a.75.75 0 0 1 1.06-1.06L8.198 5.47a.75.75 0 0 1 0 1.06L4.864 9.864a.75.75 0 0 1-1.06 0z",fill:"#fff",fillOpacity:".34"})})));var tD=t("719829");let tB=(0,n.forwardRef)((e,l)=>(0,i.jsx)("svg",(0,r._)((0,o._)({xmlns:"http://www.w3.org/2000/svg",width:36,height:36,fill:"none",ref:l},e),{children:(0,i.jsx)("path",{d:"M22.592 25.935a1.928 1.928 0 0 1-2.727 0l-7-7a1.928 1.928 0 0 1 0-2.728l.015-.015 6.985-6.985a1.929 1.929 0 1 1 2.727 2.727l-5.637 5.637 5.637 5.637a1.928 1.928 0 0 1 0 2.727z",fill:"#fff",fillOpacity:".5",opacity:".7"})}))),tW=(0,n.forwardRef)((e,l)=>(0,i.jsx)("svg",(0,r._)((0,o._)({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",ref:l},e),{children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.818 10.818a1 1 0 0 1 1.414-.022l3.803 3.686 7.348-10.407a1 1 0 0 1 1.634 1.153L8.995 16.59a1 1 0 0 1-1.513.141l-4.642-4.5a1 1 0 0 1-.022-1.413z",fill:"#FE2C55"})}))),tU=[{id:0,label:"互相关注的人可见"},{id:1,label:"粉丝可见"}],tO=e=>{let{onBack:l,className:t,privacySetting:o,onPrivacySettingChange:n}=e,r=e=>{n(e)};return(0,i.jsxs)("div",{className:s()(tD.default.settingContainer,t),children:[l&&(0,i.jsx)(tA.Z,{className:tD.default.backButton,onClick:l,src:tB,width:36,height:36,viewBox:"0 0 36 36"}),(0,i.jsxs)("div",{className:tD.default.contentWrapper,children:[(0,i.jsx)("div",{className:tD.default.title,children:"谁可以看到我的推荐 (包含历史推荐内容)"}),(0,i.jsx)("div",{className:tD.default.optionsList,children:tU.map(e=>(0,i.jsxs)("div",{className:s()(tD.default.optionItem,{[tD.default.selected]:o===e.id}),onClick:()=>r(e.id),children:[(0,i.jsx)("span",{className:tD.default.optionLabel,children:e.label}),o===e.id&&(0,i.jsx)(tA.Z,{src:tW,width:20,height:20,viewBox:"0 0 20 20",className:tD.default.checkIcon})]},e.id))})]})]})};var tZ=t("958829"),tH=t("347812"),tK=t("511324");let t$=e=>{let{userList:l=[],awemeInfo:t,onClose:o,className:r,userInfo:a,player:d}=e,[u,c]=(0,n.useState)(!1),[v,m]=(0,n.useState)(0),f=(0,n.useRef)(null),{isListenVideoMiniWin:_}=(0,eh.Iq)(e=>{let{isListenVideoMiniWin:l}=e;return{isListenVideoMiniWin:l}}),h=(0,n.useMemo)(()=>null==l?void 0:l.find(e=>{var l,t;return String(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.uid)===(null==a?void 0:null===(t=a.info)||void 0===t?void 0:t.uid)}),[l,a]),g=(0,n.useMemo)(()=>{var e;let l=(null==t?void 0:null===(e=t.stats)||void 0===e?void 0:e.recommendCount)||0;return h?l+1:l},[t,h]),w=(0,tH.w)({clickMethod:"share"});(0,n.useEffect)(()=>{(async()=>{let{data:e,statusCode:l}=await (0,tR.s$)();if(0===l){let{recommendVisibility:l}=e;m(l)}})()},[]),(0,N.o)(()=>{let e=e=>{"cancel_recommend"===e.action&&h&&1===l.length&&o()};return null==d||d.on(p.Events.USER_ACTION,e),()=>{null==d||d.off(p.Events.USER_ACTION,e)}},[d,h,l]),(0,n.useEffect)(()=>{let e=e=>{e.stopPropagation()},l=f.current;return l&&l.addEventListener("wheel",e),()=>{l&&l.removeEventListener("wheel",e)}},[]);let I=(0,n.useMemo)(()=>{if(h){let e=l.length-1;return e>0?`你和 ${e} 个关注的人推荐`:"你推荐了视频"}return`${l.length} 个关注的人推荐`},[l]),C=e=>{var l,t,o;let i;i=String(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.uid)===(null==a?void 0:null===(t=a.info)||void 0===t?void 0:t.uid)?"self":null==e?void 0:null===(o=e.user)||void 0===o?void 0:o.sec_uid;let n=(0,tP.HC)(i,"showTab=recommend&enter_method=recommend_panel");_&&tx.T.exit(),window.open(n,"_blank","noopener")},y=e=>{F.emit(F.EVENT.sendImUserMsg,{uid:e,enterMethod:tZ.Q.recommend_side_card}),w()},S=()=>{F.emit(F.EVENT.OpenJXModal,{source:"recommend_panel",logParams:{group_id:null==t?void 0:t.awemeId,author_id:String(null==t?void 0:t.authorUserId)}}),tK.Z.sendLog("fromDiscoverLabel",{group_id:null==t?void 0:t.awemeId,author_id:String(null==t?void 0:t.authorUserId),enter_from:"recommend_panel",action_type:"click"})};return(0,n.useEffect)(()=>{var e;(null===(e=l.slice(0,h?31:30))||void 0===e?void 0:e.some(e=>"568863"===String(null==e?void 0:e.recommend_app_id)))&&tK.Z.sendLog("fromDiscoverLabel",{group_id:null==t?void 0:t.awemeId,author_id:String(null==t?void 0:t.authorUserId),enter_from:"recommend_panel",action_type:"show"})},[l,h,t]),(0,i.jsxs)("div",{className:s()(tM.default.cardContainer,r),ref:f,children:[(0,i.jsxs)("div",{className:tM.default.recommendUserPanel,style:u?{display:"none"}:{},children:[(0,i.jsxs)("div",{className:tM.default.header,children:[(0,i.jsxs)("div",{className:tM.default.titleSection,children:[(0,i.jsx)("h3",{className:tM.default.title,children:I}),(0,i.jsx)("p",{className:tM.default.subtitle,children:`共${(0,e1.qe)(g)}人推荐此精选内容`})]}),(0,i.jsx)(tA.Z,{className:tM.default.closeButton,onClick:o,src:tV,width:36,height:36,viewBox:"0 0 36 36"})]}),(0,i.jsx)("div",{className:tM.default.userList,children:l.slice(0,h?31:30).map((e,l)=>{var t,o,n,r,a;return(0,i.jsxs)("div",{className:tM.default.userItem,children:[(0,i.jsx)("img",{src:null==e?void 0:null===(n=e.user)||void 0===n?void 0:null===(o=n.avatar)||void 0===o?void 0:null===(t=o.url_list)||void 0===t?void 0:t[0],className:tM.default.avatar,onClick:()=>{C(e)}}),(0,i.jsxs)("div",{className:tM.default.userInfo,children:[(0,i.jsx)("div",{className:tM.default.userNameRow,onClick:()=>{C(e)},children:(0,i.jsx)("span",{className:tM.default.userName,children:null==e?void 0:null===(r=e.user)||void 0===r?void 0:r.nickname})}),"568863"===String(null==e?void 0:e.recommend_app_id)&&(0,i.jsxs)("p",{className:tM.default.userSource,onClick:S,children:["来自抖音精选App",(0,i.jsx)(tA.Z,{src:tj,width:12,height:12,viewBox:"0 0 12 12"})]})]}),(!h||l>0)&&(0,i.jsx)("div",{className:tM.default.sendMessageButton,onClick:()=>{var l;return y(String(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.uid))},children:"发私信"})]},null==e?void 0:null===(a=e.user)||void 0===a?void 0:a.uid)})}),(0,i.jsxs)("div",{className:tM.default.footer,children:[(0,i.jsxs)("div",{className:tM.default.privacyText,children:["你的推荐仅",0===v?"互相关注的人可见":"粉丝可见",(0,i.jsx)("span",{className:tM.default.settingsLink,onClick:()=>{c(!0)},role:"button",tabIndex:0,children:"设置"})]}),h?(0,i.jsx)("div",{className:tM.default.cancelRecommendButton,onClick:()=>{null==d||d.emit(p.Events.USER_ACTION,{action:"cancel_recommend",source:"friends_like_list"}),h&&1===l.length&&o()},children:"取消推荐"}):(0,i.jsxs)("div",{className:tM.default.recommendButton,onClick:()=>{null==d||d.emit(p.Events.USER_ACTION,{action:"recommend",source:"friends_like_list"})},children:[(0,i.jsx)(tA.Z,{src:tF,width:18,height:18,viewBox:"0 0 18 18",className:tM.default.recommendButtonIcon}),"推荐"]})]})]}),u&&(0,i.jsx)(tO,{onBack:()=>{c(!1)},privacySetting:v,onPrivacySettingChange:e=>{m(e),(0,tR.a3)({on:!!e,field:"recommend_visibility"})}})]})};var tz=t("405039");let tG=e=>{let{awemeInfo:l,guideTagTriggerSource:t,abTestData:o}=e,{stats:{recommendCount:i=0}={}}=l,r=(0,n.useRef)("mutual"),a=(0,n.useMemo)(()=>{let e=null==o?void 0:o.familiarRecommendEntranceCountLabelCondition;return e?i>e?`共${(0,e1.qe)(i)}人推荐`:"点击推荐":"点击推荐"},[o,i]);return{handleRecommendReport:async e=>{var o,n,d,u,s,c,v,m,f,_;let{data:h,statusCode:p}=await (0,tR.s$)();if(0===p){let{recommendVisibility:e}=h;r.current=0===e?"mutual":"fans"}tK.Z.sendLog("recommendVideoToast",{group_id:null==l?void 0:l.awemeId,author_id:String(null==l?void 0:l.authorUserId),action_type:"click",relation_tag:null==l?void 0:null===(o=l.authorInfo)||void 0===o?void 0:o.followStatus,enter_from:(0,V.vM)(),enter_method:e,label_related_action:"label"===e?t:"",label_text:"label"===e?a:"",like_cnt:i,follow_cnt:"plus_one"===e?null==l?void 0:null===(u=l.friendRecommendInfo)||void 0===u?void 0:null===(d=u.label_user_list)||void 0===d?void 0:null===(n=d.filter(e=>{var l;return(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.follow_status)===1}))||void 0===n?void 0:n.length:void 0,mutual_cnt:"plus_one"===e?null==l?void 0:null===(v=l.friendRecommendInfo)||void 0===v?void 0:null===(c=v.label_user_list)||void 0===c?void 0:null===(s=c.filter(e=>{var l;return(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.follow_status)===2}))||void 0===s?void 0:s.length:void 0,friend_user_id:null==l?void 0:null===(_=l.friendRecommendInfo)||void 0===_?void 0:null===(f=_.label_user_list)||void 0===f?void 0:null===(m=f.map(e=>{var l;return null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.uid}))||void 0===m?void 0:m.join(","),recommend_range:r.current})},handleCancelRecommendReport:async e=>{var t;let{data:o,statusCode:i}=await (0,tR.s$)();if(0===i){let{recommendVisibility:e}=o;r.current=0===e?"mutual":"fans"}tK.Z.sendLog("cancelRecommendVideo",{group_id:null==l?void 0:l.awemeId,author_id:String(null==l?void 0:l.authorUserId),action_type:"click",relation_tag:null==l?void 0:null===(t=l.authorInfo)||void 0===t?void 0:t.followStatus,enter_from:(0,V.vM)(),enter_method:e,recommend_range:r.current})}}};function tq(e,l,t){if(t!==g.lT.Recommend)return!0;switch(l){case"digg":return e>=-1;case"share":return e>=.7;case"play":return e>=1.65;default:return!1}}function tQ(e){var l,t,o;return{user:{avatar:{url_list:[null==e?void 0:null===(l=e.info)||void 0===l?void 0:l.avatarUrl]},uid:Number(null==e?void 0:null===(t=e.info)||void 0===t?void 0:t.uid),nickname:null==e?void 0:null===(o=e.info)||void 0===o?void 0:o.nickname}}}let tX=(e,l)=>{let t=W.Le.getConfig(W.gI.RecommendStatusCache)||{},i=t[e];i?W.Le.setConfig(W.gI.RecommendStatusCache,(0,r._)((0,o._)({},t),{[e]:(0,o._)({},i,l)})):W.Le.setConfig(W.gI.RecommendStatusCache,(0,r._)((0,o._)({},t),{[e]:l}))},tY=(e,l)=>{let t=(W.Le.getConfig(W.gI.RecommendStatusCache)||{})[e];return t?t[l]:null},tJ=e=>{let{awemeInfo:l,player:t,userInfo:i,abTestData:a,userDispatch:d,scene:u}=e,{userRecommendStatus:s,status:{allowFriendRecommendGuide:c,allowSelfRecommendToFriend:v}={},friendRecommendInfo:m}=l,{isLogin:f}=i,_=c&&v,h=(null==m?void 0:m.recommend_predict_rate)||0,g=()=>{var e,t;if(!v||!f)return;let o=null===(e=W.Le.getConfig(W.gI.RecommendStatusCache))||void 0===e?void 0:e[l.awemeId];if(o)return o.recommendTagType;let i=2===s||(null==m?void 0:null===(t=m.label_user_list)||void 0===t?void 0:t.length)>0?"white":void 0;return tX(l.awemeId,{recommendTagType:i}),i},w=()=>{if(!f)return(null==m?void 0:m.label_user_list)||[];let e=tY(l.awemeId,"selfRecommend");return(null!=e?e:2===s)?[tQ(i),...(null==m?void 0:m.label_user_list)||[]]:(null==m?void 0:m.label_user_list)||[]},[I,C]=(0,n.useState)(g),[y,S]=(0,n.useState)(w),k=(0,n.useRef)(tY(l.awemeId,"guideTagTriggerSource")||void 0),T=(0,n.useRef)(tY(l.awemeId,"recommendTriggerSource")||("white"===I?"feed":void 0)),b=(0,n.useRef)(tY(l.awemeId,"cancelRecommend")||!1),L=(0,n.useRef)(!1),E=(0,n.useRef)(!1),{handleCancelRecommendReport:x,handleRecommendReport:A}=tG({awemeInfo:l,abTestData:a,guideTagTriggerSource:k.current}),P=(0,n.useMemo)(()=>null==y?void 0:y.find(e=>{var l,t;return String(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.uid)===(null==i?void 0:null===(t=i.info)||void 0===t?void 0:t.uid)}),[y,i]),R=(0,n.useMemo)(()=>v&&!P&&!b.current,[v,P]),M=()=>{if(!I&&!!_&&!!tq(h,"digg",u)&&!b.current&&!!f)k.current="like",C("guide"),tX(l.awemeId,{recommendTagType:"guide",guideTagTriggerSource:"like"})},V=()=>{let e=cookies.getItem({sKey:lD.CookieKeys.shareRecommendGuideTagNegative}),t=cookies.getItem({sKey:lD.CookieKeys.totalRecommendGuideTagNegative});if(I||e||t||!_||!tq(h,"share",u)||b.current||!f)return;C("guide"),k.current="share",tX(l.awemeId,{recommendTagType:"guide",guideTagTriggerSource:"share"});let o=Number(cookies.getItem({sKey:lD.CookieKeys.shareRecommendGuideTagCount}))||0,i=Number(cookies.getItem({sKey:lD.CookieKeys.totalRecommendGuideTagCount}))||0;cookies.setItem(lD.CookieKeys.shareRecommendGuideTagCount,o+1),cookies.setItem(lD.CookieKeys.totalRecommendGuideTagCount,i+1)},j=()=>{let e=cookies.getItem({sKey:lD.CookieKeys.playRecommendGuideTagNegative}),t=cookies.getItem({sKey:lD.CookieKeys.totalRecommendGuideTagNegative});if(I||e||t||!_||!tq(h,"play",u)||b.current||!f)return;C("guide"),k.current="play",tX(l.awemeId,{recommendTagType:"guide",guideTagTriggerSource:"play"});let o=Number(cookies.getItem({sKey:lD.CookieKeys.playRecommendGuideTagCount}))||0,i=Number(cookies.getItem({sKey:lD.CookieKeys.totalRecommendGuideTagCount}))||0;cookies.setItem(lD.CookieKeys.playRecommendGuideTagCount,o+1),cookies.setItem(lD.CookieKeys.totalRecommendGuideTagCount,i+1)},D=async function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1?arguments[1]:void 0;C("white"),S(e=>(null==e?void 0:e.find(e=>{var l,o,n;return String(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.uid)===(null===(n=t||i)||void 0===n?void 0:null===(o=n.info)||void 0===o?void 0:o.uid)}))?e:[tQ(t||i),...e]),A(o),T.current=o,L.current=!0;let n=await (0,tz.a)(null==l?void 0:l.awemeId,(null==m?void 0:null===(e=m.label_user_list)||void 0===e?void 0:e.length)>0?1:0);if(L.current=!1,(null==n?void 0:n.status_code)===0)tX(l.awemeId,{recommendTagType:"white",selfRecommend:!0}),tX(null==l?void 0:l.awemeId,{recommendTriggerSource:o});else{ev.F.info("推荐失败，请稍后重试"),C(I),S((null==m?void 0:m.label_user_list)||[]);return}},B=async e=>{if(!!v&&!P&&!L.current){if(!(null==i?void 0:i.isLogin)){var l,t;(0,ll.default)({success:async()=>{let l=await (null==d?void 0:d({type:"updateUserInfo"}));D((0,r._)((0,o._)({},l),{info:l.user}),e)},headerText:"登录后即可推荐视频",enterMethod:"recommend",next:`https://${null===(t=window)||void 0===t?void 0:null===(l=t.location)||void 0===l?void 0:l.host}`});return}await D(null,e)}},U=async e=>{var t,o;if(L.current)return;b.current=!0,!(null==m?void 0:null===(t=m.label_user_list)||void 0===t?void 0:t.length)&&C(void 0),S((null==m?void 0:m.label_user_list)||[]),x(e),L.current=!0;let n=await (0,tz.T)(null==l?void 0:l.awemeId);if(L.current=!1,(null==n?void 0:n.status_code)===0)!(null==m?void 0:null===(o=m.label_user_list)||void 0===o?void 0:o.length)&&tX(l.awemeId,{recommendTagType:void 0}),tX(l.awemeId,{selfRecommend:!1,cancelRecommend:!0});else{ev.F.info("取消推荐失败，请稍后重试"),b.current=!1,C(I),S([tQ(i),...(null==m?void 0:m.label_user_list)||[]]);return}ev.F.info("已取消推荐")};return(0,N.o)(()=>{if(!v)return;let e=e=>{switch(e.action){case"digg":("open"===e.status||e.force)&&M();break;case"share":V();break;case"recommend":B(e.source);break;case"cancel_recommend":U(e.source);break;case"shortcut_recommend":{let e=P?"cancel_recommend":"recommend";null==t||t.emit(p.Events.USER_ACTION,{action:e,source:"P"})}}};null==t||t.on(p.Events.USER_ACTION,e);let o=F.listen(F.EVENT.syncInteractionStatus,t=>{let{awemeId:o,action:i}=t;o===(null==l?void 0:l.awemeId)&&e({action:i,force:!0})});return()=>{null==t||t.off(p.Events.USER_ACTION,e),o()}},[M,V,B,U,t,v,P,a,l]),(0,N.o)(()=>{var e,l;if(!_)return;let o=e=>{if("play"===k.current)return;let{currentTime:l}=e;l>=15&&j()},i=()=>{if("play"!==k.current)j()};return null==t||null===(e=t.on)||void 0===e||e.call(t,l4.B.TimeUpdate,o),null==t||null===(l=t.on)||void 0===l||l.call(t,l4.B.Ended,i),()=>{var e,l;null==t||null===(e=t.off)||void 0===e||e.call(t,l4.B.TimeUpdate,o),null==t||null===(l=t.off)||void 0===l||l.call(t,l4.B.Ended,i)}},[t,j,_,a]),(0,N.o)(()=>{!f&&(C(g()),S(w()))},[f]),(0,N.o)(()=>(C(g()),S(w()),k.current=tY(l.awemeId,"guideTagTriggerSource")||void 0,b.current=tY(l.awemeId,"cancelRecommend")||!1,L.current=!1,E.current=!1,()=>{if(!E.current){let e=Number(cookies.getItem({sKey:lD.CookieKeys.shareRecommendGuideTagCount}))||0,l=Number(cookies.getItem({sKey:lD.CookieKeys.playRecommendGuideTagCount}))||0,t=Number(cookies.getItem({sKey:lD.CookieKeys.totalRecommendGuideTagCount}))||0;e>=10&&(cookies.setItem(lD.CookieKeys.shareRecommendGuideTagNegative,1,7200),cookies.setItem(lD.CookieKeys.shareRecommendGuideTagCount,0)),l>=15&&(cookies.setItem(lD.CookieKeys.playRecommendGuideTagNegative,1,7200),cookies.setItem(lD.CookieKeys.playRecommendGuideTagCount,0)),t>=50&&(cookies.setItem(lD.CookieKeys.totalRecommendGuideTagNegative,1,7200),cookies.setItem(lD.CookieKeys.totalRecommendGuideTagCount,0))}}),[l]),{recommendTagType:I,userList:y,handleShare:V,handleLike:M,handleClickGuideTag:()=>{E.current=!0,"share"===k.current&&cookies.setItem(lD.CookieKeys.shareRecommendGuideTagCount,0),"play"===k.current&&cookies.setItem(lD.CookieKeys.playRecommendGuideTagCount,0),cookies.setItem(lD.CookieKeys.totalRecommendGuideTagCount,0),B("label")},triggerRecommend:B,cancelRecommend:U,shouldShowFollowRecBtn:R,recommended:P,guideTagTriggerSource:k.current,recommendTriggerSource:T.current}};var t0=t("765027"),t1=t("385976");let t2=e=>{let{defaultOpenedCardType:l,defaultOpenedCardExtraProps:t}=e;(0,n.useEffect)(()=>{if("ai"===l)F.emit(F.EVENT.openAiCard,t)},[])},t3=e=>{let{defaultShow:l=!1}=e,[t,o]=(0,n.useState)(l),i=(0,n.useRef)({}),r=(0,n.useRef)({});return{closeAllCommonCardsExcept:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object.keys(i.current).filter(l=>!e.includes(l)).forEach(e=>{let l=i.current[e];l&&(t.includes(e)||l.isShow)&&l.close()}),l.forEach(e=>{if(!!r.current[e]){if("chapter"===e&&!r.current.chapter.chapterSidebarHidden){var l,t;null===(l=(t=r.current.chapter).close)||void 0===l||l.call(t)}}})},closeOtherCard:e=>{if(Object.keys(i.current).forEach(l=>{if(l===e)return;let t=i.current[l];t&&t.isShow&&t.close()}),r.current.chapter&&!r.current.chapter.chapterSidebarHidden){var l,t;null===(l=(t=r.current.chapter).close)||void 0===l||l.call(t)}},registerCard:(e,l,t)=>{i.current[e]={isShow:l,close:t}},registerSpecialCards:(e,l)=>{r.current[e]=l},getIsCommonCardShow:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(e.length?e:Object.keys(i.current)).filter(e=>!l.includes(e)).some(e=>{var l,t;return null!==(t=null===(l=i.current[e])||void 0===l?void 0:l.isShow)&&void 0!==t&&t})},isCommonCardShow:t,setIsCommonCardShow:o}},t7=e=>{let{key:l,isShow:t,close:o,registerCard:i,setIsCommonCardShow:r,getIsCommonCardShow:a}=e;i(l,t,o),(0,n.useEffect)(()=>{r(a())},[t])};var t8=t("552167");let t5=e=>{let{isUpperFeed:l,playPrevFunc:t,playNextFunc:o,changePrevVideo:i,changeNextVideo:r}=e,{fullScreenQuestionVars:a}=(0,eh.Iq)(e=>{let{fullScreenQuestionVars:l}=e;return{fullScreenQuestionVars:l}}),d=(0,n.useCallback)(()=>{if(!ex.f.playNextInterceptor(a))l?r():o()},[l,r,o,a]);return{playSwitchNextVideo:d,playSwitchPrevVideo:(0,n.useCallback)(()=>{if(!ex.f.playPrevInterceptor(a))l?i():t()},[l,i,t,a])}};var t6=t("488556"),t4=t("720359");let t9=e=>{let{modalEnterFrom:l,logParams:t,isActive:o,isCommonCardShow:i,showSideCard:r,chapterSliderShow:a,aiCardIsPined:d,useJxSlideInheritAndPin:u,useJxDefaultOpen:s,aiCardIsDefaultOpen:c,closeAiCard:v,openAiCard:m,awemeInfo:f,isInnerFeed:h,hasDefaultShowAiCardRef:p,isLogin:g,isShowAiCard:w,checkAiNote:I}=e,{aiEntryVisible:C}=(0,lt.$)({isLogin:g,awemeInfo:f,checkAiNote:I}),y=(0,t4.d)(w),S=(0,t4.d)(C);(0,_.Z)(()=>{(i||r||a)&&(!d||!u)&&v()},[i,d,r,a,u]),(0,n.useEffect)(()=>{if(!u&&o)return()=>{v()}},[o,u]),(0,_.Z)(()=>{!u&&!h&&v()},[h,u]),(0,_.Z)(()=>{!u&&(null==f?void 0:f.awemeId)&&v()},[null==f?void 0:f.awemeId,u]),(0,n.useEffect)(()=>{g&&!(null==y?void 0:y.current)&&(null==S?void 0:S.current)&&o&&(u&&d||s&&c&&!(null==p?void 0:p.current))&&m({tab:lm.X.Search,from:Y.jE.AutoShow})},[g,o,d,u,s,c]),(0,n.useEffect)(()=>{var e,o;let i=null==t?void 0:null===(e=t.search_params)||void 0===e?void 0:e.conversation_id;"ai_search"===l&&(null==t?void 0:null===(o=t.search_params)||void 0===o?void 0:o.open_conversation)==="1"&&i&&m({tab:lm.X.Search,cid:i})},[t,l])};var oe=t("794593");let ol="soda",ot=e=>{let{awemeInfo:l,isActive:t,defaultShow:i=!1,controller:r}=e,[a,d]=(0,n.useState)(i),u=(0,eH.Z)(e=>{d(!1)}),s=(0,eH.Z)(e=>{r.closeOtherCard(ol),d(!0)}),c=(0,eH.Z)(async e=>{if(!!t){if("video_bottom"===e.from){var o,i,n;oe.Z.report("click_ticker_icon_entrance",{author_id:(null==l?void 0:null===(o=l.authorInfo)||void 0===o?void 0:o.uid)||"",enter_from:(0,Z.yW)(),enter_method:"video_bottom",group_id:(null==l?void 0:l.awemeId)||"",luna_group_id:String((null==l?void 0:null===(n=l.relatedMusicAnchor)||void 0===n?void 0:null===(i=n.extraJson)||void 0===i?void 0:i.luna_sid)||""),click_action:a?"off_luna_panel":"on_luna_panel"})}a?u(e):s(e)}});return(0,n.useEffect)(()=>{d(!1)},[t,null==l?void 0:l.awemeId]),t7((0,o._)({key:ol,isShow:a,close:u},r)),(0,n.useMemo)(()=>({isShow:a,open:s,close:u,click:c}),[a,s,u,c])},oo="douPlus",oi=e=>{let{awemeInfo:l,isLogin:t,isActive:i,userDispatch:r,defaultShow:a=!1,controller:d}=e,[u,s]=(0,n.useState)(a),[c,v]=(0,n.useState)(0),m=(0,n.useRef)(null),f=(0,eH.Z)(e=>{m.current&&(m.current=null),s(!1)}),_=(0,eH.Z)(e=>{var l;d.closeOtherCard(oo),v(null!==(l=e.seq)&&void 0!==l?l:0),s(!0)}),h=(0,eH.Z)(async e=>{if(m.current&&(m.current=null),!!i){if("share"===e.from||"more"===e.from){var l;oe.Z.report("click_dou_plus",{has_coupon:e.hasCoupon?1:0,action:u?"close":"open",dou_plus_source:"origin_entrance",dou_plus_sub_source:"douyin",dou_plus_medium:(null==e?void 0:e.from)==="share"?"douyin_PC_share":"douyin_PC_moresettings",dou_plus_entrance_type:1,dou_plus_entrance_level:1,dou_plus_entrance_seq:null!==(l=null==e?void 0:e.seq)&&void 0!==l?l:0,dou_plus_referer:"homepage_hot",target_step:1})}if(u){f(e);return}t?_(e):(0,ll.default)({enterMethod:e.from,success:async()=>{r({type:"updateUserInfo"}),m.current=()=>_(e)},onClose:()=>{}})}});return(0,n.useEffect)(()=>{m.current&&(m.current=null),s(!1)},[i,null==l?void 0:l.awemeId]),(0,n.useEffect)(()=>{if(m.current&&t&&i){var e;null===(e=m.current)||void 0===e||e.call(m),m.current=null}},[t,i]),t7((0,o._)({key:oo,isShow:u,close:f},d)),(0,n.useMemo)(()=>({isShow:u,open:_,close:f,click:h,seq:c}),[u,_,f,h,c])},on=e=>{let{awemeInfo:l,isActive:t,abtestData:o,isLogin:i,dispatch:n,commonCardsController:r}=e,a=oi({awemeInfo:l,isActive:t,abtestData:o,isLogin:i,userDispatch:n,controller:r});return{sodaCtr:ot({awemeInfo:l,isActive:t,abtestData:o,isLogin:i,userDispatch:n,controller:r}),douPlusCtr:a}},or=(0,c.ZP)(()=>Promise.all([t.e("74792"),t.e("23503"),t.e("34850"),t.e("10565")]).then(t.bind(t,189685)),{ssr:!1}),oa=(0,c.ZP)(()=>Promise.all([t.e("62057"),t.e("91529"),t.e("74556"),t.e("53062")]).then(t.bind(t,651015)),{ssr:!1}),od=(0,c.ZP)(()=>t.e("83404").then(t.bind(t,219684)),{ssr:!1}),ou=(0,c.ZP)(()=>t.e("75739").then(t.bind(t,701853)),{ssr:!1}),os=(0,c.ZP)(()=>Promise.all([t.e("22556"),t.e("23145"),t.e("21248"),t.e("11073"),t.e("74792"),t.e("60073"),t.e("31522"),t.e("38946"),t.e("19584"),t.e("35827")]).then(t.bind(t,211032)),{ssr:!1}),oc=(0,c.ZP)(()=>Promise.all([t.e("22556"),t.e("23145"),t.e("21248"),t.e("11073"),t.e("74792"),t.e("60073"),t.e("31522"),t.e("38946"),t.e("19584"),t.e("35827")]).then(t.bind(t,367576)),{ssr:!1}),ov=(0,c.ZP)(()=>Promise.all([t.e("22556"),t.e("23145"),t.e("21248"),t.e("11073"),t.e("74792"),t.e("60073"),t.e("31522"),t.e("38946"),t.e("19584"),t.e("35827")]).then(t.bind(t,441885)),{ssr:!1}),om=(0,c.ZP)(()=>t.e("30188").then(t.bind(t,678137)),{ssr:!1,resolveComponent:e=>e.SearchPlayerSideCard}),of=(0,c.ZP)(()=>t.e("65520").then(t.bind(t,67655)),{ssr:!1}),o_=(0,c.ZP)(()=>t.e("81021").then(t.bind(t,316684)),{ssr:!1}),oh=[Y.jE.CommentNamedEntitySearchAiSearch,Y.jE.CommentRelatedSearchAiSearch],op=(0,n.forwardRef)(function(e,l){var t,u,c,v,Y,ei,en,er,em,ef,ey,ek,eT,eb,eN,eL,ex,eP,eR,eV,eF,ej,eD,eB,eW,eU,eH,eY,eJ,e0,e1,e2,e3,e8,e5,le,ll,lt,ln,lr,la,ld,lu,ls;let{item:lm,playPrevFunc:lf,playNextFunc:lI,deleteCurrentSwiper:lT,fullScreenTarget:lb,isActive:lN,isNext:lE,swiper:lx,children:lM,customProps:lV,isLast:lj,handleNextOnLast:lD,slideListInsideFunc:lB,InnerPlayer:lW,className:lU,isShowGuide:lO,isClientMiniWin:lZ,style:lH,close:lK,hotDefaultList:l$,mixDefault:lz,seriesDefault:lG,relatedDefault:lq,currentAwemeInfo:lQ,onAwemeInfoChange:lX,clickedCard:lY,moreBoxShowList:l1,getCurrentTime:l2,modalInnerFeedCard:l3,defaultOpenedCardType:l7,defaultOpenedCardExtraProps:l6,modalEnterFrom:l4,defaultCommentShow:l9,startTime:te,splashAdStatus:tt,changeSplashAdStatus:to,isSplashTransitionEnd:ti,isFirst:tn,needStaticContainer:tr,searchSideCardProps:ta,onSearchTextClick:td,searchListType:tu,hideSidebarSwitch:ts,searchFrom:tc,isDyPlayer:tv=!1,modalInnerPlayer:t_,index:ty,activityCardDirectOpen:tS,reuseConfig:tk}=e,{abtestData:tT={},tab:tb,userContext:tN,logParams:tL}=lV||{},{isWebMiniWin:tx}=(0,eh.Iq)(e=>{let{isWebMiniWin:l}=e;return{isWebMiniWin:l}}),tA=(null==tT?void 0:tT.aiNoteV2)===1||(null==tT?void 0:tT.aiNoteV2)===2,tP=(0,n.useRef)(0);(0,d.C)(R.w3.components.container3);let tR=(0,n.useMemo)(()=>[g.lT.Recommend,g.lT.Follow,g.lT.Friend,g.lT.Topic,g.lT.Modal].includes(tb),[tb]),tM=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"inner_player",l=arguments.length>1?arguments[1]:void 0;if(!tR&&ox)return null==lK?void 0:lK(e,l);ec.Z.sendLog("closePlayer",{click_method:e,enter_from:l});let t=e;"click_screen"===e&&(t="click_blank"),w.logInstance.sendLog("closeVideoCard",{enter_method:t,type:l,enter_from_merge:(0,V.vM)()}),ob.dispatch("modalAwemeInfo",null),!oQ.current&&F.emit(F.EVENT.pageFullScreen,{fullScreen:!1,playerId:null==ok?void 0:ok.playerId,oldFullScreen:!0,clickMethod:"inner_player"}),l3&&setTimeout(()=>{null==lK||lK()})},tV=(0,n.useRef)(null),tF=(0,n.useRef)(null),tj=(0,n.useRef)(),{userInfo:tD,dispatch:tB}=tN||{},{isLogin:tW}=tD||{},{globalIsSideBarShow:tU,setIsSideBarShowFunc:tO,isFullScreen:tZ,isCssFullScreen:tH,setTargetVideoRef:tK=()=>{},slideVideoTab:tz,setSlideVideoTab:tG,videoToast:tq=e=>ev.F.info(e,tF.current),dislikeIdList:tQ,globalIsCommentTrayPushGuideShow:tX,globalCommentTrayPushGuideType:tY,setCommentTrayPushGuideTypeFunc:t4,setIsCommentTrayPushGuideShowFunc:oe,globalIsShowAiCard:ol,setGlobalIsShowAiCard:ot,aiCardIsPined:oo,togglePinAiCard:oi,useJxSlideInheritAndPin:op,useJxDefaultOpen:og,aiCardIsDefaultOpen:ow,hasDefaultShowAiCardRef:oI,setHasDefaultShowAiCard:oC}=(0,n.useContext)(Q.C),[oy,oS]=(0,n.useState)(!1),[ok,oT]=(0,n.useState)(null),{awemeFeed:ob,metaCtxId:oN}=(0,e_.j)(),[oL,oE]=(0,n.useState)(null);(0,n.useEffect)(()=>{var e;if((null==tT?!void 0:null===(e=tT.authorOptimize)||void 0===e?!void 0:!e.render)||!!lN)return ob.subscribe("modalAwemeInfo",e=>{oE(e)})},[lN,tT]);let ox=e.isUpperFeed||!!(tR&&oL),{pathname:oA}=(0,h.a)(),oP=(0,n.useRef)(oA),oR=(0,n.useRef)(oA);!(0,j.Nr)(oA)&&(oR.current=oA);let[oM,oV]=(0,n.useState)(!1),[oF,oj]=(0,n.useState)(I.L.Author),[oD,oB]=(0,n.useState)(!1),[oW,oU]=(0,n.useState)(),[oO,oZ]=(0,n.useState)(),oH=tO||oV,oK=tG?tz:I.L.AbstractList,o$=tG||oj,oz=(0,D.x)(),oG=[g.lT.Recommend].includes(tb)||tb===g.lT.Modal&&l4===C.a.WaterFall,oq=[g.lT.Recommend,g.lT.Follow,g.lT.Friend].includes(tb)||tb===g.lT.Modal&&J.D.includes(l4),oQ=(0,n.useRef)(!1);(0,n.useEffect)(()=>{if(ok&&lN&&ox&&tR){!ok.fullscreen&&F.emit(F.EVENT.pageFullScreen,{clickMethod:"inner_feed",fullScreen:!0,playerId:ok.playerId});let e=e=>{F.emit(F.EVENT.pageFullScreen,{clickMethod:"inner_feed",fullScreen:!e,playerId:ok.playerId})};return null==ok||ok.on(p.Events.FULLSCREEN_CHANGE,e),()=>{null==ok||ok.off(p.Events.FULLSCREEN_CHANGE,e),F.emit(F.EVENT.pageFullScreen,{clickMethod:"inner_feed",fullScreen:!1,playerId:ok.playerId})}}},[ox,tR]);let oX=(0,n.useRef)(!1),oY=(0,n.useRef)(!1),oJ=(0,n.useRef)(!1),o0=(0,n.useRef)(null),o1=(0,n.useRef)(null),o2=(0,n.useRef)(null),o3=(0,n.useRef)(null),o7=(0,n.useRef)(null),o8=(0,n.useRef)(null),o5=(0,n.useRef)(),o6=(0,n.useRef)(null),o4=(0,n.useMemo)(()=>"string"==typeof tc&&tc.startsWith("video_abstract"),[tc]),o9=ox?oy:(!(0,y.Jt)(lm)||oK===I.L.Comment)&&(tO?tU:oM),ie=(0,n.useCallback)(ev.F.infoInModalVideo.bind(ev.F),[]),il=ox||tb===g.lT.Modal?ie:tq;(0,n.useEffect)(()=>{if(!tR)return;let e=ob.subscribe("modalAwemeInfo",e=>{ob.dispatch("innerFeedAwemeInfo",e);let l=document.querySelector('[data-e2e="recommend-guide-mask"]');l&&e&&F.emit(F.EVENT.RecommendGuideClose),l=null,!l3&&e&&ok.isActive&&ok.paused&&ok.play()});return()=>{e()}},[tR,ok,l3]);let{changeListenVideoFeedIndex:it}=ep({scene:tb===g.lT.Modal?"discover":tb,canUseListenFeed:oG,originAwemeInfo:lm,isActive:lN}),{changeNextVideo:io,changePrevVideo:ii,awemeInfo:ir,updateAwemeInfo:ia,prevAwemeInfo:id,nextAwemeInfo:iu,isInnerFeed:is,enterFrom:ic,updateLogParams:iv,listenFeedNextAwemeInfo:im,listenFeedPrevAwemeInfo:i_}=eA({abtestData:tT,player:ok,originAwemeInfo:(null==tT?void 0:null===(t=tT.authorOptimize)||void 0===t?void 0:t.render)?lN&&(tR&&oL||lQ)||lm:tR&&oL||lQ||lm,isActive:lN,isLast:lj,toast:il,modalEnterFrom:l4,handleNextOnLast:lD,handleOuterPlayNext:lI,handleOuterPlayPrev:lf,isInnerFeedCondition:ox,scene:tb,canUseListenFeed:oG,changeListenVideoFeedIndex:it});(0,n.useEffect)(()=>{null==lX||lX(ir)},[ir]),eM({abtestData:tT,isActive:lN,awemeInfo:ir,isModal:ox,player:ok,scene:tb,fetchAuthorPost:async e=>{if(lN){var l;let t={userId:null==e?void 0:null===(l=e.authorInfo)||void 0===l?void 0:l.secUid,maxCursor:0,count:24,locateItemId:null==e?void 0:e.awemeId,whaleCutToken:""},o=(0,M.fetchUserPost)(t);t6.Q.set(t,o)}}}),(0,n.useEffect)(()=>{let e=ob.getValue("activeIndex");return ob.subscribe("activeIndex",l=>{tR&&ob.getValue("modalAwemeInfo")&&(l>e?io():l<e&&ii(),e=l)})},[io,ii]),(0,n.useEffect)(()=>{if(oL&&lN)return tR&&(oS(!0),ok&&(tP.current=ok.currentTime,oL.awemeId===ir.awemeId&&setTimeout(()=>{null==ok||ok.emit("enter_inner_feed")}))),()=>{var e,t,o,i;tR&&(null==ok||ok.emit("exit_inner_feed",ir.awemeId),(null===(i=l.current)||void 0===i?void 0:null===(o=i.getCurrAweme)||void 0===o?void 0:null===(t=o.call(i))||void 0===t?void 0:t.awemeId)===ir.awemeId&&(tP.current=0)),F.emit(null==F?void 0:null===(e=F.EVENT)||void 0===e?void 0:e.quitInnerFeed,!0)}},[!oL,tR]),(0,n.useEffect)(()=>{!ox&&(oS(!1),nF(!1))},[ox]);let ih=(0,n.useMemo)(()=>(0,S.p)(ir)?tt===k.QB.Fullscreen||tt===k.QB.Normal:!((null==tT?void 0:tT.innerSlideSmooth)&&[g.lT.Recommend,g.lT.Follow,g.lT.Friend,g.lT.Modal,g.lT.Discover].includes(tb))||lN,[ir,tt,ti,tT,lN,tb]);(0,T.u)(oa);let{showRelatedTabList:ip,relatedBlockedByRecommendScore:ig}=eO({awemeInfo:ir,currentVideoFeedRef:o0,lastVideoFeedAwemeRef:o1,outFeedItem:lm,scene:tb,modalEnterFrom:l4,abtestData:tT,isInnerFeed:is}),{defaultCard:iw}=eZ({isActive:lN,awemeInfo:ir,clickedCard:null!=lY?lY:oK===I.L.Comment?I.L.Comment:void 0,withCtr:tb===g.lT.Recommend}),iI=(0,n.useMemo)(()=>o4?I.L.AbstractList:(null==ir?void 0:ir.awemeType)!==b.e.XgVideo||[I.L.CollectFolder].includes(iw)?iw:I.L.Comment,[iw,ir,oK,o4]),{stopAutoPlay:iC}=eK({isShow:o9||oD||oY.current,player:ok,isActive:lN,awemeInfo:ir,abtestData:tT}),{curTab:iy,curTabRef:iS,curVideoFeed:ik,changeTab:iT,lastVideoFeedAweme:ib}=e$.nW({defaultTab:iI,isActive:lN,stopAutoPlay:iC,awemeInfo:ir,abtestData:tT,showSideCard:o9});o0.current=ik,o1.current=ib,ez({originAwemeInfo:lm,awemeInfo:ir}),eG({awemeInfo:ir,curTab:iy,isActive:lN,abtestData:tT,isUpperFeed:ox,modalAwemeInfo:oL});let iN=()=>{l4===C.a.AiSearch&&ob.dispatch({modalAwemeInfo:null,nextAwemeInfo:null,prevAwemeInfo:null})},{handleAuthorVideoChange:iL,handleOtherVideoChange:iE}=eq({onChangeAwemeInfo:e=>{ox?ia(e):(null==e?void 0:e.inComingAwemeInfo)&&ob.dispatch("modalAwemeInfo",e.inComingAwemeInfo),(null==e?void 0:e.card)&&iT({tab:e.card})}}),{globalCommentCount:ix,updateGlobalCommentCount:iA,fetchComment:iP}=eQ.x({awemeInfo:ir});eX.U({isModal:ox,awemeInfo:ir,isActive:lN,fetchComment:iP,player:ok,showSideCard:o9,commentpreloadAbStatus:null==tT?void 0:tT.commentAiPreloadStatus,adCommentpreloadAbStatus:null==tT?void 0:tT.adCommentAiPreloadStatus,scene:tb,abUseSimpleNN:null==tT?void 0:tT.useSimpleNN,abVid:null==tT?void 0:tT.commentAiVid});let{reportParams:iR}=e6({originAwemeInfo:lm,awemeInfo:ir,logParams:(0,r._)((0,o._)({},tL),{is_outflow:0===ty?1:0,item_rank:ty+1}),curCard:iy,expandCard:o9?iy:"",isSideBarShow:o9,isInnerFeedCondition:ox,searchSideCardProps:ta,modalEnterFrom:l4}),{hasRelatedCardShown:iM}=e4({isActive:lN,player:ok,showSideCard:o9});(0,n.useEffect)(()=>{iv({logParams:iR})},[iR]);let iV=t3({defaultShow:!1}),{closeAllCommonCardsExcept:iF,closeOtherCard:ij,registerSpecialCards:iD,isCommonCardShow:iB}=iV,iW=(0,n.useCallback)(e=>{let l="chapterSidebar"===e;oU(l?"sidebar":"chapterSidebar"),oZ(l?"chapterSidebar":"sidebar")},[]),{isShowActivityCard:iU,activityName:iO,anchorData:iZ,openActivityCard:iH,closeActivityCard:iK}=e9.T({awemeInfo:ir,isActive:lN,onOpenCard:()=>{ij("activity")},abtestData:tT,isLogin:tW}),{sodaCtr:i$,douPlusCtr:iz}=on({awemeInfo:ir,isActive:lN,abtestData:tT,isLogin:tW,dispatch:tB,commonCardsController:iV}),{chapterProgress:iG,chapterSliderShow:iq,triggerChapterSliderShow:iQ,setChapterSliderShow:iX}=eg({player:ok,awemeInfo:ir,abTestData:tT,chapterScrollElRef:o7,topLevelSidebar:oO,activateCard:iW,resetClosingShopRef:()=>{oJ.current=!1},isActive:lN,isInnerFeed:is}),iY=lo({awemeInfo:ir,isActive:lN,isInnerFeed:is,onOpenCard:()=>{},abtestData:tT,toast:il,isLogin:tW,accountParentEl:(0,B.r)()&&lb,onLoginSuccess:()=>{null==tB||tB({type:"updateUserInfo"})}}),iJ=(null==iY?void 0:iY.renderAiCard)&&!(tb===g.lT.Search&&!ox)&&(null==iY?void 0:iY.isShowAiCard),i0=li({awemeInfo:ir,isActive:lN,isInnerFeed:is,globalIsShowAiCard:ol,setGlobalIsShowAiCard:ot,onOpenCard:()=>{iF(),nA(!1),iX(!1)},abtestData:tT,toast:il,isLogin:tW,aiCardIsPined:oo,otherCardIsOpen:iB||iq||o9,accountParentEl:(0,B.r)()&&lb,aiSearchIsDefaultShow:op&&oo||og&&ow,setHasDefaultShowAiCard:oC,onLoginSuccess:()=>{null==tB||tB({type:"updateUserInfo"})},isAiNoteCardShow:iJ}),i1=(0,n.useCallback)(e=>{var l,t;let{tab:o,clickMethod:i="",awemeInfo:n=ir,isFromUserPersonalPannel:r=!1}=e;iF(["videoDetail","recommendWhiteTag","ad","shopDetail"]);let a="chapterSidebar"===oO||iJ;if(a&&iW("sidebar"),![I.L.Comment,I.L.VideoDetail].includes(o)){if(ox){if(o===iy&&!a)return tM()}else{o$(o),iT({tab:o}),ob.dispatch({modalAwemeInfo:n,nextAwemeInfo:null,prevAwemeInfo:null}),w.logInstance.sendLog("enterVideoCardTab",{from_group_id:null==n?void 0:n.awemeId,type:o,enter_method:i,enter_from_merge:(0,V.vM)(),enter_from:null!==(l=null==tL?void 0:tL.enter_from)&&void 0!==l?l:(0,V.mo)(),tab_name:(null==tL?void 0:tL.tab_name)||(0,q.zD)(),module_name:null==tL?void 0:tL.module_name});return}}o9&&o===iy&&!a?(nA(!1,{from:i}),w.logInstance.sendLog("closeVideoCard",{type:o,enter_method:i,enter_from_merge:(0,V.vM)()})):(iT({tab:o}),o$(o),nA(!0,{from:i}),w.logInstance.sendLog("enterVideoCardTab",{from_group_id:null==n?void 0:n.awemeId,type:o,enter_method:i,enter_from_merge:(0,V.vM)(),enter_from:null!==(t=null==tL?void 0:tL.enter_from)&&void 0!==t?t:(0,V.mo)(),tab_name:(null==tL?void 0:tL.tab_name)||(0,q.zD)(),module_name:null==tL?void 0:tL.module_name}))},[o9,ir,ox,iy,lK,tT,tH,oO,iW,tb,iY]);(0,N.o)(()=>F.listen(F.EVENT.OpenRelatedCard,e=>{(null==e?void 0:e.isFromClientSync)&&i1(e)}),[tT]),(0,N.o)(()=>{let e=F.listen(F.EVENT.CloseRelatedCard,e=>{tM(null==e?void 0:e.from,null==e?void 0:e.enterFrom)});return()=>{null==e||e()}},[]),(0,n.useEffect)(()=>{if(!ox&&lN&&l3){let e;let l="auto";"mix"===l3?e=I.L.Mix:"author_card"===l3?(e=I.L.Author,l4===C.a.FollowAuthorModal&&(l="click_follow_head_show")):"series"===l3?e=I.L.Series:"collect_folder"===l3&&(e=I.L.CollectFolder),e&&setTimeout(()=>{i1({tab:e,clickMethod:l})})}},[ox,l3,i1,l4]),(0,n.useEffect)(()=>{if(ok&&oL&&!tR&&lN&&!ox){let e=ok.playerId;if((0,el.OB)()===e||!ok.paused)return(0,el.wS)(e,!1),ok.pause(),()=>{(0,el.wS)(e,!0),setTimeout(()=>{ok.play()})}}},[ok,oL,lN,tR,ox]),(0,n.useEffect)(()=>{if(lN){let e=o9&&iy===I.L.Comment;W.Le.setConfig(W.gI.IsCommetTab,e)}},[lN,o9,iy]);let{closeAdCard:i2,isShowAdCard:i3,isAdAweme:i7}=lc({awemeInfo:ir,userInfo:tD,isActive:lN,abtestData:tT,toast:il,isFirst:tn,isUpperFeed:ox,changeSplashAdStatus:to}),{recommendTagType:i8,handleClickGuideTag:i5,userList:i6,shouldShowFollowRecBtn:i4,recommended:i9,guideTagTriggerSource:ne,recommendTriggerSource:nl}=tJ({awemeInfo:ir,player:ok,userInfo:tD,abTestData:tT,userDispatch:tB,scene:tb}),{isShowRecommendWhiteTagSideCard:nt,openRecommendWhiteTagSideCard:no,closeRecommendWhiteTagSideCard:ni}=lv({onOpenCard:()=>{iF([],["chapter"]),o9&&nA(!1)},awemeInfo:ir,isActive:lN,isInnerFeed:is}),{closeAiCard:nn,isShowAiCard:nr,renderAiCard:na,activeAiCardTab:nd,setActiveAiCardTab:nu,setAiNoteEnterMethod:ns,aiSearchProps:nc,aiNoteProps:nv,isAiNoteUseable:nm,openAiCard:nf}=l_({awemeInfo:ir,isActive:lN,isInnerFeed:is,globalIsShowAiCard:ol,setGlobalIsShowAiCard:ot,onOpenCard:()=>{iF(),nA(!1),iX(!1)},abtestData:tT,toast:il,isLogin:tW,aiCardIsPined:oo,otherCardIsOpen:iB||iq||o9,accountParentEl:(0,B.r)()&&lb,aiSearchIsDefaultShow:op&&oo||og&&ow,setHasDefaultShowAiCard:oC,onLoginSuccess:()=>{null==tB||tB({type:"updateUserInfo"})}}),n_=tA?null==i0?void 0:i0.isShowAiCard:nr,nh=tA?null==i0?void 0:i0.openAiCard:nf,np=tA?null==i0?void 0:i0.closeAiCard:nn,{openShopDetailCard:ng,isShowShopDetailSideCard:nw,closeShopDetailCard:nI,isFirstLoad:nC,isAutoOpen:ny}=lp.Y({awemeInfo:ir,isActive:lN,onOpenCard:()=>{iF(["videoDetail","recommendWhiteTag","shopDetail"])},isLogin:tW,accountParentEl:(0,B.r)()&&lb,onLoginSuccess:()=>{null==tB||tB({type:"updateUserInfo"})},onCloseCard:()=>{oJ.current=!0},abtestData:tT,toast:il}),{isShowVideoInfoSideCard:nS,closeVideoInfoSideCard:nk}=lg({awemeInfo:ir,isActive:lN,abtestData:tT,isInnerFeed:is,onOpenCard:()=>{iF(["videoDetail"],["chapter"]),o9&&nA(!1)}});(0,_.Z)(()=>{i3&&(null==iY||iY.closeAiCard(),nk(),ni())},[i3]),(0,_.Z)(()=>{iF(["ad","shopDetail"])},[null==ir?void 0:ir.awemeId]);let nT=(0,n.useMemo)(()=>(0,L.o4)(ir),[ir]),nb=nT?(0,L.ZO)({rawAdData:(0,y.Rx)(ir)}):{},nN=nT?{promotion_id:nb.promotion_id,product_id:nb.product_id,shop_info:{author_id:null==ir?void 0:null===(u=ir.authorInfo)||void 0===u?void 0:u.uid}}:(null==ir?void 0:null===(v=ir.anchorInfo)||void 0===v?void 0:null===(c=v.extra)||void 0===c?void 0:c[0])||{},{sendPrefetch:nL,cancelPrefetch:nE}=(0,E._t)(()=>{var e;return(0,x.L)({promotionId:null==nN?void 0:nN.promotion_id,originType:638302,secAuthorId:null==ir?void 0:null===(e=ir.authorInfo)||void 0===e?void 0:e.secUid,roomId:"",itemId:null==ir?void 0:ir.awemeId})}),nx=(0,n.useCallback)(e=>{let{clickMethod:l}=e||{};return("hot_key"===l||"click_icon"===l)&&o9&&iy===I.L.Comment&&iB?(!oX.current&&(oX.current=!0,F.emit(F.EVENT.videoStopPlayNext,{openSideCard:!0})),iF([]),!0):(i1({tab:I.L.Comment,clickMethod:l||"click_icon"}),(!o9||iy!==I.L.Comment)&&(!!o9&&iy!==I.L.Comment||!0))},[o9,i1,iy,iB]);(0,_.Z)(()=>{oY.current=nw},[nw]);let nA=(e,l)=>{let{from:t}=l||{};!oX.current&&e&&"auto"!==t&&(oX.current=!0,F.emit(F.EVENT.videoStopPlayNext,{openSideCard:!0})),oX.current&&!e&&(oX.current=!1,F.emit(F.EVENT.videoRemoveStopPlayNext,{openSideCard:!0})),ox?(oS(e),e&&!o9&&iF(["ad"])):(null==oH||oH(e),e&&(iF(),(0,eE.nJ)(eE.mM.COMMENT_BTN_CLICKED)))},nP=(0,n.useMemo)(()=>o4?I.L.AbstractList:l9?I.L.Comment:void 0,[l9,o4]);(0,_.Z)(()=>{n_&&(iF(),nA(!1),iX(!1))},[n_]);let{openSpecificTab:nR}=lw({showSideCard:o9,isActive:lN,originAwemeInfo:lm,showRelatedTabList:ip,slideVideoTab:oK,abtestData:tT,changeTab:iT,isUpperFeed:ox,defaultLandingTab:nP,handleShowSidebar:nA,logParams:tL,searchFrom:tc}),{hotData:nM}=lC({awemeInfo:ir,slideOptimize:null==tT?void 0:tT.slideOptimize}),{delaySideCardShow:nV,setDelaySideCardShow:nF}=ly({isActive:lN,isNext:lE,player:ok,showSideCard:o9,abtestData:tT}),{delaySideCardShow:nj}=ly({isActive:lN,isNext:lE,player:ok,showSideCard:n_,abtestData:tT,keepAlive:!0});t9({modalEnterFrom:l4,logParams:tL,isActive:lN,isCommonCardShow:iB,showSideCard:o9,chapterSliderShow:iq,aiCardIsPined:oo,useJxSlideInheritAndPin:op,useJxDefaultOpen:og,aiCardIsDefaultOpen:ow,hasDefaultShowAiCardRef:oI,closeAiCard:np,openAiCard:nh,isInnerFeed:is,awemeInfo:ir,isLogin:tW,isShowAiCard:n_});let nD=lS({scene:tb,reportParams:iR,awemeInfo:ir,curCard:iy,toast:il,showRelatedTabList:ip,isShowSideBar:iB||o9||n_,handleRelated:i1}),{onAvatarClick:nB,onRelatedClick:nW}=nD,nU=(0,a._)(nD,["onAvatarClick","onRelatedClick"]),{videoTags:nO}=tE({abtestData:tT,awemeInfo:ir,scene:tb,showRelatedTabList:ip,withCtr:tb===g.lT.Recommend,originAwemeInfo:lm,isInnerFeed:is,canShowMixCard:!0,canShowSeriesCard:!0,canShowRelatedCard:!0,canShowRelatedSearchFeedBar:!0,actions:nU}),{inImmersive:nZ}=(0,l0.O)({player:ok,isActive:lN,slideOptimize:null==tT?void 0:tT.slideOptimize}),{follow:nH,unFollow:nK}=(0,ew.OM)({selfUid:null==tD?void 0:null===(Y=tD.info)||void 0===Y?void 0:Y.uid,actionUid:null==ir?void 0:null===(ei=ir.authorInfo)||void 0===ei?void 0:ei.uid,defaultFollowerStatus:null==ir?void 0:null===(en=ir.authorInfo)||void 0===en?void 0:en.followerStatus,defaultFollowStatus:null==ir?void 0:null===(er=ir.authorInfo)||void 0===er?void 0:er.followStatus,logExtraParams:(0,o._)({author_id:null==ir?void 0:null===(em=ir.authorInfo)||void 0===em?void 0:em.uid,group_id:null==ir?void 0:ir.awemeId,from_group_id:null==lm?void 0:lm.awemeId,music_id:null==ir?void 0:null===(ef=ir.music)||void 0===ef?void 0:ef.mid,compilation_id:null==ir?void 0:null===(ey=ir.mixInfo)||void 0===ey?void 0:ey.mixId,aweme_type:(null==ir?void 0:ir.isSlides)?b.e.Slides:null==ir?void 0:ir.awemeType,pic_cnt:null!==(la=null==ir?void 0:null===(ek=ir.images)||void 0===ek?void 0:ek.length)&&void 0!==la?la:0,is_pure:nZ?"1":"0",to_user_id:null==ir?void 0:null===(eT=ir.authorInfo)||void 0===eT?void 0:eT.uid,item_duration_ms:(null==ir?void 0:null===(eb=ir.video)||void 0===eb?void 0:eb.duration)||0},iR),isLogin:tW,accountParentEl:(0,B.r)()&&lb,onLoginSuccess:()=>{null==tB||tB({type:"updateUserInfo"})},fail:ew.GH}),{followStatus:n$}=(0,eI.r)({selfUid:null==tD?void 0:null===(eN=tD.info)||void 0===eN?void 0:eN.uid,actionUid:null==ir?void 0:null===(eL=ir.authorInfo)||void 0===eL?void 0:eL.uid,defaultFollowerStatus:null==ir?void 0:null===(ex=ir.authorInfo)||void 0===ex?void 0:ex.followerStatus,defaultFollowStatus:null==ir?void 0:null===(eP=ir.authorInfo)||void 0===eP?void 0:eP.followStatus});lk({scene:tb,isOuter:!ox,isActive:lN,player:ok}),lh({aiCardElRef:o3,isShowAiCard:nr});let{isMiniWin:nz}=lL({scene:tb,awemeInfo:ir,scrollElRef:o2,changeNextVideo:io,changePrevVideo:ii,isUpperFeed:ox,swiper:lx,isActive:lN&&!oL||ox,feedCssFullScreen:tH,player:ok,modalEnterFrom:l4,onFullScreen:e=>{e&&nA(is,{from:"auto"}),ox&&!tR&&!e&&F.emit(F.EVENT.pageFullScreen,{fullScreen:!0,playerId:null==ok?void 0:ok.playerId,clickMethod:"inner_player"})},onCssFullScreen:e=>{e&&nA(is,{from:"auto"}),tR&&!e&&(null==oH||oH(!1)),ox&&!e&&!(tZ||(0,B.r)())&&tM()},onFullScreenrestore:()=>{nA(is,{from:"auto"})},onTriggerModalPlayerClose:()=>{ox&&tM("click_button",iy)},onCanPlay:()=>{let e=()=>{var e;!((null===(e=window.__QUICK_PLAYER)||void 0===e?void 0:e.playerId)&&window.__QUICK_PLAYER.playerId===(null==ok?void 0:ok.playerId))&&!t1.YY.checkIsReusePlayer(null==tk?void 0:tk.scene,null==tk?void 0:tk.reuseId,ok)&&(ok.seek(te,"play"),W.Le.setConfig(W.gI.PreviewPlayInfoRecord,{awemeId:"",recordPlayTime:0}))};if(ox){let l=null==l2?void 0:l2();l&&ok.seek(l,"play"),l3&&e()}else if(tP.current)ok.seek(tP.current,"play"),tP.current=0;else if(te)e();else{let{continationInfo:e}=ir;(null==e?void 0:e.playProgress)&&(ok.seek(null==e?void 0:e.playProgress,"play"),delete e.playProgress)}},onPlay:()=>{!ox&&ob.getValue("modalAwemeInfo")&&!tR&&setTimeout(()=>{var e;return null===(e=ok.pause)||void 0===e?void 0:e.call(ok)})},onVideoTitleClick:()=>{var e,l;i1({tab:I.L.Author,clickMethod:"click_title"}),ec.Z.sendLog("clickAuthorHead",(0,o._)((0,r._)((0,o._)({click_from:"title",urlParamList:["previous_page"],author_id:null==ir?void 0:null===(e=ir.authorInfo)||void 0===e?void 0:e.uid,group_id:null==ir?void 0:ir.awemeId,log_pb:null==ir?void 0:ir.logPb,enter_from:(0,V.mo)(),is_full_screen:(0,B.r)()?"1":"0",from_follow_list:(null===(l=W.Le.getConfig(W.gI.FromFollowList))||void 0===l?void 0:l.tag)?"1":"0"},iR),{action:o9?"close":"open"}),(0,U.t)()))}});t2({defaultOpenedCardType:l7,defaultOpenedCardExtraProps:l6}),lA({scene:tb,awemeInfo:ir,isActive:lN,isNext:lE,isUpperFeed:ox,modalEnterFrom:l4,smoothInner:tR&&is});let{authorConfig:nG,commentConfig:nq}=lP.B({awemeInfo:ir,customProps:lV,reportParams:iR,fullScreenTarget:lb,tab:iy,showSideCard:o9,isShowRelatedCard:o9,player:ok,scrollElRef:o2,followStatus:n$,handleCommentClick:e=>nx(e),isActive:lN,isUpperFeed:ox,globalIsCommentTrayPushGuideShow:tX,globalCommentTrayPushGuideType:tY,setCommentTrayPushGuideTypeFunc:t4,setIsCommentTrayPushGuideShowFunc:oe,onSearchTextClick:td,scene:tb});lR({isActive:lN,isUpperFeed:ox,modalAwemeInfo:oL,showSideCard:o9,isCommonCardShow:iB,isShowAiCard:n_,abtestData:tT,scene:tb}),(0,n.useImperativeHandle)(l,()=>({getPlayerRoot:()=>{var e,l;return null===(l=tV.current)||void 0===l?void 0:null===(e=l.getPlayerRoot)||void 0===e?void 0:e.call(l)},getPlayer:()=>ok,setIsAuthorCardShow:nA,setIsShowRelatedCard:nA,getCurTab:()=>iy,getCurrAweme:()=>ir,player:ok}),[lN,iy,ok,ir]);let{onCooperationAvatarClick:nQ,isInCooperation:nX,changeIsInCooperation:nY}=lF({curTab:iy,awemeInfo:ir,handleChangeVideo:e=>{ia({inComingAwemeInfo:e})},handleCooperationAvatarClick:e=>{var l;ox?(iT({tab:I.L.Author}),nA(!0,{from:"auto"}),ia({inComingAwemeInfo:e})):(ob.dispatch({modalAwemeInfo:e,nextAwemeInfo:null,prevAwemeInfo:null}),iT({tab:I.L.Author})),w.logInstance.sendLog("enterVideoCardTab",{from_group_id:e.awemeId,type:I.L.Author,enter_method:"click_co_author_head",enter_from:null!==(l=null==tL?void 0:tL.enter_from)&&void 0!==l?l:(0,V.mo)(),enter_from_merge:(0,V.vM)(),tab_name:(null==tL?void 0:tL.tab_name)||(0,q.zD)(),module_name:null==tL?void 0:tL.module_name})},reportParams:iR,isShowVideoCard:o9});(0,_.Z)(()=>{!oL&&lN&&(nY(!1),(tZ||tH)&&nA(!1,{from:"auto"}))},[null==oL?void 0:oL.awemeId]);let{isPermanentDislikeBtn:nJ,isDislikePanelVisible:n0,dislike:n1,revokeDislike:n2,disableShortCut:n3,isAdapterMiniHeightWithDislikeBtn:n7}=tl({awemeInfo:ir,scene:tb,deleteCurrentSwiper:lT,isModal:ox,videoToast:il,abtestData:tT,dislikeIdList:tQ,uuid:null===(eR=(0,O.Es)())||void 0===eR?void 0:eR.user_unique_id,player:ok}),n8=(0,n.useMemo)(()=>(null==tT?void 0:tT.slideOptimize)&&["discover","recommend"].includes((0,Z.yW)()),[tT]),n5=(0,n.useMemo)(()=>"waterFall"===l4&&(null==oL?void 0:oL.awemeId)?(0,r._)((0,o._)({},tL),{from_group_id:null==oL?void 0:oL.awemeId}):tL,[tL,null==oL?void 0:oL.awemeId,l4]),n6=(0,n.useMemo)(()=>{if(!(null==ta?void 0:ta.scene))return{};let{awemeId:e,desc:l}=ir,t={aladdin_words:l,list_item_id:e};return!(null==ta?void 0:ta.removeThirdItemId)&&(t.search_third_item_id=e),t},[null==ta?void 0:ta.scene,ir]),n4=(0,n.useMemo)(()=>{if(null==ta?void 0:ta.toggleButtonText)return null==ta?void 0:ta.toggleButtonText;switch(null==ta?void 0:ta.scene){case"mix":var e,l;if((null==ir?void 0:null===(e=ir.seriesInfo)||void 0===e?void 0:e.seriesId)&&!(null==ir?void 0:null===(l=ir.seriesInfo)||void 0===l?void 0:l.isSeries2Mix))return"短剧";return"合集";case"user":return"相关作品";default:return""}},[ta]),n9=!o9||tb===g.lT.Search&&!lN||iB,re=!iq||!lN||iB,{isTopLevelSidebar:rl,isTopLevelChapterSidebar:rt,isBottomLevelSidebar:ro,isBottomLevelChapterSidebar:ri}=tC({sidebarHidden:n9,chapterSidebarHidden:re,bottomLevelSidebar:oW,setBottomLevelSidebar:oU,topLevelSidebar:oO,setTopLevelSidebar:oZ});t7((0,o._)({key:"ad",isShow:i3,close:i2},iV)),t7((0,o._)({key:"shopDetail",isShow:nw,close:nI},iV)),t7((0,o._)({key:"aiNote",isShow:null==iY?void 0:iY.isShowAiCard,close:null==iY?void 0:iY.closeAiCard},iV)),t7((0,o._)({key:"videoDetail",isShow:nS,close:nk},iV)),t7((0,o._)({key:"activity",isShow:iU,close:iK},iV)),t7((0,o._)({key:"recommendWhiteTag",isShow:nt,close:ni},iV)),iD("chapter",{chapterSidebarHidden:re,close:()=>{iX(!1)}});let rn=(0,n.useMemo)(()=>({showSideCard:!n9,curTab:oK,setSideCard:nA,setCurTab:o$,handleRelated:i1}),[n9,oK,nA,o$,i1]),rr=(0,r._)((0,o._)({},n6,null==tL?void 0:tL.search_params,null==iR?void 0:iR.search_params),{item_rank:((null===(eF=o5.current)||void 0===eF?void 0:null===(eV=eF.getCurIndex)||void 0===eV?void 0:eV.call(eF))||0)+1});(0,n.useEffect)(()=>{(null==lV?void 0:lV.tab)===g.lT.Search&&(ir.searchLogParams=rr)},[rr]);let ra=ic&&[I.t.Mix,I.t.Series].includes(ik)?"author_":"",[rd,ru]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=m()(()=>{let e="recommend"===(0,Z.yW)()&&!1===ox;if(ox){ru(!1);return}if((null==tT?void 0:tT.videoCut)&&tj.current&&ir&&ir.video&&e){if(1e3*ir.createTime<=17304192e5&&!ir.pcBlockedAreaRatio)return;let e=tj.current.getBoundingClientRect(),{width:l}=e,t=e.height-48;if(l/t<ir.video.width/ir.video.height){let e=ir.pcBlockedAreaRatio,o=(1-ir.video.height/ir.video.width*l/t)/2;if(!e){ru(o<.05);return}if(e&&e.length<=5)return;let i=Math.min(null==e?void 0:e[6],100-(null==e?void 0:e[7]))-100*o>=1;ru(o<.05&&i)}if(l/t>ir.video.width/ir.video.height){let e=ir.pcBlockedAreaRatio,o=(1-ir.video.width/ir.video.height*t/l)/2;if(!e){ru(o<.05);return}if(e&&e.length<=5)return;let i=Math.min(100-(null==e?void 0:e[8]),null==e?void 0:e[9])-100*o>=1;ru(o<.05&&i)}}},0);e();let l=H.Z.bind(tj.current,e);return()=>{null==l||l()}},[ir,tT,ox]),!function(e){let{awemeInfo:l,curTab:t}=e,o=(0,n.useRef)(null);(0,n.useEffect)(()=>{l?o.current=function(e){var l;if(!(null===(l=window)||void 0===l?void 0:l.requestAnimationFrame))return tI;let{timeout:t=1e4}=e,o={fps:0,duration:0,scene:(0,Z.yW)(),jank:0,jank_duration:0,bjank:0,bjank_duration:0,tab:e.curTab},i=0,n=tw(),r=n,a=null,d=null;return!function e(){a=requestAnimationFrame(function(){i++;let l=tw(),t=l-r;r=l,t>tp&&(o.jank++,o.jank_duration+=t),t>tg&&(o.bjank++,o.bjank_duration+=t),e()})}(),d=setTimeout(()=>{a&&cancelAnimationFrame(a)},t),function(){a&&cancelAnimationFrame(a),d&&clearTimeout(d);let e=tw()-n;o.fps=Math.min(Math.round(1e3*i/e),60),o.duration=Math.round(e),th.sendLog("prf_slider_modal_video",o)}}({awemeInfo:l,curTab:t}):o.current=null},[l]),(0,n.useLayoutEffect)(()=>{let e=F.listen(F.EVENT.firstFrameReady,()=>{if(o.current){var e;null===(e=o.current)||void 0===e||e.call(o),o.current=null}});return()=>{e()}})}({awemeInfo:oL,curTab:iy});let rs=ox&&lN?"slideMode":"sliderVideo",rc=(0,n.useMemo)(()=>({playerScene:tb,globalCommentCount:ix,setGlobalCommentCount:iA,authorVideoCardClick:iL,modalEnterFrom:l4,player:ok,stopAutoPlay:iC}),[tb,ix,iA,iL,ok,l4,iC]),rv=!K._.isRenderOnActive(tT)||lN,rm=lN&&(null==ir?void 0:null===(ej=ir.chapterInfo)||void 0===ej?void 0:ej.status),rf=(e,l,t)=>{if(t&&!e.find(e=>e.awemeId===t.awemeId)){var o;e=e.concat(t);let l=null===(o=t.relatedRecommend)||void 0===o?void 0:o.popoverAwemeInfo;l&&!e.find(e=>e.awemeId===l.awemeId)&&(e=e.concat(l))}return l&&!e.find(e=>e.awemeId===l.awemeId)&&(e=[l,...e]),e},{playSwitchNextVideo:r_,playSwitchPrevVideo:rh}=t5({isUpperFeed:ox,playPrevFunc:lf,playNextFunc:lI,changePrevVideo:ii,changeNextVideo:io}),rp=(0,n.useMemo)(()=>(0,r._)((0,o._)({},iR,ir.logParams),{relation:String(n$),is_click_cover:Number(ox||lm!==ir),enter_from:`${ra}${ox?e$.Cu(ik):null==iR?void 0:iR.enter_from}`,search_params:rr}),[iR,ir,n$,ox,ik,rr,lm,ra]),rg=(0,n.useMemo)(()=>{var e,l,t;return(0,r._)((0,o._)({},l1),{notInterestingIcon:ox?!is&&(null==lm?void 0:lm.awemeId)===(null==ir?void 0:ir.awemeId):null===(e=null==l1?void 0:l1.notInterestingIcon)||void 0===e||e,unfollow:!ox||null===(l=null==l1?void 0:l1.unfollow)||void 0===l||l,report:!ox||null===(t=null==l1?void 0:l1.report)||void 0===t||t})},[l1,ox,is,lm,ir]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(X.v.Provider,{value:rc,children:(0,i.jsx)(eo.k,{componentName:"Container3",children:(0,i.jsxs)("div",{"data-e2e":lN?"feed-active-video":"feed-video","data-e2e-vid":null==ir?void 0:ir.awemeId,id:rs,className:s()(et.default.playerCommentWrapper,"isDark isDeepDark",`video_${ir.awemeId}`,rs,lU,{isMiniWindow:lZ,isMiniWindowOptimize:lZ&&oz,[et.default.isMiniWindowActive]:lN&&lZ,[et.default.flex]:!nV||!nj,[et.default.isFullScreen]:tZ,[et.default.inOutFeed]:!ox,[et.default.miniWidth]:o9,[et.default.adapterSeventh]:!nw,[et.default.shopCard]:nw,[et.default.adapterMiniHeight]:ox,[et.default.adapterMiniHeight495]:ox&&tb===g.lT.Recommend,[et.default.adapterMiniHeightWithDislikeBtn]:n7,[et.default.searchFit]:tb===g.lT.Search,relatedUiAdapter:!(tb===g.lT.Search&&!ox),[et.default.transparent]:(0,S.p)(ir)&&!ti,upperFeedClass:ox,[et.default.forFixedLayer]:l4===C.a.Im&&lN}),style:lH,ref:o8,children:[(0,i.jsxs)("div",{ref:tj,className:s()(et.default.playerContainer,"playerContainer",ee.z,{[et.default.isHavePlayer]:ir,[et.default.isSafari]:(0,$.G6)(),[et.default.showSideBar]:iB||o9||iq||n_}),children:[lM,(0,i.jsxs)("div",{className:s()(et.default.playerWrap,"slider-video",{[et.default.playerCutVideo]:rd,[et.default.isVertical]:(null==ir?void 0:null===(eD=ir.video)||void 0===eD?void 0:eD.height)>(null==ir?void 0:null===(eB=ir.video)||void 0===eB?void 0:eB.width),"controls-drag-disable":null==tT?void 0:null===(eW=tT.controls)||void 0===eW?void 0:eW.dragdisable,"controls-delay-hover":null==tT?void 0:null===(eU=tT.controls)||void 0===eU?void 0:eU.delayhover,"controls-add-space":null==tT?void 0:null===(eH=tT.controls)||void 0===eH?void 0:eH.addspace,"controls-hotzone":null==tT?void 0:null===(eY=tT.controls)||void 0===eY?void 0:eY.hotzone}),ref:e=>{lN?!tF.current&&!ox&&(tF.current=e,tK(tF)):tF.current=null},children:[tb===g.lT.Modal&&(0,z.DT)()&&!oL&&(0,i.jsx)("div",{className:et.default.electronDrag}),(null==ir?void 0:ir.debugInfo)&&(0,i.jsx)(es.W,{req:null==ir?void 0:null===(eJ=ir.debugInfo)||void 0===eJ?void 0:eJ.web_debug_req,video:null==ir?void 0:null===(e0=ir.debugInfo)||void 0===e0?void 0:e0.client_rec_debug_info,size:{height:null==ok?void 0:ok._videoHeight,width:null==ok?void 0:ok._videoWidth},gear:null==ir?void 0:null===(e3=ir.video)||void 0===e3?void 0:null===(e2=e3.bitRateList)||void 0===e2?void 0:null===(e1=e2[0])||void 0===e1?void 0:e1.gearName,showPanelRightside:!0}),(0,i.jsx)(eu.r,{children:(0,i.jsx)(lW,(0,r._)((0,o._)({ref:tV},e),{listenFeedNextAwemeInfo:im,listenFeedPrevAwemeInfo:i_,canShowListenVideo:oq,changeListenVideoFeedIndex:it,canUseListenFeed:oG,onPlayer:e=>{oT(e)},actionFollow:nH,actionUnFollow:nK,isClientMiniWin:lZ,userInfo:tD,dispatch:tB,awemeInfo:ir,nextAwemeInfo:iu,prevAwemeInfo:id,videoTags:nO,isInnerFeed:is,isOuterFeedSplash:(0,S.p)(lQ||lm),playNextFunc:io,playPrevFunc:ii,deleteCurrentSwiper:lT,toggleComment:e=>nx(e),onCooperationAuthorClick:nQ,isShowCooperation:!0,onAvatarClick:nB,avatarTipText:ox&&iy===I.L.Author?"退出作者主页":void 0,logParams:(null==tT?void 0:tT.innerSlideSmooth)?rp:(0,r._)((0,o._)({},iR,ir.logParams),{relation:String(n$),is_click_cover:Number(ox||lm!==ir),enter_from:`${ra}${ox?e$.Cu(ik):null==iR?void 0:iR.enter_from}`,search_params:rr}),videoToast:il,abtestData:tT,openSpecificTab:nR,abTestData:tT,isFullScreen:tZ,isAuthorCardShow:!1,slideListInsideFunc:lB,sideBarShow:o9,onRelatedClick:ip.includes(I.L.Related)||ig?nW:void 0,isShowRelatedCard:ox,isShowGuide:lO,showPlaySwitch:tH||tZ||!1,moreBoxShowList:(null==tT?void 0:tT.innerSlideSmooth)?rg:(0,r._)((0,o._)({},l1),{notInterestingIcon:ox?!is&&(null==lm?void 0:lm.awemeId)===(null==ir?void 0:ir.awemeId):null===(ld=null==l1?void 0:l1.notInterestingIcon)||void 0===ld||ld,unfollow:!ox||null===(lu=null==l1?void 0:l1.unfollow)||void 0===lu||lu,report:!ox||null===(ls=null==l1?void 0:l1.report)||void 0===ls||ls}),shortCutFiltered:(null==lm?void 0:lm.awemeId)!==(null==ir?void 0:ir.awemeId)||ox?[A.getShortcut().dislike.badgeText]:[],positionBoxClassName:{right:s()(et.default.posTransition,t8.m4,o9||iB||iq||n_?null:et.default.interactionPos,et.default.removeSlideRelatedButton)},isAdShortCut:!o9,isShowAdCard:i3,isShowVideoInfoSideCard:nS,isShowAiCard:n_,onActivityCardClick:(e,l)=>{iU?iK("anchor"):iH(e,l)},onDouPlusClick:e=>{iz.click(e)},onSodaClick:e=>{i$.click(e)},isShowShopSideCard:nw,onShopAnchorClick:()=>{nw?nI():(ng(),nE())},onShopAnchorMouseEnter:()=>{!nw&&nL({reqKey:null==nN?void 0:nN.promotion_id})},onShopAnchorMouseLeave:()=>{!nw&&nE()},defaultIsPageFullScreen:!tZ&&!!ox&&!tR||void 0,onDislike:n1,isPermanentDislikeBtn:nJ,disableShortCut:n3,isDislike:n0,splashAdStatus:tt,fullScreenTarget:null!=lb?lb:o8.current,horizontalToggleProps:{showHorizontalToggle:!!(null==ta?void 0:ta.scene)&&!(oD||o9||iB||n_),onClick:()=>{var e;oB(!0),w.logInstance.sendLog("enterVideoCardTab",{enter_from:"general_search",enter_from_merge:"general_search",enter_method:"click_card_entrance",type:(0,e7.V)(null==ta?void 0:ta.scene,ir,null==tL?void 0:null===(e=tL.search_params)||void 0===e?void 0:e.token_type)})},buttonText:n4,buttonClassName:"",scene:null==ta?void 0:ta.scene},enableAutoPlayPlugin:!!(null==ta?void 0:ta.scene)||ox,isUpperFeed:ox,sideCardContext:rn,searchListType:tu,disableFullScreenSearchBar:!1,chapterProps:{chapterProgress:iG,triggerChapterSliderShow:()=>{iF(["ad","shopDetail"]),iQ()}},aiNoteProps:{useable:nm||(null==iY?void 0:iY.isAiNoteUseable),isShow:n_},setContainerPlayer:n8?oT:null,recommendTagProps:{userList:i6,recommendTagType:i8,onClickGuideTag:i5,onClickWhiteTag:no,shouldShowFollowRecBtn:i4,recommended:i9,guideTagTriggerSource:ne,recommendTriggerSource:nl,isShowVideoInfoSideCard:nS||!n9&&iy===I.L.VideoDetail&&o9},children:!(tv||n8)&&(0,i.jsx)(eS,{onPlayer:oT})}))}),(0,i.jsx)("div",{}),(0,i.jsx)(ed.R,{player:ok,isActive:lN,modalEnterFrom:l4,abtestData:tT}),(0,i.jsx)("div",{}),!!(tx&&(l4===C.a.UserPost||ox))&&(0,i.jsx)(t0.I,{playPrevFunc:rh,playNextFunc:r_,disablePrev:ox&&!id||!ox&&tn,disableNext:ox&&!iu||!ox&&lj,className:et.default.playSwitch})]})]}),i3&&(0,i.jsx)("div",{id:"videoSideBar",className:s()(et.default.sideBar,et.default.sideBarDefaultWidth,"isDark","dark",{[et.default.displayNone]:lZ}),onWheel:e=>e.stopPropagation(),children:(0,i.jsx)(ou,{awemeInfo:ir,onClose:()=>{i2({from:"closeIcon"})},userInfo:tD})}),na&&!(tb===g.lT.Search&&!ox)&&(0,i.jsxs)("div",{id:"hideInMiniWindow",className:s()(et.default.sideBar,et.default.sideBarDefaultWidth,"isDark","dark",{[et.default.displayNone]:lZ,[et.default.sideBarHidden]:!nr||o9||iq||iB}),onWheel:e=>e.stopPropagation(),ref:o3,children:[!nj&&nr&&(0,i.jsx)(eC.gb,{className:et.default.loading}),nj?(0,i.jsx)("div",{className:s()(et.default.sideBarInnerWrapper,et.default.relatedVertical,{[et.default.sideBarInnerHidden]:!nr}),children:(0,i.jsx)(eo.k,{componentName:P.y.AiCard,children:(0,i.jsx)(os,{isShow:nr,isAiNoteUseable:nm,activeAiCardTab:nd,setActiveAiCardTab:nu,setAiNoteEnterMethod:ns,awemeInfo:ir,usePin:op,abTestData:tT,player:ok,onClose:()=>{nn(),oh.includes(nc.entryFrom)&&nA(!0),W.Le.setConfig(W.gI.PlayerCardInfo,null)},userInfo:tD,aiSearchProps:(0,r._)((0,o._)({},nc),{userDispatch:tB,userInfo:tD,onOpenModalVideo:iN}),aiNoteProps:nv,fullScreenTarget:null!=lb?lb:o8.current,aiCardIsPined:oo,togglePinAiCard:oi})})}):null]}),(null==iY?void 0:iY.renderAiCard)&&!(tb===g.lT.Search&&!ox)&&(0,i.jsx)("div",{id:"hideInMiniWindow",className:s()(et.default.sideBar,et.default.sideBarDefaultWidth,"isDark","dark",{[et.default.displayNone]:lZ||!(null==iY?void 0:iY.isShowAiCard)}),onWheel:e=>e.stopPropagation(),ref:o3,children:(0,i.jsx)(eo.k,{componentName:P.y.AiCard,children:(0,i.jsx)(oc,{isShow:null==iY?void 0:iY.isShowAiCard,awemeInfo:ir,abTestData:tT,player:ok,onClose:()=>{null==iY||iY.closeAiCard()},userInfo:tD,aiNoteProps:null==iY?void 0:iY.aiNoteProps,fullScreenTarget:null!=lb?lb:o8.current},null==ir?void 0:ir.awemeId)})}),(null==i0?void 0:i0.renderAiCard)&&!(tb===g.lT.Search&&!ox)&&(0,i.jsxs)("div",{id:"hideInMiniWindow",className:s()(et.default.sideBar,et.default.sideBarDefaultWidth,"isDark","dark",{[et.default.displayNone]:lZ,[et.default.sideBarHidden]:!(null==i0?void 0:i0.isShowAiCard)||o9||iq||iB}),onWheel:e=>e.stopPropagation(),ref:o3,children:[!nj&&(null==i0?void 0:i0.isShowAiCard)&&(0,i.jsx)(eC.gb,{className:et.default.loading}),nj?(0,i.jsx)("div",{className:s()(et.default.sideBarInnerWrapper,et.default.relatedVertical,{[et.default.sideBarInnerHidden]:!(null==i0?void 0:i0.isShowAiCard)}),children:(0,i.jsx)(eo.k,{componentName:P.y.AiCard,children:(0,i.jsx)(ov,{isShow:null==i0?void 0:i0.isShowAiCard,awemeInfo:ir,usePin:op,abTestData:tT,player:ok,onClose:()=>{var e,l;null==i0||null===(e=i0.closeAiCard)||void 0===e||e.call(i0),oh.includes(null==i0?void 0:null===(l=i0.aiSearchProps)||void 0===l?void 0:l.entryFrom)&&nA(!0),W.Le.setConfig(W.gI.PlayerCardInfo,null)},userInfo:tD,aiSearchProps:(0,r._)((0,o._)({},null==i0?void 0:i0.aiSearchProps),{userDispatch:tB,userInfo:tD,onOpenModalVideo:iN}),fullScreenTarget:null!=lb?lb:o8.current,aiCardIsPined:oo,togglePinAiCard:oi})})}):null]}),iU&&(0,i.jsx)("div",{id:"videoSideCard",className:s()(et.default.sideBar,et.default.sideBarDefaultWidth,"isDark","dark",{[et.default.displayNone]:lZ}),onWheel:e=>e.stopPropagation(),ref:e=>{(0,$.G6)()&&e&&!e.onwheel&&(e.onwheel=e=>{e.stopPropagation()})},children:(0,i.jsx)(eo.k,{componentName:"ActivityCard",fallback:(0,i.jsx)(eC.gb,{className:s()(et.default.loading,et.default.absolute)}),children:(0,i.jsx)(od,{isLogin:tW,awemeInfo:ir,activityName:iO,anchorData:iZ,closeCard:iK,userInfo:tD,userDispatch:tB,activityCardDirectOpen:tS})})}),(0,i.jsx)(ea,{abtestData:tT,isClientMiniWin:lZ,isWebMiniWin:tx,awemeInfo:ir,userInfo:tD,isActive:lN,player:ok,sodaCtr:i$,douPlusCtr:iz}),nt&&(0,i.jsx)("div",{id:"videoSideBar",className:s()(et.default.sideBar,et.default.sideBarDefaultWidth,"isDark","dark",et.default.videoInfoSideBar,{[et.default.displayNone]:lZ}),onWheel:e=>e.stopPropagation(),children:(0,i.jsx)(t$,{player:ok,awemeInfo:ir,onClose:ni,userList:i6,userInfo:tD})}),nw&&(0,i.jsx)("div",{id:"videoSideBar",className:s()(et.default.sideBarDefaultWidth,et.default.shopSidebar,"isDark",{[et.default.displayNone]:lZ}),onWheel:e=>e.stopPropagation(),children:(0,i.jsx)(eo.k,{componentName:P.y.ShopDetailSideCard,children:(0,i.jsx)(oa,{isFirstLoad:nC,awemeInfo:ir,onClose:nI,userInfo:tD,abtestData:tT,isAutoOpen:ny})})}),!!(null==ta?void 0:ta.scene)&&(0,i.jsx)(om,(0,o._)({className:s()({[et.default.displayNone]:!oD||o9||iB||n_||nz}),currentPlayingAwemeInfo:ir,onClose:()=>oB(!1),onItemClick:e=>{var l;let{inComingAwemeInfo:t,index:o}=e;ia({inComingAwemeInfo:t}),null==ta||null===(l=ta.onSideCardClick)||void 0===l||l.call(ta,{inComingAwemeInfo:t,index:o})},updateNextAwemeInfo:e=>ob.dispatch("nextAwemeInfo",e),isActive:lN,showSearchSideCard:oD,setShowSearchSideCard:oB,ref:o5,stopAutoPlay:iC,logParams:(0,r._)((0,o._)({},tL),{search_params:rr}),isUpperFeed:ox,listReplay:!0},ta)),rv&&(0,i.jsxs)("div",{id:"videoSideCard",className:s()(et.default.sideBar,et.default.sideBarDefaultWidth,"isDark",{[et.default.sideBarHidden]:n9,[et.default.force300pxWidth]:tb===g.lT.Search&&!ox&&!n9,[et.default.displayNone]:lZ,[et.default.sideBarInBottomLayer]:ro,[et.default.sideBarInUnderLayer]:rt,[et.default.sideBarInTopLayer]:rl,[et.default.addDetailTabSideBar]:(null==tT?void 0:tT.aiNoteV2)===2}),style:{position:ri?"absolute":void 0},onWheel:e=>e.stopPropagation(),ref:o2,children:[K._.isHideSiderLoading(tT)?null:!nV&&o9&&(0,i.jsx)(eC.gb,{}),nV&&(0,i.jsx)("div",{id:"relatedVideoCard",className:s()(et.default.sideBarInnerWrapper,et.default.relatedVertical,{[et.default.sideBarInnerHidden]:!o9,[et.default.inFullScreen]:tH||tZ,LookModalFrameFast:(null===(e8=(0,G.fV)())||void 0===e8?void 0:e8.os)==="Windows"}),children:(0,i.jsx)(f.SV,{children:(0,i.jsx)(or,{isRender:iM,ref:o6,collapse:!1,scene:g.lT.Recommend,isShow:o9,awemeInfo:ir,lastVideoFeedAweme:ib,originFeedAwemeInfo:lm,enterFromPrefix:ra,handleClose:()=>{nA(!1),W.Le.setConfig(W.gI.PlayerCardInfo,null),w.logInstance.sendLog("closeVideoCard",{type:iy,enter_from_merge:(0,V.vM)(),enter_method:"click_x"})},isActive:lN,customProps:lV,logParams:iR,abtestData:tT,userContext:tN,isShowCloseBtn:!0,handleRelatedVideoChange:iE,tab:iy,videoFeed:ik,showTabList:tb!==g.lT.Search||ox?ip:[I.L.Comment],relatedAuthorConfig:nG,relatedCommentConfig:nq,defaultHotData:nM,hotDefaultList:l$,mixDefault:lz,seriesDefault:lG,relatedDefault:rf(lq||[],lQ||lm,oL),onTabChange:e=>{iT({tab:e})},isUpperFeed:ox,isObscuredByOtherCard:iB||n_||!!oL,isRenderAiNoteCard:iJ})})})]}),rm&&(0,i.jsx)("div",{id:"chapterVideoSideCard",className:s()(et.default.sideBar,et.default.sideBarDefaultWidth,et.default.chapterSideBar,"isDark",{[et.default.sideBarHidden]:re,[et.default.displayNone]:lZ,[et.default.sideBarInBottomLayer]:ri,[et.default.sideBarInUnderLayer]:rl,[et.default.chapterSideBarInTopLayer]:rt}),ref:o7,children:(0,i.jsx)("div",{id:"chapterVideoCard",className:s()(et.default.sideBarInnerWrapper,et.default.relatedVertical,{LookModalFrameFast:(null===(e5=(0,G.fV)())||void 0===e5?void 0:e5.os)==="Windows"}),children:(0,i.jsx)(f.SV,{children:(0,i.jsx)(o_,{isShow:!re,awemeInfo:ir,chapterProgress:iG,onClose:()=>{iQ()},player:ok,selfUid:null==tD?void 0:null===(le=tD.info)||void 0===le?void 0:le.uid})})})}),(0,i.jsx)("div",{id:"videoSideBar",className:s()(et.default.sideBar,et.default.sideBarDefaultWidth,"isDark","dark",et.default.videoInfoSideBar,{[et.default.videoInfoSideBarHidden]:!nS,[et.default.search]:tb===g.lT.Search}),children:nS&&(0,i.jsx)(of,{awemeInfo:ir,isTopicLinkSearchResult:!0,abtestData:tT,onClose:()=>{nk(),nA(!1)}})}),ih&&(0,i.jsx)(tf.T3,{awemeInfo:ir,elementtiming:"lcp_ele",maskClassName:s()({[et.default.maskBackgroundHidden]:(0,S.p)(ir)&&!ti}),fetchPriority:tn?"auto":void 0,abtestData:tT,priorityServerBackupBg:!1}),n0&&!lZ&&(0,i.jsx)(l8,{onRevokeDislike:n2,isActive:lN}),tr&&!lZ&&(0,i.jsx)(l5.z,{isActive:lN,awemeInfo:ir,player:ok,abtestData:tT})]})})}),is&&!tR&&!lZ&&(0,i.jsx)(tm,{userInfo:tD,awemeInfo:ir,abtestData:tT,fullScreenTarget:null!=lb?lb:o8.current}),oL&&!ox&&lN&&((null==oP?void 0:oP.current)===oA||(null==oP?void 0:oP.current)===(null==oR?void 0:oR.current))&&(0,i.jsx)(lJ,(0,r._)((0,o._)((0,r._)((0,o._)({},e),{isDyPlayer:!1,InnerPlayer:t_&&tv?t_:lW}),{abtestData:tT,logParams:n5,customProps:(0,r._)((0,o._)({},e.customProps),{logParams:n5}),close:tM,getCurrentTime:()=>oL.awemeId===lm.awemeId?null==ok?void 0:ok.currentTime:null,clickedCard:nX?I.L.Author:iy,hotDefaultList:iy===I.L.Hot?null==o6?void 0:null===(ll=o6.current)||void 0===ll?void 0:ll.getHotDefaultList():null,mixDefault:iy===I.L.Mix?null==o6?void 0:null===(lt=o6.current)||void 0===lt?void 0:lt.getMixDefaultParam():null,seriesDefault:iy===I.L.Series?null==o6?void 0:null===(ln=o6.current)||void 0===ln?void 0:ln.getSeriesDefaultParam():null,relatedDefault:iy===I.L.Related?rf((null==o6?void 0:null===(lr=o6.current)||void 0===lr?void 0:lr.getRelatedDefaultList())||[],ir,oL):null,currentAwemeInfo:oL,isActive:!0,isEnterByCssFullScreen:tH,isEnterByFullScreen:tZ,changeSplashAdStatus:to,fullScreenTarget:null!=lb?lb:o8.current}),{isClientMiniWin:lZ,hasPlaceholder:!0,relatedSmooth:tR}))]})});var og=t("90519"),ow=(0,n.forwardRef)((e,l)=>{let{customProps:t,modalEnterFrom:r}=e,{tab:a}=t||{},d=(0,n.useRef)(null);return(0,n.useImperativeHandle)(l,()=>{var e,l;return{getPlayerRoot:()=>{var e,l;return null==d?void 0:null===(l=d.current)||void 0===l?void 0:null===(e=l.getPlayerRoot)||void 0===e?void 0:e.call(l)},getPlayer:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.player},setIsAuthorCardShow:null===(e=d.current)||void 0===e?void 0:e.setIsAuthorCardShow,setIsShowRelatedCard:null===(l=d.current)||void 0===l?void 0:l.setIsShowRelatedCard,setTab:e=>{var l,t;null===(t=d.current)||void 0===t||null===(l=t.setTab)||void 0===l||l.call(t,e)},getCurTab:()=>{var e,l;return null===(l=d.current)||void 0===l?void 0:null===(e=l.getCurTab)||void 0===e?void 0:e.call(l)},getCurrAweme:()=>{var e,l;return null===(l=d.current)||void 0===l?void 0:null===(e=l.getCurrAweme)||void 0===e?void 0:e.call(l)}}},[d.current]),(0,og.s)(!0),(0,i.jsx)(op,(0,o._)({ref:d},e))})},87733:function(e,l,t){t.d(l,{g:function(){return o}}),t(338172),t(826893),t(311137),t(284961);let o=e=>{var l,t,o,i,n,r,a,d,u,s,c,v,m,f;let _=null!==(d=null==e?void 0:null===(l=e.hotList)||void 0===l?void 0:l.schema)&&void 0!==d?d:"",h=NaN,p="";return _&&(h=_.startsWith("aweme://")?Number(/\"board_type\":([\w|_]*)&/.exec(_)):Number(null===(u=/board_type=([\w|_]*)&/.exec(_))||void 0===u?void 0:u[1]),p=null!==(f=_.startsWith("aweme://")?null===(v=/\"board_sub_type\":([\w|_\"]*)\,/.exec(_))||void 0===v?void 0:null===(c=v[1])||void 0===c?void 0:null===(s=c.replaceAll)||void 0===s?void 0:s.call(c,'"',""):null===(m=/board_sub_type=([\w|_]*)&/.exec(_))||void 0===m?void 0:m[1])&&void 0!==f?f:""),{boardType:h,boardSubType:p,sentence:(null==e?void 0:null===(t=e.hotList)||void 0===t?void 0:t.sentence)||"",sentenceId:(null==e?void 0:null===(o=e.hotList)||void 0===o?void 0:o.sentenceId)||"",footer:null==e?void 0:null===(i=e.hotList)||void 0===i?void 0:i.footer,rank:null==e?void 0:null===(n=e.hotList)||void 0===n?void 0:n.rank,type:null==e?void 0:null===(r=e.hotList)||void 0===r?void 0:r.type,hotName:null==e?void 0:null===(a=e.hotList)||void 0===a?void 0:a.header}}},56733:function(e,l,t){t.d(l,{V:function(){return o}}),t(250440);let o=(e,l,t)=>{if(["douyin_dcd_model","douyin_disease","xiaohe_disease","baikemy_disease","medicines_baikemy"].includes(t)||!e)return"search_related_card";switch(e){case"user":return"author_card";case"mix":var o;return(null==l?void 0:null===(o=l.seriesInfo)||void 0===o?void 0:o.seriesId)?"playlet_card":"compilation_card";case"hot":return"hot_card";default:return"general_search"}}},249877:function(e,l,t){t.d(l,{j:function(){return o}});var o={Success:0,0:"Success",LocateError:3002056,3002056:"LocateError"}},958829:function(e,l,t){t.d(l,{Q:function(){return d},i:function(){return a}});var o=t(520739),i=t(878389),n=t(16583);let r=(0,i._)((0,o._)({},n.xM),{chat_notif_show:{eventName:"chat_notif_show",params:{}},uc_login_notify:{eventName:"uc_login_notify",params:{}},uc_login_submit:{eventName:"uc_login_submit",params:{}},uc_login_result:{eventName:"uc_login_result",params:{}},chat_cell_show:{eventName:"chat_cell_show",params:{}},chat_cell_click:{eventName:"chat_cell_click",params:{}},enter_chat:{eventName:"enter_chat",params:{}},click_enter_chat_page:{eventName:"click_enter_chat_page",params:{}},chat_setting_show:{eventName:"chat_setting_show",params:{}},chat_setting_click:{eventName:"chat_setting_click",params:{}},chat_block_popup_show:{eventName:"chat_block_popup_show",params:{}},chat_block_popup_click:{eventName:"chat_block_popup_click",params:{}},send_message:{eventName:"send_message",params:{}},send_message_response:{eventName:"send_message_response",params:{}},follow:{eventName:"follow",params:{}},follow_cancel:{eventName:"follow_cancel",params:{}},emoji_tab_show:{eventName:"emoji_tab_show",params:{}},at_panel_show:{eventName:"at_panel_show",params:{}},send_at_message:{eventName:"send_at_message",params:{}},send_at_message_response:{eventName:"send_at_message_response",params:{}},message_function_show:{eventName:"message_function_show",params:{}},pc_im_story_image_load:{eventName:"pc_im_story_image_load",params:{loadDuration:0}},im_sdk_init_time:{eventName:"im_sdk_init_time",params:{}},message_function_click:{eventName:"message_function_click",params:{}},like_message:{eventName:"like_message",params:{}},forward_message:{eventName:"forward_message",params:{}},quote_message:{eventName:"quote_message",params:{}},recall_message:{eventName:"recall_message",params:{}},delete_message:{eventName:"delete_message",params:{}},unsupported_message_show:{eventName:"unsupported_message_show",params:{}},video_cover_show:{eventName:"video_cover_show",params:{}},video_cover_click:{eventName:"video_cover_click",params:{}},click_comment_button:{eventName:"click_comment_button",params:{}},share_menu_show:{eventName:"share_menu_show",params:{}},share_video_click_head:{eventName:"share_video_click_head",params:{}},share_video_click_more_friend:{eventName:"share_video_click_more_friend",params:{}},share_video:{eventName:"share_video",params:{}},share_user:{eventName:"share_user",params:{}},share_comment:{eventName:"share_comment",params:{}},share_search:{eventName:"share_search",params:{enter_from:"others_homepage"}},click_send_message:{eventName:"click_send_message",params:{}},im_push_show:{eventName:"im_push_show",params:{}},im_push_click:{eventName:"im_push_click",params:{}},im_push_close:{eventName:"im_push_close",params:{}},new_im_show:{eventName:"new_im_show",params:{}},share_video_click_more_group:{eventName:"share_video_click_more_group",params:{}},unknown_notif_show:{eventName:"unknown_notif_show",params:{}},unknown_notif_click:{eventName:"unknown_notif_click",params:{}},unknown_notif_hover:{eventName:"unknown_notif_hover",params:{}},unknown_notif_delete:{eventName:"unknown_notif_delete",params:{}},unknown_cell_show:{eventName:"unknown_cell_show",params:{}},chat_cell_click_all:{eventName:"chat_cell_click_all",params:{}},click_author_head:{eventName:"click_author_head",params:{click_from:"im",is_full_webscreen:"0",clarity:""}},click_fold_im:{eventName:"click_fold_im",params:{}},click_exit_chat:{eventName:"click_exit_chat",params:{}},imsdk_debug_read_index_greater:{eventName:"imsdk_debug_read_index_greater",params:{}},pc_im_upload_btn_click:{eventName:"pc_im_upload_btn_click",params:{confirmStatus:"1",isGroup:"0"}},im_customer_group_notify:{eventName:"im_customer_group_notify",params:{}},im_customer_notify:{eventName:"im_customer_notify",params:{}},im_customer_click:{eventName:"im_customer_click",params:{action:"1"}},livesdk_share_success:{eventName:"livesdk_share_success",params:{share_from:"",share_type:"message",user_id:"",anchor_id:"",room_id:"",enter_from_merge:"",enter_method:"",action_type:"",request_id:""}},send_link:{eventName:"send_link",params:{enter_from:"",chat_type:"private",conversation_id:"",to_user_id:"",link_type:""}},soraka_sli_report:{eventName:"soraka_sli_report",params:{}},pc_im_show:{eventName:"pc_im_show",params:{status:"",is_show_chat_room:!1,is_fold_chat_list:!1,unread_count:0}},pc_im_chat_detail_show:{eventName:"pc_im_chat_detail_show",params:{conversation_id:"",conversation_short_id:"",chat_type:"private"}},pc_im_click:{eventName:"pc_im_click",params:{click_type:"",module_type:""}},pc_im_conversation_detail_stay_time:{eventName:"pc_im_conversation_detail_stay_time",params:{duration:-1,chat_type:"private"}},pc_im_message_show:{eventName:"pc_im_message_show",params:{message_type:"",message_id:"",chat_type:"private",aweme_type:"",card_type:"",card_key:"",to_user_id:"",from_user_id:""}},pc_im_message_click:{eventName:"pc_im_message_click",params:{message_id:"",message_type:"",chat_type:"private",aweme_type:"",card_type:"",card_key:"",to_user_id:"",from_user_id:"",click_type:"click"}},pc_im_message_click_download:{eventName:"pc_im_message_click_download",params:{message_id:"",message_type:"",chat_type:"private",aweme_type:"",card_type:"",card_key:"",to_user_id:"",from_user_id:"",click_type:"click"}},pc_interaction_click:{eventName:"pc_interaction_click",params:{message_id:"",message_type:"",chat_type:"private",aweme_type:"",card_type:"",card_key:"",click_type:""}},pc_im_conversation_list_fps:{eventName:"pc_im_conversation_list_fps",params:{fps:-1,drop_fps:-1}},pc_im_message_list_fps:{eventName:"pc_im_message_list_fps",params:{fps:-1,drop_fps:-1}},pc_im_notice_list_fps:{eventName:"pc_im_notice_list_fps",params:{fps:-1,drop_fps:-1}},pc_im_window_show_perf:{eventName:"pc_im_window_show_perf",params:{duration_fmp:"",duration_fcp:""}},pc_im_conversation_detail_perf:{eventName:"pc_im_conversation_detail_perf",params:{duration_fmp:"",duration_fcp:""}},pc_im_message_perf:{eventName:"pc_im_message_perf",params:{duration_fmp:""}},pc_im_location_click:{eventName:"pc_im_location_click",params:{conversation_id:"",message_id:"",showImNewMeessage:""}},pc_im_voice_to_text_click:{eventName:"pc_im_voice_to_text_click",params:{isCancel:""}},im_image_zoom:{eventName:"im_image_zoom",params:{}},pc_share_fps:{eventName:"pc_share_fps",params:{fps:-1,drop_fps:-1}},pc_share_render:{eventName:"pc_share_render",params:{duration:-1,listNum:-1}},pc_share_search:{eventName:"pc_share_search",params:{searchNum:-1}},pc_share_stay_time:{eventName:"pc_share_stay_time",params:{duration:-1}},pc_im_entry_show:{eventName:"pc_im_entry_show",params:{duration:-2,ready_type:""}},im_login_notify:{eventName:"im_login_notify",params:{}},pc_im_stay_time:{eventName:"pc_im_stay_time",params:{duration:-1,close_type:"hover"}},chat_notif_hover:{eventName:"chat_notif_hover",params:{}},chat_detach_btn_show:{eventName:"chat_detach_btn_show",params:{}},chat_detach_btn_click:{eventName:"chat_detach_btn_click",params:{}},open_im_new_page:{eventName:"open_im_new_page",params:{}}});n.iL._initLog(r);let a=n.iL;var d={chat_page:"chat_page",chat_panel:"chat_panel",share_board:"share_board",share_message:"share_message",chat_notif:"chat_notif",push:"push",client_push:"client_push",hover_icon:"hover_icon",im_private:"im_private",recommend_side_card:"recommend_side_card"}},16583:function(e,l,t){t.d(l,{OZ:function(){return m},Os:function(){return v},iL:function(){return s},xM:function(){return u},yW:function(){return c}});var o,i,n=t(520739);t(338172),t(250440);var r=t(544933),a=t(658065),d=t(32167);let u={pc_im_entry_show:{eventName:"pc_im_entry_show",params:{duration:-2,ready_type:""}},im_login_notify:{eventName:"im_login_notify",params:{}},pc_im_stay_time:{eventName:"pc_im_stay_time",params:{duration:-1,close_type:"hover"}},chat_notif_hover:{eventName:"chat_notif_hover",params:{}},pc_im_click:{eventName:"pc_im_click",params:{click_type:"",module_type:""}},other_share:{eventName:"other_share",params:{}},chat_vmok_perf:{eventName:"chat_vmok_perf",params:{duration_vmok_load:-1}},chat_entry_perf:{eventName:"chat_entry_perf",params:{duration_im_before_load:-1}}},s=new r.h(u),c=()=>(0,a.yW)(),v=()=>(0,d.vM)();let m=(null===(o=self.location.hostname)||void 0===o?void 0:o.startsWith("live.douyin.com"))?"live":(null===(i=self.location.pathname)||void 0===i?void 0:i.includes("/search/"))?"search":"douyin";l.ZP=(e,l)=>{try{s.sendLog(e,(0,n._)({page_host:m,enter_from:c(),previous_page:v()},l||{}))}catch(e){}}},347812:function(e,l,t){t.d(l,{w:function(){return r}});var o=t(637005),i=t(860684),n=t(631493);function r(){let{clickMethod:e=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,i.n)();return()=>{var t;null==l||null===(t=l.exitFullscreen)||void 0===t||t.call(l),o.emit(o.EVENT.triggerModalPlayerClose,{}),n.s.setPageFullscreen({playerId:l.playerId,isPageFullscreen:!1}),o.emit(o.EVENT.pageFullScreen,{clickMethod:e,fullScreen:!1,playerId:l.playerId})}}},189070:function(e,l,t){t.d(l,{BJ:function(){return s},kO:function(){return d},nA:function(){return u}});var o=t(520739),i=t(878389);t(874386);var n=t(88648),r=t(746864),a=t(637005);let d=e=>{let{isActive:l,timeout:t=2e3,useIdleCallback:o=!1,immediately:i=!1,callback:r}=e,d=(0,n.useRef)();d.current=r,(0,n.useEffect)(()=>{if(i){var e;return null===(e=d.current)||void 0===e?void 0:e.call(d)}},[i]),(0,n.useEffect)(()=>{if(!i&&o&&l){var e,t;let l;let o=0,i=setTimeout(()=>{var e,t,i;l=null===(e=d.current)||void 0===e?void 0:e.call(d),null===(t=(i=window).cancelIdleCallback)||void 0===t||t.call(i,o)},200);return o=null===(e=(t=window).requestIdleCallback)||void 0===e?void 0:e.call(t,()=>{var e;l=null===(e=d.current)||void 0===e?void 0:e.call(d),clearTimeout(i)}),()=>{var e,t;clearTimeout(i),null===(e=(t=window).cancelIdleCallback)||void 0===e||e.call(t,o),null==l||l()}}},[i,o,l]),(0,n.useLayoutEffect)(()=>{let e;if(i||o||!l)return;let n=setTimeout(()=>{var l;null==r||r(),e=null===(l=d.current)||void 0===l?void 0:l.call(d)},t),r=a.listen(a.EVENT.firstFrameReady,()=>{var l;e=null===(l=d.current)||void 0===l?void 0:l.call(d),clearTimeout(n)});return()=>{r(),null==e||e(),clearTimeout(n)}},[l,i,t,o])},u=e=>{let{awemeInfo:l,once:t=!1,immediately:a,normalDelay:u=!0}=e,[s,c]=(0,n.useState)(()=>!!a||l.awemeType!==r.e.Normal&&!!u||!1);return d((0,i._)((0,o._)({},e),{callback:()=>(c(!0),()=>{!t&&c(!1)})})),{isShow:s}},s=e=>{let{immediately:l,once:t,delay:r}=e,[a,u]=(0,n.useState)(l);return d((0,i._)((0,o._)({},e),{callback:()=>{let e;return!l&&r?e=setTimeout(()=>{u(!0)},r):u(!0),()=>{e&&clearTimeout(e),!l&&!t&&u(!1)}}})),{isShow:a}}},185026:function(e,l,t){t.d(l,{_:function(){return d}});var o=t(88648),i=t(35730),n=t(637005),r=t(782442),a=t(555106);let d=e=>{let{prevAwemeInfo:l,awemeInfo:t,isInnerFeedModel:d}=e,u=(0,o.useRef)(t);(0,o.useEffect)(()=>{u.current=t},[t]),(0,o.useEffect)(()=>{let e=null==n?void 0:n.listen(null==n?void 0:n.EVENT.quitInnerFeed,e=>{e&&r.Le.setConfig(r.gI.PreAwemeId,"")});return()=>e()},[]),(0,o.useEffect)(()=>{let e=(0,a.$o)(i.LocalStorageKeys.HasUseFlashBack),t=(0,a.$o)(i.LocalStorageKeys.ShowFlashBackTipNum)||0;if(d&&!e&&t<3){var o;let e=r.Le.getConfig(r.gI.PreAwemeId);e&&e===(null===(o=u.current)||void 0===o?void 0:o.awemeId)?n.emit(n.EVENT.showFlashbackTip,!0):n.emit(n.EVENT.showFlashbackTip,!1),(null==l?void 0:l.awemeId)&&r.Le.setConfig(r.gI.PreAwemeId,null==l?void 0:l.awemeId)}},[l,d])}},918484:function(e,l,t){t.d(l,{Kw:function(){return i},cL:function(){return n},tU:function(){return o}});var o={Photo:"photo",Name:"name",Blank:"blank",Sow:"sow",Pull:"pull",Button:"button",Source:"source",Feed:"feed",Title:"title",Card:"card",SupportArea:"support_area",SupportAreaCard:"support_area_card"},i={AdProduct:"product",AdBackupProduct:"backup_product",AdAnchor:"anchor"},n={HIDDEN:-1,"-1":"HIDDEN",MINI_DARK:0,0:"MINI_DARK",MINI_LIGHT:1,1:"MINI_LIGHT",NORMAL_LIGHT:2,2:"NORMAL_LIGHT"}},667519:function(e,l,t){t.d(l,{f:function(){return o}});let o={playNextInterceptor:function(){let{needShowQuestion:e,setNeedShowQuestion:l,isShowingQuestion:t,setIsShowingQuestion:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{needShowQuestion:!1,setNeedShowQuestion:()=>{},isShowingQuestion:!1,setIsShowingQuestion:()=>{}};return t?(null==l||l(!1),null==o||o(!1),!1):!!e&&(null==o||o(!0),!0)},playPrevInterceptor:function(){let{needShowQuestion:e,setNeedShowQuestion:l,isShowingQuestion:t,setIsShowingQuestion:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{needShowQuestion:!1,setNeedShowQuestion:()=>{},isShowingQuestion:!1,setIsShowingQuestion:()=>{}};return!!t&&(null==l||l(!1),null==o||o(!1),!0)}}},114981:function(e,l,t){t.d(l,{L:function(){return i}}),t(675373),t(874386);var o=t(255686);let i=e=>{let{promotionId:l,originType:t,secAuthorId:i,roomId:n,itemId:r}=e;return Promise.all([(0,o.y3)({promotionId:l,originType:t,secAuthorId:i,roomId:n,itemId:r}),(0,o.$P)({promotionId:l,originType:t})])}},767927:function(e,l,t){t.d(l,{t:function(){return n}});var o=t(88648),i=t(870105);function n(e){let l=(0,i.U)(),t=(0,o.useRef)(!0),n=(0,o.useRef)(e);n.current=e,(0,o.useEffect)(()=>{var e;if("function"!=typeof n.current||!l)return;let o=t.current;return t.current=!1,null===(e=n.current)||void 0===e?void 0:e.call(n,o)},[l])}},235248:function(e,l,t){t.d(l,{t:function(){return n}});var o=t(88648),i=t(244885);let n=()=>{var e;let{ref:l}=null!==(e=(0,o.useContext)(i.I))&&void 0!==e?e:{};return l?l:null}},474932:function(e,l,t){t.d(l,{m:function(){return d},w:function(){return a}});var o=t(520739);t(675373);var i=t(496349),n=t(231755);let{COMMON_SEARCH_PARAMS:r}=i||{};async function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",l=await (0,n.v_)("/aweme/v1/web/commit/dislike/item/",(0,o._)({aweme_id:e},r),{aweme_id:e}),t=l.status_code;return{statusCode:t,errMsg:0===t||l.status_msg?l.status_msg:"啊哦，服务器打瞌睡了"}}async function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",l=await (0,n.v_)("/aweme/v1/web/dislike/dimension/update/",(0,o._)({aweme_id:e,block_type:2},r),{aweme_id:e}),t=l.status_code;return{statusCode:t,errMsg:0===t||l.status_msg?l.status_msg:"啊哦，服务器打瞌睡了"}}},255686:function(e,l,t){t.d(l,{$P:function(){return x},FE:function(){return A},G:function(){return P},N7:function(){return R},Q2:function(){return y},Sn:function(){return L},Ws:function(){return b},XK:function(){return I},XQ:function(){return C},YB:function(){return T},du:function(){return k},jZ:function(){return N},w:function(){return S},y3:function(){return E}});var o=t(520739),i=t(878389),n=t(368200);t(675373),t(779788);var r=t(496349),a=t(871212),d=t(231755),u=t(349135),s=t(138871),c=t.n(s);let{COMMON_SEARCH_PARAMS:v}=r;function m(e){var l,t,o;return{text:null!==(l=null==e?void 0:e.text)&&void 0!==l?l:"",iconUrl:null!==(t=null==e?void 0:e.icon_url)&&void 0!==t?t:"",jumpUrl:null!==(o=null==e?void 0:e.jump_url)&&void 0!==o?o:""}}function f(e){var l,t,o,i;return{userAvatar:null!==(l=null==e?void 0:e.user_avatar)&&void 0!==l?l:"",userNickname:null!==(t=null==e?void 0:e.user_nickname)&&void 0!==t?t:"",text:null!==(o=null==e?void 0:e.text)&&void 0!==o?o:"",imageList:null!==(i=null==e?void 0:e.image_list)&&void 0!==i?i:[]}}function _(e){var l,t,o,i,n;return{image:null!==(l=null==e?void 0:e.image)&&void 0!==l?l:"",name:null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",price:(o=Number(null==e?void 0:e.price)/100,o),sales:null!==(i=null==e?void 0:e.sales)&&void 0!==i?i:0,productUrl:null!==(n=null==e?void 0:e.product_url)&&void 0!==n?n:""}}function h(e){var l,t,o,i,n,r,a,d,u,s,c,v,_,h,p,g,w,I,C,y,S,k,T,b,N,L,E,x,A,P,R,M,V,F,j,D,B,W,U,O,Z,H,K,$,z,G;let{item_info:q,status_code:Q,log_pb:X}=e;return{statusCode:Q,logPb:null!==(x=null==X?void 0:X.impr_id)&&void 0!==x?x:"",itemInfo:{productInfo:{name:null!==(A=null==q?void 0:null===(l=q.product_info)||void 0===l?void 0:l.name)&&void 0!==A?A:"",price:(P=Number(null==q?void 0:null===(t=q.product_info)||void 0===t?void 0:t.price)/100,P),promiseTextList:null!==(R=null==q?void 0:null===(o=q.product_info)||void 0===o?void 0:o.promise_text_list)&&void 0!==R?R:[],logisticsTextList:null!==(M=null==q?void 0:null===(i=q.product_info)||void 0===i?void 0:i.logistics_text_list)&&void 0!==M?M:[],imageUrlList:null!==(V=null==q?void 0:null===(n=q.product_info)||void 0===n?void 0:n.image_url_list)&&void 0!==V?V:[],scheme:null!==(F=null==q?void 0:null===(r=q.product_info)||void 0===r?void 0:r.scheme)&&void 0!==F?F:"",schemeQRcodeBase64:null!==(j=null==q?void 0:null===(a=q.product_info)||void 0===a?void 0:a.scheme_qrcode_base64)&&void 0!==j?j:""},shopInfo:{name:null!==(D=null==q?void 0:null===(d=q.shop_info)||void 0===d?void 0:d.name)&&void 0!==D?D:"",image:null!==(B=null==q?void 0:null===(u=q.shop_info)||void 0===u?void 0:u.image)&&void 0!==B?B:"",label:m(null==q?void 0:null===(s=q.shop_info)||void 0===s?void 0:s.label),score:null!==(W=null==q?void 0:null===(c=q.shop_info)||void 0===c?void 0:c.score)&&void 0!==W?W:0,percent:null!==(U=null==q?void 0:null===(v=q.shop_info)||void 0===v?void 0:v.percent)&&void 0!==U?U:0,tagList:null!==(O=null==q?void 0:null===(p=q.shop_info)||void 0===p?void 0:null===(h=p.tag_list)||void 0===h?void 0:null===(_=h.map)||void 0===_?void 0:_.call(h,m))&&void 0!==O?O:[],accountName:null!==(Z=null==q?void 0:null===(g=q.shop_info)||void 0===g?void 0:g.account_name)&&void 0!==Z?Z:""},commentInfo:{totalCount:null!==(H=null==q?void 0:null===(w=q.comment_info)||void 0===w?void 0:w.total_count)&&void 0!==H?H:0,tagList:null!==(K=null==q?void 0:null===(I=q.comment_info)||void 0===I?void 0:I.tag_list)&&void 0!==K?K:[],commentList:null!==($=null==q?void 0:null===(S=q.comment_info)||void 0===S?void 0:null===(y=S.comment_list)||void 0===y?void 0:null===(C=y.map)||void 0===C?void 0:C.call(y,f))&&void 0!==$?$:[]},extraInfo:{productParams:null!==(z=null==q?void 0:null===(b=q.extra_info)||void 0===b?void 0:null===(T=b.product_params)||void 0===T?void 0:null===(k=T.map)||void 0===k?void 0:k.call(T,e=>{var l,t;return{name:null!==(l=e.name)&&void 0!==l?l:"",value:null!==(t=e.value)&&void 0!==t?t:""}}))&&void 0!==z?z:[],detailImageList:null!==(G=null==q?void 0:null===(E=q.extra_info)||void 0===E?void 0:null===(L=E.detail_image_list)||void 0===L?void 0:null===(N=L.map)||void 0===N?void 0:N.call(L,e=>null!=e?e:""))&&void 0!==G?G:[]}}}}function p(e){var l;let{status_code:t,product_preview_list:o,log_pb:i}=e;return{statusCode:t,logPb:null!==(l=null==i?void 0:i.impr_id)&&void 0!==l?l:"",productPreviewList:null==o?void 0:o.map(e=>_(e))}}function g(e){var l,t;let{status_code:o,video_info_list:i,has_product_data:n,product_card:r,log_pb:a}=e;return{statusCode:o,logPb:null!==(l=null==a?void 0:a.impr_id)&&void 0!==l?l:"",videoInfoList:null!==(t=null==i?void 0:i.map(e=>(0,u.s0)(e)))&&void 0!==t?t:[],hasProductData:null!=n&&n,productCard:n?_(r):void 0}}function w(e){let{promotions:l=[],top_promotion:t,target_promotions:o=[],status_code:i,next_offset:n=-1,log_id:r,page_header:a,page_hint:d}=e||{};return{statusCode:i,promotions:l,topPromotion:t,targetPromotions:o,nextOffset:n,logId:r,pageHeader:a,pageHint:d}}async function I(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=await (0,d.U2)("/aweme/v1/web/seo/ecom/detail/product_meta",(0,i._)((0,o._)({},v),{product_id:e}),{},void 0,l,{});return(0,u.RL)(t,h)}async function C(e){let{productId:l="0",itemId:t,needProductCard:n=!1}=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=await (0,d.U2)("/aweme/v1/web/seo/ecom/detail/related_video",(0,i._)((0,o._)({},v),{product_id:l,item_id:t,need_product_card:n}),{},void 0,r,{});return(0,u.RL)(a,g)}async function y(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=await (0,d.U2)("/aweme/v1/web/seo/ecom/detail/recommend_product",(0,i._)((0,o._)({},v),{product_id:e}),{},void 0,l,{});return(0,u.RL)(t,p)}async function S(e){let{roomId:l,authorId:t,offset:n,limit:r=20}=e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=await (0,d.v_)("/live/promotions/page/",(0,i._)((0,o._)({},v),{room_id:l,author_id:t,offset:n,limit:r}),{},void 0,a);return(0,u.RL)(s,w)}async function k(e){let{roomId:l,authorId:t}=e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await (0,d.v_)("/live/promotions/page/top/",(0,i._)((0,o._)({},v),{room_id:l,author_id:t}),{},void 0,n)}async function T(e,l){let{roomId:t,authorId:r,productId:a}=e;return(0,n._)(e,["roomId","authorId","productId"]),await (0,d.U2)(l,(0,o._)((0,i._)((0,o._)({},v),{room_id:t,author_id:r,product_infos:JSON.stringify([{product_id:a}])}),e),{},void 0,null)}async function b(e){return(0,d.U2)("/aweme/v1/commerce/order/getUserAuth/",(0,i._)((0,o._)({},v),{user_id:e,app_id:a.APP_ID}))}async function N(e){return(0,d.U2)("/aweme/v1/commerce/order/saveUserAuth/",(0,i._)((0,o._)({},v),{user_id:e,app_id:a.APP_ID,auth_flag:1}))}async function L(e){let{roomId:l,authorId:t,liveSceneId:n=0,entranceInfo:r}=e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await (0,d.U2)("/live/promotions/pop/v3/",(0,i._)((0,o._)({},v),{room_id:l,author_id:t,live_scene_id:n,entrance_info:r}),{},void 0,a)}async function E(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{promotionId:t,originType:i,roomId:n,secAuthorId:r,itemId:a}=e||{};return await (0,d.v_)("/ecom/product/detail/saas/pc/",(0,o._)({is_h5:1,origin_type:i},v),{is_h5:1,use_new_price:1,bff_type:2,room_id:n,live_room_id:n,item_id:a,sec_author_id:r,origin_type:i,promotion_ids:String(t),ec_promotion_id:t},void 0,l)}async function x(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{promotionId:t,originType:o}=e||{};return await (0,d.v_)("/aweme/v2/shop/promotion/pack/detail/",{is_h5:1,origin_type:o},{is_h5:1,bff_type:2,origin_type:o,promotion_id:t},void 0,l)}async function A(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{productId:t,shopId:n,cursor:r,count:a,statId:u,tagId:s,sortType:m}=e||{};return await (0,d.U2)("/aweme/v1/web/ecom/product/comments/",(0,i._)((0,o._)({},v),{product_id:t,shop_id:n,cursor:r,count:a,stat_id:u,tag_id:s,sort_type:m}),{transformResponse:e=>c().parse(e)},void 0,l)}async function P(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{productId:t,shopId:n,statId:r}=e||{};return await (0,d.U2)("/aweme/v1/web/ecom/product/comment/counter/",(0,i._)((0,o._)({},v),{product_id:t,shop_id:n,stat_id:r}),{},void 0,l)}async function R(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{commentId:t,action:o}=e;return await (0,d.v_)("/aweme/v1/web/ecom/comment/action/",v,{comment_id:t,action:o},void 0,l)}},405039:function(e,l,t){t.d(l,{T:function(){return u},a:function(){return d}});var o=t(520739),i=t(878389);t(675373);var n=t(496349),r=t(231755);let{COMMON_SEARCH_PARAMS:a}=n||{},d=async function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return await (0,r.v_)("/aweme/v1/web/familiar/recommend/submit",(0,i._)((0,o._)({},a),{app_name:"douyin_web",device_platform:""}),{type:2,item_id:e,source:0,is_friend_recommend:l},{})},u=async e=>await (0,r.v_)("/aweme/v1/web/familiar/recommend/cancel",(0,i._)((0,o._)({},a),{app_name:"douyin_web",device_platform:""}),{type:2,item_id:e,source:0},{})},28237:function(e,l,t){t.d(l,{R:function(){return u},n:function(){return d}}),t(250440);var o=t(256277),i=t(32167),n=t(658065),r=t(577786),a=t(669201);let d=e=>{var l,t,o,i,n,r,d;return(null==e?void 0:null===(l=e.anchorInfo)||void 0===l?void 0:l.type)===a.as.AnchorShop&&(null==e?void 0:null===(i=e.anchorInfo)||void 0===i?void 0:null===(o=i.extra)||void 0===o?void 0:null===(t=o[0])||void 0===t?void 0:t.product_detail_schema)&&[1,4].includes(Number(null==e?void 0:null===(d=e.anchorInfo)||void 0===d?void 0:null===(r=d.extra)||void 0===r?void 0:null===(n=r[0])||void 0===n?void 0:n.platform))},u=e=>{var l,t,a,d;let u=(null==e?void 0:null===(t=e.anchorInfo)||void 0===t?void 0:null===(l=t.extra)||void 0===l?void 0:l[0])||{},s=(0,o.Rx)(e)||{};return{source_page:(0,i.mo)(),enter_from:(0,i.mo)(),enter_from_merge:(0,n.yW)(),group_id:e.awemeId,content_id:e.awemeId,author_id:null===(a=e.authorInfo)||void 0===a?void 0:a.uid,follow_status:(0,r.F)(null===(d=e.authorInfo)||void 0===d?void 0:d.followStatus)?"1":"0",commodity_id:u.promotion_id||"",commodity_type:u.promotion_source||"",product_id:u.product_id||"",cid:s.creative_id}}},236758:function(e,l,t){var o=t(520739),i=t(878389),n=t(563097),r=t(88648);let a=(0,r.forwardRef)((e,l)=>(0,n.jsx)("svg",(0,i._)((0,o._)({width:6,height:9,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:(0,n.jsx)("path",{opacity:".7",fillRule:"evenodd",clipRule:"evenodd",d:"M.69 8.124a.75.75 0 0 1 0-1.06l2.828-2.83L.689 1.407A.75.75 0 0 1 1.75.346L5.11 3.704a.75.75 0 0 1 0 1.061L1.75 8.124a.75.75 0 0 1-1.06 0z",fill:"#fff"})})));l.Z=a}}]);
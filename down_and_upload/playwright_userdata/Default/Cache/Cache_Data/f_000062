"use strict";(self.webpackChunkdouyin_web=self.webpackChunkdouyin_web||[]).push([["26950"],{60441:function(e,l,i){i.d(l,{Hh:function(){return a},vE:function(){return r},xB:function(){return o}}),i(602157),i(250440);var t=i(105600);let n=(e,l)=>{var i;return null==e?void 0:null===(i=e.trim())||void 0===i?void 0:i.slice(0,l)},o=e=>{let l,i;let{desc:o,nickname:r,createTimeStr:a,likeCount:d,textExtra:s=[],ocrContent:u}=e,c=s.filter(e=>e.type===t.TextType.HashTag).map(e=>e.hashtagName).join(","),v=`${r}在抖音记录美好生活${a} - 抖音`,m=`${r}于${a}发布在抖音，已经收获了${d}个喜欢，来抖音，记录美好生活！`,f="抖音,抖音短视频,抖音官网";return o?(l=`${n(o,200)} - 抖音`,i=`${n(o,120)} - ${m}`):(l=u.length<30?v:`${n(u,30)} - 抖音`,i=u.length<30?m:`${n(u,120)} - ${m}`),{title:l,description:i,keywords:c?`${c},${f}`:f}},r=e=>{let{desc:l="",nickname:i,createTimeStr:r,likeCount:a,keyword:d="",source:s=0,ocrContent:u,keywordList:c=[]}=e,v=`${i}于${r}发布在抖音，已经收获了${a}个喜欢，来抖音，记录美好生活！`,{title:m,description:f,keywords:_}=o(e);return t.HOT_KEYWORD_TYPE_LIST.includes(s)?(m=l.includes(d)?m:`${d}-${l}-抖音`,_=`${d},抖音`):(m=`${d}-抖音`,_=`${c.slice(0,3).join(",")},抖音`),{title:m,description:f=`${d}${n(u,120)} - ${v}`,keywords:_}},a=e=>{let{desc:l,nickname:i,createTimeStr:t,likeCount:r,ocrContent:a=""}=e,d=`${i}于${t}发布在抖音，已经收获了${r}个喜欢，来抖音，记录美好生活！`,{description:s,keywords:u}=o(e),c=a.length<30?`${l} - ${i} - 抖音`:`${n(a,30)} - 抖音`;return{title:c,description:a.length<30?s:`${n(a,120)} - ${d}`,keywords:u}}},295471:function(e,l,i){i.d(l,{l:function(){return x}});var t=i("520739"),n=i("878389");i("927234"),i("874386");var o=i("563097"),r=i("88648"),a=i("713097"),d=i.n(a),s=i("456128"),u=i("658065"),c=i("32167"),v=i("637005"),m=i("649368");let f=(0,r.forwardRef)((e,l)=>(0,o.jsx)("svg",(0,n._)((0,t._)({width:8,height:8,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:(0,o.jsx)("path",{opacity:".7",d:"M.455 6.435a.78.78 0 0 0 1.103 1.103l2.434-2.435 2.435 2.435A.78.78 0 0 0 7.53 6.435L5.095 4 7.53 1.566A.78.78 0 0 0 6.427.463L3.992 2.897 1.558.463A.78.78 0 0 0 .455 1.566L2.889 4 .455 6.435z",fill:"#fff"})})));var _={cardAd:"auIPeWle",cover:"BPfFVE0r",douyinIcon:"Zf1aLzBu",coverContent:"v3mtt6oK",coverImg:"iTTEOGZL",info:"XqUInXNy",title:"vwDdvG9C",actions:"h1vWzGpx",link:"hPAqs8Ha",button:"A3iwm53Y",secondary:"o4kMRWJb",tertiary:"NQ7omhr0",adTag:"dTOXLecF",withBackground:"JrsPxN_j"},h=i("544933");let g={enter_from_merge:"",enter_from:"",sub_tab_name:"",source_id:"",card_type:"not_fixed_card",card_rank:"",is_card_mark:0,button_num:0};var p={firstButton:"first_button",secondButton:"second_button",clickCaption:"click_caption",otherLocation:"other_location"};let w=new h.h({feedAdCardShow:{eventName:"feed_ad_card_show",params:(0,t._)({},g)},feedAdCardClick:{eventName:"feed_ad_card_click",params:(0,n._)((0,t._)({},g),{click_location:""})},feedAdCardClose:{eventName:"feed_ad_card_close",params:(0,t._)({},g)}});var C=i("88961");let x=e=>{let{cardAd:l,cardStyle:i,onClose:a,onShow:h,logParams:g,enterMethod:x}=e,{id:b,order:I,permanent:y,postUrl:j,title:L,showAdTag:k}=l||{},T=(0,r.useMemo)(()=>(null==l?void 0:l.actions)?"link"===l.actions[0].type?[l.actions[0]]:l.actions.filter(e=>!!(null==e?void 0:e.text)&&(!!e.is_open_JX_modal||!!(null==e?void 0:e.link)))||[]:[],[null==l?void 0:l.actions]),S=()=>({enter_from_merge:(0,u.yW)(),enter_from:(0,c.vM)(),sub_tab_name:(null==g?void 0:g.sub_tab_name)||"",source_id:b.toString(),card_type:y?"fixed_card":"not_fixed_card",card_rank:I.toString(),is_card_mark:k?1:0,button_num:T.length}),[E,N]=function(e){let[l,i]=(0,C.Z)(),t=(0,r.useRef)(!1);return!t.current&&i&&(e&&e(),t.current=!0),[l,i]}(()=>{null==h||h(l),w.sendLog("feedAdCardShow",(0,t._)({},S()))}),P=()=>{null==a||a(l),w.sendLog("feedAdCardClose",(0,t._)({},S()))},R=(e,l)=>{let{link:i}=e||{};if(null==e?void 0:e.is_open_JX_modal){w.sendLog("feedAdCardClick",(0,n._)((0,t._)({},S()),{click_location:l})),v.emit(v.EVENT.OpenJXModal,{source:x});return}if(!!i)window.open(i,"_blank","noopener"),w.sendLog("feedAdCardClick",(0,n._)((0,t._)({},S()),{click_location:l}))};return(0,r.useEffect)(()=>v.listen(v.EVENT.RefreshFeedList,()=>{N&&w.sendLog("feedAdCardShow",(0,t._)({},S()))}),[N]),(0,o.jsxs)("div",{className:d()(_.cardAd,{[_.withBackground]:"with-background"===i}),onClick:e=>{e.stopPropagation(),R(T[0],p.otherLocation)},ref:E,children:[(0,o.jsx)("div",{className:_.cover,children:(0,o.jsx)(s.Q,{imgClass:_.coverImg,className:_.coverContent,src:j,iconWidth:24,iconHeight:28,showImageInSSR:!1,imageReady:!0,skeletonClass:_.douyinIcon})}),(0,o.jsxs)("div",{className:_.info,children:[(0,o.jsx)("div",{className:_.title,onClick:e=>{e.stopPropagation(),R(T[0],p.clickCaption)},children:L}),(0,o.jsx)("div",{className:_.actions,children:T.map((e,l)=>(0,o.jsxs)("span",{className:d()({[_.link]:"link"===e.type,[_.button]:"button"===e.type,[_.secondary]:"button"===e.type&&0===l,[_.tertiary]:"button"===e.type&&1===l}),onClick:i=>{i.stopPropagation(),R(e,0===l?p.firstButton:p.secondButton)},children:[e.text,(0,o.jsx)(m.Z,{})]},l))})]}),k&&(0,o.jsxs)("div",{className:_.adTag,children:[(0,o.jsx)("span",{children:"广告"}),(0,o.jsx)("span",{onClick:e=>{e.stopPropagation(),P()},children:(0,o.jsx)(f,{})})]})]})}},792060:function(e,l,i){var t=i(563097);i(88648);var n=i(501981),o=i(700662);l.Z=e=>{let{children:l,mobileUrl:i,applicableDevice:r}=e,a=(0,n.Yr)();return(0,t.jsx)(o.$,{mobileUrl:i,nonce:a,applicableDevice:r,children:l})}},291628:function(e,l,i){var t=i(563097);i(88648);var n=i(439837),o=i.n(n),r=i(792060);l.Z=e=>{let{videoDetail:l,mobileUrl:i,children:n}=e,{desc:a,authorInfo:d,createTime:s=Date.now()/1e3,video:u,awemeId:c}=l||{},{nickname:v=""}=d||{},{cover:m}=u||{},f=o()(1e3*s).format("YYYYMMDD")||"",_=`${v}在抖音记录美好生活${f}`;return a&&(_=a.slice(0,35)),l?(0,t.jsxs)(r.Z,{mobileUrl:i,children:[n,(0,t.jsx)("meta",{name:"lark:url:enable",content:u?"true":"false"}),(0,t.jsx)("meta",{name:"lark:url:video_icon_url",content:"https://lf1-cdn-tos.bytegoofy.com/goofy/ies/douyin_web/public/favicon.ico"}),(0,t.jsx)("meta",{name:"lark:url:video_title",content:_}),(0,t.jsx)("meta",{name:"lark:url:video_cover_image_url",content:m}),(0,t.jsx)("meta",{name:"lark:url:video_iframe_url",content:`https://www.douyin.com/light/${c}`}),(0,t.jsx)("meta",{name:"lark:url:video_brand_name",content:"抖音"})]}):(0,t.jsx)(r.Z,{mobileUrl:i,children:n})}},936681:function(e,l,i){i.d(l,{R:function(){return m}}),i("874386"),i("250440");var t=i("563097");i("88648");var n=i("713097"),o=i.n(n),r=i("55426"),a=i("421885"),d=i("956428"),s=i("180962"),u=i("555679"),c={tagContainer:"MuOMBG7w",tagText:"j0NhDonV",yellow:"cnXJYqGj",green:"XyANTGWL",recommended:"HiCadb44"};a.Z,d.Z,s.Z,u.Z;let v=new Map([["follow",{text:"你的关注"}],["recommended",{text:"为你推荐"}],["collect",{text:"收藏"}],["digg",{text:"点赞"}],["comment",{text:"评论"}]]),m=e=>{let{count:l,type:i,className:n,abTestData:a}=e,d=v.get("recommended"===i?"recommended":"follow");return(0,t.jsx)(t.Fragment,{children:d&&(0,t.jsx)("span",{className:o()(c.tagContainer,n,{[c.yellow]:"collect"===i,[c.green]:"comment"===i,[c.green]:"follow"===i,[c.recommended]:"recommended"===i}),children:(0,t.jsx)("span",{className:o()(c.tagText),children:`${["follow","recommended"].includes(i)?"":(0,r.qe)(l||0)}${d.text}`})})})}},325430:function(e,l,i){i.d(l,{Z:function(){return eD}});var t=i("520739"),n=i("878389");i("675373"),i("602157"),i("874386"),i("698295"),i("630833");var o=i("563097"),r=i("88648"),a=i("713097"),d=i.n(a),s=i("222406"),u=i("465571"),c=i("338426"),v=i("149250"),m=i("948375"),f=i("567754"),_=i("410665"),h=i("702726"),g=i("234048"),p=i("597334"),w=i("105600"),C=i("598467"),x=i("828564"),b=i("417069"),I=i("901414"),y=i("473677"),j=i("906499"),L=i("128505"),k=i("903868"),T=i("317914"),S=i("782442"),E=i("55426"),N=i("32167"),P=i("637005"),R=i("577786"),M=i("658065"),A=i("807939"),D=i("330746"),O=i("782563"),V=i("273329"),F={more:"okbbldWm",videoCard:"Ety_VxKJ",cardInfo:"aQ9_t9OG",bgChange:"Ggrj06si",videoImg:"Lcu93pLN",imgAspectRatio:"tIDxbbb0",hover:"MXa_Fvst",hotMask:"ZNnEuoIx",hotBottomInfo:"DzD5gTdY",hotCount:"PI_YRTgM",hotText:"_FSjEjz0",hotDuration:"bDPIenef",coverBg:"yCZK873D",coverMask:"HS_xtX97",cardInfoContainer:"eHJ6sWzB",transparent:"N6iRTJrK",decs:"bWzvoR9D",userText:"cFBFnzvk",userTextContent:"v2EXCtbT",userName:"i1udsuGn",text:"H0ZV35Qb",marginRight:"kGiKw5ui",highlightTag:"fNbKQpbC",highlightTagWithoutMarginRight:"L9x6LbYL",divider:"TGGwK4S0",interactiveBox:"uvLZJzu_",contents:"uvbktBRs",icon:"os6QELZF",barContainer:"jOEMaHXF",barIcon:"t3FiK6uZ",barText:"JrUsR5HS",barDivide:"fbxmM1V3",barDesc:"JoNaf7Md",createTime:"RIr_dcq4",hasMarginRight:"a9pGU2CK",flexColumn:"K7AQ1qf_",needScale:"qitm_ReH",imageChange:"nG23Syh1",at:"usZ3A4ca",report:"WSk_EDgD",bottom:"UN0kFYlU",bigCard:"MOOYT7l5",isBigCardCutVideo:"l3knLhM1",jxThemeColor:"Cy3BHAAt",moreBtnBgChange:"Ozj4cge_"},B=i("784492"),U=i("746864"),H=i("516599"),G=i("456128"),Z=i("288867"),$=i("85599"),z=i("667557"),W={videoImage:"aEPe5XR7",videoBox:"_mZtzTNG",videoBoxUnsetBg:"RnLdibGs",img:"FzTzDfM8",gaosi:"MHUGVJJ0",imgCover:"arVEnqPE",videoInfo:"nxtM_NY2",discoverWatchLaterToast:"K1TmrJVT",inVisible:"kteHsmP9"},J=i("689021"),Y={playingCover:"ap8bVGAY",safari:"puRNIeSZ",playingCoverInner:"ZkyW_Mff"};let q=()=>(0,o.jsx)("div",{className:d()(Y.playingCover,{[Y.safari]:(0,D.G6)()}),onClick:e=>{e.stopPropagation(),e.preventDefault()},children:(0,o.jsxs)("div",{className:Y.playingCoverInner,children:[(0,o.jsx)(J.WaveLineAnimation,{className:Y.icon}),(0,o.jsx)("span",{children:"播放中"})]})});var X=i("916956");let K=e=>{let{previewUrlList:l,onVideoEnded:i,onVideoStopped:t,onVideoPlaying:n,topAwemeId:o,isTopCard:a=!1}=e,d=(0,k.Iq)(e=>{let{pipWindow:l}=e;return{pipWindow:l}}),[s,u]=(0,r.useState)(!1),[c,v]=(0,r.useState)(!1),[f,_]=(0,r.useState)(!1),h=(0,r.useRef)(),g=(0,r.useRef)(0);(0,r.useEffect)(()=>{c&&(null==n||n())},[c]);let p=(0,m.Z)(e=>{v(e)}),w=(0,m.Z)(()=>{v(!0)}),C=(0,m.Z)(()=>{p(!1)}),x=(0,r.useMemo)(()=>{let e=l.length>0,i=!!(null==d?void 0:d.pipWindow);return e&&(a?s:c&&!i)},[l,c,a,s]),b=(0,r.useRef)(x);(0,r.useLayoutEffect)(()=>{!x&&b.current&&(_(!1),null==t||t(Date.now()-g.current))},[x,t]),(0,X.C)(()=>{u(!0)},[]),(0,B.Z)(()=>{if(!a){if(P.emit(P.EVENT.JingxuanTopCard,{action:c?"pause":"play",awemeId:o,from:c?"hover_other_cover":"cancel_hover_other_cover"}),c)return P.listen(P.EVENT.JingxuanTopCard,e=>{let{action:l}=e;"pauseOtherCard"===l&&v(!1)})}},[c,a]),(0,r.useEffect)(()=>{b.current=x},[x]);let I=(0,m.Z)(()=>{null==i||i()});return{onMouseEnter:w,onMouseLeave:C,isPlay:x,isHovered:c,setIsHovered:p,onEnded:I,onPlaying:(0,m.Z)(()=>{_(!0)}),isReady:f,previewImageRef:h}},Q=e=>{let{awemeInfo:l,useOuterProgress:i=!1}=e,[t,n]=(0,r.useState)(!1),[o,a]=(0,r.useState)(0),[d,s]=(0,r.useState)(0),[u,c]=(0,r.useState)(0);return(0,r.useEffect)(()=>{if(!i||!l.awemeId)return;let e=e=>{let{awemeId:i}=e;if(i!==l.awemeId)return;let t=S.Le.getConfig(S.gI.JxOuterProgress),o=(null==t?void 0:t[i])||{};(null==o?void 0:o.isWatchedEnd)||(null==o?void 0:o.progress)?(n(!0),a((null==o?void 0:o.progress)||0),s((null==o?void 0:o.startTime)||0),c((null==o?void 0:o.duration)||0)):(n(!1),a(0),s(0))};e({awemeId:l.awemeId});let t=P.listen(P.EVENT.UpdateJxOuterProgress,e);return()=>{null==t||t()}},[i,l]),{showOuterProgress:t,outerProgress:o,outerStartTime:d,outerDuration:u}};var ee="hRlVOg7l",el="PRUt1wQg";let ei=e=>{let{progress:l,outerClassName:i,onShow:t}=e,n=(0,_.x)(()=>{null==t||t()});return(0,o.jsx)("div",{ref:n,className:d()(ee,i),children:(0,o.jsx)("div",{className:el,style:{width:`${l}%`}})})};var et=i("794593");let en=r.lazy(()=>Promise.all([i.e("42562"),i.e("5405"),i.e("47730")]).then(i.bind(i,405430)));var eo={OutSide:0,0:"OutSide",Inner:1,1:"Inner"};let er=e=>{H.F.info(e)};var ea=(0,r.forwardRef)((e,l)=>{var i;let{style:a,className:u,imageClassName:c,imgClass:v,imageSkeletonClass:m="",imgUrl:f="",children:_,onClick:h,defaultImageColor:g,onVideoStopped:w,onVideoPlaying:C,previewUrlList:x=[],width:b,height:I,fakeHorizontalInfo:y,onVideoEnded:j,isHorizontal:L=!1,isSpider:T,debugInfo:E,appendPlayerConfig:N,alt:R,awemeInfo:O,onMouseEnter:F,onMouseLeave:H,showProgressBar:J,onPreviewChange:Y,logParams:X,showImageInSSR:ee,forceContainerCover:el=!1,renderExtension:eo,onImgLoad:ea,onLoadedData:ed,priority:es,videoImageWidth:eu,videoImageHeight:ec,decoding:ev,scene:em,user:ef,onRef:e_,disablePreview:eh=!1,disableByMoreAction:eg=!1,enableNotePreview:ep=!1,blurLightCover:ew=!1,needOperateHidden:eC=!1,isBigCard:ex=!1,isTopCard:eb=!1,isTopCardActive:eI,topAwemeId:ey,showWatchLater:ej=!1,imageReady:eL,tab:ek,enableCardHoverPreview:eT,canCancleWatchLaterOnPreview:eS,withBlurBg:eE,withBlurBgPerf:eN,enableImageX:eP,scrollContainerRef:eR,reuseConfig:eM,showAiEntry:eA,onClickAiEntry:eD,abTestData:eO,onClickPipIcon:eV,isPipPlaying:eF,dislikeCoverVisible:eB,useOuterProgress:eU=!1,forceHiddenOuterProgress:eH=!1}=e,eG=(0,r.useRef)(!1),eZ=(0,k.Iq)(e=>{let{pipWindow:l,isWebMiniWin:i}=e;return{pipWindow:l,isWebMiniWin:i}}),[e$,ez]=(0,r.useState)(null),[eW,eJ]=(0,r.useState)(null),eY=(null==O?void 0:O.awemeType)===U.e.Note,{showOuterProgress:eq,outerProgress:eX,outerStartTime:eK,outerDuration:eQ}=Q({awemeInfo:O,useOuterProgress:eU}),{setIsHovered:e0,isPlay:e1,onMouseEnter:e2,onMouseLeave:e3,onEnded:e5,onPlaying:e6,isReady:e4,previewImageRef:e7,isHovered:e8}=K({previewUrlList:x,onVideoStopped:w,onVideoEnded:j,onVideoPlaying:C,isTopCard:eb,topAwemeId:ey}),[e9,le]=(0,r.useState)(e1),ll=(0,r.useCallback)(()=>{if(null==h||h(),(null==x?void 0:x.length)!==0)e0(!1)},[e0,h,x]);(0,r.useEffect)(()=>{var e,l,i;let t=(null===(e=S.Le.getConfig(S.gI.IsInModalVideo))||void 0===e?void 0:e.isInModal)||!1;(null===(i=window)||void 0===i?void 0:null===(l=i.__QUICK_PLAYER)||void 0===l?void 0:l.player)||t?le(!1):le(e1)},[e1]),(0,B.Z)(()=>{if(eb){var e,l,i;let t=(null===(e=S.Le.getConfig(S.gI.IsInModalVideo))||void 0===e?void 0:e.isInModal)||!1,n=null===(i=window)||void 0===i?void 0:null===(l=i.__QUICK_PLAYER)||void 0===l?void 0:l.player;le(e1&&!!eI&&!(null==eZ?void 0:eZ.pipWindow)&&!t&&!n)}},[eb,eI,e1,null==eZ?void 0:eZ.pipWindow]),(0,r.useEffect)(()=>{if(eb){let e=P.listen(P.EVENT.videoPause,()=>{le(!1)}),l=P.listen(P.EVENT.exitModalVideo,()=>{le(e1&&!!eI&&!(null==eZ?void 0:eZ.pipWindow))});return()=>{null==e||e(),null==l||l()}}},[eb,eI,e1,null==eZ?void 0:eZ.pipWindow]);let li=(!(0,D.vU)()||O)&&e9&&(null==x?void 0:x.length)>0;(0,r.useEffect)(()=>{null==Y||Y(li)},[li]);let{isiPad:lt}=(0,p.X)(),{isWebMiniWin:ln=!1}=(0,k.Iq)(e=>{let{isWebMiniWin:l}=e;return{isWebMiniWin:l}}),lo=(0,r.useCallback)(()=>{e2(),null==F||F()},[e2,F,ln]),lr=(0,r.useCallback)(()=>{e3(),null==H||H()},[e3,H]);(0,r.useEffect)(()=>{if(e$&&!eg&&!eT&&!lt){let e=A.mouseEnter(e$,lo,!0),l=A.mouseLeave(e$,lr);return()=>{e(),l()}}},[e$,eg,eT,lt,lo,lr]),(0,r.useImperativeHandle)(l,()=>({enter(){e$&&!eg&&lo()},leave(){e$&&!eg&&lr()}}),[e$,eg,lo,lr]),(0,r.useEffect)(()=>{let e=()=>{"hidden"===document.visibilityState&&lr()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[lr]),(0,r.useEffect)(()=>{ln&&lr()},[ln]);let la=(e8||li)&&ej&&(0,z.D)(O)&&!eB,ld=(0,r.useMemo)(()=>{let e=(0,M.yW)();return(0,n._)((0,t._)({},X),{enter_from:e,enter_from_merge:e,tab_name:null!=ek?ek:e,click_method:`${e}_preview`})},[X]),ls=(0,r.useMemo)(()=>eS?(0,n._)((0,t._)({},O),{watchLaterInfo:null}):O,[eS,O]),lu=(0,r.useMemo)(()=>({watchLaterAwemeInfo:ls,user:ef}),[ls,ef]),lc=(0,r.useCallback)(()=>{var e,l,i,t;if(!eG.current)eG.current=!0,et.Z.report("pc_theme_progress_bar_show",{enter_from:(0,M.yW)(),enter_from_merge:(0,M.yW)(),enter_method:"",tab_name:null==X?void 0:X.tab_name,sub_tab_name:null==X?void 0:X.sub_tab_name,aweme_type:null==X?void 0:null===(e=X.awemeInfo)||void 0===e?void 0:e.awemeType,group_id:null==X?void 0:null===(l=X.awemeInfo)||void 0===l?void 0:l.awemeId,author_id:null==X?void 0:null===(t=X.awemeInfo)||void 0===t?void 0:null===(i=t.authorInfo)||void 0===i?void 0:i.uid,item_duration_ms:eQ})},[X,eQ]);return(0,o.jsxs)("div",{style:a,onClick:ll,className:d()(W.videoImage,u,"videoImage"),ref:e=>{ez(e),null==e_||e_(e)},children:[(0,o.jsxs)("div",{className:d()(W.videoBox,{[W.videoBoxUnsetBg]:!li}),ref:e=>{eJ(e)},children:[(0,o.jsx)(G.Q,{skeletonStyle:{background:g},className:d()(c,{[W.inVisible]:eb&&!eI}),imgClass:d()(W.img,v,{[W.imgCover]:el,[W.gaosi]:eh&&!(0,D.G6)()}),skeletonClass:m,src:f,isPreviewing:e4&&li,isSpider:T,alt:R,showImageInSSR:ee,imageReady:eL,onHandleImgLoad:ea,priority:es,width:eu,height:ec,decoding:ev,blurLightCover:ew,withBlurBgPerf:eN,withBlurBg:eE,imgUrlList:(null==O?void 0:null===(i=O.video)||void 0===i?void 0:i.coverUrlList)||[],enableImageX:eP,scrollContainerRef:eR}),li&&!eh&&(!eY||ep)&&(0,o.jsx)(s.SV,{Slardar:(0,V.f5)(),children:(0,o.jsx)(r.Suspense,{fallback:(0,o.jsx)("div",{}),children:(0,o.jsx)(en,{startTime:eq?eK:void 0,isTopCardActive:eI,needOperateHidden:eC,previewUrlList:x||[],isHorizontal:L,onReady:e6,onLoadedData:ed,onEnded:e5,ratio:I/b,fakeHorizontalInfo:y,showProgressBar:J,ref:e7,logParams:X,awemeInfo:O,appendPlayerConfig:N,container:e$,coverContainer:eW,renderExtension:eo,forceContainerCover:el,scene:em,user:ef,isTopCard:eb,isBigCard:ex,reuseConfig:eM,isShowWatchLater:la&&eb&&!!(null==eO?void 0:eO.jingxuanCover169),useNewControlIcon:eb&&!!(null==eO?void 0:eO.jingxuanCover169),watchLaterProps:lu,enableNote:!0,pip:{show:"discover"===em,onClick:()=>{null==eV||eV()}}})})}),li&&eY&&(null==eo?void 0:eo({type:U.e.Note})),(0,D.vU)()&&(null==eo?void 0:eo()),!li&&(0,o.jsx)("div",{className:d()(W.videoInfo),children:r.Children.toArray(_).map(e=>{var l;if((null==e?void 0:null===(l=e.props)||void 0===l?void 0:l.slot)===1)return e})}),la&&!(eb&&(null==eO?void 0:eO.jingxuanCover169))&&(0,o.jsx)($.nf,{awemeInfo:ls,isActive:!0,isPreview:!0,isLogin:null==ef?void 0:ef.isLogin,loginDispatch:null==ef?void 0:ef.dispatch,logParams:ld,toast:e=>er({text:e,className:eS?W.discoverWatchLaterToast:""}),canCancleWatchLaterOnPreview:eS}),eF&&!eB&&(0,o.jsx)(q,{}),eq&&!eH&&!li&&(0,o.jsx)(ei,{onShow:lc,progress:eX})]}),r.Children.toArray(_).map(e=>{var l;if((null==e?void 0:null===(l=e.props)||void 0===l?void 0:l.slot)===0)return e}),E&&(0,o.jsx)(Z.W,{req:null==E?void 0:E.web_debug_req,video:null==E?void 0:E.client_rec_debug_info,isLeft:!1,showPanelRightside:!0})]})}),ed=i("881155"),es=i("643728"),eu=i("254897"),ec=i("964374"),ev=i("612075"),em={videoCoverContainer:"UVozwOjM",weeklyRecommendTag:"v8Eq4MV4",topContain:"Rmj61Lln",tag:"U0Kc5fVM",icon:"VzYy3NPA",homeTag:"EnxOJUbc",homeTagText:"Tu_AoxtC",homeTagHot:"FN6VbMH0",homeTagRank:"KXiXPh4W",homeTagContainer:"LTe9QCEO",time:"enTvYUph",likes:"x7P__y2r"};let ef=(0,r.forwardRef)((e,l)=>(0,o.jsxs)("svg",(0,n._)((0,t._)({width:10,height:12,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:[(0,o.jsx)("path",{d:"M.616 4.435a.75.75 0 0 1 0-1.292l3.622-2.135a1.5 1.5 0 0 1 1.524 0l3.622 2.135a.75.75 0 0 1 0 1.292L5.762 6.57a1.5 1.5 0 0 1-1.524 0L.616 4.435z",fill:"#fff"}),(0,o.jsx)("path",{d:"M.07 5.785a.5.5 0 0 1 .684-.177l3.738 2.204a1 1 0 0 0 1.016 0l3.738-2.204a.5.5 0 1 1 .508.862L6.016 8.673a2 2 0 0 1-2.032 0L.246 6.47a.5.5 0 0 1-.177-.685z",fill:"#fff"}),(0,o.jsx)("path",{d:"M.754 7.858a.5.5 0 1 0-.508.862l3.738 2.203a2 2 0 0 0 2.032 0L9.754 8.72a.5.5 0 1 0-.508-.862l-3.738 2.204a1 1 0 0 1-1.016 0L.754 7.857z",fill:"#fff"})]}))),e_=(0,r.forwardRef)((e,l)=>(0,o.jsxs)("svg",(0,n._)((0,t._)({width:14,height:14,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:[(0,o.jsx)("g",{filter:"url(#ic_home_note_svg__filter0_d_3305_2957)",children:(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.917 1.75c-.645 0-1.167.522-1.167 1.167V8.75c0 .644.522 1.167 1.167 1.167H8.75c.644 0 1.167-.523 1.167-1.167V2.917c0-.645-.523-1.167-1.167-1.167H2.917zm2.333 10.5a1.167 1.167 0 0 1-1.167-1.167H8.75a2.333 2.333 0 0 0 2.333-2.333V4.083c.645 0 1.167.523 1.167 1.167v4.667a2.333 2.333 0 0 1-2.333 2.333H5.25z",fill:"#fff"})}),(0,o.jsx)("defs",{children:(0,o.jsxs)("filter",{id:"ic_home_note_svg__filter0_d_3305_2957",x:-1,y:-1,width:16,height:16,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,o.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,o.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,o.jsx)("feOffset",{}),(0,o.jsx)("feGaussianBlur",{stdDeviation:".5"}),(0,o.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,o.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0"}),(0,o.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_3305_2957"}),(0,o.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_3305_2957",result:"shape"})]})})]}))),eh=(0,r.forwardRef)((e,l)=>(0,o.jsxs)("svg",(0,n._)((0,t._)({width:14,height:14,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:[(0,o.jsxs)("g",{filter:"url(#ic_home_collect_svg__filter0_d_3305_2200)",fill:"#fff",clipPath:"url(#ic_home_collect_svg__clip0_3305_2200)",children:[(0,o.jsx)("path",{d:"M11.922 5.212a.63.63 0 0 0 .293-.545.631.631 0 0 0-.292-.545L7.275 1.355a.495.495 0 0 0-.511-.001L2.079 4.12a.63.63 0 0 0-.294.544c0 .23.112.44.292.546l4.65 2.774c.16.095.352.096.512 0l4.683-2.773z"}),(0,o.jsx)("path",{d:"M12.145 6.7c.148.297.053.673-.211.839l-4.686 2.937a.495.495 0 0 1-.532 0L2.068 7.582c-.265-.165-.36-.54-.214-.838.147-.298.48-.406.745-.24L6.98 9.231l4.419-2.77c.264-.166.598-.06.745.238z"}),(0,o.jsx)("path",{d:"M11.934 9.872c.264-.166.359-.541.211-.839-.147-.297-.48-.404-.745-.238l-4.42 2.77L2.6 8.835c-.265-.165-.598-.057-.745.241-.147.298-.051.673.214.838l4.648 2.896a.495.495 0 0 0 .532 0l4.686-2.938z"})]}),(0,o.jsxs)("defs",{children:[(0,o.jsxs)("filter",{id:"ic_home_collect_svg__filter0_d_3305_2200",x:".785",y:".283",width:12.43,height:13.604,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,o.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,o.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,o.jsx)("feOffset",{}),(0,o.jsx)("feGaussianBlur",{stdDeviation:".5"}),(0,o.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,o.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0"}),(0,o.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_3305_2200"}),(0,o.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_3305_2200",result:"shape"})]}),(0,o.jsx)("clipPath",{id:"ic_home_collect_svg__clip0_3305_2200",children:(0,o.jsx)("path",{fill:"#fff",d:"M0 0h14v14H0z"})})]})]}))),eg=(0,r.forwardRef)((e,l)=>(0,o.jsxs)("svg",(0,n._)((0,t._)({width:14,height:14,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:[(0,o.jsx)("path",{d:"M1.283 7a2.917 2.917 0 0 1 3.792-2.783.583.583 0 1 0 .35-1.113 4.083 4.083 0 1 0 0 7.793.583.583 0 0 0-.35-1.114A2.917 2.917 0 0 1 1.283 7z",fill:"#fff"}),(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.8 2.917a4.083 4.083 0 1 0 0 8.166 4.083 4.083 0 0 0 0-8.166zM6.883 7a2.917 2.917 0 1 1 5.834 0 2.917 2.917 0 0 1-5.834 0z",fill:"#fff"})]})));var ep=i("327306"),ew=r.memo(e=>{var l,i,t,n,r;let{style:a,className:s,showTag:u,tagName:c,showTime:v,time:m,showLikes:f,likes:_,showIntegrationTag:h,showCooperationTag:g=!0,showHomeNote:p,showHomeCollect:w,showHomeHot:C,awemeInfo:x,scene:b}=e,I=(0,ep._)(),{userInfo:j}=(0,ev.useUserContext)(),{uid:L=""}=null!==(n=null==j?void 0:j.info)&&void 0!==n?n:{},k=(0,ed.$m)(x,(null==x?void 0:null===(l=x.authorInfo)||void 0===l?void 0:l.uid)===L),T=(0,es.$)({awemeInfo:x,abTestData:I});return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{style:a,className:d()(em.videoCoverContainer,s),children:[T&&(0,o.jsx)(es.n,{scene:"videoCard",className:em.weeklyRecommendTag,awemeInfo:x}),!T&&(0,o.jsx)(ed.zx,{type:k}),!T&&!k&&(0,o.jsxs)("div",{className:d()(em.topContain),children:[h&&(0,o.jsxs)("div",{className:d()(em.homeTag),children:[(0,o.jsx)(y.Z,{width:10,height:12,viewBox:"0 0 10 12",src:ef,className:em.icon}),(0,o.jsx)("span",{className:em.homeTagText,children:"合集"})]}),u&&c&&(0,o.jsx)("div",{className:d()(em.tag),children:c}),g&&!h&&!(u&&c)&&!p&&!w&&!C&&Number(null!==(r=null==x?void 0:null===(t=x.cooperationInfo)||void 0===t?void 0:null===(i=t.cooperationCreators)||void 0===i?void 0:i.length)&&void 0!==r?r:0)>1&&(0,o.jsxs)("div",{className:d()(em.homeTag),children:[(0,o.jsx)(y.Z,{width:14,height:14,viewBox:"0 0 14 14",src:eg,className:em.icon}),(0,o.jsx)("span",{className:em.homeTagText,children:"共创"})]})]}),!T&&!k&&(0,o.jsxs)("div",{className:d()(em.homeTagContainer),children:[p&&(0,o.jsxs)("div",{className:d()(em.homeTag),children:[(0,o.jsx)(y.Z,{width:14,height:14,viewBox:"0 0 14 14",src:e_,className:em.icon}),(0,o.jsx)("span",{className:em.homeTagText,children:"图文"})]}),w&&(0,o.jsxs)("div",{className:d()(em.homeTag),children:[(0,o.jsx)(y.Z,{width:14,height:14,viewBox:"0 0 14 14",src:eh,className:em.icon}),(0,o.jsx)("span",{className:em.homeTagText,children:"合集"})]}),C&&(0,o.jsxs)("div",{className:d()(em.homeTag,em.homeTagHot),children:[(0,o.jsx)("span",{className:em.homeTagText,children:"热榜"}),(0,o.jsx)("span",{className:em.homeTagRank,children:"TOP"})]})]}),v&&(0,o.jsx)("div",{className:d()(em.time),children:m}),f&&(0,o.jsxs)("div",{className:d()(em.likes),children:[(0,o.jsx)(eu.z,{initialMounted:!!S.Le.getConfig(S.gI.isCSRRender),style:"discover"===b?{marginRight:"2px"}:{fontSize:"20px",marginRight:"2px"},svg:(0,o.jsx)(ec.Z,{className:em.icon})}),(0,o.jsx)("span",{children:_})]})]})})}),eC=i("936681");let ex=(0,r.forwardRef)((e,l)=>(0,o.jsxs)("svg",(0,n._)((0,t._)({width:12,height:12,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:[(0,o.jsxs)("g",{clipPath:"url(#ic_hot_svg__clip0_3118_121700)",children:[(0,o.jsx)("mask",{id:"ic_hot_svg__a",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:1,y:-2,width:10,height:14,children:(0,o.jsx)("path",{d:"M1.5-1.05h9.208v8.233a4.516 4.516 0 0 1-4.516 4.516A4.692 4.692 0 0 1 1.5 7.007V-1.05z",fill:"#C4C4C4"})}),(0,o.jsxs)("g",{mask:"url(#ic_hot_svg__a)",children:[(0,o.jsx)("path",{d:"M9.393 3.552c.961 1.062 1.316 2.125 1.316 3.187 0 1.417-.068 1.797 0 1.771-1.859.738-5.123-.93-6.021-3.187-.899-2.258.38-4.25 2.353-5.313.078-.041.126.028.126.133 0 1.638 1.265 2.346 2.226 3.409z",fill:"url(#ic_hot_svg__paint0_linear_3118_121700)"}),(0,o.jsx)("path",{d:"M10.545 8.87c.191-.348.557 1.057.164-1.226.354-1.967-1.142-2.745-2.125-2.321-1.645.708-2.48.708-3.542.354-.69-.23-1.638-.708-1.934-1.77-.329 1.416.66 4.065 2.157 4.964 1.497.898 5.09.348 5.28 0z",fill:"url(#ic_hot_svg__paint1_linear_3118_121700)"}),(0,o.jsx)("path",{d:"M2.775 3.338C2.534 3.58 1.5 4.825 1.5 6.815c0 1.99 1.063 4.884 4.604 4.884 3.542 0 4.931-1.406 5.313-3.255-3.188 1.771-5.656 0-6.021-.354-.9-.872-2.125-2.411-2.338-4.604-.029-.301-.042-.39-.283-.148z",fill:"url(#ic_hot_svg__paint2_linear_3118_121700)"})]})]}),(0,o.jsxs)("defs",{children:[(0,o.jsxs)("linearGradient",{id:"ic_hot_svg__paint0_linear_3118_121700",x1:4.536,y1:".278",x2:8.934,y2:6.742,gradientUnits:"userSpaceOnUse",children:[(0,o.jsx)("stop",{offset:".021",stopColor:"#FADF32"}),(0,o.jsx)("stop",{offset:".451",stopColor:"#EB9B46"}),(0,o.jsx)("stop",{offset:".782",stopColor:"#EB5854"})]}),(0,o.jsxs)("linearGradient",{id:"ic_hot_svg__paint1_linear_3118_121700",x1:3.616,y1:4.788,x2:11.598,y2:9.516,gradientUnits:"userSpaceOnUse",children:[(0,o.jsx)("stop",{stopColor:"#FFC533"}),(0,o.jsx)("stop",{offset:".436",stopColor:"#F26461"}),(0,o.jsx)("stop",{offset:".809",stopColor:"#FF0544"})]}),(0,o.jsxs)("linearGradient",{id:"ic_hot_svg__paint2_linear_3118_121700",x1:9.195,y1:11.126,x2:1.577,y2:4.974,gradientUnits:"userSpaceOnUse",children:[(0,o.jsx)("stop",{offset:".134",stopColor:"#FA0951"}),(0,o.jsx)("stop",{offset:".354",stopColor:"#FA3E65"}),(0,o.jsx)("stop",{offset:".881",stopColor:"#F2AE49"}),(0,o.jsx)("stop",{offset:".998",stopColor:"#FAC032"})]}),(0,o.jsx)("clipPath",{id:"ic_hot_svg__clip0_3118_121700",children:(0,o.jsx)("path",{fill:"#fff",d:"M0 0h12v12H0z"})})]})]}))),eb=e=>{let{awemeInfo:l,isModalPlayingCurrentVideo:i,onClickPipIcon:t}=e,{isWebMiniWin:n,pipWindow:o,isListenVideoMiniWin:a}=(0,k.Iq)(e=>{let{isWebMiniWin:l,pipWindow:i,isListenVideoMiniWin:t}=e;return{isWebMiniWin:l,pipWindow:i,isListenVideoMiniWin:t}}),d=(0,r.useMemo)(()=>(n||a)&&i,[n,l,i,a]),[s,u]=(0,r.useState)(!1),c=s||d;return(0,r.useEffect)(()=>{if(o){let e=()=>{u(!1)};return o.addEventListener("pagehide",e),()=>{o.removeEventListener("pagehide",e)}}},[o]),(0,r.useEffect)(()=>{!d&&u(!1)},[d]),{isPipPlaying:c,handleClickPipIcon:()=>{u(!0),null==t||t()}}};var eI=i("14108");let ey=(e,l)=>{var i,t,n,o,a,d,s,u,c,v;let m=!!e.authorInfo.roomId,f=(0,r.useMemo)(()=>{var i,t,n,o,r;return{web_rid:null===(n=e.authorInfo)||void 0===n?void 0:null===(t=n.roomData)||void 0===t?void 0:null===(i=t.owner)||void 0===i?void 0:i.web_rid,room_id:null===(o=e.authorInfo)||void 0===o?void 0:o.roomId,request_id:null==e?void 0:e.logPb,anchor_id:null===(r=e.authorInfo)||void 0===r?void 0:r.uid,live_position:l}},[null===(i=e.authorInfo)||void 0===i?void 0:i.uid,null===(o=e.authorInfo)||void 0===o?void 0:null===(n=o.roomData)||void 0===n?void 0:null===(t=n.owner)||void 0===t?void 0:t.web_rid,null===(a=e.authorInfo)||void 0===a?void 0:a.roomId,null==e?void 0:e.logPb,l]);return{isAuthorLiving:m,handleJumpToLiveRoom:(0,r.useCallback)(()=>{var i,t,n,o,r;let a=(0,eI.cc)({anchor_id:null===(n=e.authorInfo)||void 0===n?void 0:null===(t=n.roomData)||void 0===t?void 0:null===(i=t.owner)||void 0===i?void 0:i.id_str,web_rid:null===(r=e.authorInfo.roomData)||void 0===r?void 0:null===(o=r.owner)||void 0===o?void 0:o.web_rid,enter_from_merge:"web_homepage_discover",enter_method:"web_video_card",enter_method_temai:"web_video_card",action_type:"click",room_id:e.authorInfo.roomId,request_id:null==e?void 0:e.logPb,live_position:l,__is_replaced_live__:(null==e?void 0:e.__is_replaced_live__)?"1":"0"});window.open(a,"_blank","noopener")},[null===(u=e.authorInfo)||void 0===u?void 0:null===(s=u.roomData)||void 0===s?void 0:null===(d=s.owner)||void 0===d?void 0:d.id_str,null===(v=e.authorInfo.roomData)||void 0===v?void 0:null===(c=v.owner)||void 0===c?void 0:c.web_rid,e.authorInfo.roomId,null==e?void 0:e.logPb,l]),liveParams:f}};var ej="GqvoOOqQ",eL="gyc_BqdH",ek="vYT08osC";let eT=e=>{let{onClick:l}=e;return(0,o.jsxs)("div",{className:ej,onClick:l,children:[(0,o.jsx)("div",{className:eL,children:(0,o.jsx)(J.default,{size:7})}),(0,o.jsx)("div",{className:ek,children:"正在直播"})]})};var eS=i("128231"),eE=i.n(eS),eN=i("161045");let eP=(e,l)=>l&&1e-4>Math.abs(e/l-16/9),eR=e=>{let{awemeInfo:l,isBigCard:i,scene:t,abTestData:n,ref:o}=e,[a,d]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{var e,r,a;if("discover"!==t||!i||(null==l?void 0:l.webCardType)||!l.pcBlockedAreaRatio||(null!==(a=null==l?void 0:l.createTime)&&void 0!==a?a:0)*1e3<=17304192e5||!(null==l?void 0:null===(e=l.video)||void 0===e?void 0:e.height)||!(null==l?void 0:null===(r=l.video)||void 0===r?void 0:r.width)||eP(l.video.width,l.video.height))return;let s=eE()(()=>{if(o.current&&l&&l.video){let e=o.current.getBoundingClientRect(),{width:i}=e,t=(null==n?void 0:n.jingxuanCover169)?e.height:e.height-90;if(i/t<l.video.width/l.video.height){let e=l.pcBlockedAreaRatio,n=(1-l.video.height/l.video.width*i/t)/2;if(!e){d(n<.05);return}if(e&&e.length<=5)return;let o=Math.min(null==e?void 0:e[6],100-(null==e?void 0:e[7]))-100*n>=1;d(n<.05&&o)}if(i/t>l.video.width/l.video.height){let e=l.pcBlockedAreaRatio,n=(1-l.video.width/l.video.height*t/i)/2;if(!e){d(n<.05);return}if(e&&e.length<=5)return;let o=Math.min(100-(null==e?void 0:e[8]),null==e?void 0:e[9])-100*n>=1;d(n<.05&&o)}}},0);s();let u=eN.Z.bind(o.current,s);return()=>u()},[t,i,null==l?void 0:l.awemeId,n]),a},eM=(0,c.ZP)(()=>i.e("45937").then(i.bind(i,654402)),{ssr:!1,resolveComponent:e=>{let{More:l}=e;return l}}),eA=e=>{let{hotInfo:l}=e;return(0,o.jsx)("div",{className:d()(F.hotMask),children:(0,o.jsxs)("div",{className:F.hotBottomInfo,children:[(null==l?void 0:l.header)?(0,o.jsxs)("div",{className:F.hotCount,children:[(0,o.jsx)("img",{src:"//p-pc-weboff.byteimg.com/tos-cn-i-9r5gewecjs/hot.png",alt:"热点icon"}),(0,o.jsx)("span",{className:F.hotText,children:null==l?void 0:l.hotTitle})]}):null,(null==l?void 0:l.footer)?(0,o.jsx)("span",{className:d()(F.hotDuration,F.hotTextHide),children:null==l?void 0:l.footer}):null]})})};var eD=e=>{var l,i,a,c,B,U,H,G,Z,$,z,W,J,Y,q,X,K,Q,ee,el,ei,et;let{style:en,className:er,imageClassName:ed,imgClass:es,imageSkeletonClass:eu,imageBoxClassName:ec,cardInfoClassName:ev,cardIndex:em,description:ef,userName:e_,likesCount:eh,videoTime:eg,userHref:ep,userHrefTarget:eI,imgUrl:ej,onClick:eL,onShow:ek,onMouseEnter:eS,onMouseLeave:eE,width:eN=0,height:eP=0,showLikes:eD=!0,fakeHorizontalInfo:eO,previewUrlList:eV,isHorizontal:eF,showIntegrationTag:eB,showHomeNote:eU,showHomeHot:eH,awemeInfo:eG,showHotInfo:eZ,hotInfo:e$,url:ez,isSpider:eW,debugInfo:eJ,appendPlayerConfig:eY,showHighLightTag:eq=!1,isShowCreateTime:eX=!1,isShowDescription:eK=!0,blurLightCover:eQ=!1,isNameFirst:e0=!1,willJump:e1=!1,videoInteractionTags:e2=[],showProgressBar:e3,onVideoPlaying:e5,onVideoStopped:e6,coverMask:e4,onVideoImageMouseEnter:e7,onVideoImageMouseLeave:e8,onLoadedData:e9,tab:le,videoImageStyle:ll,showImageInSSR:li,forceContainerCover:lt=!1,renderExtension:ln,useStyleInUserLink:lo=!1,children:lr,onCoverLoad:la,videoImageHeight:ld,videoImageWidth:ls,videoImagePriority:lu,decoding:lc,scene:lv,user:lm,abTestData:lf,enableNotePreview:l_,needOperateHidden:lh,hasNoFollow:lg,isBigCard:lp=!1,isTopCard:lw=!1,isTopCardActive:lC,topAwemeId:lx,showMore:lb=!1,showWatchLater:lI,logParams:ly,imageReady:lj,enableCardHoverPreview:lL=!1,onMorePopperShow:lk,onMorePopperHidden:lT,withBlurBg:lS,disabledALink:lE,enableImageX:lN,scrollContainerRef:lP,reuseConfig:lR,onClickAiEntry:lM,onClickPipIcon:lA,isModalPlayingCurrentVideo:lD}=e,{isListenVideoMiniWin:lO}=(0,k.Iq)(e=>{let{isListenVideoMiniWin:l}=e;return{isListenVideoMiniWin:l}}),[lV,lF]=(0,r.useState)(!1),lB=(0,r.useRef)(null),lU=(0,r.useRef)(null),[lH,lG]=(0,r.useState)(eh),[lZ,l$]=(0,r.useState)(null!==(ei=null===(i=S.Le.getConfig(S.gI.CollectStatusCache))||void 0===i?void 0:null===(l=i[null==eG?void 0:eG.awemeId])||void 0===l?void 0:l.count)&&void 0!==ei?ei:null==eG?void 0:null===(a=eG.stats)||void 0===a?void 0:a.collectCount),[lz,lW]=(0,r.useState)(null!==(et=null===(U=S.Le.getConfig(S.gI.FollowStatusCache))||void 0===U?void 0:null===(c=U[null==eG?void 0:null===(B=eG.authorInfo)||void 0===B?void 0:B.uid])||void 0===c?void 0:c.followStatus)&&void 0!==et?et:null==eG?void 0:null===(H=eG.authorInfo)||void 0===H?void 0:H.followStatus),[lJ,lY]=(0,r.useState)(!1),[lq,lX]=(0,r.useState)({cover:{done:!1,success:!1},node:!1}),[lK,lQ]=(0,r.useState)(!1),{isPipPlaying:l0,handleClickPipIcon:l1}=eb({awemeInfo:eG,isModalPlayingCurrentVideo:lD,onClickPipIcon:lA}),l2=lK||l0,[l3,l5]=(0,r.useState)(!1),[l6,l4]=(0,r.useState)(!1),l7=(0,r.useRef)(0),l8=r.useMemo(()=>{var e,l,i;return`/root/live/${null===(i=eG.authorInfo)||void 0===i?void 0:null===(l=i.roomData)||void 0===l?void 0:null===(e=l.owner)||void 0===e?void 0:e.web_rid}`},[null===($=eG.authorInfo)||void 0===$?void 0:null===(Z=$.roomData)||void 0===Z?void 0:null===(G=Z.owner)||void 0===G?void 0:G.web_rid]),l9=r.useCallback(()=>{if(l8){var e,l,i,o,r,a,d,s,u;let c=`${l8}?${f.stringify((0,n._)((0,t._)({},ly),{anchor_id:null===(i=eG.authorInfo)||void 0===i?void 0:null===(l=i.roomData)||void 0===l?void 0:null===(e=l.owner)||void 0===e?void 0:e.id_str,web_rid:null===(r=eG.authorInfo.roomData)||void 0===r?void 0:null===(o=r.owner)||void 0===o?void 0:o.web_rid,enter_from_merge:"web_homepage_discover",enter_method:"web_video_card",enter_method_temai:"web_video_card",action_type:"click",room_id:eG.authorInfo.roomId,request_id:null==eG?void 0:eG.logPb,live_position:em,__is_replaced_live__:(null==eG?void 0:eG.__is_replaced_live__)?"1":"0"}))}`;(0,L.X)({href:c,reusePlayer:0,webRid:null===(s=eG.authorInfo)||void 0===s?void 0:null===(d=s.roomData)||void 0===d?void 0:null===(a=d.owner)||void 0===a?void 0:a.web_rid,abtestData:lf,roomId:null===(u=eG.authorInfo)||void 0===u?void 0:u.roomId,usePreCreate:!0})}},[l8,ly,null===(J=eG.authorInfo)||void 0===J?void 0:null===(W=J.roomData)||void 0===W?void 0:null===(z=W.owner)||void 0===z?void 0:z.web_rid,null===(X=eG.authorInfo)||void 0===X?void 0:null===(q=X.roomData)||void 0===q?void 0:null===(Y=q.owner)||void 0===Y?void 0:Y.id_str,null===(Q=eG.authorInfo.roomData)||void 0===Q?void 0:null===(K=Q.owner)||void 0===K?void 0:K.web_rid,eG.authorInfo.roomId,null==eG?void 0:eG.logPb]),{isAuthorLiving:ie,handleJumpToLiveRoom:il,liveParams:ii}=ey(eG,em,l9);(0,u.C)(T.w3.components.video_card);let it=(0,r.useMemo)(()=>(null==eG?void 0:eG.createTime)>0?(0,E.MH)((null==eG?void 0:eG.createTime)*1e3):"",[null==eG?void 0:eG.createTime]),io=(0,_.Y)(()=>{h.logInstance.sendLog("postTimeShow",{enter_from:(0,N.mo)(),group_id:eG.awemeId,post_time:it})});(0,r.useEffect)(()=>{let e=x.a.addCb(e=>{var l,i,t;let{action:n,diggCount:o,awemeId:r,actionUid:a,followStatus:d,collectCount:s}=e;(null==eG?void 0:eG.awemeId)===r&&(lG((0,E.qe)(null!=o?o:null==eG?void 0:null===(i=eG.stats)||void 0===i?void 0:i.diggCount)),l$(null!=s?s:null==eG?void 0:null===(t=eG.stats)||void 0===t?void 0:t.collectCount)),("follow"===n||"unFollow"===n)&&a===(null==eG?void 0:null===(l=eG.authorInfo)||void 0===l?void 0:l.uid)&&lW(d)});return()=>{e()}},[eG]);let ir=(0,m.Z)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!!lw)P.emit(P.EVENT.JingxuanTopCard,{action:"topCardReplace",awemeId:lx,cancelReplace:e})}),ia=(0,_.x)(()=>lX(e=>(0,n._)((0,t._)({},e),{node:!0})));(0,r.useEffect)(()=>{lq.node&&(null==ek||ek())},[lq.node,ek]);let id=(0,r.useCallback)(e=>{let l=void 0===e||e;lX(e=>(0,n._)((0,t._)({},e),{cover:{success:l,done:!0}}))},[ej]);(0,r.useEffect)(()=>{if(!!lq.cover.done&&!!lq.node)null==la||la(lq.cover.success,ej)},[lq.cover.done,lq.node,lq.cover.success,la,ej]);let is=eq&&(null==eG?void 0:eG.insertId),iu=eq&&(0,R.F)(lz)&&!is,ic=eq&&lz!==g.$u.FollowEach&&lz!==g.$u.Followed&&!is&&(null==e2?void 0:e2[0]),iv=()=>{e8&&e8(),null==eE||eE()},im=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!l2&&lL){let e=A.mouseEnter(ia.current,()=>{var e,l;lL&&(null==im||null===(l=im.current)||void 0===l||null===(e=l.enter)||void 0===e||e.call(l))},!0),l=A.mouseLeave(ia.current,()=>{var e,l;lL&&(null==im||null===(l=im.current)||void 0===l||null===(e=l.leave)||void 0===e||e.call(l))});return()=>{e(),l()}}},[l2,lL]);let i_=(0,r.useRef)({is_first_large_card_outflow:lp?1:0});i_.current.is_first_large_card_outflow=lp?1:0;let ih=eR({awemeInfo:eG,isBigCard:lp,scene:lv,ref:ia}),{isiPad:ig}=(0,p.X)(),ip="discover"===lv,iw=ip&&!!(null==lf?void 0:lf.themeColorOptimize)&&!lp,iC=(0,r.useCallback)(()=>{lQ(!0)},[]),ix=(0,r.useCallback)(()=>{lQ(!1)},[]),ib=(0,r.useCallback)(()=>{clearTimeout(l7.current),l4(!0)},[]),iI=(0,r.useCallback)(()=>{clearTimeout(l7.current),l7.current=setTimeout(()=>{l4(!0)},250)},[]),iy=(0,r.useCallback)(()=>{var e,l;l5(!0),null==im||null===(l=im.current)||void 0===l||null===(e=l.leave)||void 0===e||e.call(l),lF(!0)},[]),ij=(0,r.useCallback)(()=>{l5(!1),lF(!1)},[]),iL=(0,r.useCallback)(()=>{lF(!0)},[]);return(0,r.useMemo)(()=>({is_first_large_card_outflow:lp?1:0}),[lp]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(b.B,{target:"_blank",rel:`noopener noreferrer${lg?" nofollow":""}`,href:ez,isNeedSeoOpt:!0,className:d()(F.videoCard,er,{[F.hover]:l6,otherVideoCard:!ip,[F.bigCard]:lp,[F.isBigCardCutVideo]:ih}),style:en,onClick:e=>{!e1&&e.preventDefault(),null==eL||eL(e),null==iv||iv()},isUseALink:!lE&&(null==eG?void 0:eG.isHighQuality)!==w.HighQualityStatus.NotHighQuality,onMouseEnter:ig?void 0:()=>{clearTimeout(l7.current),l4(!0)},onMouseLeave:ig?void 0:()=>{l7.current=setTimeout(()=>{l4(!1)},250)},children:[(0,o.jsxs)("div",{ref:ia,className:F.flexColumn,children:[(0,o.jsxs)(ea,{abTestData:lf,onMouseEnter:()=>{e7&&e7(),null==eS||eS(),S.Le.setConfig(S.gI.VideoCardMouseOverTime,Date.now()),h.logInstance.sendLog("coverMouseover",{enter_from_merge:(0,M.yW)(),request_id:null==eG?void 0:eG.logPb,content_sdk:"video",group_id:null==eG?void 0:eG.awemeId,aweme_type:null==eG?void 0:eG.awemeType})},onMouseLeave:iv,className:d()(ec,{[F.report]:ip&&!l3&&lK}),imageClassName:d()(F.videoImg,{[F.imgAspectRatio]:ip},ed),imgClass:es,imageSkeletonClass:eu,imgUrl:ej,debugInfo:(null==eG?void 0:eG.debugInfo)||eJ,width:eN,height:eP,videoImageWidth:ls,videoImageHeight:ld,priority:lu,decoding:lc,fakeHorizontalInfo:eO,appendPlayerConfig:eY,previewUrlList:eV,awemeInfo:eG,isHorizontal:eF,onLoadedData:e9,onVideoPlaying:e5,onVideoStopped:e6,onPreviewChange:e=>{e?lY(!0):lY(!1)},showProgressBar:e3,isSpider:eW,alt:(0,D.vU)()?"":ef,style:ll,showImageInSSR:li,logParams:(0,t._)({awemeInfo:eG,tab_name:le||""},ly),forceContainerCover:lt,renderExtension:ln,onImgLoad:id,scene:lv,blurLightCover:eQ,user:lm,onRef:e=>lB.current=e,disablePreview:l2,disableByMoreAction:lK,enableNotePreview:l_,needOperateHidden:lh,isBigCard:lp,isTopCard:lw,topAwemeId:lx,showWatchLater:lI,tab:le,imageReady:lj,ref:im,enableCardHoverPreview:lL,canCancleWatchLaterOnPreview:ip,withBlurBg:lS,withBlurBgPerf:ip,enableImageX:lN,scrollContainerRef:lP,reuseConfig:lR,showAiEntry:ip,onClickAiEntry:lM,onClickPipIcon:l1,isPipPlaying:l0,dislikeCoverVisible:l3,isTopCardActive:lC,useOuterProgress:iw,forceHiddenOuterProgress:lV,children:[(0,o.jsx)(e=>(0,o.jsx)("div",{className:d()(F.coverBg)}),{slot:eo.Inner}),!l2&&(0,o.jsx)(ew,{scene:lv,showIntegrationTag:eB,showTime:!eU,showLikes:eD,likes:lH,time:eg,slot:eo.Inner,awemeInfo:eG,showHomeNote:eU}),eZ&&e$&&!lJ&&(0,o.jsx)(eA,{slot:eo.OutSide,hotInfo:e$}),(0,o.jsx)(e=>e4?(0,o.jsx)("div",{className:d()(F.coverMask),children:e4}):null,{slot:eo.OutSide})]}),(0,o.jsx)("div",{className:d()(F.cardInfo,ev),ref:lU,children:(0,o.jsxs)("div",{className:d()(F.cardInfoContainer,{[F.transparent]:ip&&lK}),children:[eK&&!e0&&(0,o.jsx)("div",{className:d()(F.decs),children:ef}),(0,o.jsxs)("div",{className:d()(F.userText,{[F.bottom]:e0}),onClick:e=>{if(ie){l9(),e.preventDefault(),e.stopPropagation();return}},children:[ip?(0,o.jsxs)("span",{className:F.userTextContent,onClick:e=>{var l;if(lO&&v.T.exit(),e.preventDefault(),e.stopPropagation(),ie){l9();return}null===(l=window)||void 0===l||l.open(ep,(0,O.DT)()?"_blank":eI,"noopener")},children:[(0,o.jsxs)("span",{className:d()(F.text,{[F.marginRight]:!iu&&!ic&&!is&&!eX}),children:["@",(0,o.jsx)("span",{className:F.userName,children:e_})]}),eX&&!ie&&!ic&&!is&&!iu&&(0,o.jsxs)("span",{className:d()(F.createTime,{[F.hasMarginRight]:lb}),ref:io,children:["\xa0\xb7\xa0",it]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("span",{onClick:e=>{var l;if(lO&&v.T.exit(),e.preventDefault(),e.stopPropagation(),ie){l9();return}null===(l=window)||void 0===l||l.open(ep,(0,O.DT)()?"_blank":eI,"noopener")},className:d()(F.text,{[F.marginRight]:!iu&&!ic&&!is&&!eX}),children:[(0,o.jsx)("span",{className:d()(F.at),children:"@"}),(0,o.jsx)("span",{className:d()(F.userName),children:e_})]}),eX&&!ie&&!ic&&!is&&!iu&&(0,o.jsx)("span",{className:d()(F.createTime,{[F.hasMarginRight]:lb}),ref:io,children:` \xb7 ${it}`})]}),(iu||is)&&(0,o.jsx)(eC.R,{abTestData:lf,className:d()(ie?F.highlightTagWithoutMarginRight:F.highlightTag,{[F.jxThemeColor]:ip&&!!(null==lf?void 0:lf.themeColorOptimize)}),type:is?"recommended":"follow"}),ic&&(0,o.jsx)(eC.R,{abTestData:lf,className:d()(F.highlightTag,{[F.jxThemeColor]:ip&&!!(null==lf?void 0:lf.themeColorOptimize)}),type:e2[0],count:{collect:lZ,comment:null==eG?void 0:null===(ee=eG.stats)||void 0===ee?void 0:ee.commentCount}[e2[0]]||0}),ie&&(0,o.jsx)(eT,{onClick:e=>{e.preventDefault(),e.stopPropagation(),h.logInstance.sendLog("liveCardClickEvent",(0,t._)({enter_method:"web_video_card",enter_from_merge:"web_homepage_discover",action_type:"click"},ii));let l=I.e.getPipWindow({scene:C.d.ListenVideo})||I.e.getPipWindow({scene:C.d.WebVideo});l&&l.close(),l9()}}),lb&&(0,o.jsx)(s.SV,{Slardar:(0,V.f5)(),children:(0,o.jsx)(eM,{awemeInfo:eG,className:F.more,cardInfoContainerRef:lU,imageContainerRef:lB,onCoverHover:(null==lf?void 0:lf.innerSlideSmooth)?iC:()=>lQ(!0),onCoverCancelHover:(null==lf?void 0:lf.innerSlideSmooth)?ix:()=>lQ(!1),user:lm,tab:le,onMouseEnter:(null==lf?void 0:lf.innerSlideSmooth)?ib:()=>{clearTimeout(l7.current),l4(!0)},onMouseLeave:(null==lf?void 0:lf.innerSlideSmooth)?iI:()=>{clearTimeout(l7.current),l7.current=setTimeout(()=>{l4(!0)},250)},logParams:i_.current,enableCardHoverPreview:lL||ip,onPopperShow:lk,onPopperHidden:lT,onDislikeCoverShow:(null==lf?void 0:lf.innerSlideSmooth)?iy:()=>{var e,l;l5(!0),null==im||null===(l=im.current)||void 0===l||null===(e=l.leave)||void 0===e||e.call(l),lF(!0)},onDislikeCoverHidden:(null==lf?void 0:lf.innerSlideSmooth)?ij:()=>{l5(!1),lF(!1)},onReportCoverShow:(null==lf?void 0:lf.innerSlideSmooth)?iL:()=>{lF(!0)},onReplaceTopCard:ir})})]}),eK&&e0&&(0,o.jsx)("div",{className:d()(F.decs),children:ef}),eH&&(0,o.jsxs)("div",{className:F.barContainer,children:[(0,o.jsx)(y.Z,{className:F.barIcon,width:12,height:12,viewBox:"0 0 12 12",src:ex}),(0,o.jsxs)("span",{className:F.barText,children:["热榜：",null==eG?void 0:null===(el=eG.hotList)||void 0===el?void 0:el.title]})]})]})})]}),lr]}),eW&&(0,o.jsx)(j.a,(0,n._)((0,t._)({style:lo?(0,n._)((0,t._)({},en),{width:"auto",height:"auto"}):{},href:ep,target:"_blank",isNeedSeoOpt:!0},lg?{rel:"nofollow"}:{}),{children:e_}))]})}},21202:function(e,l,i){i.r(l),i.d(l,{default:function(){return tM}}),i("874386"),i("250440"),i("882732"),i("544943");var t=i("563097"),n=i("88648"),o=i("553542"),r=i("465571"),a=i("35385"),d=i("317914"),s=i("782563"),u=i("616520"),c=i("89435"),v=i("392323"),m=i("297769"),f=i("520739"),_=i("878389");i("675373"),i("50013"),i("268917");var h=i("567754"),g=i("713097"),p=i.n(g),w=i("309931"),C=i("909543"),x=i("747909"),b=i("338426"),I=i("134761"),y=i("581708"),j=i("948375"),L=i("172589"),k=i("56906"),T=i("651019"),S=i("77711");let E=(0,n.createContext)(null);class N{updateState(e,l){if(void 0!==e.container&&(this.container=e.container),void 0!==e.playParams){var i,t;this.playParams=(0,_._)((0,f._)({},this.playParams,e.playParams),{playerConfig:(0,_._)((0,f._)({},null===(i=this.playParams)||void 0===i?void 0:i.playerConfig,null===(t=e.playParams)||void 0===t?void 0:t.playerConfig),{onPlay:()=>{var l,i;this.isPlaying=!0,null===(i=e.playParams.playerConfig)||void 0===i||null===(l=i.onPlay)||void 0===l||l.call(i)},onPause:()=>{var l,i;this.isPlaying=!1,null===(i=e.playParams.playerConfig)||void 0===i||null===(l=i.onPause)||void 0===l||l.call(i)},onEnd:()=>{var l,i;this.isPlaying=!1,null===(i=e.playParams.playerConfig)||void 0===i||null===(l=i.onEnd)||void 0===l||l.call(i)}})})}void 0!==e.isPlaying&&(this.isPlaying=e.isPlaying),null==l||l(),this.lastUsed=Date.now()}clearVideoClasses(){var e,l,i;let t=null===(i=this.ref)||void 0===i?void 0:null===(l=i.current)||void 0===l?void 0:null===(e=l.getPlayer)||void 0===e?void 0:e.call(l);(null==t?void 0:t.video)&&(t.video.className="")}assignTo(e,l){this.updateState({container:e,playParams:l,isPlaying:!0},void 0)}release(){this.updateState({container:null,playParams:null,isPlaying:!1},void 0)}isAvailable(){return null===this.container}pause(){this.updateState({isPlaying:!1},()=>{var e,l;let i=null===(e=this.ref.current)||void 0===e?void 0:e.getPlayer();null==i||null===(l=i.pause)||void 0===l||l.call(i)})}play(){this.updateState({isPlaying:!0},()=>{var e,l,i;let t=null===(e=this.ref.current)||void 0===e?void 0:e.getPlayer();null==t||null===(l=t.resetState)||void 0===l||l.call(t),null==t||null===(i=t.play)||void 0===i||i.call(t).catch(()=>{})})}constructor(e){(0,I._)(this,"id",void 0),(0,I._)(this,"container",void 0),(0,I._)(this,"playParams",void 0),(0,I._)(this,"isPlaying",void 0),(0,I._)(this,"lastUsed",void 0),(0,I._)(this,"ref",void 0),this.id=e,this.container=null,this.playParams=null,this.isPlaying=!1,this.lastUsed=Date.now(),this.ref=n.createRef()}}class P{addActiveListener(e){this.activeListeners.add(e)}removeActiveListener(e){this.activeListeners.delete(e)}notifyActiveChange(){let e=this.getActiveInstances();this.activeListeners.forEach(l=>l(e))}getInstanceByContainer(e){return this.instances.find(l=>l.container===e)}assignInstance(e,l){let i=this.getInstanceByContainer(e);if(i)return i.clearVideoClasses(),i.assignTo(e,l),this.notifyActiveChange(),i;let t=this.instances.find(e=>e.isAvailable());if(t)return t.clearVideoClasses(),t.assignTo(e,l),this.notifyActiveChange(),t;let n=new N(`player_${Date.now()}`);return n.assignTo(e,l),n.clearVideoClasses(),this.instances.push(n),this.notifyActiveChange(),n}pause(e){let l=this.getInstanceByContainer(e);l&&l.pause()}release(e){let l=this.getInstanceByContainer(e);l&&(l.release(),this.notifyActiveChange())}getActiveInstances(){return this.instances.filter(e=>!e.isAvailable())}cleanupIdleInstances(){let e=Date.now();this.instances=this.instances.filter(l=>(!l.isAvailable()||!(e-l.lastUsed>3e4))&&!0)}startCleanupTimer(){!this.cleanupInterval&&(this.cleanupInterval=setInterval(()=>{this.cleanupIdleInstances()},1e4))}stopCleanupTimer(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)}clearAll(){this.instances=[],this.stopCleanupTimer(),this.notifyActiveChange()}constructor(){this.instances=[],this.cleanupInterval=null,this.activeListeners=new Set}}let R=(0,n.memo)(e=>{let{playerPool:l,instance:i,plugins:o}=e,{container:r,playParams:a,ref:d}=i,{playerConfig:s,style:u,pluginSchema:c={}}=a||{};n.useRef(0);let v=n.useRef(!1);return(n.useEffect(()=>{var e,l,i,t,n,o,a;!(null==d?void 0:null===(t=d.current)||void 0===t?void 0:null===(i=t.getPlayer())||void 0===i?void 0:null===(l=i._core)||void 0===l?void 0:null===(e=l._src)||void 0===e?void 0:e.includes(null==s?void 0:s.url))&&!v.current&&r&&(v.current=!0,null==d||null===(a=d.current)||void 0===a||null===(o=a.getPlayer())||void 0===o||null===(n=o.retry)||void 0===n||n.call(o))},[r]),r&&a)?(0,w.createPortal)((0,t.jsx)(n.Fragment,{children:(0,t.jsxs)(y.N,(0,_._)((0,f._)({className:"liveCardPlayer",style:(0,f._)({height:"100%"},u),ref:e=>{d.current={getPlayer:()=>null==e?void 0:e.player,getPlayerLogger:()=>null==e?void 0:e.logger}},role:"consumer"},s),{children:[c&&Object.entries(c).map(e=>{let[l,i]=e,n=o[l];return n?(0,t.jsx)(n,(0,f._)({},i.props),l):null}),(0,t.jsx)(S.h,{source:"LiveCardPlayer"})]}))},i.id),r):null}),M=(0,n.memo)(e=>{let{playerPool:l,plugins:i}=e,[o,r]=(0,n.useState)([]);return(0,n.useEffect)(()=>{let e=e=>{r(e)};return l.addActiveListener(e),r(l.getActiveInstances()),()=>{l.removeActiveListener(e)}},[l]),(0,t.jsx)(t.Fragment,{children:o.map(e=>(0,t.jsx)(n.Fragment,{children:(0,t.jsx)(R,{playerPool:l,instance:(0,f._)({},e),plugins:i})},`${e.id}`))})}),A=e=>{let{children:l}=e,i=(0,n.useRef)(new P),o=(0,n.useRef)({VipLiveBoundaryPlugin:L.VipLiveBoundaryPlugin,LinkMicPreviewPlugin:k.$,AdaptedBySEIPlugin:T.AdaptedBySEIPlugin});(0,n.useEffect)(()=>(i.current.startCleanupTimer(),()=>i.current.stopCleanupTimer()),[]);let r=(0,j.Z)(e=>{o.current=(0,f._)({},o.current,e)}),a=(0,j.Z)((e,l)=>e?i.current.assignInstance(e,l):null),d=(0,j.Z)(e=>{try{i.current.pause(e),i.current.release(e)}catch(e){}}),s=(0,j.Z)(e=>i.current.getInstanceByContainer(e)),u=(0,j.Z)(()=>{i.current.clearAll()});(0,n.useEffect)(()=>()=>{u()},[]);let c=(0,n.useMemo)(()=>({play:a,pause:d,getInstance:s,clearAllPlayers:u,plugins:o.current,registerPlugin:r}),[]);return(0,t.jsxs)(E.Provider,{value:c,children:[l,(0,t.jsx)(M,{playerPool:i.current,plugins:o.current})]})};var D=i("222406"),O=i("916956"),V=i("598467"),F=i("147613"),B=i("720359"),U=i("823685"),H=i("452894"),G=i("205457"),Z=i("53289"),$=i("301061"),z=i("637005"),W=i("30321"),J=i("782442"),Y=i("801849"),q=i("913807"),X=i("431811"),K=i("708034"),Q=i("424944"),ee=i("734017"),el=i("385976"),ei=i("475343"),et=i("901414"),en=i("870105"),eo=i("650963"),er=i("988634");let ea=()=>Promise.all([i.e("92432"),i.e("97718"),i.e("16970")]).then(i.bind(i,79383)),ed=(0,n.forwardRef)(function(e,l){return(0,t.jsx)(er.o,(0,f._)({innerRef:l,id:"island_79fa5",load:ea},e))});var es=i("273329"),eu=i("75791"),ec={waterfallPage:"J3t3MiSx",waterfallPageWithSubTab:"lg5aZGLT",topicPage:"yw47L6dp",topicPageWithDiscoverCardOptimize:"ENZJYd9Y",feedTitle:"VjU1fbw5",wrapperMarin:"T1Z8UGmI",bannerContainer:"wJYo7lH3",tabs:"NBzonCuX",switchBtn:"DCiV3oEY",hasTabExpand:"zSXa7kMD",hasSubList:"ekig2YD4",jxThemeColor:"vIoCbNLX",tabPanelCt:"_IHwSGRR",discoverTabBar:"Udp77Cqy",subTabStickyContainer:"z4HYz8IX",subTag:"JzQoT6Su",active:"nxoIfbTv",loadingContainer:"sIvwyIT6",hidden:"IBffRJCQ"},ev=i("419105");i("237819"),i("819117");var em=i("729532"),ef=i("738363"),e_=i("459633"),eh=i("811183"),eg=i("682644"),ep=i("295471");i("110006"),i("826893");var ew=i("456128"),eC=i("649368"),ex=i("88961"),eb=i("544933");let eI=new eb.h({subTabLiveShow:{eventName:"discover_sub_tab_live_show",params:{order:0,link:"",id:"",title:""}},subTabLiveClick:{eventName:"discover_sub_tab_live_click",params:{order:0,link:"",id:"",title:""}}});var ey="d39TlVx6",ej="DYLEJdv_",eL="ticjC6SX",ek="CCF1EZHU",eT="mXDA3PHe",eS="zFkGFrJ1",eE="ZKoWQCVw",eN="eAblXhYC",eP="fclP7dde",eR="FEv4lfuG";let eM=e=>{let{cardLiveInfo:l,cardStyle:i}=e,{live_title:o,live_cover:r,live_btn:a,live_link:d,live_idx:s}=l||{},[u,c]=function(e){let[l,i]=(0,ex.Z)(),t=(0,n.useRef)(!1);return!t.current&&i&&(e&&e(),t.current=!0),[l,i]}(()=>{var e,l;eI.sendLog("subTabLiveShow",{title:o,link:d,order:s,id:null==d?void 0:null===(l=d.match)||void 0===l?void 0:null===(e=l.call(d,/\d+/))||void 0===e?void 0:e[0]})}),v=e=>{var l,i;window.open(e,"_blank","noopener"),eI.sendLog("subTabLiveClick",{title:o,link:e,order:s,id:null==e?void 0:null===(i=e.match)||void 0===i?void 0:null===(l=i.call(e,/\d+/))||void 0===l?void 0:l[0]})};return(0,t.jsxs)("div",{className:p()(ey,{[eR]:"with-background"===i}),onClick:e=>{e.stopPropagation(),v(d)},ref:u,children:[(0,t.jsx)("div",{className:ej,children:(0,t.jsx)(ew.Q,{imgClass:eT,className:ek,src:r,iconWidth:24,iconHeight:28,showImageInSSR:!1,imageReady:!0,skeletonClass:eL})}),(0,t.jsxs)("div",{className:eS,children:[(0,t.jsx)("div",{className:eE,onClick:e=>{e.stopPropagation(),v(d)},children:o}),(0,t.jsx)("div",{className:eN,children:(0,t.jsxs)("span",{className:eP,onClick:e=>{e.stopPropagation(),v(d)},children:[a,(0,t.jsx)(eC.Z,{})]})})]})]})};var eA={CardAd:"card_ad",SubTabLive:"sub_tab_live"};i("284961");var eD=i("128231"),eO=i.n(eD),eV=i("746864"),eF=i("77726"),eB=i("831202"),eU=i("367366"),eH=i("123869"),eG=i("609774"),eZ=i("427283"),e$=i("380755"),ez=i("902845"),eW={waterfallWrapper:"y5ITbwZt",noScrollParent:"xtJZF6iO",waterfallContainer:"priTOakK",skeletonContainer:"sz5zXBaj",item:"Xyhun5Yc",contentVisible:"G7eFnmxX",emptyItem:"pAWPzs6W",placeHolder:"jXX0YrFq",imgBox:"kYbKtTlb",infoBox:"URyB53nF",opBtn:"qUv8LssR",noMoreText:"LKdPHpfD"};let eJ=ef.ERROR_CODE,eY=e=>{let{statusCode:l,isGaiaTab:i}=e;if(i)return(0,t.jsx)(ez.nl,{title:"活动已下线"});switch(l){case eJ.ERROR_404:return(0,t.jsx)(ez.dR,{title:"暂无更多数据",desc:" "});case eJ.ERROR_502:case eJ.ERROR_NO_NETWORK:return(0,t.jsx)(ez.oO,{});default:return(0,t.jsx)(ez.nl,{})}},eq=e=>{let{reload:l,statusCode:i,className:n}=e,o=i===eJ.ERROR_502?"超时":"异常";return(0,t.jsxs)("div",{className:p()(eW.noMoreText,n),children:["服务",o,"，重新",(0,t.jsx)("span",{onClick:l,className:eW.opBtn,children:"刷新"}),"拉取数据"]})};var eX=i("372311"),eK=e=>{let{containerClassName:l}=e,i=(0,n.useMemo)(()=>Array(60).fill({id:"skeleton"}),[]);return(0,r.C)(d.w3.components.discover_skeleton_component),(0,t.jsx)("div",{className:p()(eW.waterfallContainer,eW.skeletonContainer,l),children:i.map((e,l)=>(0,t.jsx)("div",{className:p()(eW.item),children:(0,t.jsx)(eX.P,{className:eW.placeHolder,imgBoxClassName:eW.imgBox,infoBoxClassName:eW.infoBox,useNewLogo:!0})},`${null==e?void 0:e.id}_${l}`))})},eQ={LOADING:0,0:"LOADING",SUCCESS:1,1:"SUCCESS",FAILED:2,2:"FAILED"},e0={LOADING:0,0:"LOADING",SUCCESS:1,1:"SUCCESS",FAILED:2,2:"FAILED"};let e1=4/3;var e2=n.forwardRef((e,l)=>{let{renderItem:i,fetchStatus:o,showDataList:a,containerClassName:s,statusCode:u,onload:c,update:v,reload:m,onCoverShow:f,abTestData:_={},setLoadingElement:h,setWaterfallContainer:g,showReplaceLoading:w}=e,C=(0,n.useRef)(!1),x=(0,n.useRef)(0),[b,I]=(0,n.useState)(0);return(0,r.C)(d.w3.components.discover_success_component),(0,n.useEffect)(()=>{(null==_?void 0:_.discoverTaskOptimize)||I(a.length),a.length&&!C.current&&(C.current=!0,null==c||c())},[a,c,_]),(0,n.useEffect)(()=>{let e=(null==_?void 0:_.discoverTaskOptimize)?a.length:b;e!==x.current&&(x.current=e,null==v||v())},[b,v,a,_]),(0,t.jsxs)(G.k,{componentName:"SuccessComponent",children:[(0,t.jsx)("div",{className:p()(eW.waterfallContainer,s),ref:e=>{l.current=e,g(e)},children:null==a?void 0:a.map((e,n)=>{var o,r,d;let{id:s,displayId:u,render:c,inView:v}=e,m=(null==a?void 0:null===(o=a[0])||void 0===o?void 0:o.isTopCard)?null==a?void 0:null===(r=a[0])||void 0===r?void 0:r.awemeId:"";return(0,t.jsx)("div",{className:p()(eW.item,"discover-video-card-item",eW.contentVisible,{[eW.emptyItem]:!v}),id:s,"data-aweme-id":null!==(d=null==e?void 0:e.awemeId)&&void 0!==d?d:"",style:{backgroundColor:e.bgColor},children:v?c?null==c?void 0:c(e):null==i?void 0:i(e,f,void 0,n,l,m):null},u||s)})}),(0,t.jsx)("div",{ref:e=>{e&&(null==h||h(e))},children:!w&&o===e0.LOADING&&(0,t.jsx)($.gb,{})}),o===e0.FAILED&&(0,t.jsx)(eq,{reload:m,statusCode:u})]})});i("527785");var e3=i("507217"),e5=new eb.h({waterfallSlideFeatureV2:{eventName:"waterfall_slide_feature_v2",params:{velocity:0}},waterfallSlideFeature:{eventName:"waterfall_slide_feature",params:{duration:0}},discoverSlide:{eventName:"discover_slide",params:{tab_name:"",sub_tab_name:"",direction:"down",gid_list:"",visit_id:""}},waterfallProcessStat:{eventName:"waterfall_process_stat",params:{enter_from:"",from:"",skeleton_show_time:0,waterfall_fetch_end:0,first_img_load_time:0,init_duration:0,data_duration:0,cover_duration:0}},waterfallLoadmoreStat:{eventName:"waterfall_loadmore_stat",params:{enter_from:"",duration:0}}});e3.FastSlowFeature.slow,e3.FastSlowFeature.fast;let e6={[e3.FastSlowFeature.normal]:150,[e3.FastSlowFeature.fast]:220};class e4{calcHeight(e){let l=this.scrollParentEl||this.waterfallWrapperRef.current;if(l){let{scrollTop:i}=l;if(!e){let e=i-this.preTop,l=Date.now()-this.preTime;this.addSimple({velocity:Math.abs(e/l*1e3)})}this.preTop=i,this.preTime=Date.now()}}onScroll(){this.calcHeight(!1)}init(){let e=this.scrollParentEl||this.waterfallWrapperRef.current;this.onScrollHandler=eO()(()=>{this.onScroll()},200),null==e||e.addEventListener("scroll",this.onScrollHandler),this.calcHeight(!0)}sendLog(){this.queue.length>=this.coldStartNumberThreshold&&e5.sendLog("waterfallSlideFeatureV2",{velocity:this.getFeatureVal()})}getFeatureType(){return this.featureType||e3.FastSlowFeature.normal}calcFeatureType(){let e;if(this.queue.length<this.coldStartNumberThreshold)return;let l=this.getFeatureVal();e=l>=e6[e3.FastSlowFeature.fast]?e3.FastSlowFeature.fast:l>=e6[e3.FastSlowFeature.normal]&&l<e6[e3.FastSlowFeature.fast]?e3.FastSlowFeature.normal:e3.FastSlowFeature.slow,this.featureType=e,J.Le.setConfig(J.gI.HomeFastSlowSlideFeature,e)}addSimple(e){if(!((null==e?void 0:e.velocity)<0))this.queue.length>=this.maxCacheCount&&this.deleteSimple(),this.queue.push(e),this.calcFeatureType(),this.sendLog()}deleteSimple(){this.queue.shift()}clearSimple(){this.queue=[]}getFeatureVal(){return this.queue.reduce((e,l)=>e+=l.velocity,0)/this.queue.length}destroy(){this.clearSimple();let e=this.scrollParentEl||this.waterfallWrapperRef.current;null==e||e.removeEventListener("scroll",this.onScrollHandler),this.onScrollHandler=null}constructor(e){(0,I._)(this,"maxCacheCount",void 0),(0,I._)(this,"coldStartNumberThreshold",void 0),(0,I._)(this,"queue",[]),(0,I._)(this,"timer",void 0),(0,I._)(this,"preTime",void 0),(0,I._)(this,"preTop",void 0),(0,I._)(this,"scrollParentEl",void 0),(0,I._)(this,"waterfallWrapperRef",void 0),(0,I._)(this,"featureType",e3.FastSlowFeature.normal),(0,I._)(this,"onScrollHandler",void 0);let{maxCacheCount:l,scrollParentEl:i,waterfallWrapperRef:t}=e;this.scrollParentEl=i,this.waterfallWrapperRef=t,this.maxCacheCount=l,this.coldStartNumberThreshold=2,this.preTop=0,this.preTime=0,this.onScroll=this.onScroll.bind(this)}}let e7=e=>{let{scrollParentEl:l,waterfallWrapperRef:i,abTestData:t}=e,o=(0,n.useRef)(null);(0,n.useEffect)(()=>{var e,n;return(null==t?void 0:null===(e=t.homeFastSlowSlide)||void 0===e?void 0:e.isOpen)?(o.current=new e4({maxCacheCount:5,scrollParentEl:l,waterfallWrapperRef:i}),null===(n=o.current)||void 0===n||n.init(),()=>{var e;null==o||null===(e=o.current)||void 0===e||e.destroy(),o.current=null}):()=>{}},[t,l,i])},e8=(e,l)=>{if(e){let{scrollTop:i,clientHeight:t,scrollHeight:n}=e;return i+t+l>n&&t>0}return!1},e9=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.filter((e,t)=>!(l.find(l=>l.id===e.id)||l.find(l=>l.awemeId===e.awemeId))&&(e.displayId=`${e.id}_${Date.now()}_${t}`,e.awemeType===eV.e.LiveCard&&(e.width=240,e.height=320),i&&e.awemeType===eV.e.Note&&(e.width=320,e.height=240,e.video.width=320,e.video.height=240),e.height&&e.width||e.ratio))},le=e=>{let l=[],i=[];null==e||e.forEach(e=>{e.awemeType===eV.e.LiveCard?l.push(e):i.push(e)});let t=l.map(e=>e.awemeId),n=l.map(e=>e.encodedAwemeId).filter(e=>void 0!==e),o=i.map(e=>e.awemeId);return{liveIds:t,liveEncodedIds:n,ids:o,encodedIds:i.map(e=>e.encodedAwemeId).filter(e=>void 0!==e)}};var ll=i("877639"),li=i.n(ll),lt=i("83288");let ln=e=>{var l,i,t,n;return(0,B.d)((null==e?void 0:e.jxAllowCache)&&(null==e?void 0:null===(l=e.jxCacheMode)||void 0===l?void 0:l.cache)&&(null==e?void 0:null===(i=e.jxCacheMode)||void 0===i?void 0:i.mode)===1&&(null==e?void 0:null===(t=e.jxCacheMode)||void 0===t?void 0:t.hotVV)&&(null==e?void 0:null===(n=e.jxCacheMode)||void 0===n?void 0:n.expire))};i("950331"),i("429532"),i("981168"),i("927234");let lo=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===l)return;let i=e[l];e.splice(l,1),e.unshift(i)},lr=e=>[eV.e.NewNormal,eV.e.Normal].includes(e.awemeType),la=e=>e.findIndex(lr),ld=e=>{var l,i,t,n;return e.webCardType?3:lr(e)&&(null==e?void 0:null===(l=e.video)||void 0===l?void 0:l.height)&&(null==e?void 0:null===(i=e.video)||void 0===i?void 0:i.width)&&(null==e?void 0:null===(t=e.video)||void 0===t?void 0:t.width)>(null==e?void 0:null===(n=e.video)||void 0===n?void 0:n.height)?1e-4>Math.abs(e.video.width/e.video.height-16/9)?2:1:0},ls=e=>{let l=0,i=-1;return e.forEach((e,t)=>{if(3===l)return;let n=ld(e);n>l&&(i=t,l=n)}),i},lu=(e,l)=>{var i;if(!(null==e?void 0:null===(i=e.awemeList)||void 0===i?void 0:i.length))return[];let t=e.awemeList.map(e=>Object.assign({},e,{inView:!0}));if(1===l){let e=la(t);e>=0&&(lo(t,e),t[0].isTopCard=!0)}else if(2===l){let e=ls(t);e>=0&&(lo(t,e),t[0].isTopCard=!0,t[0].isBigCard=!0)}return t};var lc=i("237652"),lv=i("349135"),lm=i("497730");i("413806");let lf=e=>{if(e.watchLaterInfo){var l,i,t;let{list:n=""}=null!==(l=J.Le.getConfig(J.gI.WatchLater))&&void 0!==l?l:{};if(!(n&&n.includes(e.awemeId))){let l=null!==(i=J.Le.getConfig(J.gI.WatchLater))&&void 0!==i?i:{},n=null!==(t=l.list)&&void 0!==t?t:"",o=Array.from(new Set([...n?n.split(","):[],e.awemeId]));J.Le.setConfig(J.gI.WatchLater,(0,_._)((0,f._)({},l),{list:o.join(",")}))}}},l_=ef.ERROR_CODE;function lh(e){var l,i,o,a;let{awemeIdsRef:u,fetchMore:c,fetchMoreDistance:m=3600,renderItem:_,abTestData:h,containerClassName:g,onListLoad:C,onError:x,children:b,scrollParentEl:I,scrollListenerEl:y=I,className:L,perfProps:k,firstBigCard:T=!1,isGaiaTab:S=!1,tagId:E,selectedTab:N,setLoadingElement:P,setShowReplaceLoading:R,showReplaceLoading:M}=e,[A,D]=(0,n.useState)(eQ.LOADING),[V,U]=(0,n.useState)(e0.LOADING),[H,G]=(0,n.useState)(0),Z=(0,n.useRef)(""),$=(0,n.useRef)(null),[W,Y]=(0,n.useState)(null),X=(0,B.d)(h),K=(0,B.d)(null==h?void 0:h.jingxuanModalAds),{homeFetchData:Q,updateSubTabLiveCardList:ee,updateFeedCardAdResourceList:el}=(0,e$.useDiscoverCommonContext)((0,eo.P1)(["homeFetchData","updateFeedCardAdResourceList","updateSubTabLiveCardList"])),ei=(0,n.useRef)([]),et=(0,n.useRef)([]),er=(0,n.useRef)([]),ea=(0,n.useRef)((null==Q?void 0:Q.isCourse)&&null!==(i=null==Q?void 0:Q.offset)&&void 0!==i?i:0),ed=(0,n.useRef)(0),es=(0,n.useRef)(!1),eu=(0,n.useRef)(e0.LOADING),ec=(0,n.useRef)(!1),ev=(0,n.useRef)(!0),em=(0,n.useRef)(null),ef=(0,n.useRef)(!1),e_=(0,n.useRef)(!1),eh=(0,n.useRef)(!1),eg=(0,n.useRef)(null),{showDataList:ep,isTopBigCard:ew,resetTopAweme:eC,renderList:ex,showAwemeList:eb,fetchDataListRef:eI,canLiveAutoPlay:ey,needReplaceTopCardRef:ej,onReplaceBigCard:eL,clearNeedReplaceTopCard:ek,topCardAb:eT}=function(e){var l,i,t;let{abTestData:o,selectedTab:r,isGaiaTab:a,tagId:d,scrollListenerEl:u,waterfallContainer:c,awemeIdsRef:v}=e,m=(0,B.d)(u),_=(0,n.useRef)({scrollHeight:0,scrollWidth:0,columnCount:0,itemHeight:0,itemWidth:0}),h=(null==o?void 0:o.jingxuanCover169)?1536:1850,g=(0,n.useRef)(!0),p=(0,n.useRef)(!1),w=(0,en.U)(),C=(0,B.d)(w),x=(0,n.useRef)(0),b=(0,n.useRef)(!1),{homeFetchData:I,finalFeedCardAdListMap:y,activeSubTab:L}=(0,e$.useDiscoverCommonContext)((0,eo.P1)(["homeFetchData","finalFeedCardAdListMap","activeSubTab"])),k=(0,n.useMemo)(()=>(null==o?void 0:o.jingxuanCover169)?24:20,[null==o?void 0:o.jingxuanCover169]),[T]=(0,n.useState)(null!==(t=null==o?void 0:o.jxTopCard)&&void 0!==t?t:0),S=lu(I,T),E=(0,n.useRef)(S),[N,P]=(0,n.useState)(S),R=(0,n.useRef)(T>0&&(!((null==S?void 0:S.length)>0)||(null===(l=S[0])||void 0===l?void 0:l.isTopCard))),M=(0,n.useRef)(2===T),[A,D]=(0,n.useState)(2===T),V=(0,n.useRef)(!1),[U,H]=(0,n.useState)(0===T||!R.current),G=(0,n.useRef)(!0),Z=(0,n.useMemo)(()=>(null==y?void 0:y[r])||[],[y,r]),$=(0,j.Z)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!m.current||!p.current||!c)return;let l=c.children[1],{height:i,width:t}=m.current.getBoundingClientRect(),{height:n,width:o}=l.getBoundingClientRect(),r=0,a=Array.from(c.children).slice(0,6).map(e=>e.getBoundingClientRect()),d=a.map(e=>e.top);d.forEach(l=>{l===d[0]&&(r+=0===r&&e&&Math.abs(a[0].width-a[1].width)>10?3:1)}),_.current={scrollHeight:i,scrollWidth:t,columnCount:r,itemHeight:n,itemWidth:o},g.current=!1}),W=(0,j.Z)(()=>{T>0&&(R.current=!0,V.current=!1,H(!1))}),Y=(0,j.Z)(e=>{if(0===T)return;if(!E.current.length){W();return}let l=E.current[0],i=l.isTopCard,t=l.isBigCard;if(!M.current&&2===T){t&&(l.isTopCard=!1,l.isBigCard=!1,W());return}if(!i&&R.current){let l=e?E.current.slice(e):E.current.slice(0,20),i=2===T?ls(l):la(l);if(-1===i)R.current=!1;else{lo(E.current,i+(e||0)),H(!1);let l=E.current[0];l.isTopCard=!0,l.isBigCard=2===T}}}),q=(0,j.Z)(e=>{Y(null==e?void 0:e.topCardStartIndex),P([...E.current]),v&&(v.current=E.current.map(e=>e.awemeId))}),X=(0,n.useMemo)(()=>{var e,l,i;let t=[...N],n=null===(e=t[0])||void 0===e?void 0:e.isTopCard,r=t.length,u=null==Z?void 0:Z.sort((e,l)=>e.order-l.order),c=n?1:0,v=0;null==u||u.forEach(e=>{let l=(0,f._)({itemType:eA.CardAd,inView:!0,displayId:e.id.toString()},e);if(!(e.order>r+1))t.splice(e.order+v-1+c,0,l),v++}),a&&t.length>0&&(null!==(i=null==L?void 0:null===(l=L.find(e=>e.id===Number(d)))||void 0===l?void 0:l.lives)&&void 0!==i?i:[]).forEach(e=>{let l=(0,f._)({itemType:eA.SubTabLive,inView:!0,displayId:e.live_title+e.live_idx},e);t.splice(e.live_idx-1+c,0,l)});let h=t.length>=100;return h!==p.current&&(p.current=h&&!(0,s.tq)()),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!m.current||!p.current)return(null==o?void 0:o.discoverTaskOptimize)?e.map(e=>(e.inView=!0,e)):e.map(e=>Object.assign({},e,{inView:!0}));let l=e[0].isBigCard;g.current&&$(l);let{columnCount:i,itemHeight:n,scrollHeight:r}=_.current,a=n+k,d=m.current.scrollTop;C.current?x.current=d:d=x.current;let s=Math.ceil(r/a),u=Math.floor(d/a)*i,c=Math.min(u+(s+1)*i,t.length),v=Math.max(u-2*i,0),f=c+2*i,h=e=>e>=v&&e<f;return e.map((e,t)=>{let n=!0;return(n=l?t>=i+3?h(t+5):0===t?h(0)||h(i):h(t+3):h(t),null==o?void 0:o.discoverTaskOptimize)?(e.inView=n,e):Object.assign({},e,{inView:n})})}(t)},[L,Z,N,k]);(0,O.C)(()=>{if(2===T){let e=innerWidth>=h;M.current=e,D(e),!M.current&&q()}},[h]),(0,n.useEffect)(()=>{!A&&!U&&H(!0)},[A,U]),(0,n.useEffect)(()=>{if(T>0){var e;if(null==X||!X[0]||(null==X?void 0:null===(e=X[0])||void 0===e?void 0:e.isTopCard))return z.listen(z.EVENT.JingxuanTopCard,e=>{var l;let{action:i,awemeId:t,canLiveAutoPlay:n}=e;if(t===(null==X?void 0:null===(l=X[0])||void 0===l?void 0:l.awemeId))"playEnd"===i?(V.current=!0,H(!0)):"liveAutoPlay"===i&&!V.current&&H(n)});H(!0)}},[null==X?void 0:null===(i=X[0])||void 0===i?void 0:i.awemeId]);let K=(0,n.useRef)(!1),Q=(0,j.Z)(e=>{if(!!(T>0)){if(1===T){R.current=!1,E.current[0].isTopCard=!1,q();return}2===T&&(K.current=!0,e())}}),ee=(0,j.Z)(e=>{if(!!K.current)K.current=!1,R.current=e,!e&&(R.current=!1,E.current=E.current.slice(1),q())}),el=(0,j.Z)(()=>{if(2===T){let e=innerWidth>=h;M.current=e,D(e)}g.current=!0,q()});return(0,F.o)(()=>{if(!u||!c)return;let e=eO()(()=>q(),100),l=eO()(()=>{var e;2===T&&(null===(e=J.Le.getConfig(J.gI.IsInModalVideo))||void 0===e?void 0:e.isInModal)?b.current=!0:null==el||el()},100);window.addEventListener("resize",l);let i=p.current;return i&&(null==u||u.addEventListener("scroll",e)),()=>{window.removeEventListener("resize",l),!i&&(null==u||u.removeEventListener("scroll",e))}},[u,c,null==X?void 0:X.length,el]),(0,F.o)(()=>{if(2===T)return z.listen(z.EVENT.exitModalVideo,()=>{b.current&&(b.current=!1,null==el||el())})},[el]),(0,F.o)(()=>{if(G.current){G.current=!1;return}null==el||el()},[el]),{showAwemeList:N,fetchDataListRef:E,showDataList:X,renderList:q,isTopBigCard:2===T&&A&&!!(!(null==X?void 0:X.length)||X[0].isBigCard),resetTopAweme:W,canLiveAutoPlay:U,needReplaceTopCardRef:K,onReplaceBigCard:Q,clearNeedReplaceTopCard:ee,topCardAb:T}}({abTestData:h,selectedTab:N,isGaiaTab:S,tagId:E,scrollListenerEl:y,waterfallContainer:W,awemeIdsRef:u}),eS=(0,B.d)(c),eE=0===H&&!eI.current.length&&A===eQ.LOADING,eN=(0,B.d)(eE);(0,r.C)(d.w3.components.discover_waterfall_comp),!function(e){var l,i,t,o;let{abTestData:r,showAwemeList:a,homeFetchData:d,selectedTab:s}=e,u=(0,B.d)((null==r?void 0:r.jxAllowCache)&&(null==r?void 0:null===(l=r.jxCacheMode)||void 0===l?void 0:l.cache)&&(null==r?void 0:null===(i=r.jxCacheMode)||void 0===i?void 0:i.mode)===1&&(null==r?void 0:null===(t=r.jxCacheMode)||void 0===t?void 0:t.expire)),c=(0,B.d)((null==r?void 0:null===(o=r.jxCacheMode)||void 0===o?void 0:o.expire)||0);(0,n.useEffect)(()=>{var e,l,i,t;let n=u.current&&"undefined"!=typeof TextEncoder,o=s&&eZ.Xq.includes(s);if(!!n&&!!o&&((null==d?!void 0:null===(e=d.awemeList)||void 0===e?!void 0:!e.length)||(null==d?void 0:null===(i=d.awemeList)||void 0===i?void 0:null===(l=i[0])||void 0===l?void 0:l.awemeId)!==(null==a?void 0:null===(t=a[0])||void 0===t?void 0:t.awemeId)))(0,lt.J9)({tagId:s,originalList:a,expireS:c.current,redisMode:"replace"})},[a,s,d])}({abTestData:h,showAwemeList:eb,homeFetchData:Q,selectedTab:N});let{trySaveCache:eP,clearSaveTimeout:eR}=function(e){var l,i,t,o,r,a;let{abTestData:d,selectedTab:s}=e,u=(0,B.d)((null==d?void 0:d.jxAllowCache)&&(null==d?void 0:null===(l=d.jxCacheMode)||void 0===l?void 0:l.cache)&&(null==d?void 0:null===(i=d.jxCacheMode)||void 0===i?void 0:i.mode)===0&&(null==d?void 0:null===(t=d.jxCacheMode)||void 0===t?void 0:t.normalFetchScene)==="csr"&&(null==d?void 0:null===(o=d.jxCacheMode)||void 0===o?void 0:o.expire)),c=(0,n.useRef)(null),v=(0,n.useRef)(!1),m=(0,n.useRef)(!u.current),f=(0,B.d)((null==d?void 0:null===(r=d.jxCacheMode)||void 0===r?void 0:r.hotVV)===1),_=(0,B.d)((null==d?void 0:null===(a=d.jxCacheMode)||void 0===a?void 0:a.expire)||0),h=(0,j.Z)(()=>{c.current&&(clearTimeout(c.current),c.current=null)}),g=(0,j.Z)(async()=>{v.current=!0;let{statusCode:e,awemeList:l}=await (0,q.fetchHomeModuleFeed)({moduleId:3003101,referType:10,count:10,seoFlag:0,refreshIndex:1,liteType:1,tagId:s,pullType:"0"===s&&f.current?8:void 0,useV2:1},void 0,{},void 0);0===e&&(null==l?void 0:l.length)&&(await (0,lt.J9)({tagId:null!=s?s:"",originalList:l,expireS:_.current,redisMode:"normal"}),m.current=!0),v.current=!1,c.current=null}),p=(0,j.Z)(()=>{if(m.current)return;let e=u.current&&"undefined"!=typeof TextEncoder,l=s&&eZ.Xq.includes(s);if(!e||!l){m.current=!0;return}if(!v.current)c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{g()},5e3)});return(0,n.useEffect)(()=>()=>{h()},[]),{trySaveCache:p,clearSaveTimeout:h}}({abTestData:h,selectedTab:N});!function(e){let{firstLoadStatus:l,fetchStatus:i,statusCode:t,logId:o,onError:r}=e;(0,n.useEffect)(()=>{if((l===eQ.FAILED||i===e0.FAILED)&&0!==t){let e={statusCode:t,firstLoadStatus:l,fetchStatus:i,logId:o};r(e),eB.oe.event.error({name:eB.Mo.WaterfallLoadError,report:(0,f._)({},e)})}},[l,i,r,t,o])}({statusCode:H,firstLoadStatus:A,fetchStatus:V,logId:null==Z?void 0:Z.current,onError:x}),(0,n.useEffect)(()=>()=>{ec.current=!0},[]);let eM=(0,n.useRef)(0);(0,F.o)(()=>{if(!y)return;let e=eO()(()=>{var e;let l=y.scrollTop,i=l>eM.current,t=J.Le.getConfig(J.gI.JingXuanVisitId);e5.sendLog("discoverSlide",{tab_name:"discover",sub_tab_name:null!==(e=eZ.z0[Number(null!=E?E:0)])&&void 0!==e?e:E,direction:i?"down":"up",gid_list:"",visit_id:t||""}),eM.current=l},300,{leading:!1,trailing:!0});return null==y||y.addEventListener("scroll",e),()=>{null==y||y.removeEventListener("scroll",e)}},[y]),e7({scrollParentEl:I,waterfallWrapperRef:eg,abTestData:h});let eD=(0,n.useCallback)(()=>{eI.current.length||ei.current.length?D(eQ.SUCCESS):D(eQ.FAILED),U(e0.FAILED),eu.current=e0.FAILED,es.current=!1},[]),{fetchWholeFirstFeedAndOverWrite:ez}=function(e){let{fetchDataListRef:l,renderList:i,abTestData:t,tagId:n}=e,o=e=>{null==e||e.forEach(e=>{let i=l.current.findIndex(l=>e.awemeId===l.awemeId);if(-1!==i){let t=l.current[i];l.current[i]=(0,f._)({},l.current[i],e),l.current[i].video.cover=t.video.cover,l.current[i].video.coverUrlList=t.video.coverUrlList,l.current[i].video.cover169UrlList=t.video.cover169UrlList,l.current[i].video.cover169BigUrlList=t.video.cover169BigUrlList,l.current[i].webRawData.cutTitle=t.webRawData.cutTitle,t.awemeType===eV.e.Note&&(l.current[i].video.width=t.width,l.current[i].video.height=t.height),lf(e)}}),i()},r=e=>{(0,lc.q)({itemIds:e,from:"overWriteByIds",originType:lm.F.DiscoverPage}).then(e=>{if((null==e?void 0:e.status_code)===0){var l,i;let t=null===(i=e.aweme_details)||void 0===i?void 0:null===(l=i.map)||void 0===l?void 0:l.call(i,e=>(0,lv.s0)(e));(null==t?void 0:t.length)&&o(t)}})},a=async e=>{var l;let{ids:i=[],encodedIds:t=[],liveIds:a=[],liveEncodedIds:d=[],responseFrom:s,logId:u}=e||{},c=await (0,q.fetchHomeModuleFeed)({useV2:1,moduleId:3003101,referType:10,count:20,seoFlag:0,refreshIndex:1,liteType:2,logId:u,provider:s,preIds:i.toString(),encodedPreIds:t.toString(),preRoomIds:a.toString(),encodedPreRoomIds:d.toString(),tagId:n});if((null==c?void 0:c.statusCode)===0&&(null==c?void 0:null===(l=c.awemeList)||void 0===l?void 0:l.length)){o(c.awemeList);let e=i.filter(e=>{var l;return!(null==c?void 0:null===(l=c.awemeList)||void 0===l?void 0:l.find(l=>(null==l?void 0:l.awemeId)===e))});e.length&&r(e)}else r(i)};return{overWrite:o,overWriteByIds:r,fetchWholeFirstFeedAndOverWrite:a}}({fetchDataListRef:eI,renderList:ex,abTestData:h,tagId:E}),eJ=(0,n.useCallback)(async function(){let{isReload:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(ec.current||es.current)return;if(e)G(0);else if((!ev.current||eu.current===e0.FAILED)&&eb.length){ej.current&&ek(!1);return}!em.current&&(em.current=setTimeout(()=>{if(eu.current===e0.LOADING){try{(0,w.unstable_batchedUpdates)(()=>{G(l_.ERROR_502),eD()})}catch(e){G(l_.ERROR_502),eD()}ef.current=!0}em.current=null},2e4)),U(e0.LOADING),eu.current=e0.LOADING,es.current=!0,eR();let l=Date.now();(0,eF.B1)({tag:d.w3.fetchers.fetcher_waterfall_start,once:!0});let{data:i,hasMore:t,statusCode:n,logPb:o,maxCursor:r,responseFrom:a}=await eS.current(ea.current,e);if(ec.current)return;(0,eF.B1)({tag:d.w3.fetchers.fetcher_waterfall_end,once:!0}),z.emit(z.EVENT.discoverPageLcp),z.emit(z.EVENT.getHotList),(0,eG.C6)();let s=Date.now();0===n&&(ea.current=r);let u=function(e){try{if(!e)return"";let l={impr_id:""};return"string"==typeof e&&(l=JSON.parse(e)),(null==l?void 0:l.impr_id)||""}catch(e){return""}}(o);eB.oe.event.info({name:eB.Mo.WaterfallFetchTime,metrics:{duration:s-l},report:{logId:u,firstLoadStatus:A}}),em.current&&(clearTimeout(em.current),em.current=null),Z.current=u;let c=e9(i,eI.current,!!a);c.forEach(e=>{var l,i,t,n,o,r,a,d,s,u,c,v,m,f,_,h,g,p,w,C,x,b,I;if(e.awemeType===eV.e.LiveCard){if(null===(r=e.cellRoom)||void 0===r?void 0:null===(o=r.rawdata)||void 0===o?void 0:null===(n=o.cover)||void 0===n?void 0:null===(t=n.url_list)||void 0===t?void 0:null===(i=t[0])||void 0===i?void 0:null===(l=i.includes)||void 0===l?void 0:l.call(i,".heif?")){let l=null===(a=e.cellRoom)||void 0===a?void 0:a.rawdata.cover.url_list[0].replace(".heif?",".jpeg?");e.cellRoom.rawdata.cover.url_list[0]=l}}else{if(null==e?void 0:null===(c=e.video)||void 0===c?void 0:null===(u=c.coverUrlList)||void 0===u?void 0:null===(s=u[0])||void 0===s?void 0:null===(d=s.includes)||void 0===d?void 0:d.call(s,".heif?")){let l=e.video.coverUrlList[e.video.coverUrlList.length-1];e.video.cover=l}if((null==e?void 0:null===(m=e.video)||void 0===m?void 0:null===(v=m.cover169UrlList)||void 0===v?void 0:v[0])&&(null==e?void 0:null===(g=e.video)||void 0===g?void 0:null===(h=g.cover169UrlList)||void 0===h?void 0:null===(_=h[0])||void 0===_?void 0:null===(f=_.includes)||void 0===f?void 0:f.call(_,".heif?"))){let l=e.video.cover169UrlList[e.video.cover169UrlList.length-1];e.video.cover169UrlList[0]=l}if((null==e?void 0:null===(w=e.video)||void 0===w?void 0:null===(p=w.cover169BigUrlList)||void 0===p?void 0:p[0])&&(null==e?void 0:null===(I=e.video)||void 0===I?void 0:null===(b=I.cover169BigUrlList)||void 0===b?void 0:null===(x=b[0])||void 0===x?void 0:null===(C=x.includes)||void 0===C?void 0:C.call(x,".heif?"))){let l=e.video.cover169BigUrlList[e.video.cover169BigUrlList.length-1];e.video.cover169BigUrlList[0]=l}}lf(e)});if((()=>{if(ef.current){ef.current=!1;return}if(0!==n){G(n),eD();return}if((null==I?void 0:I.clientHeight)===0){eu.current=e0.SUCCESS,U(e0.SUCCESS),es.current=!1;return}if(t&&!c.length){G(l_.ERROR_404),eD();return}if(!t&&(ev.current=!1),A===eQ.LOADING&&D(eQ.SUCCESS),a&&c.length){!(null==h?void 0:h.discoverEnableWebp)&&c.forEach(e=>{var l;if(null==e?void 0:null===(l=e.video)||void 0===l?void 0:l.coverUrlList){let l=e.video.coverUrlList.find(e=>e.includes(".jpeg?"));l&&(e.video.cover=l)}});let{ids:e,encodedIds:l,liveIds:i,liveEncodedIds:t}=le(c);ez({ids:e,encodedIds:l,liveIds:i,liveEncodedIds:t,responseFrom:a,logId:u})}return eu.current=e0.SUCCESS,0===eI.current.length&&c.length>0&&(0,v.Fp)(),U(e0.SUCCESS),!0})()){let e=-1;ej.current?(eI.current=eI.current.slice(1),e=eI.current.length,eI.current=[...eI.current,...c],ej.current=!1,ex({topCardStartIndex:e})):(eI.current=[...eI.current,...c],ex())}else ej.current&&ek(!1)}catch(e){eD(),ej.current&&ek(!1)}finally{eP()}},[A,eD,ex,I]);(0,n.useEffect)(()=>z.listen(z.EVENT.JingxuanTopCard,e=>{var l;let{action:i,awemeId:t,cancelReplace:n}=e;"topCardReplace"===i&&t===(null==ep?void 0:null===(l=ep[0])||void 0===l?void 0:l.awemeId)&&(n?ej.current&&ek(!0):eL(eJ))}),[eL,eJ,null==ep?void 0:null===(l=ep[0])||void 0===l?void 0:l.awemeId]);let eq=(0,n.useCallback)(async()=>{let e=I||eg.current;if(!(0,eU.r)()&&eu.current!==e0.FAILED){if(e){var l,i,t,n,o;let r=0;if(null===(i=X.current)||void 0===i?void 0:null===(l=i.homeFastSlowSlide)||void 0===l?void 0:l.isOpen){let e=J.Le.getConfig(J.gI.HomeFastSlowSlideFeature);r=(null===(o=X.current)||void 0===o?void 0:null===(n=o.homeFastSlowSlide)||void 0===n?void 0:null===(t=n.distanceMap)||void 0===t?void 0:t[e])||0}e8(e,m+r)&&!es.current&&(z.emit(z.EVENT.homeLoadMoreReach),await eJ())}}},[eJ,m,I]),eX=(0,n.useCallback)(()=>{let e=eg.current,l=I||e;if(!eE)e_.current=!0,l&&e8(l,m)&&eq(),ex(),e_.current=!1},[eE,ex,m,eq,I]),e1=(0,n.useRef)(!1),e3=(0,B.d)(()=>{if(!e1.current)return;let e=eg.current,l=I||e;l&&e8(l,m)&&eq()});(0,F.o)(()=>((null==eN?void 0:eN.current)?eJ():e3.current(),()=>{e1.current=!0}),[]),!function(e){let{waterfallWrapperRef:l,needSkeleton:i,onResizeEvent:t,onScrollEvent:n,scrollListenerEl:o}=e;(0,F.o)(()=>{let e=()=>{if(!t)return;let e=eO()(()=>{if(!!(null==l?void 0:l.current)&&0!==l.current.clientHeight)null==t||t()},300);return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}};if(i){let l=e();return()=>{null==l||l()}}let r=e(),a=(()=>{if(!n||!(null==l?void 0:l.current))return;let e=o||l.current;if(!e)return()=>void 0;let i=li()(()=>{null==n||n()},50);return null==e||e.addEventListener("scroll",i),null==e||e.addEventListener("wheel",i),()=>{null==e||e.removeEventListener("scroll",i),null==e||e.removeEventListener("wheel",i)}})();return()=>{null==r||r(),null==a||a()}},[i,t,n,l,o])}({waterfallWrapperRef:eg,scrollListenerEl:y,scrollParentEl:I,needSkeleton:eE,onResizeEvent:eX,onScrollEvent:eq}),(0,n.useEffect)(()=>{if(eE){var e;null==k||null===(e=k.onSkeletonShow)||void 0===e||e.call(k),er.current=[]}},[eE]),(0,n.useEffect)(()=>{var e;null==k||null===(e=k.onLoadMoreShow)||void 0===e||e.call(k,V)},[V]);let{replaceFirstPageCache:e6}=function(e){let{abTestData:l,tagId:i,fetchDataListRef:t,homeFetchData:o,renderList:r,onScroll:a,setShowReplaceLoading:d}=e,s=(0,n.useRef)(null),u=async function(){var e,l,n,c,v,m,f,_;let h,g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(window.__JINGXUAN_PRE_FETCH&&"loading"===window.__JINGXUAN_PRE_FETCH.fetchHomeModuleFeedStatus&&g<3){s.current&&clearTimeout(s.current),s.current=setTimeout(()=>u(g+1),1e3);return}(null===(l=window)||void 0===l?void 0:null===(e=l.__JINGXUAN_PRE_FETCH)||void 0===e?void 0:e.homeFetchData)&&"success"===window.__JINGXUAN_PRE_FETCH.fetchHomeModuleFeedStatus?(h=null===(_=window)||void 0===_?void 0:null===(f=_.__JINGXUAN_PRE_FETCH)||void 0===f?void 0:f.homeFetchData,delete window.__JINGXUAN_PRE_FETCH):h=await (0,q.fetchHomeModuleFeed)({useV2:1,moduleId:3003101,referType:10,count:10,seoFlag:0,refreshIndex:1,liteType:0,tagId:i,pullType:""===i?8:void 0});let p=(null==h?void 0:h.statusCode)===0&&(null==h?void 0:null===(n=h.awemeList)||void 0===n?void 0:n.length)?null==h?void 0:h.awemeList:[],w=(null==p?void 0:null===(c=p.map)||void 0===c?void 0:c.call(p,e=>Object.assign({},e,{inView:!0})))||[],C=(null===(m=t.current)||void 0===m?void 0:null===(v=m.filter)||void 0===v?void 0:v.call(m,e=>{var l,i;return!(null==o?void 0:null===(i=o.awemeList)||void 0===i?void 0:null===(l=i.find)||void 0===l?void 0:l.call(i,l=>l.awemeId===e.awemeId))}))||[];t.current=[...w,...C],r(),null==d||d(!1),z.emit(z.EVENT.HideHorizontalTabsLoading),await a()};return{replaceFirstPageCache:u}}({abTestData:h,tagId:E,fetchDataListRef:eI,homeFetchData:Q,renderList:ex,onScroll:eq,setShowReplaceLoading:R});(0,n.useEffect)(()=>{(null==Q?void 0:Q.redisMode)==="replace"?e6():(async()=>{var e,l,i,t,n,o;if(Q&&(null==Q?void 0:null===(e=Q.awemeList)||void 0===e?void 0:e.length)&&!Q.isCourse){let e=!!K.current;if(!e&&(["sort","new_hottest_id","old_hottest_id"].includes(null!==(t=null==Q?void 0:Q.responseFrom)&&void 0!==t?t:"")||(null==Q?void 0:null===(i=Q.awemeList)||void 0===i?void 0:null===(l=i.some)||void 0===l?void 0:l.call(i,e=>{var l,i;return(null==e?void 0:e.awemeType)!==eV.e.LiveCard&&(null==e?void 0:null===(i=e.video)||void 0===i?void 0:null===(l=i.playAddr)||void 0===l?void 0:l.length)===0})))&&(e=!0),(null==Q?void 0:Q.responseFrom)&&e){let{ids:e,encodedIds:l,liveIds:i,liveEncodedIds:t}=le(null==Q?void 0:Q.awemeList);await ez({ids:e,encodedIds:l,liveIds:i,liveEncodedIds:t,responseFrom:null==Q?void 0:Q.responseFrom,logId:Z.current||(null===(o=window.SSR_RENDER_DATA)||void 0===o?void 0:null===(n=o.app)||void 0===n?void 0:n.logId)||""})}await eq()}})()},[Q]),(0,F.o)(()=>(0,eG.oX)(async()=>{var e,l,i,t;if(N===eZ._D[eZ.JY.Course]||S){z.emit(z.EVENT.refreshPage);return}if(!eh.current)eC(),eh.current=!0,eI.current=(null===(l=eI.current)||void 0===l?void 0:null===(e=l.slice)||void 0===e?void 0:e.call(l,ed.current+1))||[],et.current=null===(t=et.current)||void 0===t?void 0:null===(i=t.filter)||void 0===i?void 0:i.call(t,e=>eI.current.some(l=>l.id===e.id)),ed.current=0,ea.current=0,ex(),eq(),await Promise.allSettled([eJ(),null==el?void 0:el(N),null==ee?void 0:ee()]),eh.current=!1}),[N]);let e4=(0,n.useCallback)((e,l)=>{!(null==e?void 0:e.insertId)&&(ed.current=Math.max(ed.current,l))},[]),ll=(0,n.useCallback)((e,l,i,t,n,o)=>_(e,l,(null==h?void 0:h.discoverTaskOptimize)?e4:()=>{!(null==e?void 0:e.insertId)&&(ed.current=Math.max(ed.current,t))},t,n,o,ey),[_,ey]),ln=(0,n.useCallback)((e,l,i)=>{var t,n,o;null==k||null===(t=k.onCoverLoad)||void 0===t||t.call(k,e,l,i),window.jxHydrateReadyCb&&(null===(n=(o=window).jxHydrateReadyCb)||void 0===n||n.call(o))},[null==k?void 0:k.onCoverLoad]),lr=A===eQ.FAILED,ld=V===e0.SUCCESS,lh=(0,n.useCallback)(e=>{eI.current=e,ex()},[]);return(0,t.jsxs)("div",{className:p()(L,eW.waterfallWrapper,{[eW.noScrollParent]:!I}),ref:eg,children:[b,lr&&!ld&&(0,t.jsx)(eY,{isGaiaTab:S,statusCode:H}),eE?(0,t.jsx)(eK,{containerClassName:p()({bigCardWaterfallContainer:2===eT},g)}):(0,t.jsx)(t.Fragment,{children:ep.length?(0,t.jsx)(e2,{ref:$,setWaterfallContainer:Y,renderItem:ll,hideSecond:T&&(null==ep?void 0:ep[0])&&ep[0].awemeType!==eV.e.LiveCard&&(null!==(o=ep[0].width)&&void 0!==o?o:0)>(null!==(a=ep[0].height)&&void 0!==a?a:0),fetchStatus:V,showDataList:ep,containerClassName:p()({bigCardWaterfallContainer:ew},g),statusCode:H,onload:C,reload:()=>{eJ({isReload:!0})},update:()=>{es.current=!1,eq()},onCoverShow:ln,abTestData:h,setLoadingElement:P,showReplaceLoading:M}):!lr&&!ld&&(0,t.jsx)(eY,{statusCode:H})}),(0,t.jsx)(eH.IsLivingPlugin,{activeIndex:-1,dataList:eb,setDataList:lh,scene:"jingxuan_card"})]})}var lg=(0,n.forwardRef)((e,l)=>{let[i,o]=(0,n.useState)(!0),r=(0,n.useRef)(!1),{onError:a,onListLoad:d,perfLogFunctions:s}=e||{},{onSkeletonShow:u,onCoverLoad:c,onReload:v,onLoadMoreShow:m,isActiveTab:h}=s||{},g=()=>{if(!!r.current)null==v||v(),o(!1),setTimeout(()=>{o(!0),r.current=!1},0)};(0,n.useImperativeHandle)(l,()=>({reloadList:g,isListLoadEndRef:r}));let p=(0,n.useCallback)(function(){for(var l=arguments.length,i=Array(l),t=0;t<l;t++)i[t]=arguments[t];(null==h?void 0:h(e.selectedTab))&&(null==c||c(...i))},[c]),w=(0,n.useMemo)(()=>({onSkeletonShow:u,onCoverLoad:p,onLoadMoreShow:m}),[]);return i&&(0,t.jsx)(lh,(0,_._)((0,f._)({onError:e=>{r.current=!0,null==a||a(e)},onListLoad:()=>{r.current=!0,null==d||d()}},e),{perfProps:w}))});let lp=(e,l)=>{let i=[];return e.forEach((e,l)=>{var t,n;i[l]=e,i[l].height=null==e?void 0:null===(t=e.video)||void 0===t?void 0:t.height,i[l].width=null==e?void 0:null===(n=e.video)||void 0===n?void 0:n.width,i[l].id=null==e?void 0:e.awemeId}),i};var lw=i("419936"),lC=i.n(lw),lx=i("451238"),lb=i.n(lx),lI=i("656062"),ly=i.n(lI),lj=i("35730"),lL=i("555106"),lk=i("44905"),lT=i("67704"),lS=i("402971");let lE=(e,l)=>{if(lC()(e))return ly()(e,l)},lN=e=>{let{selectedTab:l}=e,{setClosedCardAdIdListMap:i}=(0,e$.useDiscoverCommonContext)(e=>{let{setClosedCardAdIdListMap:l}=e;return{setClosedCardAdIdListMap:l}}),{userInfo:t}=(0,lS.useUserInfoContext)(),o=e=>{var i,n,o;if(!l)return;let r=null!==(o=(0,lL.$o)(lj.LocalStorageKeys.DiscoverFeedCardAdUnique))&&void 0!==o?o:{},a=(null==t?void 0:t.isLogin)?null==t?void 0:null===(i=t.info)||void 0===i?void 0:i.uid:(null===(n=(0,lk.Es)())||void 0===n?void 0:n.user_unique_id)||"",d=lb()({},r,{[a]:{[l]:[e]}},lE);(0,lL.qQ)(lj.LocalStorageKeys.DiscoverFeedCardAdUnique,d),(0,lT.EN)({uidKey:a})},r=(0,n.useCallback)(e=>{null==i||i(i=>{if(void 0===l)return i;let t=(0,f._)({},i),n=(null==t?void 0:t[l])||[];return n.push(e),t[l]=n,t})},[i]);return{onShow:e=>{!e.permanent&&o(e.id)},onClose:e=>{if(!!e.id)o(e.id),null==r||r(e.id)}}};var lP=i("368200");i("602157"),i("779788");let lR=(0,n.forwardRef)((e,l)=>(0,t.jsx)("svg",(0,_._)((0,f._)({width:105,height:120,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:(0,t.jsx)("path",{d:"M89.013 24.055C82.55 19.84 77.883 13.098 76.427 5.238A28.704 28.704 0 0 1 75.939 0H55.31l-.035 82.675c-.345 9.257-7.967 16.689-17.307 16.689-2.902 0-5.636-.726-8.044-1.992-5.517-2.907-9.299-8.692-9.299-15.35 0-9.56 7.783-17.343 17.343-17.343 1.783 0 3.495.297 5.119.803V44.423a38.211 38.211 0 0 0-5.12-.368C17.034 44.055 0 61.088 0 82.027c0 12.848 6.42 24.216 16.213 31.088A37.749 37.749 0 0 0 37.973 120c20.939 0 37.972-17.033 37.972-37.973V40.101a49.054 49.054 0 0 0 28.704 9.227v-20.63a28.56 28.56 0 0 1-15.636-4.643z",fill:"#121423",fillOpacity:".9",opacity:".04"})})));var lM={cover:"HGXOsC8m",content:"oOD4qrps",leftTag:"n32o9S1r",rightTag:"Ii8ePykI",backgroundLoading:"yhodAwbf",backgroundMask:"uYH4uOmd",backgroundMaskNotLoad:"CSA25PZv",mask:"UYTgsheo",background:"PXxuR3wP",hoverImg:"H3DqGJMV",hideImage:"AYYwUaes",footer:"lCgTcfSm",title:"HwxFa2Yf",markers:"uQUfgoO0",hideMarkers:"jXA11yAM",hideTags:"_6ff2r2G",hideMarkersAnimation:"BIg3N8nW",showMarkersAnimation:"pfEzElxN"},lA=i("999238"),lD=e=>{let{onLog:l,isReady:i}=e,t=n.useRef(!1);return n.useEffect(()=>{i&&!t.current&&(t.current=!0,l&&l())},[l,i]),null};let lO=e=>{let{isFirstPageItem:l=!1,imageSrc:i,scale:o=16/9,title:r,fit:a="cover",mask:d,leftMarker:s,rightMarker:u,className:c,hideMarkers:v=!1,hideTags:m=!1,onMouseLeave:f,onMouseEnter:_,onClick:h,maskZIndex:g=2,alt:w,animation:C,hideShadow:x,forwardRef:b,onLog:I,lazyLoadOffset:y=600,lazyLoad:j=!1,isLogReady:L,rightTag:k,leftTag:T,hoverImg:S}=e,[E,N]=n.useState(l),P=n.useRef(null);n.useEffect(()=>{P.current&&P.current.complete&&N(!0)},[]);let R=n.useCallback(()=>{!E&&N(!0)},[E]),M=n.useMemo(()=>(0,t.jsx)("img",{alt:w,ref:P,src:i,onLoad:R,className:p()(lM.background,{[lM.hideImage]:!E,[lM.hoverImg]:S}),style:{objectFit:a}}),[w,P,i,R,E,a,S]);return(0,t.jsxs)("div",{ref:b,title:"",className:p()(lM.cover,c),style:{paddingTop:`${1/o*100}%`},onMouseEnter:_,onMouseLeave:f,onClick:h,children:[d&&(0,t.jsx)("div",{style:{zIndex:g},className:lM.mask,children:d}),(0,t.jsx)("div",{className:lM.backgroundLoading,children:(0,t.jsx)(lR,{})}),(0,t.jsx)(lD,{onLog:I,isReady:L}),j?(0,t.jsx)(lA.default,{height:"100%",offset:y,once:!0,children:M}):M,!x&&(0,t.jsx)("div",{className:p()(lM.backgroundMask,{[lM.backgroundMaskNotLoad]:!E})}),(0,t.jsxs)("div",{className:p()(lM.content,{[lM.hideTags]:m}),children:[T&&(0,t.jsx)("div",{className:lM.leftTag,children:T}),k&&(0,t.jsx)("div",{className:lM.rightTag,children:k})]}),(0,t.jsxs)("div",{className:p()(lM.footer,{[lM.hideMarkersAnimation]:C&&v,[lM.showMarkersAnimation]:C&&!v,[lM.hideMarkers]:!C&&v}),children:[(0,t.jsx)("div",{className:lM.title,children:r}),(0,t.jsxs)("div",{className:lM.markers,children:[s,u]})]})]})};var lV=n.forwardRef((e,l)=>(0,t.jsx)(lO,(0,_._)((0,f._)({},e),{forwardRef:l}))),lF={card:"Y4KdzJ21",cover:"E_lyUKRn",noMargin:"VGqxa7dc",title:"Zfmp49H9"},lB=e=>{let{width:l,title:i,cover:n,meta:o,detail:r,className:a,onMouseEnter:d,onMouseLeave:s,onClick:u}=e;return(0,t.jsxs)("div",{style:{width:l},onMouseEnter:d,onMouseLeave:s,onClick:u,className:p()(lF.card,a),children:[(0,t.jsx)("div",{className:p()(lF.cover,{[lF.noMargin]:r}),children:n}),r||(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:lF.title,children:i}),(0,t.jsx)("div",{children:o})]})]})},lU=i("448715"),lH="Hlhnjx4q",lG="OCq6LNvT",lZ=e=>{let{title:l,children:i}=e;return(0,t.jsxs)("div",{className:lH,children:[(0,t.jsx)("h1",{className:lG,"data-e2e":"live-room-name",children:l}),i]})},l$=i("225520"),lz=i("519055"),lW=i("577786"),lJ=i("330746"),lY=i("309244"),lq="hmXZ4_2_",lX="tf7tsyLn";let lK=e=>{let{count:l,className:i,renderSVG:n}=e;return(0,t.jsxs)("span",{className:p()(lq,i),children:[n?n():(0,t.jsx)(lY.Z,{}),(0,t.jsx)("span",{className:lX,children:l||"0"})]})};var lQ={liveCard:"upEORSfP",borderRadius:"Rbi0dLbR",liveCover:"FLKrazjV",coverMask:"I5X716yZ",cardInfo:"x7F_6nV8",linkMicPreview:"e0rL9YWj"},l0=i("240026"),l1={liveTag:"Invt7kl0",hasRedPack:"mmuZGyYZ",isFirstLive:"_E4ppM2S",liveTagText:"czPHNW9v",redPack:"jStc0Hl_",realText:"ZSMMXimI"},l2=i("545546"),l3=e=>{var l,i;let{roomData:o}=e,r=(0,l0.T)(),a=n.useMemo(()=>{var e;return(null==o?void 0:null===(e=o.others)||void 0===e?void 0:e.web_enter_benefit_point_data)||{has_ongoing_lottery:!1,has_ongoing_lucky_money:!1}},[o]),d=(0,l2.gE)(r,a.has_ongoing_lottery,a.has_ongoing_lucky_money,!0),s=null==o?void 0:null===(i=o.episode_extra)||void 0===i?void 0:null===(l=i.mod)||void 0===l?void 0:l.episode_stage;return(0,t.jsx)("div",{className:p()(l1.liveTag,{[l1.hasRedPack]:!0,[l1.isFirstLive]:s}),children:(0,t.jsxs)("span",{className:p()(l1.liveTagText),"data-e2e":"user-info-living",children:[d.icon&&(0,t.jsx)("img",{src:d.icon,className:l1.redPack}),(0,t.jsx)("span",{className:l1.realText,children:s?"首播中":"直播中"})]})})},l5=i("554425"),l6=i("885714");i("209955");let l4=()=>{let e=n.useContext(E);if(!e)throw Error("useLiveCard must be used within LiveCardProvider");let{play:l,pause:i,clearAllPlayers:t,getInstance:o}=e;return{play:l,pause:i,getInstance:o,clearAllPlayers:t}};var l7=i("200224"),l8=i("645260"),l9=i.n(l8),ie=i("697041"),il={cardInfo:"ZBvIT8gG",cardInfoContainer:"dud1zPsv",decs:"Tu5IS0vC",userText:"SWvUuhxn",text:"wdOwEL1J",marginRight:"xdtM920o",at:"ViYzOeP6",userName:"TvB65_nE"},ii=i("55426"),it=i("421885"),io=i("956428"),ir=i("180962"),ia=i("555679"),id={tagContainer:"ei4kM2gw",tagText:"dX9GIMHH",yellow:"p6rGz3E_",green:"w4TcqMaX",recommended:"kw3HDa6o"};it.Z,io.Z,ir.Z,ia.Z;let is=new Map([["follow",{text:"你的关注"}],["recommended",{text:"为你推荐"}],["collect",{text:"收藏"}],["digg",{text:"点赞"}],["comment",{text:"评论"}]]),iu=e=>{let{count:l,type:i,className:n}=e,o=is.get("recommended"===i?"recommended":"follow");return(0,t.jsx)(t.Fragment,{children:o&&(0,t.jsx)("span",{className:p()(id.tagContainer,n,{[id.yellow]:"collect"===i,[id.green]:"comment"===i,[id.green]:"follow"===i,[id.recommended]:"recommended"===i}),children:(0,t.jsx)("span",{className:p()(id.tagText),children:`${["follow","recommended"].includes(i)?"":(0,ii.qe)(l||0)}${o.text}`})})})};var ic=e=>{let{text:l,userName:i,className:n,roomhref:o,onEnterLive:r,isShowFollowHighlightTag:a}=e;return(0,t.jsx)("div",{className:p()(il.cardInfo,n),children:(0,t.jsx)("div",{target:"_blank",rel:"noopener noreferrer",onClick:r,children:(0,t.jsxs)("div",{className:p()(il.cardInfoContainer),children:[(0,t.jsx)("div",{className:p()(il.decs),children:l}),(0,t.jsx)("div",{className:p()(il.userText),children:(0,t.jsxs)("div",{className:p()(il.text),children:["@",(0,t.jsx)("span",{className:p()(il.userName),children:i}),a&&(0,t.jsx)(iu,{className:il.highlightTag,type:"follow"})]})})]})})})},iv=i("459049"),im=i("114682"),i_=i("688032"),ih=i("797973"),ig=i("155953"),ip=i("108374");let iw=e=>{var l,i,o,r;let{isFirstPageItem:a,anchorId:d,webRid:s,roomId:u,onMouseEnter:c,onMouseLeave:v,onHoverChange:m,userCount:g,cover:w,source:C,title:x,scale:b,onVideoClick:I,onLog:y,coverClassName:L,className:k,authorInfo:T,playerConfig:S,playerStyle:E,isActive:N,lazyLoad:P=!1,fit:R="cover",leftMarker:M,rightMarker:A,hideMarkers:D,leftTag:O,animation:V,hideShadow:B,isLogReady:U,instanceId:H="default",rawData:G,isEnd:Z,linkerMap:$,sceneId:z=253,teaLogParams:Y,search_params:q="",detail:X,description:K,onEnterLive:Q,awemeInfo:ee}=e,[el,ei]=n.useState(!1),et=n.useRef(null),en=n.useRef(null),[eo,er]=n.useState(!1),ea=n.useRef(null),ed=(0,l0.T)(),{isFeedH265:es}=(0,l6.Z)({abtestData:ed,tab:"liveCard"}),[eu,ec]=n.useState(Z),[ev,em]=n.useState(!1),ef=(0,l5.Bq)({room:G,abtestData:ed,isFeedH265:es&&!ev}),e_=!ev&&(null==G?void 0:G.redirectUrl)?null==G?void 0:G.redirectUrl:null==ef?void 0:ef.url,eh=n.useCallback(e=>{es&&!ev&&em(!0)},[es,ev,em]),{play:eg,pause:ep,getInstance:ew}=l4(),[eC,ex]=n.useState(!1),eb=n.useRef(!1),eI=n.useRef(null),ey=n.useMemo(()=>{var e,l,i,t,n,o;let r=null!==(o=null===(i=J.Le.getConfig(J.gI.FollowStatusCache))||void 0===i?void 0:null===(e=i[null==G?void 0:null===(l=G.owner)||void 0===l?void 0:l.id])||void 0===e?void 0:e.followStatus)&&void 0!==o?o:null==G?void 0:null===(n=G.owner)||void 0===n?void 0:null===(t=n.follow_info)||void 0===t?void 0:t.follow_status;return(0,lW.F)(r)},[G]),[ej,eL]=n.useState(!1),ek=(null==G?void 0:null===(o=G.paid_live_data)||void 0===o?void 0:null===(i=o.privilege_info_map)||void 0===i?void 0:null===(l=i[101])||void 0===l?void 0:l.paid_live_type)===101,eT=n.useMemo(()=>!!((null==$?void 0:$[5])||(null==$?void 0:$[8])||(null==$?void 0:$[12])),[$]),eS=n.useMemo(()=>{var e;return null==G?void 0:null===(e=G.linker_detail)||void 0===e?void 0:e.function_type},[G]),eE=n.useMemo(()=>3===Number(null==G?void 0:G.live_room_mode),[G]),eN=l9()(G,"AnchorABMap",{}),eP=l9()(eN,"linkmic_video_equal_layout_frame_opt","0"),eR=n.useMemo(()=>!eu&&!ej&&!eT&&!ek&&!!e_&&N,[N,eT,ej,eu,ek,e_]),eM=(null==G?void 0:null===(r=G.paid_live_data)||void 0===r?void 0:r.paid_type)===1,eA=n.useMemo(()=>eR||el||eC?(er(!0),1):(er(!1),0),[el,eR,eC]),eD=()=>{!eC&&ei(!1),(0,im.bi)(Y),I&&I()},eO=n.useCallback(()=>{(0,im.JW)(Y),y&&y()},[Y]);n.useEffect(()=>{Z&&ec(!0)},[Z]);let eV=n.useCallback(()=>{ec(!0)},[]),eF=n.useCallback(()=>(0,ie.Y)(d,z).then(e=>{let{status_code:l,data:i=[]}=e.data;0===l&&ec(!i.some(e=>{let l=l9()(e,"user_live",[])[0];return 1===l9()(l,"live_status")}))}),[d,z]);n.useEffect(()=>{if(en.current){var e,l;ea.current=(0,_._)((0,f._)({},ea.current),{width:(null===(e=en.current)||void 0===e?void 0:e.offsetWidth)||"100%",height:(null===(l=en.current)||void 0===l?void 0:l.offsetHeight)||"100%"})}},[en.current]);let eB=n.useMemo(()=>eu?(0,t.jsx)(l7.PlayerEndCover,{cover:w,children:"直播已结束"}):ej||ek?(0,t.jsx)(l7.PlayerEndCover,{cover:w,children:"会员直播中"}):(el||eR)&&eT?(0,t.jsx)(l7.PlayerEndCover,{cover:w,children:"直播连麦中"}):(el||eR)&&eM?(0,t.jsx)(l7.PlayerEndCover,{cover:w,children:"付费直播中"}):null,[eu,eR,w,el,eT,eM,ek]),eU=n.useCallback(()=>{let e=!1;if(!lz.s){var l;e=(null===(l=navigator.userAgent)||void 0===l?void 0:l.indexOf("Firefox"))!==-1}if(e)return;if(c){c();return}if(!eR&&!!e_)ei(!0)},[c,eR,ei,e_]),eH=n.useCallback(e=>{var l;if(!(null===(l=et.current)||void 0===l?void 0:l.contains(e.relatedTarget))){if(v){v();return}if(eR)return;ei(!1)}},[v,eR]),eG=(0,j.Z)(()=>({playerConfig:(0,f._)({url:e_,onError:eh,onEnd:eV,updatePlayer:{autoPlay:!0},baseConfig:(0,f._)({url:e_,_freezeUrl:e_,autoplay:!0,muted:!0,volume:0,decryption:null,mediaAttributes:{muted:!0}},null==S?void 0:S.baseConfig),logOptions:{ext:{is_all_265:!((0,ip.ld)(null==G?void 0:G.stream_url)||(0,ip.ld)(null==G?void 0:G.additional_stream_url)),anchor_id:d,room_id:u}}},S),style:E||ea.current||{},container:en.current,pluginSchema:{VipLiveBoundaryPlugin:{props:{customContent:(0,t.jsx)(l7.PlayerEndCover,{cover:w,children:"会员直播中"}),roomId:u,paidLiveData:null==G?void 0:G.paid_live_data,onShowVipLiveBoundary:e=>{eL(e)},abTestData:ed}},LinkMicPreviewPlugin:{props:{anchorId:d,roomId:u,functionType2:eS,className:p()(lQ.linkMicPreview),linkmicVideoEqualLayoutFrameOpt:eP,disableClairvoyance:eE&&"audio_audience"!==eS}},AdaptedBySEIPlugin:{linkmicVideoEqualLayoutFrameOpt:eP}}}));(0,F.o)(()=>{eb.current&&ig.Z&&!(0,W.Nr)(location.pathname)&&(en.current.style.display="block",ig.Z.destroy(),eb.current=!1,ex(!1),ei(!1))},[ig.Z,en.current]);let eZ=(0,j.Z)(e=>{(0,im.wp)((0,f._)({play_type:e},Y))}),e$=(0,j.Z)(()=>{if(!eu&&!ej&&!eT&&!ek)eI.current&&clearTimeout(eI.current),eI.current=setTimeout(()=>{let e=eG(),{container:l}=e;eg(l,(0,lP._)(e,["container"])),eZ(el?im.F7.HOVER:im.F7.AUTO)},200)}),ez=(0,j.Z)(()=>{eI.current&&(clearTimeout(eI.current),eI.current=null)},[]);n.useEffect(()=>{eR&&(ei(!1),eF(),e$())},[eR]),n.useEffect(()=>{el&&(eF(),e$())},[el]);let eW=n.useRef(!0);n.useEffect(()=>{if(eW.current){eW.current=!1;return}!el&&!eR&&en.current&&!eC&&(ep(en.current),ez())},[el,eR,en.current,eC]),n.useEffect(()=>()=>{ez()},[]);let eJ=n.useMemo(()=>{let{roomId:e,enter_method:l,enter_from_merge:i,live_position:t,request_id:n}=Y;return(0,iv.h)(s,{from_search:"true",search_params:JSON.stringify(q),enter_from_merge:i,enter_method:l,live_position:t,request_id:n})},[q,Y,s]),eY=(0,ih.Z)(()=>`/root/live/${s}`),eq=n.useMemo(()=>{var e;return Object.values((null==G?void 0:null===(e=G.stream_url)||void 0===e?void 0:e.pull_datas)||{}).length>0&&!(0,lJ.G6)()},[G]),eX=n.useCallback(()=>{var e,l,i,t,n,o;null==Q||Q();let r=eY(),a=ew(en.current),d=null==a?void 0:null===(i=a.ref)||void 0===i?void 0:null===(l=i.current)||void 0===l?void 0:null===(e=l.getPlayer)||void 0===e?void 0:e.call(l),c=null==a?void 0:null===(o=a.ref)||void 0===o?void 0:null===(n=o.current)||void 0===n?void 0:null===(t=n.getPlayerLogger)||void 0===t?void 0:t.call(n),v=!eq&&d;if(r){let e=`${r}?${h.stringify((0,_._)((0,f._)({},Y),{use_new_preview:!!v}))}`;(0,i_.X)({href:e,reusePlayer:v?1:0,_reusePlayer:v?1:0,webRid:s,reuseId:v?`f_${s}`:void 0,abtestData:ed,roomId:u,usePreCreate:!v}),v&&(eb.current=!0,ex(!0),en.current.style.display="none",ig.Z.save(d,c))}},[Q,Y,s,ew,ig.Z,en.current]);return n.useCallback(()=>{null==Q||Q(),window.open(eJ)},[Q,eJ]),(0,t.jsx)("div",{ref:et,style:{height:"100%"},onMouseEnter:e=>{eU(),null==m||m(!0)},onMouseOut:e=>{!e.currentTarget.contains(e.relatedTarget)&&(eH(e),null==m||m(!1))},onClick:e=>{eD(),e.stopPropagation()},children:(0,t.jsx)(lB,{className:p()(lQ.liveCard,k),cover:(0,t.jsx)(lU.G,{target:"_blank",rel:"noopener noreferrer",onClick:eX,children:(0,t.jsx)(lV,{className:p()(lQ.liveCover,L,lQ.borderRadius),isFirstPageItem:a,fit:R,scale:b,lazyLoad:P,isLogReady:U,onLog:eO,mask:(0,t.jsx)("div",{id:H,ref:en,className:lQ.coverMask,children:eB&&eB}),onEnterLive:eX,maskZIndex:eA,imageSrc:w,rightTag:(0,t.jsx)(l3,{roomData:G}),hoverImg:eo,leftMarker:g&&(0,t.jsx)(lK,{count:g})})}),title:x&&(0,t.jsx)(lZ,{title:x}),meta:C&&(0,t.jsx)(l$.Hw,(0,f._)({},C)),detail:X||(0,t.jsx)("div",{className:lQ.cardInfo,children:(0,t.jsx)(ic,{onEnterLive:eX,text:K,userName:null==C?void 0:C.userName,isShowFollowHighlightTag:ey})})})})};var iC=i("702726"),ix=i("256067"),ib=i("14108"),iI=i("658065"),iy=i("32167"),ij=i("301699"),iL=i("276152"),ik=i("650197"),iT=i("137425"),iS=i("325430"),iE="A86toEf_",iN="VM304bjn",iP="xqpdksRR",iR="i8buBzdG";let iM=e=>{var l,i,t;let{rawdata:n}=e.cellRoom||{},o=(null==n?void 0:null===(l=n.room_view_stats)||void 0===l?void 0:l.is_hidden)?"":null==n?void 0:null===(i=n.room_view_stats)||void 0===i?void 0:i.display_short;return{cellRoomRowData:n,userCount:o,requestId:null!==(t=null==e?void 0:e.logPb)&&void 0!==t?t:""}},iA=e=>{let{itemInfo:l,itemRef:i,index:t,topAwemeId:o,canLiveAutoPlay:r,isTabActive:a}=e,{visibleLiveCards:d,setVisibleLiveCards:s}=(0,e$.useDiscoverCommonContext)((0,eo.P1)(["visibleLiveCards","setVisibleLiveCards"])),[u,c]=(0,n.useState)(r),v=(0,j.Z)(e=>{if(!r&&!!o)e?(c(!0),z.emit(z.EVENT.JingxuanTopCard,{action:"pause",awemeId:o,from:"hover_other_cover"})):(c(!1),z.emit(z.EVENT.JingxuanTopCard,{action:"play",awemeId:o,from:"cancel_hover_other_cover"}))});(0,n.useEffect)(()=>{if(!r&&u)return z.listen(z.EVENT.JingxuanTopCard,e=>{let{action:l,awemeId:i}=e;"liveAutoPlay"===l&&i===o&&c(!1)})},[r,u]),(0,n.useEffect)(()=>{if(l.awemeType!==eV.e.LiveCard||!i.current||!s||void 0===t)return;let e=new IntersectionObserver(e=>{let[i]=e;i.isIntersecting?s(e=>[...e,{id:l.awemeId,index:t}]):s(e=>e.filter(e=>e.id!==l.awemeId))},{threshold:.5}),n=i.current;return e.observe(n),()=>{e.unobserve(n),s(e=>e.filter(e=>e.id!==l.awemeId))}},[l.awemeType,l.awemeId,t,s]);let m=(0,n.useMemo)(()=>!!d&&0!==d.length&&d.reduce((e,l)=>e.index<l.index?e:l).id===l.awemeId,[d,l.awemeId]);return{isActiveLiveCard:m,canLivePlay:(!!r||u)&&m&&a,onHoverChange:v}},iD=e=>{let{itemInfo:l,isTabActive:i}=e;return(0,n.useEffect)(()=>()=>{var e,i;let{awemeId:t=""}=null!=l?l:{},n=J.Le.getConfig(J.gI.keepPlayersInfo),o=`${ei.v.Discover}-${t}`,r=null==n?void 0:null===(e=n.get)||void 0===e?void 0:e.call(n,o);r&&(null==r||null===(i=r.destroyFn)||void 0===i||i.call(r),null==n||n.delete(o))},[]),(0,n.useEffect)(()=>{if(!i){z.emit(z.EVENT.JingxuanTopCard,{action:"pause",awemeId:null==l?void 0:l.awemeId});let e=J.Le.getConfig(J.gI.topCardManualPause)||{};e[null==l?void 0:l.awemeId]&&(delete e[null==l?void 0:l.awemeId],J.Le.setConfig(J.gI.topCardManualPause,e))}},[i]),null};var iO=new eb.h({waterfallProcessStat:{eventName:"waterfall_process_stat",params:{enter_from:"",from:"",skeleton_show_time:0,waterfall_fetch_end:0,first_img_load_time:0,init_duration:0,data_duration:0,cover_duration:0}},waterfallLoadmoreStat:{eventName:"waterfall_loadmore_stat",params:{enter_from:"",duration:0}},videoCoverShow:{eventName:"video_cover_show",params:{enter_from:"discover",tab_name:"",author_id:"",group_id:"",cover_url:"",rank:0,trending_topic:"",logPb:"",module_id:-1,channel:"",aweme_type:"",is_compilation_anchor:0,badge:"",sub_tab_name:"",is_co_publish:0,co_publish_author_list:void 0,video_scale:0,from_click_group_id:"",if_first_big_card:0,visit_id:"",gid_rank:0,is_first_screen:0,page_rank:0,loading_duration:0,filter_name:"",boost_task_id:"",page_mode:"",is_first_large_card_outflow:"0",is_theme_progress_bar:""}},videoCoverLoad:{eventName:"video_cover_load",params:{enter_from:"discover",tab_name:"",author_id:"",group_id:"",cover_url:"",rank:0,trending_topic:"",logPb:"",module_id:-1,channel:"",aweme_type:"",is_compilation_anchor:0,badge:"",sub_tab_name:"",is_co_publish:0,co_publish_author_list:void 0,video_scale:0,from_click_group_id:"",if_first_big_card:0,first_page_item:0,cover_show_time:0,page_mode:""}},videoCoverClick:{eventName:"video_cover_click",params:{aweme_info:{},enter_from:"discover",tab_name:"",author_id:"",group_id:"",cover_url:"",rank:0,trending_topic:"",logPb:"",module_id:-1,channel:"",aweme_type:"",is_compilation_anchor:0,badge:"",sub_tab_name:"",is_co_publish:0,co_publish_author_list:void 0,from_click_group_id:"",if_first_big_card:0,visit_id:"",gid_rank:0,is_first_screen:0,page_rank:0,loading_duration:0,filter_name:"",boost_task_id:"",page_mode:"",is_first_large_card_outflow:"0",is_theme_progress_bar:""}},clickRefresh:{eventName:"click_refresh",params:{enter_from:"discover",tab_name:"",module_id:-1,channel:""}},loadingMore:{eventName:"loading_more",params:{enter_from:"discover",tab_name:"",url_path:"",module_id:-1}},clickDiscoverTab:{eventName:"click_discover_tab",params:{tab_name:"",module_id:-1}},clickLoadMore:{eventName:"click_load_more",params:{tab_name:"",click_position:"",enter_from:"discover"}},hoverPlayTime:{eventName:"hover_play_time",params:{group_id:"",author_id:"",enter_from:"",tab_name:"",duration:0,is_full_screen:"0",video_scale:0,if_first_big_card:0,visit_id:"",gid_rank:0,is_first_screen:0}},hoverPlay:{eventName:"hover_play",params:{group_id:"",author_id:"",enter_from:"",tab_name:"",is_full_screen:"0",video_scale:0,if_first_big_card:0,aweme_info:{},visit_id:"",gid_rank:0,is_first_screen:0}},autoVideoPlay:{eventName:"auto_video_play",params:{group_id:"",author_id:"",enter_from:"",tab_name:"",is_full_screen:"0"}},autoPlayTime:{eventName:"auto_play_time",params:{group_id:"",author_id:"",enter_from:"",tab_name:"",duration:0,is_full_screen:"0"}},noMoreContentShow:{eventName:"no_more_content_show",params:{enter_from:"discover"}},noMoreContentClick:{eventName:"no_more_content_click",params:{enter_from:"discover"}},pageView:{eventName:"page_view",params:{url:"",url_path:"",enter_from:"",link_from:"",tab_name:"",enter_method:"",aweme_type:0,theme:"light",is_topknot:0,abtest:"",ischange:"",old_ttwid:"",enter_by_tab:0,browser_height:0,browser_width:0,browser_ratio:0,redirect_from:"",from_push:0,seo_vids:"",url_source:"",url_source_method:"",word_strategy:"",physical_screen_num:0,physical_screen_info:"",match_id:"",enter_from_merge:"",is_small_window:0,is_mobile:0,is_ipad:0,is_apad:0,if_from_widget:0,theme_raw_value:"",reason:"",open_from_page:"",multi_window_order:"",multi_window_open_from:"",is_child_route:!1,is_support_wasm:!1,sub_tab_name:""}},pageStayTime:{eventName:"page_stay_time",params:{url:"",url_path:"",enter_from:"",enter_from_merge:"",previous_page:"",enter_method:"",duration:0,is_visible:1,link_from:"",tab_name:"",aweme_type:0,player_paused:0,player_muted:0,reason:"",is_child_route:!1,sub_tab_name:"",is_small_window:"0"}},filterPageStayTime:{eventName:"filter_page_stay_time",params:{duration:0,filter_list:"",filter_name:"",sub_tab_name:"",enter_method:"",enter_from:""}},firstScreenCount:{eventName:"first_screen_count",params:{tab_name:"",count:0,scene:"",pathname:"",log_id:""}},clickDiscoverTabReload:{eventName:"click_discover_tab_reload",params:{tab_name:""}},discoverClose:{eventName:"discover_close",params:{visit_id:"",close_method:"change_tab",to_page:""}},discoverCourserFilterListClick:{eventName:"discover_courser_filter_list_click",params:{filter_list:"",filter_name:"",sub_tab_name:"",enter_method:"",enter_from:""}}});let iV=(e,l)=>{let{cover:i,cover169UrlList:t,coverUrlList:n,cover169BigUrlList:o}=(null==e?void 0:e.video)||{},r=(null==e?void 0:e.isTopCard)&&(null==o?void 0:o[0])||(null==t?void 0:t[0]);return(null==l?void 0:l.jingxuanCover169)?r||i||(null==n?void 0:n[0]):i};var iF=i("739808");let iB={},iU=()=>{let e=et.e.getPipWindow({scene:V.d.ListenVideo})||et.e.getPipWindow({scene:V.d.WebVideo});e&&e.close()},iH=new Set(["onShow","onMouseEnter","onClick","onClickPipIcon"]),iG=new Set(["reuseConfig","logParams"]);var iZ=n.memo(e=>{var l,i,o,a,s,u,c,v,m,h,g,w,C,x,b,I,y,j,L,k,T,S,E,N,P,R,M,A,D,O,V,F,H,G,Z;let{isTabActive:$=!1,isTopCardActive:z=!1,isModalPlayingCurrentVideo:W,itemInfo:Y,appendPlayerConfig:q,abTestData:X={},onClick:K,onCoverLoad:Q,onLoadedData:ee,minAspectRatio:et,maxAspectRatio:en,onShow:er,onMouseEnter:ea,onMouseLeave:ed,isBigCard:es=!1,isTopCard:eu=!1,canLiveAutoPlay:ec=!0,scene:ev,tabName:em,onMorePopperShow:ef,onMorePopperHidden:e_,logParams:eh={},isFirstPageItem:eg,containerScrolled:ep,index:ew,scrollContainerRef:eC,reuseConfig:ex,onClickPipIcon:eb,modalAwemeInfoRef:eI,setModalAwemeInfo:ey,setDefaultModalAwemeInfo:ej,topAwemeId:eL}=e,{awemeType:ek,mixInfo:eT}=Y,{latestClickAwemeIdRef:eS,homeFetchData:eE,updateLatestClickAwemeIdRef:eN}=(0,e$.useDiscoverCommonContext)((0,eo.P1)(["latestClickAwemeIdRef","homeFetchData","updateLatestClickAwemeIdRef"])),eP=!!(null==eT?void 0:eT.mixId),eR=ek===eV.e.Note,eM={videoImageWidth:null==Y?void 0:Y.calculateWidth,videoImageHeight:null==Y?void 0:Y.calculateHeight,videoImagePriority:!!(void 0!==Y.index&&Y.index<=eZ.Rg),decoding:"async"},[eA,eD]=(0,n.useState)(!ep),[eO,eB]=(0,n.useState)({}),eU=(0,n.useRef)(null),eH=(0,ix.u)({value:(null==Y?void 0:null===(l=Y.video)||void 0===l?void 0:l.width)/(null==Y?void 0:null===(i=Y.video)||void 0===i?void 0:i.height),max:en,min:et}),eG=(0,iF.V1)(),{userInfo:ez,dispatch:eW}=(0,lS.useUserInfoContext)()||{},{info:eJ,isLogin:eY}=ez,eq=(0,n.useMemo)(()=>{if("discover"===ev)return!eu||!eG&&((null==X?void 0:X.jingxuanCover169)===U.JingxuanCover169.V2||(null==X?void 0:X.jingxuanCover169)===U.JingxuanCover169.V4||(null==X?void 0:X.jingxuanCover169)===U.JingxuanCover169.V5);return!1},[eG,eu,ev,X]),eX=(0,n.useRef)(!1);(0,r.C)(d.w3.components.discover_waterfall_item),(0,n.useEffect)(()=>{var e,l,i;eX.current&&(null==eS?void 0:eS.current)===(null==Y?void 0:Y.awemeId)&&((null==Y?void 0:null===(l=Y.video)||void 0===l?void 0:null===(e=l.playAddr)||void 0===e?void 0:e.length)||(null==Y?void 0:null===(i=Y.video)||void 0===i?void 0:i.playApi))&&(K(eO),eX.current=!1)},[null==Y?void 0:null===(o=Y.video)||void 0===o?void 0:o.playAddr,null==Y?void 0:null===(a=Y.video)||void 0===a?void 0:a.playApi,eO,K]);let eK=iV(Y,X),eQ=(0,n.useRef)(0),e0=(0,n.useMemo)(()=>{var e;let l=((null==Y?void 0:null===(e=Y.video)||void 0===e?void 0:e.coverUrlList)||[]).find(e=>e.includes(".heif?"));return!eg&&!!l&&("discover"===ev||(null==em?void 0:em.includes("channel")))},[eg,Y,ev,em]),e1=(0,n.useMemo)(()=>(0,_._)((0,f._)({},eh),{visit_id:J.Le.getConfig(J.gI.JingXuanVisitId)||"",is_first_screen:Number(eA),gid_rank:(ew||0)+1}),[eh,ew,eA]),e2=(0,n.useMemo)(()=>(null==Y?void 0:Y.awemeType)===eV.e.Note?(0,ib.Wr)(Y.awemeId):(0,ib.JF)(Y.awemeId),[Y.awemeId,null==Y?void 0:Y.awemeType]),e3=(0,n.useMemo)(()=>{var e,l,i,t,n,o,r,a,d,s;return{userHref:(0,ib.HC)(null==Y?void 0:null===(e=Y.authorInfo)||void 0===e?void 0:e.secUid,`enter_from=${(0,iI.yW)()}&enter_method=video_cover_title&from_gid=${null==Y?void 0:Y.awemeId}`),likesCount:(0,ii.qe)(Y.stats.diggCount),videoTime:(0,ii.$y)(Y.video.duration),previewUrlList:(null==Y?void 0:null===(i=Y.video)||void 0===i?void 0:null===(l=i.playAddr)||void 0===l?void 0:l.length)||(null==Y?void 0:null===(t=Y.video)||void 0===t?void 0:t.playApi)?[...null!==(s=null==Y?void 0:null===(r=Y.video)||void 0===r?void 0:null===(o=r.playAddr)||void 0===o?void 0:null===(n=o.map)||void 0===n?void 0:n.call(o,e=>e.src||""))&&void 0!==s?s:[]].concat((null==Y?void 0:null===(a=Y.video)||void 0===a?void 0:a.playApi)?null==Y?void 0:null===(d=Y.video)||void 0===d?void 0:d.playApi:[]):[]}},[null==Y?void 0:Y.video,null==Y?void 0:null===(s=Y.authorInfo)||void 0===s?void 0:s.secUid,null==Y?void 0:null===(u=Y.stats)||void 0===u?void 0:u.diggCount,null==Y?void 0:null===(c=Y.video)||void 0===c?void 0:c.duration]),e5=(null===(v=J.Le.getConfig(J.gI.JxOuterProgress))||void 0===v?void 0:v[null==Y?void 0:Y.awemeId])||{},e6=(0,B.d)((0,f._)({video_scale:(null==Y?void 0:null===(m=Y.video)||void 0===m?void 0:m.width)/(null==Y?void 0:null===(h=Y.video)||void 0===h?void 0:h.height),enter_from:(0,iy.vM)(),enter_from_merge:(0,iy.vM)(),group_id:null==Y?void 0:Y.awemeId,aweme_type:null==Y?void 0:Y.awemeType,is_compilation_anchor:0,from_click_group_id:null!==(N=null==Y?void 0:Y.insertId)&&void 0!==N?N:"",tab_name:em,if_follow:null!==(P=null===(C=J.Le.getConfig(J.gI.FollowStatusCache))||void 0===C?void 0:null===(g=C[null==Y?void 0:null===(w=Y.authorInfo)||void 0===w?void 0:w.uid])||void 0===g?void 0:g.followStatus)&&void 0!==P?P:null==Y?void 0:null===(x=Y.authorInfo)||void 0===x?void 0:x.followStatus,pc_source:null==Y?void 0:null===(b=Y.chanFeedVideo)||void 0===b?void 0:b.source,video_source:(0,ik.B)(Y),first_page_item:eg,cover_show_time:Date.now()-(null==eQ?void 0:eQ.current),visit_id:J.Le.getConfig(J.gI.JingXuanVisitId)||"",is_first_screen:Number(eA),gid_rank:(ew||0)+1,page_rank:Y.refreshIndex,boost_task_id:(null==Y?void 0:Y.boostTaskId)||"",is_theme_progress_bar:(null==e5?void 0:e5.isWatchedEnd)||(null==e5?void 0:e5.progress)?"1":"0"},eh)),e4=(0,n.useCallback)(()=>{!iB[Y.awemeId]&&(iB[Y.awemeId]=!0,eQ.current=Date.now(),null==er||er(),eD(!ep),iO.sendLog("videoCoverShow",e6.current))},[Y.awemeId,ep,e6,er]),e7=(0,n.useCallback)((e,l)=>{null==Q||Q(e,l,{isTopCard:null==Y?void 0:Y.isTopCard,isBigCard:null==Y?void 0:Y.isBigCard}),iO.sendLog("videoCoverLoad",e6.current)},[Q,null==Y?void 0:Y.isTopCard,null==Y?void 0:Y.isBigCard]),e8=(0,n.useCallback)(e=>{null==ee||ee((0,_._)((0,f._)({},e),{isTopCard:null==Y?void 0:Y.isTopCard,isBigCard:null==Y?void 0:Y.isBigCard}))},[ee,null==Y?void 0:Y.isTopCard,null==Y?void 0:Y.isBigCard]),e9=async e=>{let l=await (0,iT.m_)({awemeId:e,originType:lm.F.DiscoverOpen});(null==l?void 0:l.statusCode)===0&&(null==l?void 0:l.detail)&&(null==eS?void 0:eS.current)===e&&!(null==eI?void 0:eI.current)&&(null==ej||ej(null==l?void 0:l.detail),null==ey||ey(null==l?void 0:l.detail))},le=(0,n.useCallback)(()=>{var e,l,i,t,n;Y.awemeId&&(null===el.YY||void 0===el.YY||null===(n=el.YY.setPlayerReuseAble)||void 0===n||n.call(el.YY,ei.v.Discover,Y.awemeId)),null==eN||eN(null==Y?void 0:Y.awemeId),(0,ij.Vw)(iL.H.video_cover_click,(0,f._)({aweme_info:Y},e6.current)),iO.sendLog("videoCoverClick",e6.current);let o=`${d.w3.modal.modal_first_video_play}_start`;(0,eF.tl)(o),(0,eF.B1)({tag:o}),(null==Y?void 0:null===(e=Y.images)||void 0===e?void 0:e.length)||(null==Y?void 0:null===(i=Y.video)||void 0===i?void 0:null===(l=i.playAddr)||void 0===l?void 0:l.length)||(null==Y?void 0:null===(t=Y.video)||void 0===t?void 0:t.playApi)?K({visit_id:J.Le.getConfig(J.gI.JingXuanVisitId)||"",is_first_screen:Number(eA),gid_rank:(ew||0)+1,is_outflow:1,from_gid:null==Y?void 0:Y.awemeId,item_rank:1}):(eX.current=!0,(null==eE?void 0:eE.redisMode)==="replace"&&eg&&e9(Y.awemeId),eB({visit_id:J.Le.getConfig(J.gI.JingXuanVisitId)||"",is_first_screen:Number(eA),gid_rank:(ew||0)+1,is_outflow:1,from_gid:null==Y?void 0:Y.awemeId,item_rank:1}))},[e6,ew,Y,null==Y?void 0:Y.awemeId,null==Y?void 0:Y.images,null==Y?void 0:null===(I=Y.video)||void 0===I?void 0:I.playAddr,null==Y?void 0:null===(y=Y.video)||void 0===y?void 0:y.playApi,K,eA,eg,eE,eN]),ll=eg||iB[Y.awemeId],li=Y.awemeType===eV.e.LiveCard,{isActiveLiveCard:lt,onHoverChange:ln,canLivePlay:lo}=iA({itemInfo:Y,itemRef:eU,index:ew,topAwemeId:eL,canLiveAutoPlay:ec,isTabActive:$}),{cellRoomRowData:lr,userCount:la,requestId:ld}=iM(Y);if(li)return(0,t.jsx)("div",{ref:eU,style:{height:"100%"},children:(0,t.jsx)(iw,{onHoverChange:ln,onEnterLive:iU,isFirstPageItem:eg,awemeInfo:Y,isActive:lo,rawData:lr,instanceId:lt?"AUTOPLAY_LIVE_CARD":"MULTI_PLAY_LIVE_CARD",description:(null==lr?void 0:lr.title)||"",anchorId:(null==lr?void 0:null===(R=lr.owner)||void 0===R?void 0:R.id_str)||"",roomId:(null==lr?void 0:null===(A=lr.owner)||void 0===A?void 0:null===(M=A.own_room)||void 0===M?void 0:M.room_ids_str[0])||"",webRid:(null==lr?void 0:null===(D=lr.owner)||void 0===D?void 0:D.web_rid)||"",userCount:la,cover:(null==lr?void 0:null===(V=lr.cover)||void 0===V?void 0:null===(O=V.url_list)||void 0===O?void 0:O[0])||"",isEnd:(null==lr?void 0:lr.status)!==2,teaLogParams:{live_position:(ew||0)+1,anchor_id:null==lr?void 0:null===(F=lr.owner)||void 0===F?void 0:F.id_str,room_id:(null==lr?void 0:null===(G=lr.owner)||void 0===G?void 0:null===(H=G.own_room)||void 0===H?void 0:H.room_ids_str[0])||"",enter_from_merge:"web_homepage_discover",enter_method:"web_live_card",is_aweme_tied:eY?1:0,request_id:ld},source:{userName:null==lr?void 0:null===(Z=lr.owner)||void 0===Z?void 0:Z.nickname},title:(null==lr?void 0:lr.title)||"",isLogReady:!!eY,linkerMap:null==lr?void 0:lr.linker_map,scale:4/3})});let ls=(0,t.jsx)(iS.Z,(0,_._)((0,f._)({className:p()("waterfall-videoCardContainer",{jingxuanVideoCard:"discover"===ev}),cardIndex:ew,imageBoxClassName:iR,imgClass:p()("discover-video-card-img",{"jingxuan-top-card-img":eu}),onLoadedData:e8,logParams:e1,enableCardHoverPreview:!1,showHighLightTag:!0,appendPlayerConfig:q,showImageInSSR:eg,disabledALink:!0,imageReady:ll,showHomeNote:eR,showHomeCollect:eP,awemeInfo:Y,url:e2,description:(null==Y?void 0:null===(j=Y.webRawData)||void 0===j?void 0:j.cutTitle)||Y.desc,imgUrl:eK,onClick:le,onMouseLeave:ed,onMouseEnter:ea,imageClassName:iE,imageSkeletonClass:p()({[iP]:(null==Y?void 0:null===(L=Y.video)||void 0===L?void 0:L.cover)==="cache"}),userName:Y.authorInfo.nickname,userHref:e3.userHref,userHrefTarget:"_blank",likesCount:e3.likesCount,videoTime:e3.videoTime,width:null==Y?void 0:null===(k=Y.video)||void 0===k?void 0:k.width,height:null==Y?void 0:null===(T=Y.video)||void 0===T?void 0:T.height,previewUrlList:e3.previewUrlList,isHorizontal:(null==Y?void 0:null===(S=Y.video)||void 0===S?void 0:S.width)>(null==Y?void 0:null===(E=Y.video)||void 0===E?void 0:E.height),fakeHorizontalInfo:null==Y?void 0:Y.fakeHorizontalInfo,isShowCreateTime:!0,videoImageStyle:{paddingTop:`${1/eH*100}%`},onShow:e4,onCoverLoad:e7,onUserNameClick:()=>{var e;iC.logInstance.sendLog("clickNickname",{enter_from:(0,iI.yW)(),to_user_id:null==Y?void 0:null===(e=Y.authorInfo)||void 0===e?void 0:e.uid,group_id:null==Y?void 0:Y.awemeId})},scene:ev,blurLightCover:!1,user:{info:eJ,isLogin:eY,dispatch:eW},abTestData:X,enableNotePreview:!0,needOperateHidden:null==X||!X.jingxuanCover169||!eu,topAwemeId:eL,isTopCard:eu,isBigCard:es,isTopCardActive:z,isModalPlayingCurrentVideo:W},eM),{showMore:!0,tab:em,showWatchLater:!0,onMorePopperHidden:e_,onMorePopperShow:ef,withBlurBg:eq,cardInfoClassName:p()({[iN]:"discover"===ev}),enableImageX:e0,scrollContainerRef:eC,reuseConfig:ex,onClickPipIcon:eb}),`${Y.awemeId}${eu?"-topcard":""}`);return eu?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(iD,{itemInfo:Y,isTabActive:$}),ls]}):ls},(e,l)=>{var i;if(!(null===(i=J.Le.getConfig(J.gI.AbtestData))||void 0===i?void 0:i.enableJingxuanZustand))return!1;for(let i in l){if(!(iH.has(i)||iG.has(i))){if(!Object.is(e[i],l[i]))return!1}}return!0}),i$=i("892043"),iz=i("375944"),iW=i("176638");let iJ=e=>{var l;let{abTestData:i,className:n,country:o}=e,r={wid:(null===(l=(0,lk.Es)())||void 0===l?void 0:l.user_unique_id)||""},a={clientType:(0,s.DT)()?"Client":"Web",os:(0,iz.fV)().os,isInPWA:(0,iW.f)()},d={teaInstance:iC.logInstance};return i.homeBanner===U.HomeBannerABVal.On?(0,t.jsx)(i$.Z,{className:n,userInfo:r,systemInfo:a,logConfig:d,country:o,clickAction:()=>{z.emit(z.EVENT.OpenJXModal,{source:"discover_banner"})}}):null};var iY=i("327306");let iq=ef.ERROR_CODE,iX=(e,l)=>{var i;let t=null===(i=(0,K.oZ)(l))||void 0===i?void 0:i.fetcher;return t?t.request({cached:!0,consume:!0,params:e,fetcherOptions:{expired:36e5,resetExpiredCacheBefore:!1,hoverDelay:!0}}):(0,eh.F)(e)};var iK=e=>{var l,o,a,s;let{tab:u,subTagInfoRef:c,filterName:v,request:m,isTabActive:h,selectedTab:g,modalAwemeInfo:w,setModalAwemeInfo:C,setDefaultModalAwemeInfo:x,defaultList:b,perfLogFunctions:I,preloadModuleFeed:y,onVideoCardMouseLeave:j,onVideoCardClick:L,country:k,className:T,onClickPipIcon:S,setLogParams:E,appendPlayerConfig:N,showReplaceLoading:P,setShowReplaceLoading:R}=e,M=(0,B.d)(w),A=(0,n.useRef)(null),D=(0,n.useRef)(),O=(0,n.useRef)(),V=(0,lS.useUserInfoContext)()||{},H=(0,iY._)()||{};!function(e){let{ref:l,abTestData:t}=e;(0,n.useEffect)(()=>{let e=l.current;if(e){let l;let t=!1;return i.e("16708").then(i.t.bind(i,597965,23)).then(i=>{var n,o;let{Monitor:r}=i;if(!t)(l=new r({el:e,appId:6383,region:"cn",userUniqueId:null!==(o=null===(n=(0,lk.Es)())||void 0===n?void 0:n.user_unique_id)&&void 0!==o?o:"",selector:"img, canvas",customHeadersHandler:e=>{let l=e.get("x-imagex-extra");return JSON.parse(null!=l?l:"{}")},defaultConfig:{reportRateConfig:{reportRate:.1,reportRateError:.1}}})).updateReportParams({imagex_vid:0}),l.start()}),()=>{t=!0,null==l||l.stop()}}},[])}({ref:O,abTestData:H});let G=eZ.z0[g],[Z,$]=(0,n.useState)(),[W,Y]=(0,n.useState)(),[q,K]=(0,n.useState)(!1),{homeFetchData:Q,isDefaultLanding:ee,updateFeedCardAdResourceList:et,updateSubTabLiveCardList:en,pageMode:er}=(0,e$.useDiscoverCommonContext)((0,eo.P1)(["homeFetchData","isDefaultLanding","updateFeedCardAdResourceList","updateSubTabLiveCardList","pageMode"])),ea=(0,n.useRef)((null==Q?void 0:Q.isCourse)&&null!==(a=null==Q?void 0:null===(o=Q.awemeList)||void 0===o?void 0:null===(l=o.map)||void 0===l?void 0:l.call(o,e=>null==e?void 0:e.awemeId))&&void 0!==a?a:[]),es=(0,n.useRef)(0);(0,r.C)(d.w3.components.discover_tab);let{setLoadingElement:eu}=(0,e_._)({scrollListenerEl:W,scene:G,enableRecordFrameTime:!0,enableRecordLongTask:!0,enableRecordLoadingShow:!0,crashFPSThreshold:24,slideEndDelay:300,logParams:(0,f._)({sub_tab_name:null!==(s=eZ.z0[g])&&void 0!==s?s:g},ee?{enter_method:"default_landing"}:{}),abTestData:H});!function(e){let{scrollEl:l,onSideBarShow:i}=e;(0,F.o)(()=>{if(!l)return;z.emit(z.EVENT.globalScrollEl,l);let e=z.listen(z.EVENT.sideBarShow,()=>{z.emit(z.EVENT.globalScrollEl,l),null==i||i()});return()=>{e()}},[l])}({scrollEl:W});let{targetResource:ev}=(0,X.II)(e=>{let{targetResource:l}=e;return{targetResource:l}}),{stuff_detail:ef}=ev||{},eh=(0,n.useRef)(!0),ew=ln(H),eC=(0,n.useCallback)(async()=>{var e;let l;em.z.markStart("discover_csr_fetch_data",{once:!0});let i=Q&&(null==Q?void 0:null===(e=Q.awemeList)||void 0===e?void 0:e.length),t=!i&&eh.current,n={tagId:"0"===g?"":g,activeId:u.is_active_tab?u.key:"",isActiveTab:u.is_active_tab},o=ew.current&&"0"===g,r={useV2:1};if(!i&&eh.current&&(r.liteType=1,o&&(r.pullType=8)),eh.current&&(eh.current=!1),t){let[e]=await Promise.allSettled([m(t,(0,f._)({},r,n)),null==et?void 0:et(g),null==en?void 0:en()]).finally(()=>eh.current=!1);l=(0,f._)({},(null==e?void 0:e.status)==="fulfilled"&&(null==e?void 0:e.value)||{})}else l=await m(t,(0,f._)({},r,n)).finally(()=>eh.current=!1);return em.z.markEnd("discover_csr_fetch_data",{once:!0}),l},[m,u,g,Q,et]),ex=(0,n.useRef)(!0);(0,F.o)(()=>{if(ex.current){ex.current=!1;return}I.onCacheTabActive(g)},[]),(0,F.o)(()=>{if(Z){let e=()=>{K(!0)};return Z.addEventListener("scroll",e),()=>{Z.removeEventListener("scroll",e)}}},[Z]),(0,F.o)(()=>{if(w)return()=>{};if(!D.current)return;let e=e=>{if("ArrowDown"===e.code||"ArrowUp"===e.code){let i="ArrowUp"===e.code,t=D.current;if(t){var l;(0,eg.X)({top:Math.min(Math.max((null!==(l=t.scrollTop)&&void 0!==l?l:0)+(i?-100:100),0),t.scrollHeight),behavior:"smooth"},t)}}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[w]);let eb=(0,n.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;arguments.length>1&&arguments[1];for(let l=0;l<3;l++){let i;if(g===eZ._D[eZ.JY.Course]){let l=0===(i=await iX({tabId:"screen_course_page",offset:e,size:6,tagIdList:c.current.courseTagIdStr,idList:ea.current.join(",")},c.current.courseTagIdStr)).statusCode&&0===i.awemeList.length&&i.hasMore;es.current=l?es.current+1:0,i.hasMore=i.hasMore&&es.current<3}else i=await eC();let{statusCode:t,hasMore:n,awemeList:o=[],offset:r=0,logPb:a="",responseFrom:d=""}=i;if(0===t&&0!==o.length||2===l)return{data:lp(o,H),hasMore:!!n,statusCode:t,logPb:a,responseFrom:d,maxCursor:r}}return{data:[],hasMore:!1,statusCode:iq.ERROR_UNKNOWN,logPb:""}},[V,eC,g,c]);(0,F.o)(()=>()=>{(null==D?void 0:D.current)&&(D.current.style.overflow="auto")},[]);let{onShow:eI,onClose:ey}=lN({selectedTab:g}),ej=(e,l)=>{if(E(l),J.Le.setConfig(J.gI.ModalStartOpenTime,Date.now()),L(e.awemeId),3===H.discoverOptimize){let l=(0,f._)({},e);l.video.originCover=iV(e,H),C(l)}else C(e)},eL=e=>{if(e.awemeId){var l;null===el.YY||void 0===el.YY||null===(l=el.YY.setPlayerReuseAble)||void 0===l||l.call(el.YY,ei.v.Discover,e.awemeId)}if(S(),L(e.awemeId),3===H.discoverOptimize){let l=(0,f._)({},e);l.video.originCover=iV(e,H),C(l)}else C(e)},ek=(0,n.useMemo)(()=>{var e;return(0,f._)({sub_tab_name:null!==(e=eZ.z0[g])&&void 0!==e?e:g,filter_name:v||""},ee?{enter_method:"default_landing"}:{})},[ee,g,v]),eT=(0,n.useCallback)(()=>{D.current&&(D.current.style.overflow="auto")},[]),eS=(0,n.useCallback)(()=>{if(D.current){let{scrollTop:e}=D.current;D.current.style.overflow="hidden",D.current.scrollTop=e}},[]),eE=(0,n.useCallback)((e,l,i,n,o,r,a)=>{var d,s,u;let c=!!(null==Q?void 0:null===(s=Q.awemeList)||void 0===s?void 0:null===(d=s.find)||void 0===d?void 0:d.call(s,l=>(null==l?void 0:l.awemeId)===e.awemeId));return e.itemType===eA.CardAd?(0,t.jsx)(ep.l,{cardAd:e,cardStyle:"transparent",onShow:eI,onClose:ey,logParams:{sub_tab_name:eZ.z0[g],filter_name:v||""},enterMethod:"discover_ad_card"}):e.itemType===eA.SubTabLive?(0,t.jsx)(eM,{cardLiveInfo:e,cardStyle:"transparent"}):(0,t.jsx)(iZ,{isTabActive:h,isTopCardActive:(null==e?void 0:e.isTopCard)?!w&&h:void 0,isModalPlayingCurrentVideo:(null==e?void 0:e.awemeId)===(null==w?void 0:w.awemeId),canLiveAutoPlay:a,appendPlayerConfig:N,isFirstPageItem:c,containerScrolled:q,minAspectRatio:e1,maxAspectRatio:e1,scene:"discover",onCoverLoad:l,onLoadedData:I.onLoadedData,reuseConfig:{scene:ei.v.Discover,reuseId:null==e?void 0:e.awemeId,autoCreate:!0,keepPlayer:null==e?void 0:e.isTopCard},onShow:()=>{null==i||i()},index:n,onMouseEnter:()=>{null==y||y(e.awemeId,U.MainHoverPreloadAction.hover,!0)},onMouseLeave:j,itemInfo:e,abTestData:H,onClick:l=>ej(e,l),onClickPipIcon:()=>eL(e),isBigCard:null==e?void 0:e.isBigCard,isTopCard:null==e?void 0:e.isTopCard,topAwemeId:r,onMorePopperShow:eS,onMorePopperHidden:eT,logParams:(0,_._)((0,f._)({sub_tab_name:null!==(u=eZ.z0[g])&&void 0!==u?u:g,filter_name:v||"",is_first_large_card_outflow:(null==e?void 0:e.isBigCard)?"1":"0"},ee?{enter_method:"default_landing"}:{}),{page_mode:er}),scrollContainerRef:o,modalAwemeInfoRef:M,setModalAwemeInfo:C,setDefaultModalAwemeInfo:x})},[H,y,j,g,h,Q,ee,q,w,N,ek]);return(0,t.jsxs)("div",{className:p()(ec.waterfallPage,T),ref:e=>{if(!!e){O.current=e;D.current=e,$(e),Y(e)}},children:["0"===g&&(0,t.jsx)(iJ,{className:ec.bannerContainer,abTestData:H,country:k}),ef&&"300205"===g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ed,{islandMode:"load",disableTDK:!0,className:p()(ec.topicPage,ec.topicPageWithDiscoverCardOptimize)}),(0,t.jsx)("div",{className:ec.feedTitle,style:{paddingLeft:28},children:(0,t.jsx)("h2",{children:"更多热门"})})]}):null,(0,t.jsx)("div",{className:p()(ec.wrapperMarin,"jingxuanFeedList"),children:(0,t.jsx)(lg,{ref:A,awemeIdsRef:ea,defaultList:b,scrollParentEl:Z,scrollListenerEl:W,renderItem:eE,fetchMore:eb,modalAwemeInfo:w,abTestData:H,selectedTab:g,isGaiaTab:u.is_active_tab,tagId:"0"!==g&&g?g:"",perfLogFunctions:I,setLoadingElement:eu,setShowReplaceLoading:R,showReplaceLoading:P})})]})},iQ=i("172660"),i0=i("794593"),i1=()=>{let e=(0,n.useRef)({step:{init:!1,skeleton:!1,cover:!1,loadmore:0,top_card_cover:!1,top_card_load_data:!1},info:{reload:!1,tabChange:!1,log:!1,activeKey:"",sub_tab_name:"",filter_name:""}}),l=()=>{let l=(0,Y.I)()?"route":"url",i=e.current.info.reload?"reload":l;return e.current.info.tabChange&&(i=`tab-change-${e.current.info.activeKey}`),{enter_from:(0,iI.yW)(),from:i}},i=l=>(0,Y.I)()||e.current.info.reload?(0,eF.J1)(l)-(0,eF.J1)(d.w3.page.page_init_time):(0,eF.J1)(l),t=l=>{if((0,Y.I)()||e.current.info.reload){let e=(0,eF.J1)(d.w3.page.page_tab_click_time);return e?((0,eF.tl)(d.w3.page.page_tab_click_time),(0,eF.J1)(l)-e):(0,eF.J1)(l)-(0,eF.J1)(d.w3.page.page_init_time)}if(!e.current.info.tabChange)return(0,eF.J1)(l);{var i;let e=null!==(i=(0,eF.J1)("discover_tab_change"))&&void 0!==i?i:0;return(0,eF.J1)(l)-e}},o=(0,n.useCallback)(l=>e.current.info.activeKey===l,[]);(0,F.o)(()=>z.listen(z.EVENT.RefreshFeedList,l=>{(0,eF.B1)({tag:d.w3.page.page_init_time}),e.current.step.cover=!1,e.current.step.top_card_cover=!1,e.current.step.top_card_load_data=!1,e.current.info.reload=!0,e.current.info.tabChange=!1,e.current.info.log=!1}),[]),(0,a.w)(()=>{(0,eF.tl)("discover_tab_change")},[]);let r=async function(){var n;if(arguments.length>0&&void 0!==arguments[0]&&arguments[0],e.current.info.log)return;let{enter_from:o,from:r}=l();if(J.Le.getConfig(J.gI.DiscoverPageCache)){let e=(0,eF.J1)(d.w3.page.cache_page_active_time)-(0,eF.J1)("click_discover_tab");i0.Z.report("web_perf_timing",{enter_from:o,from:"cache",[d.w3.moment.first_img_render_time]:e});return}let a=i(d.w3.moment.skeleton_render_time),u=i(d.w3.fetchers.fetcher_waterfall_start),c=i(d.w3.fetchers.fetcher_waterfall_end),v=t(d.w3.moment.first_img_render_time),m={enter_from:o,from:r,[d.w3.fetchers.fetcher_waterfall_start]:u,[d.w3.fetchers.fetcher_waterfall_end]:c,[d.w3.fetchers.fetcher_waterfall_duration]:c-u,[d.w3.moment.skeleton_render_time]:a,[d.w3.moment.first_img_render_time]:v};if(performance.getEntriesByName("img-loaded")[0]&&"url"===r&&(null===(n=window.pageDirectRender)||void 0===n?void 0:n.imageLoadedTime)){let e=window.pageDirectRender.imageLoadedTime;(0,eF.tl)("img-loaded");let l=(0,s.DT)()?await (0,iQ.P)(e):{};i0.Z.report("web_perf_timing",(0,_._)((0,f._)({},l,m),{from:"url",[d.w3.moment.first_img_render_time]:e,scene:window.JX_CACHE?"first_screen_cache":""}))}else{let e=(0,s.DT)()?await (0,iQ.P)(v):{};i0.Z.report("web_perf_timing",(0,f._)({},e,m))}e.current.info.log=!0},u=()=>{e.current.step.loadmore=0},c=(0,n.useCallback)(()=>{!e.current.step.skeleton&&((0,eF.B1)({tag:d.w3.moment.skeleton_render_time}),e.current.step.skeleton=!0)},[]),v=(0,n.useCallback)((i,n,o)=>{if((null==o?void 0:o.isTopCard)&&i&&!e.current.step.top_card_cover){var a;if(e.current.step.top_card_cover=!0,J.Le.getConfig(J.gI.DiscoverPageCache))return;(0,eF.B1)({tag:"jingxuan_top_card_img_loaded"});let{from:i}=l(),n=0,r=null===(a=performance.getEntriesByName("jingxuan-top-img-load"))||void 0===a?void 0:a[0];r?(n=r.startTime,(0,eF.tl)("jingxuan-top-img-load")):n=t("jingxuan_top_card_img_loaded"),i0.Z.report("jingxuan_perf_timing",{from:i,first_img_load_time:n,is_first_large_card_outflow:(null==o?void 0:o.isBigCard)?"1":"0",sub_tab_name:e.current.info.sub_tab_name,filter_name:e.current.info.filter_name})}!e.current.step.cover&&i&&((0,eF.B1)({tag:d.w3.moment.first_img_render_time}),e.current.step.cover=!0,r(n))},[]),m=(0,n.useCallback)(i=>{if((null==i?void 0:i.isTopCard)&&!e.current.step.top_card_load_data){e.current.step.top_card_load_data=!0;let{from:n}=l(),o=t("jx-top-card-first-frame");i0.Z.report("jingxuan_perf_timing",{from:n,cost:null==i?void 0:i.cost,first_data_load_time:o,is_first_large_card_outflow:(null==i?void 0:i.isBigCard)?"1":"0",sub_tab_name:e.current.info.sub_tab_name,filter_name:e.current.info.filter_name})}},[]),h=(0,n.useCallback)(e=>{let{enter_from:i}=l();(0,eF.B1)({tag:"discover_tab_active"});let t=(0,eF.J1)("discover_tab_change");if(!t)return;let n=(0,eF.J1)("discover_tab_active");i0.Z.report("web_perf_timing",{enter_from:i,from:`tab-change-${e}-cache`,[d.w3.moment.first_img_render_time]:n-t})},[]),g=(0,n.useCallback)(l=>{e.current.info.activeKey=l},[]),p=(0,n.useCallback)(l=>{e.current.info.sub_tab_name=l.sub_tab_name,e.current.info.filter_name=l.filter_name},[]),w=(0,n.useCallback)(l=>{e.current.step.cover=!1,e.current.info.reload=!1,e.current.info.log=!1,e.current.step.top_card_cover=!1,e.current.step.top_card_load_data=!1,g(l),e.current.info.tabChange=!0,(0,eF.B1)({tag:"discover_tab_change"})},[]),C=(0,n.useCallback)(l=>{l===e0.LOADING&&0===e.current.step.loadmore&&(e.current.step.loadmore=1,(0,eF.B1)({tag:"page_discover_loadmore_show",detail:{status:l}})),l===e0.SUCCESS&&1===e.current.step.loadmore&&(e.current.step.loadmore=2,(0,eF.B1)({tag:"page_discover_loadmore_hidden",detail:{status:l}}),u())},[]),x=(0,n.useCallback)(()=>{(0,eF.B1)({tag:d.w3.page.page_init_time}),(0,eF.tl)(d.w3.fetchers.fetcher_waterfall_start),(0,eF.tl)(d.w3.fetchers.fetcher_waterfall_end);let{step:l,info:i}=e.current;l.cover=!1,l.top_card_cover=!1,l.top_card_load_data=!1,l.skeleton=!1,l.loadmore=0,i.log=!1,i.reload=!0,i.tabChange=!1},[]);return!e.current.step.init&&((0,eF.B1)({tag:d.w3.page.page_init_time}),e.current.step.init=!0),(0,F.o)(()=>{J.Le.getConfig(J.gI.DiscoverPageCache)&&((0,eF.B1)({tag:d.w3.page.cache_page_active_time}),r())},[]),(0,a.w)(()=>{J.Le.setConfig(J.gI.DiscoverPageCache,!0),e.current.info.log=!1},[]),(0,n.useEffect)(()=>{let e=()=>r();return document.addEventListener("visibilitychange",e),window.addEventListener("beforeunload",e),()=>{document.removeEventListener("visibilitychange",e),window.removeEventListener("beforeunload",e),r(),(0,eF.tl)(d.w3.fetchers.fetcher_waterfall_start),(0,eF.tl)(d.w3.fetchers.fetcher_waterfall_end)}},[]),(0,n.useRef)({onSkeletonShow:c,onLoadMoreShow:C,onCoverLoad:v,onLoadedData:m,onReload:x,onCacheTabActive:h,updateTabInfo:g,updateLogInfo:p,onTabChange:w,isActiveTab:o}).current},i2=i("387595");let i3=eZ._D[eZ.JY.Course],i5=e=>(null==e?void 0:e.length)?[{tagId:0,tagLevel:0,tagTitle:"全部"},...e]:[],i6=e=>{var l;return e?`[${null!==(l=e.parentTagId)&&void 0!==l?l:e.tagId},${e.parentTagId?e.tagId:0},0]`:"[0,0,0]"};var i4=i("906499"),i7={container:"BV4VjV4V",switchBtn:"yNXnwbCx",tabList:"MiT1nPeA",tabExpand:"a4PHYcwe",tab:"G64ykXqt",disabled:"kGkPufW9",active:"aFtto_CK"};let i8=(0,b.ZP)(()=>i.e("56877").then(i.bind(i,551303)),{ssr:!1}),i9=[{label:"全部",key:"0"},{label:"公开课",key:"100000"},{label:"游戏",key:"300205"},{label:"二次元",key:"300206"},{label:"音乐",key:"300209"},{label:"美食",key:"300204"},{label:"知识",key:"300213"},{label:"体育",key:"300207"}],te=e=>{let l=(0,n.useMemo)(()=>(null==e?void 0:e.length)?e:i9,[e]);return(0,n.useEffect)(()=>{(0,K.mi)(l)},[l]),l};var tl=e=>{var l;let{className:i,tabClassName:o,style:r,onTabClick:a,tabList:d,activeKey:s,onTabChange:u,disabled:c=!1,abTestData:v,isSpider:m}=e,f=(0,n.useRef)(null),_=(0,n.useRef)(null),h=te(d),g=(e,l)=>{null==a||a(e,l),!c&&(null==e?void 0:e.key)!==s&&(null==u||u(e,l))};return(0,n.useEffect)(()=>{var e,l;null==_||null===(l=_.current)||void 0===l||null===(e=l.updateButtonStatus)||void 0===e||e.call(l)},[h]),(0,t.jsxs)("div",{className:p()(i7.container,i7.tabExpand,i),style:r,children:[(0,t.jsx)("div",{className:i7.tabList,ref:f,children:null==h?void 0:null===(l=h.map)||void 0===l?void 0:l.call(h,(e,l)=>{var i;let{label:n,key:r}=e,a=null!==(i=eZ.z0[Number(r)])&&void 0!==i?i:"all",d="all"===a?"/jingxuan":`/jingxuan/${a}`,u=`https://www.douyin.com${d}`;return(0,t.jsx)("div",{className:p()(i7.tab,{[i7.active]:r===s,[i7.disabled]:c},o),onClick:i=>{var t,n;g(e,l),null==_||null===(n=_.current)||void 0===n||null===(t=n.onItemClick)||void 0===t||t.call(n,i,l)},onMouseEnter:()=>{var e;let{predictor:l}=null!==(e=(0,K.Z1)(r))&&void 0!==e?e:{};if(r!==s&&!c&&!!l)l.enter({params:{useV2:1,liteType:1,tagId:r},fetcherOptions:{expired:3e4,resetExpiredCacheBefore:!1,hoverDelay:!0}})},children:m?(0,t.jsx)(i4.a,{target:"_blank",href:u,children:n}):n},r)})}),(0,t.jsx)(D.SV,{Slardar:es.oe,children:(0,t.jsx)(n.Suspense,{fallback:null,children:(0,t.jsx)(i8,{ref:_,className:i7.switchBtn,scrollRef:f})})})]})};let ti=(e,l)=>{let i=(0,n.useMemo)(()=>((null==e?void 0:e.length)?e:i9).some(e=>e.key===l)?l:"0",[l,e]),t=(0,n.useRef)(i);return(0,n.useEffect)(()=>{t.current=i},[i]),(0,n.useEffect)(()=>{let e=new URL(location.href);e.searchParams.get("tag_id")&&(e.searchParams.delete("tag_id"),window.history.replaceState(null,"",e))},[]),{selectedTab:i,selectedTabRef:t}};var tt=i("903868");let tn=(0,b.ZP)(()=>i.e("56877").then(i.bind(i,551303)),{ssr:!1}),to={mp4encryptplayer:{config:{waitingTimeOut:7500,canplayTimeout:7500,timeout:4500}},DASHPlugin:{waitingTimeOut:7500,canplayTimeout:7500,timeout:4500}},tr=n.forwardRef((e,l)=>{let{request:i,resetRefreshIndex:o,tabs:s,country:c,defaultTagId:v,onChannelTabChange:m,onChannelTabReload:g,defaultSubTags:b}=e,{homeFetchData:I,setHomeFetchData:y,isDefaultLanding:j,updateFeedCardAdResourceList:L,updateSubTabLiveCardList:k,ssrTagId:T}=(0,e$.useDiscoverCommonContext)((0,eo.P1)(["homeFetchData","setHomeFetchData","isDefaultLanding","updateFeedCardAdResourceList","updateSubTabLiveCardList","ssrTagId"])),{isListenVideoMiniWin:S,jxRedisMode:E}=(0,tt.Iq)(e=>{let{isListenVideoMiniWin:l,jxRedisMode:i}=e;return{isListenVideoMiniWin:l,jxRedisMode:i}}),[N,P]=(0,n.useState)(null),[R,M]=(0,n.useState)(null),[er,ea]=(0,n.useState)({}),[em,ef]=(0,n.useState)(!1),e_=(0,n.useRef)(null);(0,n.useRef)(null);let eg=(0,n.useRef)(null),[ep,ew]=(0,n.useState)(null),eC=te(s),{selectedTab:ex,selectedTabRef:eb}=ti(eC,v),eI=(0,lS.useUserInfoContext)()||{},ey=(0,iY._)()||{},{targetResource:ej,handleTagChange:eL,resourceList:ek}=(0,X.II)(e=>{let{targetResource:l,handleTagChange:i,resourceList:t}=e;return{targetResource:l,handleTagChange:i,resourceList:t}}),{stuff_detail:eT}=ej||{},{keep_old_component:eS}=eT||{},eE=null==R?void 0:R.awemeId,eN=i1(),eP="replace"===E&&T===ex,[eR,eM]=(0,n.useState)(eP),eA=ln(ey);(0,r.C)(d.w3.components.discover_feed_list);let eD=(0,n.useMemo)(()=>{var e;return null==ek?void 0:null===(e=ek.find)||void 0===e?void 0:e.call(ek,e=>{try{var l;let i=JSON.parse(null==e?void 0:e.stuff_detail);return(null==i?void 0:i.reuse_tab)&&(null==i?void 0:null===(l=i.tab)||void 0===l?void 0:l.includes("300205"))}catch(e){return!1}})},[ek]);(0,n.useImperativeHandle)(l,()=>({setShowReplaceLoading:eM})),(0,O.C)(()=>{var e,l,i,t,n,o,r,a,d,s,u,c,v,m,f;if((null===(l=window)||void 0===l?void 0:null===(e=l.__QUICK_PLAYER)||void 0===e?void 0:e.removeCardHandlers)&&(window.__QUICK_PLAYER.removeCardHandlers.forEach(e=>"function"==typeof e&&e()),delete window.__QUICK_PLAYER.removeCardHandlers),null===(t=window)||void 0===t?void 0:null===(i=t.__QUICK_PLAYER)||void 0===i?void 0:i.player){let e=null===(n=window.__QUICK_PLAYER)||void 0===n?void 0:n.awemeInfo;e?(P(e),M(e),null===(o=window.__QUICK_PLAYER)||void 0===o||delete o.awemeInfo):(null===(s=window)||void 0===s||null===(d=s.__QUICK_PLAYER)||void 0===d||null===(a=d.player)||void 0===a||null===(r=a.destroy)||void 0===r||r.call(a),null===(v=window)||void 0===v||null===(c=v.__QUICK_PLAYER)||void 0===c||null===(u=c.destroyQuickPlayerDom)||void 0===u||u.call(c),null===(m=window)||void 0===m||delete m.__QUICK_PLAYER)}else null===(f=window)||void 0===f||delete f.__QUICK_PLAYER},[]),(0,n.useEffect)(()=>{let{url:e,query:l}=h.parseUrl(location.href);(null==l?void 0:l.modal_id)&&eV(e=>(0,_._)((0,f._)({},e),{targetGid:null==l?void 0:l.modal_id,ready:!0}))},[]);let[eO,eV]=(0,n.useState)({ready:!1,awemeList:[],targetGid:""}),eF=(0,n.useRef)(""),eB=(0,n.useMemo)(()=>{var e,l;return K.WB.setDelay((null==ey?void 0:null===(e=ey.jingxuanModalOpt)||void 0===e?void 0:e.triggerTime)||2e3),{action:U.MainHoverPreloadAction.hover,cache:U.MainHoverPreloadCache.off,cacheTime:0,count:(null==ey?void 0:null===(l=ey.jingxuanModalOpt)||void 0===l?void 0:l.preloadCount)||8}},[ey]);(0,n.useEffect)(()=>{(null==eB?void 0:eB.cache)===U.MainHoverPreloadCache.on&&ev.Z.setCacheTime(null==eB?void 0:eB.cacheTime)},[eB]),(0,n.useEffect)(()=>{eF.current=null==R?void 0:R.awemeId},[R]);let eU=(0,n.useMemo)(()=>{let e=[],l=!1;if((null==eB?void 0:eB.action)===U.MainHoverPreloadAction.hover||(null==eB?void 0:eB.action)===U.MainHoverPreloadAction.click){var i;let t=!1;(null==ey?void 0:null===(i=ey.jingxuanModalOpt)||void 0===i?void 0:i.logicOptimize)&&(t=!!(null==R?void 0:R.awemeId)),e=(null==R?void 0:R.awemeId)===(null==eO?void 0:eO.targetGid)?eO.awemeList:[],l=(null==R?void 0:R.awemeId)===(null==eO?void 0:eO.targetGid)?eO.ready:t}else l=!0;return{preloadAwemeList:e,preloadReady:l}},[eB,eO,null==R?void 0:R.awemeId,ey]),eH=(0,n.useCallback)(async(e,l,i)=>{var t;if(null===(t=eC.find(e=>e.key===ex))||void 0===t?void 0:t.is_active_tab)return;let n=(null==eB?void 0:eB.cache)===U.MainHoverPreloadCache.on;if((null==eB?void 0:eB.action)===l){if(n){let l=ev.Z.getCache(e);if(l){!l.loading&&eV({ready:!0,awemeList:null==l?void 0:l.value,targetGid:e});return}}let l={targetGid:e,tagId:"0"===ex?"":ex,onRequestBefore:()=>{var l;(null==ey?void 0:null===(l=ey.jingxuanModalOpt)||void 0===l?void 0:l.logicOptimize)&&eV({ready:!1,awemeList:[],targetGid:e}),n&&ev.Z.setCacheLaoading(e)},callback:l=>{var i;n&&ev.Z.setCache(e,l),(null!=ey&&null!==(i=ey.jingxuanModalOpt)&&void 0!==i&&i.logicOptimize&&!eF.current||eF.current===e)&&eV({ready:!0,awemeList:l,targetGid:e})},useV2:1,count:(null==eB?void 0:eB.count)||8};i?null===K.WB||void 0===K.WB||K.WB.enter({params:l,fetcherOptions:{hoverDelay:!1}}):null===K.ky||void 0===K.ky||(0,K.ky)(l)}},[eB,ex,ey]),eG=(0,n.useCallback)(()=>{(null==eB?void 0:eB.action)===U.MainHoverPreloadAction.hover&&(null===K.WB||void 0===K.WB||K.WB.leave())},[K.WB,eB]),ez=(0,n.useCallback)(e=>{var l;if(null==ey?void 0:null===(l=ey.jingxuanModalOpt)||void 0===l?void 0:l.logicOptimize){null==eH||eH(e,U.MainHoverPreloadAction.click,!1);return}if((null==eB?void 0:eB.action)===U.MainHoverPreloadAction.hover){let l=(null==eB?void 0:eB.cache)===U.MainHoverPreloadCache.on?ev.Z.getCache(e):null;l?!l.loading&&eV({awemeList:null==l?void 0:l.value,targetGid:e,ready:!0}):(null===K.WB||void 0===K.WB||K.WB.leave(),eV(l=>(0,_._)((0,f._)({},l),{targetGid:e,ready:!0})))}null==eH||eH(e,U.MainHoverPreloadAction.click,!1)},[eH,eB,ey]),eW=(0,n.useCallback)(e=>{ez(e)},[ez]),eJ=(0,n.useCallback)(async()=>{if(S){var e;let l=et.e.getPipWindow({scene:V.d.ListenVideo});null==l||null===(e=l.close)||void 0===e||e.call(l)}ef(!0)},[S]),{subTags:eY,subTagInfoRef:eq,currentSubTag:eX,preloadTagOnHover:eK,onSubTagClick:eQ,getSubTabKey:e0,refReloadSubTab:e1}=function(e){let{selectedTab:l,defaultSubTags:i,setHomeFetchData:t}=e,[o,r]=(0,n.useState)(i5(null==i?void 0:i[i3])),[a,d]=(0,n.useState)(l===i3&&(null==o?void 0:o.length)?o:[]),[s,u]=(0,n.useState)(a[0]),[c,v]=(0,n.useState)(0),m=(0,n.useRef)({courseTagIdStr:"[0,0,0]"});m.current.courseTagIdStr=i6(s),(0,n.useEffect)(()=>{let e=l===i3&&(null==o?void 0:o.length)?o:[];d(e),u(e[0])},[l,o]),(0,n.useEffect)(()=>{if(null==o?void 0:o.length){(0,K.mk)(o.map(i6));return}let e=!1;return(0,eh.W)({tabId:"screen_course_page"}).then(l=>{if(!e&&0===l.statusCode){let e=i5(l.tagList);r(e),e.length&&(0,K.mk)(e.map(i6)),J.Le.setConfig(J.gI.JxCourseFilterList,l.tagList.map(e=>e.tagTitle).join(","))}}),()=>{e=!0}},[]);let f=(0,B.d)(()=>{t(void 0),u(a[0]),v(0)});{let e=null==i?void 0:i[i3];e&&!J.Le.getConfig(J.gI.JxCourseFilterList)&&J.Le.setConfig(J.gI.JxCourseFilterList,e.map(e=>e.tagTitle).join(","))}return{subTags:a,subTagInfoRef:m,currentSubTag:s,onSubTagClick:(e,l)=>{t(void 0),(null==s?void 0:s.tagId)===e.tagId?v(Math.floor(1e4*Math.random())):(u(e),v(0)),l===i3&&iO.sendLog("discoverCourserFilterListClick",{filter_list:J.Le.getConfig(J.gI.JxCourseFilterList)||"",filter_name:e.tagTitle,sub_tab_name:"course",enter_method:"other",enter_from:"discover"})},preloadTagOnHover:(e,l)=>{if(l===i3){var i,t;if(e.tagTitle===(null==s?void 0:s.tagTitle))return;let l=i6(e),n=null===(i=(0,K.oZ)(l))||void 0===i?void 0:i.predictor;null==n||null===(t=n.enter)||void 0===t||t.call(n,{params:{tabId:"screen_course_page",offset:0,size:6,tagIdList:l,idList:""},fetcherOptions:{expired:36e5,resetExpiredCacheBefore:!1,hoverDelay:!0}})}},refReloadSubTab:f,getSubTabKey:e=>{if(e===i3)return`${m.current.courseTagIdStr}-${c}`}}}({selectedTab:ex,defaultSubTags:b,setHomeFetchData:y}),[e2,e3]=(0,n.useState)(new Map().set(ex,{timeStamp:Date.now(),key:`tabPanelCt-${ex}-1`})),e5=(0,n.useCallback)(e=>{if(null==g||g(e),eN.updateTabInfo(e),eN.onReload(),e===eZ._D[eZ.JY.Course]){var l;null===(l=e1.current)||void 0===l||l.call(e1)}e3(l=>{let i=new Map;return Array.from(l.entries()).forEach(l=>{let[t,n]=l;i.set(t,t===e?{timeStamp:Date.now(),key:`tabPanelCt-${t}-${n.key.endsWith("1")?"0":"1"}`}:n)}),i})},[]);(0,F.o)(()=>z.listen(z.EVENT.refreshPage,()=>{e5(ex)}),[e5,ex]);let e6=(0,C.u)(),e4=(0,n.useCallback)(e=>{var l,i,t,n,r;null==m||m(e),null==o||o();let a=(null===(l=eC.find(l=>l.key===e))||void 0===l?void 0:l.is_active_tab)?e:null!==(i=eZ.z0[Number(e)])&&void 0!==i?i:"all";e6("all"===a?"/jingxuan":`/jingxuan/${a}`),null==eL||eL(e),eN.onTabChange(e);let d=new Map;Array.from(e2.entries()).forEach(e=>{let[l,i]=e;d.set(l,i)});let s=d.get(ex);d.set(ex,{timeStamp:Date.now(),key:null!==(t=null==s?void 0:s.key)&&void 0!==t?t:`tabPanelCt-${ex}-1`});let u=d.get(e),c="300205"===e&&eD;(!u||c||u.timeStamp+3e5<Date.now())&&(d.set(e,{timeStamp:Date.now(),key:`tabPanelCt-${e}-${(null==u?void 0:null===(r=u.key)||void 0===r?void 0:null===(n=r.endsWith)||void 0===n?void 0:n.call(r,"1"))?"0":"1"}`}),null==o||o()),e3(d)},[o,eL,eD,e2,ex]),e7=(0,n.useCallback)(e=>{e===ex&&(iO.sendLog("clickDiscoverTabReload",{tab_name:ex||"0"}),null==L||L(ex),null==k||k(),e5(ex))},[ex,e5]),e8=(0,B.d)(e4);(0,a.w)(()=>{(0,W.Nr)(location.pathname)||0===Number(eb.current)||e8.current("0")},[]);let e9=(0,n.useCallback)(()=>{if(window.jxHydrateReadyCb){var e,l;null===(e=(l=window).jxHydrateReadyCb)||void 0===e||e.call(l)}},[]);(0,n.useEffect)(()=>{var e,l;let i=e=>{var l,i,t,n,o,r,a,d,s,u;let{target:c}=e;if(!c||(null===(i=c.classList)||void 0===i?void 0:null===(l=i.contains)||void 0===l?void 0:l.call(i,"semi-tabs-tab-active")))return;let v=null==c?void 0:null===(n=c.dataset)||void 0===n?void 0:null===(t=n.tabkey)||void 0===t?void 0:t.slice(7);if(!v||Date.now()-(null!==(a=null===(o=e2.get(v))||void 0===o?void 0:o.timeStamp)&&void 0!==a?a:0)<=3e5)return;if(v===eZ._D[eZ.JY.Course]){let e=null===(d=(0,K.oZ)("[0,0,0]"))||void 0===d?void 0:d.predictor;null==e||null===(s=e.enter)||void 0===s||s.call(e,{params:{tabId:"screen_course_page",offset:0,size:6,tagIdList:"[0,0,0]",idList:""},fetcherOptions:{expired:36e5,resetExpiredCacheBefore:!1,hoverDelay:!0}});return}let{predictor:m}=null!==(u=(0,K.Z1)(v))&&void 0!==u?u:{};if(v===eb.current||!m)return;let f=null===(r=eC.find(e=>e.key===v))||void 0===r?void 0:r.is_active_tab;m.enter({params:{useV2:1,liteType:1,tagId:v,activeId:f?v:"",isActiveTab:f,pullType:eA.current&&"0"===v?8:void 0},fetcherOptions:{expired:3e4,resetExpiredCacheBefore:!1,hoverDelay:!0}})},t=[];return null===(l=document.querySelectorAll(".discover-tab-bar .semi-tabs-tab-top.semi-tabs-tab-single"))||void 0===l||null===(e=l.forEach)||void 0===e||e.call(l,e=>{e.addEventListener("mouseenter",i),t.push(()=>{e.removeEventListener("mouseenter",i)})}),()=>{t.forEach(e=>null==e?void 0:e()),t=[]}},[eC,e2,ey]);let le=(0,C.a)(),ll=(0,u.e2)(le.pathname)&&!(0,W.Nr)(le.pathname),li=(0,B.d)(e=>{z.emit(z.EVENT.triggerModalPlayerClose),z.emit(z.EVENT.closeImConversation),M(e),J.Le.setConfig(J.gI.ModalStartOpenTime,Date.now()),ez(null==e?void 0:e.awemeId)});(0,i2.x)(!R,li,!0),(0,n.useEffect)(()=>{var e;let l=document.querySelector(".discover-tab-container.semi-tabs.semi-tabs-top"),i=document.querySelector(".discover-tab-bar.semi-tabs-bar.semi-tabs-bar-line.semi-tabs-bar-top");eg.current=i,ew(l);let t=setTimeout(()=>{var e,l;null==e_||null===(l=e_.current)||void 0===l||null===(e=l.updateButtonStatus)||void 0===e||e.call(l)},200),n=e=>{var l,i;null==e||e.stopPropagation(),null==e_||null===(i=e_.current)||void 0===i||null===(l=i.updateButtonStatus)||void 0===l||l.call(i)};return null==i||null===(e=i.addEventListener)||void 0===e||e.call(i,"scroll",n),()=>{var e;null==i||null===(e=i.removeEventListener)||void 0===e||e.call(i,"scroll",n),clearTimeout(t)}},[eC]),(0,n.useEffect)(()=>{try{var e,l,i;if((0,Y.I)())return;let t=(null==I?void 0:I.redisVersion)?"normal":"";(null==I?void 0:I.redisMode)==="replace"&&(t="replace"),iO.sendLog("firstScreenCount",{tab_name:(0,ee.zD)(),pathname:location.pathname,scene:t,count:null!==(l=null==I?void 0:null===(e=I.awemeList)||void 0===e?void 0:e.length)&&void 0!==l?l:-1,log_id:null!==(i=null==I?void 0:I.logId)&&void 0!==i?i:""})}catch(e){}},[]);let lt=(0,n.useMemo)(()=>{if(ex===eZ._D[eZ.JY.Course])return to},[ex]),lo=(0,en.U)(),lr=(0,n.useMemo)(()=>{var e;return(0,f._)({enter_from:"discover",enter_from_merge:"discover",cover_group_id:eE,from_group_id:eE,api_path:q.API_PATH_MODULE_FEED,live_log_params:(0,_._)((0,f._)({},er||{}),{enter_from_merge:"web_homepage_discover",enter_method:"web_live_cell",cover_group_id:eE,from_group_id:eE,api_path:q.API_PATH_MODULE_FEED}),if_first_big_card:!1,sub_tab_name:null!==(e=eZ.z0[ex])&&void 0!==e?e:ex,filter_name:ex===eZ._D[eZ.JY.Course]&&(null==eX?void 0:eX.tagTitle)||"",is_first_large_card_outflow:(null==R?void 0:R.isBigCard)?"1":"0"},j?{enter_method:"default_landing"}:{})},[eE,null==eX?void 0:eX.tagTitle,j,er,null==R?void 0:R.isBigCard,ex]);return(0,n.useEffect)(()=>{eN.updateTabInfo(null!=ex?ex:"")},[ex]),(0,n.useEffect)(()=>{var e;eN.updateLogInfo({sub_tab_name:null!==(e=eZ.z0[ex])&&void 0!==e?e:ex,filter_name:ex===eZ._D[eZ.JY.Course]&&(null==eX?void 0:eX.tagTitle)||""})},[ex,null==eX?void 0:eX.tagTitle]),(0,t.jsx)(G.k,{componentName:"FeedList",onError:e9,children:(0,t.jsxs)(A,{children:[(0,t.jsx)(x.Tabs,{keepDOM:!0,type:"line",lazyRender:!0,activeKey:ex,onChange:e4,onTabClick:(e,l)=>{var i,t,n;if("keydown"===l.type&&"Space"===l.code)return;e7(e);let o=null==eC?void 0:null===(i=eC.findIndex)||void 0===i?void 0:i.call(eC,l=>l.key===e);null==e_||null===(n=e_.current)||void 0===n||null===(t=n.onItemClick)||void 0===t||t.call(n,l,o)},className:p()("discover-tab-container",ec.tabs,{cover16To9Container:!!(null==ey?void 0:ey.jingxuanCover169),notCover16To9Container:!(null==ey?void 0:ey.jingxuanCover169),maxColumn4:(null==ey?void 0:ey.jingxuanCover169)===U.JingxuanCover169.V1||(null==ey?void 0:ey.jingxuanCover169)===U.JingxuanCover169.V2,maxColumn5:(null==ey?void 0:ey.jingxuanCover169)===U.JingxuanCover169.V3||(null==ey?void 0:ey.jingxuanCover169)===U.JingxuanCover169.V4||(null==ey?void 0:ey.jingxuanCover169)===U.JingxuanCover169.V5,maxColumn6:!(null==ey?void 0:ey.jingxuanCover169),jxThemeColorOptimize:!!(null==ey?void 0:ey.themeColorOptimize),[ec.jxThemeColor]:!!(null==ey?void 0:ey.themeColorOptimize)}),tabBarClassName:p()("discover-tab-bar",ec.discoverTabBar,ec.hasTabExpand,{[ec.hasSubList]:eY.length>0}),tabPaneMotion:!1,children:null==eC?void 0:eC.map(e=>{var l;return(0,t.jsx)(x.TabPane,{tab:e.label,itemKey:e.key,children:(0,t.jsx)(Q.O,{active:e.key===ex&&ll,className:ec.tabPanelCt,children:eT&&!eS&&"300205"===ex?(0,t.jsx)(ed,{islandMode:"load",disableTDK:!0,className:ec.topicPage}):(0,t.jsxs)(t.Fragment,{children:[eY.length>0&&(0,t.jsx)("div",{className:p()(ec.subTabStickyContainer),children:eY.map(l=>(0,t.jsx)("div",{className:p()(ec.subTag,{[ec.active]:l.tagId===(null==eX?void 0:eX.tagId)}),onClick:()=>{eQ(l,e.key)},onMouseEnter:()=>{if(l.tagId!==(null==eX?void 0:eX.tagId))eK(l,e.key)},children:l.tagTitle},l.tagId))}),eP&&(0,t.jsx)("div",{className:p()(ec.loadingContainer,{[ec.hidden]:!eR}),children:(0,t.jsx)($.gb,{})}),(0,t.jsx)(iK,{tab:e,isTabActive:lo&&ex===e.key,appendPlayerConfig:e.key===eZ._D[eZ.JY.Course]?to:void 0,className:p()({[ec.waterfallPageWithSubTab]:eY.length>0}),subTagInfoRef:eq,filterName:e.key===eZ._D[eZ.JY.Course]?null==eX?void 0:eX.tagTitle:void 0,abTestData:ey,request:i,resetRefreshIndex:o,selectedTab:e.key,modalAwemeInfo:R,setModalAwemeInfo:M,setDefaultModalAwemeInfo:P,setLogParams:ea,perfLogFunctions:eN,country:c,preloadModuleFeed:eH,onVideoCardClick:eW,onVideoCardMouseLeave:eG,onClickPipIcon:eJ,setShowReplaceLoading:eM,showReplaceLoading:eR},e0(e.key))]})},null===(l=e2.get(e.key))||void 0===l?void 0:l.key)},`panelKey_${e.key}`)})}),(0,t.jsx)(D.SV,{Slardar:es.oe,children:(0,t.jsx)(n.Suspense,{fallback:null,children:ep?(0,w.createPortal)((0,t.jsx)(tn,{ref:e_,className:ec.switchBtn,scrollRef:eg}),ep):null})}),R&&(0,t.jsx)(Z.default,{appendPlayerConfig:lt,preloadReady:eU.preloadReady||N,preloadAwemeList:eU.preloadAwemeList,isUseChannelFeed:!1,modalAwemeInfo:R,userContext:eI,abtestData:ey,modalEnterFrom:H.a.WaterFall,close:()=>{z.emit(z.EVENT.UpdateJxOuterProgress,{awemeId:null==R?void 0:R.awemeId}),N&&P(null),M(null),el.YY.clearAllReusePlayer(),((null==eB?void 0:eB.action)===U.MainHoverPreloadAction.click||(null==eB?void 0:eB.action)===U.MainHoverPreloadAction.hover)&&eV({ready:!1,targetGid:"",awemeList:[]})},anyHooks:e=>{var l;let i="0"===ex?"":ex,t=i===eZ._D[eZ.JY.Course];t&&(i=eZ._D[eZ.JY.Knowledge]);let n=null===(l=eC.find(e=>e.key===ex))||void 0===l?void 0:l.is_active_tab;return(0,eu.b)((0,_._)((0,f._)({},e),{tagId:i,isActiveTab:n,isCourseTab:t}))},scene:"waterFall",reuseConfig:{scene:ei.v.Discover,reuseId:null==R?void 0:R.awemeId,autoCreate:!1,keepPlayer:null==R?void 0:R.isTopCard},logParams:lr,hideModalWhenPip:!0,hideModalByPipInitial:em,setHideModalByPipInitial:ef,autoOpenPip:!0})]})})});i("302653");let ta=e=>{var l;let i=(0,iY._)(),t=!!(e&&(null==e?void 0:null===(l=e.awemeList)||void 0===l?void 0:l.length)),o=(0,n.useRef)(t?1:0),r=(0,n.useCallback)(async(e,l)=>{o.current+=1;let t=K.MX;if(null==l?void 0:l.tagId){var n,r;t=null!==(r=null===(n=(0,K.Z1)(l.tagId))||void 0===n?void 0:n.fetcher)&&void 0!==r?r:K.MX}return await t.request({cached:e,consume:!0,params:(0,_._)((0,f._)({useV2:1,refreshIndex:o.current,discoverTaskOptimize:null==i?void 0:i.discoverTaskOptimize},l),{filterGids:(0,lt.C0)(null==l?void 0:l.tagId)}),fetcherOptions:{resetExpiredCacheBefore:!1,hoverDelay:!0}})},[i]);return{request:r,resetRefreshIndex:(0,n.useCallback)(()=>{o.current=0},[])}};var td={containerWrapper:"_kAB1Uz4",videoListContainer:"_Huh4h8J",channelTabs:"J8VqcEvn",cardWrapper:"uudlPMPX"};let ts=4/3;var tu=e=>{let{videoList:l}=e;return(0,t.jsx)(x.List,{grid:{gutter:20,span:12,lg:{span:8},xl:{span:6},xxl:{span:4}},dataSource:l,renderItem:(e,l)=>{var i,n,o;return(0,t.jsx)(x.List.Item,{children:(0,t.jsx)(iS.Z,{url:e.awemeType===eV.e.Note?(0,ib.Wr)(e.awemeId):(0,ib.JF)(e.awemeId),awemeInfo:e,description:e.desc,imgUrl:e.video.cover,userName:e.authorInfo.nickname,userHrefTarget:"_self",likesCount:(0,ii.qe)(e.stats.diggCount),videoTime:(0,ii.$y)(e.video.duration),width:e.video.width,height:e.video.height,userHref:(0,ib.HC)(null==e?void 0:null===(i=e.authorInfo)||void 0===i?void 0:i.secUid),showIntegrationTag:!1,willJump:!0,showImageInSSR:!0,isSpider:!0,isHorizontal:(null==e?void 0:null===(n=e.video)||void 0===n?void 0:n.width)>(null==e?void 0:null===(o=e.video)||void 0===o?void 0:o.height),fakeHorizontalInfo:null==e?void 0:e.fakeHorizontalInfo,isShowCreateTime:!0,videoImageStyle:{paddingTop:`${1/ts*100}%`},previewUrlList:[],style:{width:"100%"},useStyleInUserLink:!0},l)})}})},tc={container:"BsipbtF1",progressWrap:"DQrNr1gM",blur:"GcuENFWI",leftWrap:"AEruwqcu",rightWrap:"ZzoZfzdH",textCtl:"FjYSn821",ctlBtn:"rpDiVikl",playBtn:"gY6vHCX2",textWrap:"Gf9LsSXS",nickName:"eNZhohZD",title:"l7zzV7xD",infoWrap:"Q2thCSho",interaction:"dhcEkpj3"};let tv=e=>{let{text:l,count:i}=e;return(0,t.jsxs)("div",{className:tc.interaction,children:[(0,t.jsx)("span",{className:tc.interactType,children:l}),(0,t.jsx)("span",{className:tc.interactNum,children:i})]})},tm=e=>{let{children:l}=e;return(0,t.jsx)("div",{className:tc.ctlBtn,children:l})};var tf=e=>{var l,i,n;let{videoInfo:o}=e;return(0,t.jsxs)("div",{className:tc.container,children:[(0,t.jsx)("video",{poster:null==o?void 0:null===(l=o.video)||void 0===l?void 0:l.cover}),(0,t.jsxs)("div",{className:tc.textWrap,children:[(0,t.jsxs)("div",{className:tc.nickName,children:[(0,t.jsx)("a",{target:"_blank",href:(0,ib.HC)(null==o?void 0:null===(i=o.authorInfo)||void 0===i?void 0:i.secUid),rel:"noreferrer nofollow",children:null==o?void 0:null===(n=o.authorInfo)||void 0===n?void 0:n.nickname}),(0,t.jsx)("span",{children:(0,ii.YW)((null==o?void 0:o.createTime)*1e3)})]}),(0,t.jsx)("a",{className:tc.title,target:"_blank",href:(0,ib.$N)(null==o?void 0:o.awemeId),rel:"noreferrer nofollow",children:null==o?void 0:o.desc})]}),(0,t.jsxs)("div",{className:tc.progressWrap,children:[(0,t.jsxs)("div",{className:tc.leftWrap,children:[(0,t.jsx)(tm,{children:(0,t.jsx)("span",{className:tc.playBtn})}),(0,t.jsx)(tm,{children:(0,t.jsxs)("span",{className:tc.textCtl,children:["00:00 / ",(0,ii.$y)(null==o?void 0:o.video.duration)]})})]}),(0,t.jsxs)("div",{className:tc.rightWrap,children:[(0,t.jsx)(tm,{children:(0,t.jsx)("span",{className:tc.textCtl,children:"连播"})}),(0,t.jsx)(tm,{children:(0,t.jsx)("span",{className:tc.textCtl,children:"清屏"})}),(0,t.jsx)(tm,{children:(0,t.jsx)("span",{className:tc.textCtl,children:"智能"})}),(0,t.jsx)(tm,{children:(0,t.jsx)("span",{className:tc.textCtl,children:"倍速"})})]})]}),(0,t.jsx)("div",{className:tc.infoWrap,children:(0,t.jsx)(tv,{text:"点赞",count:(0,ii.qe)(null==o?void 0:o.stats.diggCount)})})]})};let t_=e=>{let{homeSeoDataResult:l,tabs:i,defaultTagId:n,modalVideoDetail:o}=e,{selectedTab:r}=ti(i,n);return l?(0,t.jsxs)("div",{className:td.containerWrapper,children:[o&&(0,t.jsx)("div",{className:td.cardWrapper,children:(0,t.jsx)(tf,{videoInfo:o})}),(0,t.jsx)(tl,{tabList:i,className:td.channelTabs,activeKey:r,isSpider:!0}),(0,t.jsx)("div",{className:td.videoListContainer,children:(0,t.jsx)(tu,{videoList:null==l?void 0:l.videoList})})]}):null};i("338172");var th=i("439837"),tg=i.n(th),tp=i("501981"),tw=i("252197"),tC=i("291628"),tx=i("60441");let tb=e=>{switch(e){case eZ.JY.Game:return{title:"抖音游戏_游戏解说_游戏视频推荐_游戏攻略 - 抖音精选电脑版",keyword:"抖音游戏,游戏解说,游戏推荐,游戏攻略",description:"涵盖游戏视频、游戏攻略、游戏解说、游戏推荐等海量优质视频内容，系列合集内容连续看，有用又有趣，无论是休闲解压、消遣下饭，还是发现爱好、获取知识，你想要的好内容，都在抖音精选。"};case eZ.JY.Acg:return{title:"抖音二次元_二次元视频大全 - 抖音精选电脑版",keyword:"抖音二次元,二次元视频大全",description:"涵盖二次元视频等海量优质视频内容，系列合集内容连续看，有用又有趣，无论是休闲解压、消遣下饭，还是发现爱好、获取知识，你想要的好内容，都在抖音精选。"};case eZ.JY.Music:return{title:"抖音音乐_抖音神曲_抖音热门歌曲 - 抖音精选电脑版",keyword:"抖音音乐,抖音神曲,抖音热门歌曲",description:"涵盖抖音音乐、抖音神曲、抖音热门歌曲等海量优质视频内容，系列合集内容连续看，有用又有趣，无论是休闲解压、消遣下饭，还是发现爱好、获取知识，你想要的好内容，都在抖音精选。"};case eZ.JY.Food:return{title:"抖音美食_抖音美食推荐 - 抖音精选电脑版",keyword:"抖音美食,抖音美食推荐",description:"涵盖抖音美食等海量优质视频内容，系列合集内容连续看，有用又有趣，无论是休闲解压、消遣下饭，还是发现爱好、获取知识，你想要的好内容，都在抖音精选。"};case eZ.JY.Knowledge:return{title:"抖音知识 - 抖音精选电脑版",keyword:"抖音知识",description:"涵盖抖音知识等海量优质视频内容，系列合集内容连续看，有用又有趣，无论是休闲解压、消遣下饭，还是发现爱好、获取知识，你想要的好内容，都在抖音精选。"};case eZ.JY.Sports:return{title:"抖音体育 - 抖音精选电脑版",keyword:"抖音体育",description:"涵盖抖音体育等海量优质视频内容，系列合集内容连续看，有用又有趣，无论是休闲解压、消遣下饭，还是发现爱好、获取知识，你想要的好内容，都在抖音精选。"};default:return{title:"抖音精选电脑版 - 抖音旗下优质视频平台",keyword:"抖音精选,抖音精选电脑版,抖音精选网页版",description:"海量优质视频内容，涵盖游戏、二次元、美食、音乐、知识、体育运动、旅行、生活等各类题材，系列合集内容连续看，有用又有趣，无论是休闲解压、消遣下饭，还是发现爱好、获取知识，你想要的好内容，都在抖音精选。"}}},tI=e=>{let l=e?tg()(e):tg()(),i=l.hour(7).minute(52).second(22),t=i,n=i;i.isAfter(l)&&(t=i.subtract(1,"day"),n=i.subtract(1,"day"));let o=t.format("YYYY-MM-DDTHH:mm:ssZ[Z]")||"";return[o,n.format("YYYY-MM-DDTHH:mm:ssZ[Z]")||""]},ty=e=>{let{modalVideoDetail:l,subPage:i="",videoList:n=[]}=e,o=(0,tp.Yr)(),r="",a="",d="",s="",u="";if(l){let{desc:e,authorInfo:i,createTime:t=Date.now()/1e3,textExtra:n,seoInfo:o,awemeId:a}=l;r=`https://www.douyin.com/jingxuan?modal_id=${a}`;let{nickname:c,totalFavorited:v=0}=i||{},m=tg()(1e3*t).format("YYYYMMDD")||"",f=(0,ii.qe)(v),{title:_,keywords:h,description:g}=(0,tx.xB)({desc:e,nickname:c,createTimeStr:m,likeCount:f,textExtra:n,ocrContent:(null==o?void 0:o.ocrContent)||""});d=_,s=h,u=g}else{var c;let{title:e,keyword:l,description:t}=tb(i);d=e,s=l,u=t;let o=i?`/jingxuan/${i}`:"/jingxuan";r=`https://www.douyin.com${o}`;let[v,m]=tI(J.Le.getConfig(J.gI.ServerTime)),f=JSON.stringify((null==n?void 0:null===(c=n.slice(0,3))||void 0===c?void 0:c.map(e=>{var l;let i=null==e?void 0:null===(l=e.video)||void 0===l?void 0:l.cover;return(null==i?void 0:i.startsWith("//"))?`https:${i}`:i}))||[]);a=`{
      "@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
      "@id": "${r}",
      "title": "${d}",
      "images": ${f},
      "description": "${u}",
      "pubDate": "${v}",
      "upDate": "${m}"
    }`}return(0,F.o)(()=>{(0,tw.J)({title:d,description:u,keywords:s})},[]),(0,t.jsxs)(tC.Z,{videoDetail:l,children:[(0,t.jsx)("title",{children:d}),(0,t.jsx)("meta",{name:"description",content:u}),(0,t.jsx)("meta",{name:"keywords",content:s}),(0,t.jsx)("link",{rel:"canonical",href:r}),a&&(0,t.jsx)("script",{type:"application/ld+json",nonce:o,children:a})]})};var tj=i("155714"),tL=i("20157");let tk={next_real_cnt:1,scene:1,report_rate:.8,range:0,enter_from:"discover",predict:{video:{enable:1},waterfall:{enable:1},comment:{enable:1}},real:{video:{enable:1},waterfall:{enable:1},comment:{enable:1}}},tT=e=>{(0,n.useEffect)(()=>{var l;return null===(l=(0,tj.lZ)())||void 0===l||l.registerScene(tL.P.HOME_PAGE_PRELOAD,(0,_._)((0,f._)({},tk),{abTestData:e,enableInference:!0})),()=>{var e;null===(e=(0,tj.lZ)())||void 0===e||e.unregisterScene(tL.P.HOME_PAGE_PRELOAD)}},[])};var tS=i("151681"),tE=i("346798"),tN=i("363706");let tP=()=>{(0,F.o)(()=>{let e=J.Le.getConfig(J.gI.JingXuanVisitId);return!e&&(J.Le.setConfig(J.gI.JingXuanVisitId,String(Date.now())),e=J.Le.getConfig(J.gI.JingXuanVisitId)),()=>{J.Le.setConfig(J.gI.JingXuanVisitId,""),iO.sendLog("discoverClose",{visit_id:e||"",close_method:"change_tab",to_page:""})}},[]),(0,F.o)(()=>((0,tN.vP)({key:"jingxuan_visit",event:(e,l,i)=>{if("page_unload"===i){let e=J.Le.getConfig(J.gI.JingXuanVisitId);iO.sendLog("discoverClose",{visit_id:e||"",close_method:"exit_douyin"},!1)}}}),()=>{(0,tN.xC)("jingxuan_visit")}),[])},tR=e=>{let{homeFetchData:l}=e;(0,n.useEffect)(()=>{var e;if(!!(null==l?void 0:l.redisVersion))J.Le.setConfig(J.gI.JingxuanCacheAwmeInfoIds,(null===(e=l.awemeList)||void 0===e?void 0:e.map(e=>e.awemeId))||[])},[l])};var tM=(0,c.C)(function(e){let{defaultSubTags:l,homeSeoDataResult:i,homeFetchData:u,isSpider:c=(0,s._Q)(),discoverTab:f,tagId:_,landingPage:h}=e,g=(0,iY._)()||{},p=(0,o.U)(),w=null==p?void 0:p.tag,C=(0,n.useRef)({}),x=(0,tE.J)({ssrDiscoverTab:f,ssrHomeFetchData:u,landingPage:h,ssrTagId:_}),b=(0,e$.useDiscoverCommonStore)(e=>{let{finalTabList:l,homeFetchData:i,setHomeFetchData:t,setIsDefaultLanding:n}=e;return{finalTabList:l,homeFetchData:i,setHomeFetchData:t,setIsDefaultLanding:n}}),{finalTabList:I,homeFetchData:y,setHomeFetchData:j,setIsDefaultLanding:L}=g.enableJingxuanZustand?b:x,[k,T]=(0,n.useState)(!1),S=(0,n.useMemo)(()=>{var e;return k&&I.find(e=>e.is_active_tab&&e.key===w)?w:(w&&!eZ._D[w]&&history.replaceState({},"","/jingxuan"),w&&null!==(e=eZ._D[w])&&void 0!==e?e:"0")},[w,k,I]),{country:E}=(0,tt.Iq)(e=>{let{country:l}=e;return{country:l}}),{request:N,resetRefreshIndex:P}=ta(y),{modalVideoDetail:R}=(0,m.K)(e=>{let{modalVideoDetail:l}=e;return{modalVideoDetail:l}});return(0,r.C)(d.w3.components.discover_page),tT(g),(0,v.$I)(),!function(){let{awemeFeed:e}=(0,tS.j)(),l=(0,n.useRef)(!1),i=(0,n.useRef)(!0);(0,F.o)(()=>{var e;if(i.current){i.current=!1;return}let l=null!==(e=J.Le.getConfig(J.gI.CachePage))&&void 0!==e?e:[];!(null==l?void 0:l.includes("/jingxuan"))&&J.Le.setConfig(J.gI.CachePage,[...l,"/jingxuan"])},[]),(0,n.useEffect)(()=>()=>{var e,l;let i=null!==(l=J.Le.getConfig(J.gI.CachePage))&&void 0!==l?l:[];J.Le.setConfig(J.gI.CachePage,null==i?void 0:null===(e=i.filter)||void 0===e?void 0:e.call(i,e=>"/jingxuan"===e))},[]),(0,n.useLayoutEffect)(()=>z.listen(z.EVENT.exitChildRoute,()=>{"/jingxuan"!==location.pathname&&l.current&&(l.current=!1,e.dispatch({modalAwemeInfo:null,nextAwemeInfo:null,prevAwemeInfo:null}))}),[])}(),tR({homeFetchData:y}),(0,n.useEffect)(()=>{try{var e;if(null===(e=location.href)||void 0===e?void 0:e.includes("pip")){let e=new URL(window.location.href);e.searchParams.delete("pip"),e.searchParams.delete("modal_id"),window.history.replaceState({},"",e)}}catch(e){}},[]),(0,a.w)(()=>{var e,l,i,t;null==L||L(!1),null==C||null===(l=C.current)||void 0===l||null===(e=l.setShowReplaceLoading)||void 0===e||e.call(l,!1),window.jxHydrateReadyCb&&(null===(i=(t=window).jxHydrateReadyCb)||void 0===i||i.call(t))},[]),tP(),(0,t.jsxs)(tE.O.Provider,{value:x,children:[(0,t.jsx)(ty,{modalVideoDetail:R,subPage:w,videoList:c?null==i?void 0:i.videoList:null==y?void 0:y.awemeList}),c?(0,t.jsx)(t_,{modalVideoDetail:R,homeSeoDataResult:i,tabs:I,defaultTagId:S}):(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(tr,{ref:C,defaultSubTags:l,abTestData:g,request:N,resetRefreshIndex:P,tabs:I,defaultTagId:S,country:E,onChannelTabChange:e=>{var l,i;T(!0),y&&e!==_&&(null==j||j(void 0)),null==C||null===(i=C.current)||void 0===i||null===(l=i.setShowReplaceLoading)||void 0===l||l.call(i,!1),null==L||L(!1)},onChannelTabReload:e=>{null==j||j(void 0),null==L||L(!1)}})})]})},e=>(0,u.e2)(e),"Da2ISZXp")},346798:function(e,l,i){i.d(l,{J:function(){return w},O:function(){return g}});var t=i(520739),n=i(878389);i(874386),i(250440),i(675373);var o=i(88648),r=i(784492),a=i(811796),d=i(67704),s=i(913807),u=i(44905),c=i(782442),v=i(903868),m=i(427283),f=i(380755),_=i(327306),h=i(402971);let g=(0,o.createContext)({}),p=e=>(null==e?void 0:e.redisMode)==="replace"?"replace":(null==e?void 0:e.redisVersion)?"append":"",w=e=>{var l;let{ssrDiscoverTab:i,ssrHomeFetchData:g,landingPage:w,ssrTagId:C}=e||{},x=(0,o.useRef)(p(g)),b=(0,a.d)(),{userInfo:I}=(0,h.useUserInfoContext)(),{discoverFeedCardAdList:y=[],discoverActiveSubTabList:j=[]}=(0,v.Iq)(e=>{let{discoverFeedCardAdList:l,discoverActiveSubTabList:i}=e;return{discoverFeedCardAdList:l,discoverActiveSubTabList:i}}),{enableJingxuanZustand:L}=(0,_._)()||{},k=(0,f.useDiscoverCommonStore)(e=>e.setState),[T,S]=(0,o.useState)(i),[E,N]=(0,o.useState)("discover"===w),[P,R]=(0,o.useState)(j),M=(0,o.useRef)(),[A,D]=(0,o.useState)([]),[O,V]=(0,o.useState)(g),[F,B]=(0,o.useState)({}),U=F,H=(0,f.useDiscoverCommonStore)(e=>e.closedCardAdIdListMap);U=L?H:U;let G=(0,o.useCallback)(e=>{M.current=e},[]),Z=(0,o.useMemo)(()=>{var e;let l=(null==T?void 0:null===(e=T.filter)||void 0===e?void 0:e.call(T,e=>(null==e?!!void 0:!!e.is_active_tab)||m.mh.includes(e.key)))||[];return L&&k({finalTabList:l}),l},[T,L]),$=(0,o.useMemo)(()=>{var e,l;return(null==I?void 0:I.isLogin)?null==I?void 0:null===(e=I.info)||void 0===e?void 0:e.uid:null===(l=(0,u.Es)())||void 0===l?void 0:l.user_unique_id},[I]),z=(0,o.useMemo)(()=>(0,d.lE)({feedCardAdList:y,ctx:b})||{},[y,b]);(0,o.useMemo)(()=>{L&&k({activeSubTab:j,feedCardAdListMap:z,isDefaultLanding:"discover"===w,homeFetchData:g,feedCardAdList:y,ssrCtx:b,latestClickAwemeIdRef:M,pageMode:x.current})},[L]),(0,o.useMemo)(()=>{k({ssrTagId:C})},[C]);let[W,J]=(0,o.useState)(z),Y=W,q=(0,f.useDiscoverCommonStore)(e=>e.feedCardAdListMap);Y=L?q:Y;let X=(0,o.useMemo)(()=>{let e={};for(let i of Object.keys(Y||{})){var l;e[i]=(null===(l=Y[i])||void 0===l?void 0:l.filter(e=>{var l,t;return!(null==U?void 0:null===(t=U[i])||void 0===t?void 0:null===(l=t.includes)||void 0===l?void 0:l.call(t,null==e?void 0:e.id))}))||[]}return L&&k({finalFeedCardAdListMap:e}),e},[Y,U,L]),K=(0,o.useCallback)(async e=>{let l=await (0,d.to)(b),i=(0,d.lE)({feedCardAdList:l});e?J(l=>(0,n._)((0,t._)({},l),{[e]:(null==i?void 0:i[e])||[]})):J(i)},[]),Q=(0,f.useDiscoverCommonStore)(e=>e.updateFeedCardAdResourceList);K=L?Q:K,(0,o.useEffect)(()=>{!(null==i?void 0:i.length)&&(0,s.getChannelSetting)({},void 0).then(e=>{(null==e?void 0:e.status_code)===0&&S(null==e?void 0:e.config_info)})},[i]);let ee=(0,o.useCallback)(async()=>{(0,d.hz)(b).then(e=>{R(null!=e?e:[])})},[]);(0,o.useEffect)(()=>{!j.length&&(0,d.hz)(b).then(e=>{if(L){k({activeSubTab:null!=e?e:[]});return}R(null!=e?e:[])})},[j,L]),(0,r.Z)(()=>{(0,d.EN)({uidKey:$}),K()},[$]);let el=null==Z?void 0:null===(l=Z.map(e=>null==e?void 0:e.key))||void 0===l?void 0:l.join();c.Le.setConfig(c.gI.DiscoverTabList,el);let ei=(0,o.useRef)({finalTabList:[],finalFeedCardAdListMap:{},activeSubTab:[],feedCardAdListMap:{},isDefaultLanding:!1,setIsDefaultLanding:()=>{},homeFetchData:void 0,setHomeFetchData:()=>{},feedCardAdList:[],setClosedCardAdIdListMap:()=>{},latestClickAwemeIdRef:void 0,updateLatestClickAwemeIdRef:()=>{},visibleLiveCards:[],setVisibleLiveCards:()=>{},updateFeedCardAdResourceList:()=>Promise.resolve(),updateSubTabLiveCardList:()=>Promise.resolve(),ssrTagId:"",pageMode:""});return L?ei.current:{finalTabList:Z,finalFeedCardAdListMap:X,activeSubTab:P,feedCardAdListMap:Y,isDefaultLanding:E,setIsDefaultLanding:N,homeFetchData:O,setHomeFetchData:V,feedCardAdList:y,setClosedCardAdIdListMap:B,updateFeedCardAdResourceList:K,updateSubTabLiveCardList:ee,visibleLiveCards:A,setVisibleLiveCards:D,latestClickAwemeIdRef:M,updateLatestClickAwemeIdRef:G,ssrTagId:C,pageMode:x.current}}},380755:function(e,l,i){i.r(l),i.d(l,{useDiscoverCommonContext:function(){return c},useDiscoverCommonStore:function(){return u}});var t=i(520739),n=i(878389),o=i(88648),r=i(67704),a=i(650963),d=i(665067),s=i(346798);let u=(0,a.fw)((e,l)=>({finalTabList:[],finalFeedCardAdListMap:{},activeSubTab:[],feedCardAdListMap:{},isDefaultLanding:!1,setIsDefaultLanding:l=>{e({isDefaultLanding:l})},homeFetchData:void 0,setHomeFetchData:l=>{e({homeFetchData:l})},feedCardAdList:[],visibleLiveCards:[],setVisibleLiveCards:l=>{e(e=>({visibleLiveCards:l(e.visibleLiveCards||[])}))},closedCardAdIdListMap:{},setClosedCardAdIdListMap:l=>{e(e=>({closedCardAdIdListMap:l(e.closedCardAdIdListMap||{})}))},latestClickAwemeIdRef:void 0,ssrTagId:"",pageMode:"",updateLatestClickAwemeIdRef:e=>{let{latestClickAwemeIdRef:i}=l();i&&(i.current=e||"")},ssrCtx:void 0,updateFeedCardAdResourceList:async i=>{let o=await (0,r.to)(l().ssrCtx),a=(0,r.lE)({feedCardAdList:o});i?e(e=>({feedCardAdListMap:(0,n._)((0,t._)({},e.feedCardAdListMap),{[i]:(null==a?void 0:a[i])||[]})})):e({feedCardAdListMap:a})},updateSubTabLiveCardList:async()=>{(0,r.hz)(l().ssrCtx).then(l=>{e({activeSubTab:null!=l?l:[]})})}})),c=function(e,l){let i=(0,d.U)(),t=(0,o.useContext)(s.O),n=u(e,l);return i.enableJingxuanZustand?n:t}},26709:function(e,l,i){i.d(l,{X:function(){return N}});var t=i("520739"),n=i("878389");i("874386"),i("250440");var o=i("563097"),r=i("713097"),a=i.n(r),d=i("645260"),s=i.n(d),u=i("96008"),c=i.n(u),v=i("88648"),m=i("154953"),f=i("450402"),_=i("318034"),h=i("401953"),g=i("699235"),p=i("272775"),w=i("926012"),C=i("291575"),x=i("718770"),b=i("211286"),I=i("437998"),y={DEFAULT:0,0:"DEFAULT",GUEST:1,1:"GUEST"},j=e=>{let{type:l=0,isLock:i,cls:t,handleClick:n,joinText:r}=e;return(0,o.jsxs)("div",{onClick:n,className:a()(I.default.joinContainer,t),"data-e2e":"mic_seat",children:[(0,o.jsx)("div",{className:I.default.joinIcon,children:(0,o.jsx)("span",{className:a()(I.default.joinSvg,{[I.default.lockIcon]:i,[I.default.guestLockIcon]:1===l&&i,[I.default.joinGuest]:1===l})})}),(0,o.jsx)("span",{className:a()(I.default.joinText,"joinTextContent"),children:r})]})},L=i("625703"),k=i("578006"),T=i("164416"),S=i("187577"),E=i("207964");let N=e=>{var l,i,r,d;let{user:u,className:I,onJoinRoom:N,disable:P,onUserClick:R,isLock:M,showAnchorLabel:A,playModesPC:D,orderSingInfo:O,setFloatModal:V,avatarBorderColor:F,joinText:B=k.p.JOIN_CHAT,setRankParam:U,setRankListShow:H,teamfightInfo:G,guestBattleInfo:Z,giftLabelBackgroundColor:$,selfUidStr:z,giftLabelIcon:W="",giftLabelStyle:J={},allowSendGiftGuest:Y=!0,onHover:q,isMvp:X,isRed:K,mvpIcon:Q,position:ee,singV3Ab:el="0",animationMap:ei,mvpUseridRef:et,mvpChangeRef:en,audioPower:eo,isCrossLink:er=!1,roomBattleType:ea="pk",dynamic:ed=!1,isAudioStage:es=!1,giftLabelMerge:eu=!1}=e,[ec,ev]=v.useState(!1);v.useRef("");let em=v.useMemo(()=>(null==u?void 0:u.is_background)===1,[u]),ef=v.useMemo(()=>(null==u?void 0:u.silence_status)!==m.Ai.STATUS_UNSILENCE,[u]),{isGuestBattle:e_}=(0,b.Z)({guestBattleInfo:Z}),{giftNum:eh,isGroupFight:eg}=(0,L.Z)({listUser:u,teamfightInfo:G,selfUidStr:z,guestBattleInfo:Z,isCrossLink:er,roomBattleType:ea}),ep=v.useCallback(e=>{e.talk>0?ev(!0):!e.talk&&ev(!1)},[]),{gameType:ew}=(0,S.zL)(),eC=v.useMemo(()=>{var e,l,i,o,r,a,d;let s=[];return O&&(null==O||null===(e=O.user_microphone_list)||void 0===e||e.forEach(e=>{if(e.is_singing){var l,i,o,r;(null==e?void 0:null===(l=e.microphone_list)||void 0===l?void 0:l[0].title_sponsor)&&(s=[(0,n._)((0,t._)({},null==e?void 0:null===(i=e.microphone_list)||void 0===i?void 0:i[0]),{toUserId:null!==(r=null==e?void 0:null===(o=e.order_user)||void 0===o?void 0:o.id_str)&&void 0!==r?r:""})])}})),Z&&(s=null==Z?void 0:null===(l=Z.results)||void 0===l?void 0:l.filter(e=>{var l,i;return String(null==e?void 0:null===(l=e.user)||void 0===l?void 0:l.id_str)===String(null==u?void 0:null===(i=u.user)||void 0===i?void 0:i.id_str)},[])),G&&(ew===T.D$.ROOMBATTLE?null==G||null===(a=G.team_infos)||void 0===a||null===(r=a.filter(e=>(null==e?void 0:e.team_id)==="1"))||void 0===r||null===(o=r[0])||void 0===o||null===(i=o.players)||void 0===i||i.forEach(e=>{var l;(null==e?void 0:e.title_sponsor)&&String(null==e?void 0:e.user_id)===String(null==u?void 0:null===(l=u.user)||void 0===l?void 0:l.id_str)&&(s=[e])}):null==G||null===(d=G.team_infos)||void 0===d||d.forEach(e=>{var l;null==e||null===(l=e.players)||void 0===l||l.forEach(e=>{var l;(null==e?void 0:e.title_sponsor)&&String(null==e?void 0:e.user_id)===String(null==u?void 0:null===(l=u.user)||void 0===l?void 0:l.id_str)&&(s=[e])})})),s||[]},[Z,G,O]),ex=e=>{null==e||e.stopPropagation(),U({teamfight_id:eg?null==G?void 0:G.teamfight_id_str:null==Z?void 0:Z.battle_id_str,user:null==u?void 0:u.user,isGuestContribution:e_}),H(!0)};v.useEffect(()=>u?(null==eo||eo.on(null==u?void 0:u.linkmic_id_str,ep),()=>{ev(!1),null==eo||eo.off(null==u?void 0:u.linkmic_id_str,ep)}):c(),[ep,null==u?void 0:u.linkmic_id_str,eo]);let eb=v.useMemo(()=>{if(!e_||!(null==u?void 0:u.user.id_str)||!(null==Z?void 0:Z.battle_id))return"";let e=null==Z?void 0:Z.status,l=null,i=null==ei?void 0:ei.get(`${null==u?void 0:u.user.id_str}_${null==Z?void 0:Z.battle_id}`);return(null==Z||Z.results.forEach(i=>{var t,n,o;if(String(i.guest_id)===String(null==u?void 0:null===(t=u.user)||void 0===t?void 0:t.id_str)){if([1,4].includes(Number(e))&&(null==i?void 0:i.role)===1)switch(Number(null==i?void 0:null===(o=i.crown_info)||void 0===o?void 0:null===(n=o.cur_grade)||void 0===n?void 0:n.level)){case 1:l="CrystalCrown";break;case 2:l="GemstoneCrown";break;case 3:l="DiamondCrown";break;default:l="Knuckle"}[1,4].includes(Number(e))&&(null==i?void 0:i.role)===2&&(l="HeartBreak"),(null==i?void 0:i.role)===0&&(l=""),2===Number(e)&&(null==i?void 0:i.role)===1&&(l="Victory")}}),i===l)?"":(null==ei||ei.set(`${null==u?void 0:u.user.id_str}_${null==Z?void 0:Z.battle_id}`,l),l)},[null==Z?void 0:Z.status,null==Z?void 0:Z.results,e_,null==u?void 0:null===(l=u.user)||void 0===l?void 0:l.id_str,null==Z?void 0:Z.battle_id]),eI=v.useMemo(()=>{if(!e_)return"";let e="";return null==Z||Z.results.forEach(l=>{var i,t,n;if(String(l.guest_id)===String(null==u?void 0:null===(i=u.user)||void 0===i?void 0:i.id_str)){if((null==l?void 0:l.role)===1)switch(Number(null==l?void 0:null===(n=l.crown_info)||void 0===n?void 0:null===(t=n.cur_grade)||void 0===t?void 0:t.level)){case 1:e="CrystalCrown";break;case 2:e="GemstoneCrown";break;case 3:e="DiamondCrown";break;default:e="Knuckle"}(null==l?void 0:l.role)===2&&(e="HeartBreak")}}),e},[u,Z,e_]),ey=v.useMemo(()=>(null==D?!!void 0:!!D.includes(C.V0.LinkmicPlayMode_OrderSing))||!1,[D]),ej=v.useMemo(()=>{var e;let l={};return null==O||O.user_microphone_list.forEach(e=>{var i,t,n,o,r;l[null==e?void 0:null===(i=e.order_user)||void 0===i?void 0:i.id_str]={userId:null==e?void 0:null===(t=e.order_user)||void 0===t?void 0:t.id_str,is_singing:null==e?void 0:e.is_singing,currentSingItem:null==O?void 0:O.current_sing_item,golden_microphone_icon:null==O?void 0:O.golden_microphone_icon,live_linkmic_order_sing_micro_opt:null==O?void 0:O.live_linkmic_order_sing_micro_opt,goldenCount:null===(r=e.microphone_list)||void 0===r?void 0:null===(o=r.filter(e=>e.microphone_type===f.W5.GOLDEN_MICROPHONE))||void 0===o?void 0:null===(n=o[0])||void 0===n?void 0:n.micro_phone_num}}),l[null==u?void 0:null===(e=u.user)||void 0===e?void 0:e.id_str]},[O,u]),eL=v.useCallback(e=>{e.stopPropagation(),V(w.uH.ORDER_SING)},[V]),ek=(null===(i=(null!==(d=null==Z?void 0:Z.results)&&void 0!==d?d:[]).filter(e=>{var l,i;return String(e.guest_id)===(null==u?void 0:null===(l=u.user)||void 0===l?void 0:l.id_str)||String(e.guest_id_str)===(null==u?void 0:null===(i=u.user)||void 0===i?void 0:i.id_str)}))||void 0===i?void 0:i.length)>0,eT=v.useRef(),eS=(0,E.useInLiveAudioLayoutOptAB)();return u?(0,o.jsxs)("div",{onClick:R,className:a()(x.default.userContainer,I,{[x.default.dynamicAudioItem]:ed&&!es,[x.default.audioStageUserScale]:ed&&es,[x.default.infoNoShrink]:eS}),onMouseEnter:e=>null==q?void 0:q(e,eT),ref:eT,"data-e2e":"mic_seat",children:[(0,o.jsx)(h.b,{img:s()(u,"user.avatar_large.url_list[0]",""),isTalking:ec&&!ef,gender:null===(r=u.user)||void 0===r?void 0:r.gender,user:u,className:a()(x.default.avatar,{[x.default.userAdjust]:ed&&es}),isLeave:em,borderColor:F,battleIcon:eI,battleAnimation:eb,showAnchorLabel:A&&!ey,isMvp:X,mvpIcon:Q,mvpUseridRef:et,mvpChangeRef:en,titleSponsor:eC}),es?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(g._,{isMute:ef,noName:!0,className:x.default.userNameRight})}):(0,o.jsxs)(o.Fragment,{children:[ey&&(0,o.jsx)(p._,{className:x.default.micphoneLabel,onClick:eL,isAnchor:A&&!ey,labelInfo:ej,singV3Ab:el,user:u,position:ee,titleSponsor:eC}),eu?(0,o.jsxs)("div",{style:{display:"flex",width:"100%"},children:[(0,o.jsx)("div",{style:{flex:"1 1 0%",minWidth:0},children:(0,o.jsx)(g._,{isMute:ef,className:x.default.userName,userName:s()(u,"user.nickname",""),onClick:ex})}),Y&&(0,o.jsx)("div",{style:{flex:"0 0 auto",marginLeft:8},children:(0,o.jsx)(_.X,{giftNum:eh,isJoinGuestBattle:ek,onClick:ex,showGiftIcon:!$,background:$,giftLabelIcon:W,type:e_?_.l.GUEST:_.l.DEFAULT,giftLabelStyle:J,isMvp:X,isRed:K,mvpIcon:Q,style:{position:"relative"},guestBattleInfo:Z,user:u})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g._,{isMute:ef,className:x.default.userName,userName:s()(u,"user.nickname",""),onClick:ex}),Y&&(0,o.jsx)(_.X,{giftNum:eh,isJoinGuestBattle:ek,onClick:ex,showGiftIcon:!$,background:$,giftLabelIcon:W,type:e_?_.l.GUEST:_.l.DEFAULT,giftLabelStyle:J,isMvp:X,isRed:K,mvpIcon:Q,style:{position:"relative"},guestBattleInfo:Z,user:u})]})]})]}):(0,o.jsx)(j,{type:e_?y.GUEST:y.DEFAULT,cls:a()(I,{[x.default.dynamicAudioItem]:ed,[x.default.infoNoShrink]:eS}),isLock:M,joinText:B,handleClick:P||M?c():N,"data-e2e":"mic_seat"})}},91518:function(e,l,i){i.d(l,{s:function(){return b}}),i("874386"),i("250440");var t=i("563097"),n=i("713097"),o=i.n(n),r=i("88648"),a=i("412679"),d=i("178849"),s=i("393265"),u=i("926012"),c=i("777185"),v=i("291870"),m=i("788376"),f=i("456147"),_=i("516599"),h=i("58655"),g=i.p+"media/bg.394717bcadc491f0.png",p=i("231414"),w=i("197960");let C={[u.yP.AUDIO_1V8]:80,[u.yP.AUDIO_1V8_STAGE]:80,[u.yP.AUDIO_GRID]:80,[u.yP.VIDEO_1V6]:42.5,[u.yP.VIDEO_DYNAMIC]:63.56,[u.yP.VIDEO_GRID]:62.45,[u.yP.VIDEO_6V6]:61,[u.yP.VIDEO_2V4V4]:50.6},x=16/9,b=e=>{let{isAdmin:l=!1,roomId:i="",layout:n,renderElement:b,className:I,isTheaterOn:y,statusText:j,teamfightInfo:L,onClickStatusBar:k,isPreview:T,incomingPlayer:S=null}=e,{eventStore:E,linkmicStore:N}=(0,h.o)(),{linkmicEvent:P}=E||{},R=r.useRef(),[M,A]=r.useState(x),{isInPunish:D,leftTeamScore:O,rightTeamScore:V}=(0,m.Z)({teamfightInfo:L}),{player:F}=(0,s.n)(),B=S||F,U=r.useCallback(()=>{var e,l;let i=null==B?void 0:null===(e=B.root)||void 0===e?void 0:e.clientWidth,t=null==B?void 0:null===(l=B.root)||void 0===l?void 0:l.clientHeight;return i&&t?i/t:x},[]),H=r.useCallback(()=>{clearTimeout(R.current),R.current=setTimeout(()=>{A(U())},50)},[]);r.useEffect(()=>(null==B||B.on(a.FP.FULLSCREEN_CHANGE,H),()=>{null==B||B.off(a.FP.FULLSCREEN_CHANGE,H)}),[]);let G=r.useCallback(()=>{A(U())},[]);r.useEffect(()=>(window.addEventListener("resize",G),()=>{window.removeEventListener("resize",G)}),[]),r.useEffect(()=>{H()},[y]);let Z=r.useMemo(()=>`${C[n]*x/M}%`,[M,n]),$=r.useMemo(()=>null==L?void 0:L.status,[L]),z=r.useCallback(()=>(0,t.jsx)("div",{className:v.default.source,children:(0,t.jsx)(c.Z,{teamFightInfo:L,eggModeInfo:null==N?void 0:N.eggModeInfo,leftPKScore:O,rightPKScore:V,showAroundFaceStatus:D})}),[O,V,D,null==N?void 0:N.eggModeInfo]),W=$===d.Hj.LinkmicTeamfightStatus_PREPARE&&l,J=()=>(0,t.jsx)("div",{className:v.default.actionBar,onClick:()=>Q(),children:"开始团战"}),{hideEgg:Y,isMutiEggTimeUseful:q}=(0,w.Z)(),X=r.useMemo(()=>(0,t.jsx)(p.Z,{isVideoGuropFight:!1,isGroupFight:!0,eggModeInfo:null==N?void 0:N.eggModeInfo}),[null==N?void 0:N.eggModeInfo]),K=r.useMemo(()=>{var e;return(0,t.jsxs)("div",{className:v.default.audioGridContainer,style:{width:Z},children:[(0,t.jsx)("div",{className:o()(v.default.mediumAudioItem,v.default.anchorItem),children:b(0)}),(null==N?void 0:null===(e=N.eggModeInfo)||void 0===e?void 0:e.egg_info)&&q&&[d.Hj.LinkmicTeamfightStatus_PLAYING,d.Hj.LinkmicTeamfightStatus_PUNISHING].includes($)&&X,(0,t.jsxs)("div",{className:v.default.seatsGroupContainer,children:[(0,t.jsxs)("div",{className:v.default.topBar,children:[z(),W?J():j&&!T&&(0,t.jsx)("div",{className:v.default.status,onClick:()=>null==k?void 0:k(),children:j})]}),[void 0,void 0].map((e,l)=>{var i;return(0,t.jsxs)("div",{className:v.default.gridsArea,children:[(null==N?void 0:null===(i=N.eggModeInfo)||void 0===i?void 0:i.egg_info)&&q&&[d.Hj.LinkmicTeamfightStatus_PLAYING,d.Hj.LinkmicTeamfightStatus_PUNISHING].includes($)&&(0,t.jsxs)("div",{className:Y?v.default.hide:v.default.show,children:[(0,t.jsx)("div",{className:v.default.eggLeftSide,style:{backgroundImage:`${0===l?"linear-gradient(to right, rgba(252, 28, 109, 0.56), rgba(255, 42, 119, 0))":"linear-gradient(to right, rgba(39, 164, 255, 0.67), rgba(39, 164, 255, 0))"}`}}),(0,t.jsx)("div",{className:v.default.eggRightSide,style:{backgroundImage:`${0===l?"linear-gradient(to right, rgba(252, 28, 109, 0.56), rgba(255, 42, 119, 0))":"linear-gradient(to right, rgba(39, 164, 255, 0.67), rgba(39, 164, 255, 0))"}`}})]}),(0,t.jsxs)("div",{className:v.default.gridsBox,children:[(0,t.jsx)("div",{className:v.default.grid,children:[void 0,void 0].map((e,i)=>(0,t.jsx)("div",{className:v.default.mediumAudioItem,children:b(4*i+1+2*l)},`${l}_${i}`))}),(0,t.jsx)("div",{className:v.default.grid,children:[void 0,void 0].map((e,i)=>(0,t.jsx)("div",{className:v.default.mediumAudioItem,children:b(4*i+2+2*l)},`${l}_${i}`))})]})]},l)})]})]})},[b,Z,j,z,$,W,null==N?void 0:N.eggModeInfo]),Q=()=>{null==P||P.liveGroupFightStart(),(0,f.lV)({room_id:i}).then(e=>{var l,i,t,n;(null==e?void 0:null===(i=e.data)||void 0===i?void 0:null===(l=i.data)||void 0===l?void 0:l.prompts)?(_.F.info(null==e?void 0:null===(n=e.data)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.prompts,null==B?void 0:B.root),null==P||P.liveGroupFightStartSuccess("fail_member_cnt")):null==P||P.liveGroupFightStartSuccess("success")})};return r.useEffect(()=>{null==N||N.setLayoutBackgroundImg(n===u.yP.AUDIO_1V8||n===u.yP.AUDIO_GRID||n===u.yP.AUDIO_1V8_STAGE?g:"")},[n]),(0,t.jsx)("div",{className:o()(v.default.container,I,{[v.default.audioBackground]:[u.yP.AUDIO_GRID,u.yP.AUDIO_1V8_STAGE,u.yP.AUDIO_1V8,u.yP.AUDIO_DOUBLE_C].includes(n)}),children:(n===u.yP.AUDIO_1V8||n===u.yP.AUDIO_GRID||n===u.yP.AUDIO_1V8_STAGE)&&K})}},562923:function(e,l,i){i.d(l,{PY:function(){return j}}),i(874386),i(250440);var t=i(563097),n=i(713097),o=i.n(n),r=i(88648),a=i(412679),d=i(393265),s=i(454194),u=i(926012),c=i(127845),v=i(456147),m=i(83188),f=i(779145),_=i.n(f),h=i(178849),g=i(788376),p=i(777185),w=i(516599),C=i(58655),x=i(231414),b=i(197960);let I={[u.yP.AUDIO_1V8]:50.4,[u.yP.AUDIO_GRID]:42,[u.yP.VIDEO_1V6]:42.5,[u.yP.VIDEO_1V8]:42.5,[u.yP.VIDEO_DYNAMIC]:63.56,[u.yP.VIDEO_GRID]:62.45,[u.yP.VIDEO_6V6]:61,[u.yP.VIDEO_1_V_8]:63.56,[u.yP.VIDEO_1_V_6]:63.56,[u.yP.VIDEO_1_V_3]:63.56,[u.yP.VIDEO_DYNAMIC_FLOAT]:32,[u.yP.VIDEO_T1_V_B8]:43},y=16/9,j=e=>{let{layout:l,renderElement:i,className:n,backgroundImg:f,isTheaterOn:j,micSeats:L,teamfightInfo:k,ext:T={},isAdmin:S=!1,roomId:E,onClickStatusBar:N,isPreview:P=!1,incomingPlayer:R=null}=e,{eventStore:M,linkmicStore:A}=(0,C.o)(),{linkmicEvent:D}=M||{},{isInPunish:O,leftTeamScore:V,rightTeamScore:F,statusTexting:B,redGroupSeats:U}=(0,g.Z)({teamfightInfo:k}),H=r.useRef(),[G,Z]=r.useState(y),{player:$}=(0,d.n)(),z=R||$,W=r.useCallback(()=>{var e,l;let i=null==z?void 0:null===(e=z.root)||void 0===e?void 0:e.clientWidth,t=null==z?void 0:null===(l=z.root)||void 0===l?void 0:l.clientHeight;return i&&t?i/t:y},[]),J=r.useCallback(()=>{clearTimeout(H.current),H.current=setTimeout(()=>{Z(W())},50)},[]);r.useEffect(()=>(null==z||z.on(a.FP.FULLSCREEN_CHANGE,J),()=>{null==z||z.off(a.FP.FULLSCREEN_CHANGE,J)}),[]);let Y=r.useCallback(()=>{Z(W())},[]);r.useEffect(()=>(window.addEventListener("resize",Y),()=>{window.removeEventListener("resize",Y)}),[]),r.useEffect(()=>{J()},[j]);let q=r.useMemo(()=>`${I[l]*y/G}%`,[G,l]),X=r.useMemo(()=>null==k?void 0:k.status,[k]),{hideEgg:K,isMutiEggTimeUseful:Q}=(0,b.Z)(),ee=r.useMemo(()=>(0,t.jsx)(x.Z,{isVideoGuropFight:!0,isGroupFight:!0,eggModeInfo:null==A?void 0:A.eggModeInfo}),[null==A?void 0:A.eggModeInfo]);r.useEffect(()=>{X===h.Hj.LinkmicTeamfightStatus_FINISHED&&(null==A||A.setEggModeInfo({}))},[X]);let el=r.useCallback(()=>(0,t.jsx)("div",{className:s.default.sourceBar,children:[h.Hj.LinkmicTeamfightStatus_PLAYING,h.Hj.LinkmicTeamfightStatus_PUNISHING].includes(X)?(0,t.jsx)(p.Z,{teamFightInfo:k,eggModeInfo:null==A?void 0:A.eggModeInfo,leftPKScore:V,rightPKScore:F,showAroundFaceStatus:O}):(0,t.jsx)("div",{className:s.default.emptyBar})}),[V,F,O,q,X]),ei=()=>{null==D||D.liveGroupFightStart(),(0,v.lV)({room_id:E}).then(e=>{var l,i,t,n;(null==e?void 0:null===(i=e.data)||void 0===i?void 0:null===(l=i.data)||void 0===l?void 0:l.prompts)?(w.F.info(null==e?void 0:null===(n=e.data)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.prompts,null==z?void 0:z.root),null==D||D.liveGroupFightStartSuccess("fail_member_cnt")):null==D||D.liveGroupFightStartSuccess("success")})},et=()=>(0,t.jsx)("div",{className:s.default.actionBar,onClick:e=>{ei()},children:"开始团战"}),en=X===h.Hj.LinkmicTeamfightStatus_PREPARE&&S,eo=r.useMemo(()=>{var e,l;return(0,t.jsxs)("div",{className:o()(s.default.videoT1B8Container),style:{width:q},children:[(0,t.jsx)("div",{className:o()(s.default.anchor,"__clairvoyance"),children:i(0)}),(null==A?void 0:null===(e=A.eggModeInfo)||void 0===e?void 0:e.egg_info)&&Q&&[h.Hj.LinkmicTeamfightStatus_PLAYING,h.Hj.LinkmicTeamfightStatus_PUNISHING].includes(X)&&ee,!P&&(0,t.jsxs)("div",{className:s.default.topBar,children:[el(),en?et():B&&(0,t.jsx)("div",{className:s.default.status,onClick:e=>{null==N||N(e)},children:B})]}),(0,t.jsxs)("div",{className:s.default.guests,children:[(null==A?void 0:null===(l=A.eggModeInfo)||void 0===l?void 0:l.egg_info)&&Q&&[h.Hj.LinkmicTeamfightStatus_PLAYING,h.Hj.LinkmicTeamfightStatus_PUNISHING].includes(X)&&(0,t.jsxs)("div",{className:`${s.default.eggModeAnimate} ${K?s.default.hide:s.default.show}`,children:[(0,t.jsxs)("div",{className:s.default.eggModeAnimateChild,children:[(0,t.jsx)("div",{className:s.default.eggLeftSide,style:{backgroundImage:"linear-gradient(to right, rgba(252, 28, 109, 0.56), rgba(255, 42, 119, 0))"}}),(0,t.jsx)("div",{className:s.default.eggRightSide,style:{backgroundImage:"linear-gradient(to right, rgba(252, 28, 109, 0.56), rgba(255, 42, 119, 0))"}})]}),(0,t.jsxs)("div",{className:s.default.eggModeAnimateChild,children:[(0,t.jsx)("div",{className:s.default.eggLeftSide,style:{backgroundImage:"linear-gradient(to right, rgba(39, 164, 255, 0.67), rgba(39, 164, 255, 0))"}}),(0,t.jsx)("div",{className:s.default.eggRightSide,style:{backgroundImage:"linear-gradient(to right, rgba(39, 164, 255, 0.67), rgba(39, 164, 255, 0))"}})]})]}),[void 0,void 0].map((e,l)=>(0,t.jsx)("div",{className:s.default.gridRow,children:[void 0,void 0,void 0,void 0].map((e,n)=>{var r,a;let d=n+1+4*l;return(0,t.jsx)("div",{className:o()(s.default.videoItem,"videoItem","__clairvoyance",{[s.default.red]:U.includes(d)&&!(null==L?void 0:null===(r=L[d])||void 0===r?void 0:r.user),[s.default.blue]:!U.includes(d)&&!(null==L?void 0:null===(a=L[d])||void 0===a?void 0:a.user)}),children:i(d)},`${l}_${n}`)})},l))]})]})},[i,q,el,B,et,L,P,null==A?void 0:A.eggModeInfo]),[er,ea]=r.useState({}),ed=r.useRef(null);r.useEffect(()=>(ed.current=setTimeout(()=>{ea({})},300),()=>{ed.current&&clearTimeout(ed.current)}),[G,l]);let es=r.useMemo(()=>{try{var e;let l=document.getElementsByClassName("__clairvoyance");return null===(e=_()(l))||void 0===e?void 0:e.map(e=>(0,m._q)(null==z?void 0:z.root,e))}catch(e){return[]}},[L,G,l,er]);return(0,t.jsxs)("div",{className:o()(s.default.container,n,{[s.default.audioBackground]:[u.yP.AUDIO_GRID,u.yP.AUDIO_1V8,u.yP.AUDIO_DOUBLE_C].includes(l),[s.default.video6v6Background]:l===u.yP.VIDEO_6V6}),children:[(e=>{if(e===u.yP.VIDEO_T1_V_B8)return eo;return null})(l),l===u.yP.VIDEO_T1_V_B8&&f&&(0,t.jsx)(c.Z,{backgoundImgSrc:f,clairvoyancePaths:es})]})}},56906:function(e,l,i){i.d(l,{$:function(){return Z},Z:function(){return $}});var t=i("520739");i("874386"),i("250440"),i("429532"),i("675373"),i("819117");var n=i("563097"),o=i("88648"),r=i("412679"),a=i("877639"),d=i.n(a),s=i("146778"),u=i("792907"),c=i("466621"),v=i("26709"),m=i("926012"),f=i("664014"),_=i("312435"),h=i("393265"),g=i("697041"),p=i.p+"media/groupFightBg.394717bcadc491f0.png",w=i("309585"),C=i("14108"),x=i("361993"),b=i("211286"),I=i("91518");i("284961"),i("826893");var y=i("948922"),j=i("645260"),L=i.n(j),k=i("578006");let T=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.includes("https")?e:e.replace("http","https")},S=(e,l)=>{let{isGroupFight:i=!1,redGroupSeats:t=[],isGuestBattle:n=!1}=l;return n?"加入作战":i?`加入${t.includes(e)?"红队":"蓝队"}`:k.p.JOIN_CHAT},E=(e,l,i,t)=>{var n,o,r,a,d,s,u,c,v,m,f,_,h;let{isGuestBattle:g=!1}=t,p=g?T(L()(e,"ui_info.score_icon.url_list[0]","")):"",w={},C=null==i?void 0:null===(n=i.user)||void 0===n?void 0:n.id_str,x=null==e?void 0:null===(o=e.results)||void 0===o?void 0:o.filter(e=>String(e.guest_id)===C||String(e.guest_id_str)===C)[0];if(!x||x.role===y.L0.GuestBattlePlayerRoleNone)return{giftIcon:p,giftStyle:w};let b=String(null!==(d=null==x?void 0:null===(a=x.crown_info)||void 0===a?void 0:null===(r=a.cur_grade)||void 0===r?void 0:r.level)&&void 0!==d?d:-1),I=null==x?void 0:x.role;if(w={width:"22px",height:"22px",maxWidth:"22px",maxHeight:"22px",position:"absolute",top:"-2px",left:"-4px"},I===y.L0.GuestBattlePlayerRoleWinner){let e=null!==(c=null==l?void 0:null===(u=l.guest_battle_theme_element)||void 0===u?void 0:null===(s=u.first_config)||void 0===s?void 0:s.grade_configs)&&void 0!==c?c:[];e.length&&(p=T(null===(m=e[b])||void 0===m?void 0:null===(v=m.play_value_icon)||void 0===v?void 0:v.url_list[0]))}else{let e=null==l?void 0:null===(_=l.guest_battle_theme_element)||void 0===_?void 0:null===(f=_.straggler_config)||void 0===f?void 0:f.grade_config;(null==e?void 0:e.play_value_icon)&&(p=T(null==e?void 0:null===(h=e.play_value_icon)||void 0===h?void 0:h.url_list[0]))}return{giftIcon:p,giftStyle:w}};var N=i("456147"),P=i("884866"),R=i("159471"),M=i("562923"),A=i.p+"media/guestBattleBg.90cb9b030e3bf46e.png",D=i("310732"),O=i("62014"),V=i("204503"),F=i("551572"),B=i("622307");let U=(0,C.Pe)(),H=e=>w.Z.get(`${U}/webcast/linkmic_audience/get_play_mode_info/`,{params:e}),G=e=>w.Z.get(`${U}/webcast/dress/list/`,{params:e}),Z=e=>{var l,i;let{anchorId:a,roomId:w,className:C,linkerMap:y={},functionType2:j,onLayoutChange:L,dressListAll:k=[],linkmicVideoEqualLayoutFrameOpt:T="0",setIsPk:U,layout:Z}=e,$=!!(0,B.yk)()||e.disableClairvoyance,{player:z}=(0,h.n)(),[W,J]=o.useState(Z),[Y,q]=o.useState(c.Fk),[X,K]=o.useState({}),Q=o.useRef({}),ee=o.useRef({}),[el,ei]=o.useState(!1),et=o.useRef(void 0);et.current=W;let[en,eo]=o.useState(0),er=o.useRef(new O.a),[ea,ed]=o.useState(),[es,eu]=o.useState(),ec=null==ea?void 0:null===(l=ea.data)||void 0===l?void 0:l.teamfight_info,ev=null==ea?void 0:null===(i=ea.data)||void 0===i?void 0:i.guest_battle_info,em=o.useMemo(()=>{var e,l;return Number.isInteger(null==es?void 0:null===(e=es.data)||void 0===e?void 0:e.gift_id)&&Number(null==es?void 0:null===(l=es.data)||void 0===l?void 0:l.gift_id)>0},[null==es?void 0:es.data]),ef=o.useMemo(()=>void 0!==W,[W]);o.useEffect(()=>{w&&ef&&(H({room_id:w,_point:2}).then(e=>{ed(null==e?void 0:e.data)}),(0,N.RO)({room_id:w}).then(e=>{eu(null==e?void 0:e.data)}))},[w,ef]),o.useEffect(()=>{let e=null==ev?void 0:ev.dress_id;if(""!==e){let l=null==k?void 0:k.find(l=>(null==l?void 0:l.dress_id)===e);l?K(l):G({dress_id:e}).then(e=>{var l,i,t,n;if(null==e?void 0:null===(l=e.data)||void 0===l?void 0:l.data){let l=null!==(n=null==e?void 0:null===(t=e.data)||void 0===t?void 0:null===(i=t.data)||void 0===i?void 0:i.dress_list)&&void 0!==n?n:[];l.length&&K(l[0])}})}},[null==ev?void 0:ev.dress_id]),o.useEffect(()=>{y[5]&&[21,22].includes(en)?22===en?J(m.yP.AUDIO_GRID):26===en?J(m.yP.AUDIO_DOUBLE_C):25===en?J(m.yP.MATE_CUSTOM):J(m.yP.AUDIO_1V8):y[16]&&J(m.yP.VIDEO_6V6)},[y,en]);let e_=o.useCallback(()=>Y,[q,Y]),eh=o.useMemo(()=>(0,P.Qx)(Y),[Y]),eg=o.useCallback(d()(()=>(0,g.m)(w,a).then(e=>{let{data:{data:l,status_code:i}}=e;if(0===i){var t,n,o,r,a,d;let e={},i={};return eo(null==l?void 0:null===(t=l.linker_base_info)||void 0===t?void 0:t.ui_layout),null==l||null===(n=l.user)||void 0===n||n.forEach(l=>{l.linkmic_id_str&&(e[l.linkmic_id_str]=l)}),et.current===m.yP.VIDEO_6V6&&(null==l||null===(a=l.linker_content_map[null===(d=Object.keys(null==l?void 0:l.linker_content_map))||void 0===d?void 0:d[0]])||void 0===a||null===(r=a.linked_users)||void 0===r||r.map(l=>{l.user_position=l.user_position+m.Lf[W],l.linkmic_id_str&&(e[l.linkmic_id_str]=l)})),null==l||null===(o=l.locked_positions)||void 0===o||o.forEach(e=>{("number"==typeof e.position||"string"==typeof e.position)&&(i[e.position]=e)}),Q.current=Object.assign({},Q.current,e),ee.current=i,Promise.resolve()}}),3e3),[w,a,W]),{isGroupFight:ep,isGroupPlaying:ew,isInPunish:eC,redGroupSeats:ex,statusTexting:eb}=(0,x.Z)({teamfightInfo:ec,linkMicSeats:Y}),{isGuestBattle:eI}=(0,b.Z)({guestBattleInfo:ev});o.useEffect(()=>{let e=Object.keys(y);if(!(e.length<=0)&&(1!==e.length||"4"!==e[0]))return eg().then(()=>{let e=(0,t._)({},c.Fk);Object.keys(Q.current).forEach(l=>{let i=Q.current[l];e[i.user_position]={idx:i.user_position,user:i}}),q(e)}).finally(()=>{ei(!0)}),()=>{(null==eg?void 0:eg.cancel)&&(null==eg||eg.cancel())}},[]);let ey=o.useCallback(()=>Q.current,[]),ej=o.useCallback(()=>ee.current,[]);o.useEffect(()=>{null==L||L(W)},[W]),(0,c.wz)({setLayout:J,enable:!0,setSeats:q,getSeats:e_,layout:W,getUsers:ey,getPositions:ej,onUsersUpdate:el&&eg,roomIdStr:w,audioPower:er.current,setIsPk:U});let eL=o.useCallback(()=>{J(void 0)},[]);o.useEffect(()=>{if(W===m.yP.AUDIO_1V8||W===m.yP.AUDIO_1V8_STAGE||W===m.yP.AUDIO_GRID||W===m.yP.AUDIO_DOUBLE_C||W===m.yP.VIDEO_1V6||W===m.yP.VIDEO_1V8||W===m.yP.VIDEO_2V4V4||W===m.yP.VIDEO_GRID||W===m.yP.VIDEO_6V6||W===m.yP.VIDEO_DYNAMIC||W===m.yP.VIDEO_DYNAMIC_FLOAT||W===m.yP.VIDEO_1_V_3||W===m.yP.VIDEO_1_V_6||W===m.yP.VIDEO_1_V_8||W===m.yP.VIDEO_T1_V_B8||W===m.yP.MATE_CUSTOM){var e;ei(!0),(null===(e=Object.keys(Q.current))||void 0===e?void 0:e.length)===0&&eg().then(()=>{let e=W===m.yP.MATE_CUSTOM?{}:(0,t._)({},c.Fk);W===m.yP.AUDIO_DOUBLE_C&&(e[9]={idx:9}),Object.keys(Q.current).forEach(l=>{let i=Q.current[l];e[i.user_position]={idx:i.user_position,user:i}}),q(e)}).finally(()=>{ei(!0)})}else ei(!1)},[W]),o.useEffect(()=>(z.on(r.FP.CHANGE_URL,eL),()=>{z.off(r.FP.CHANGE_URL,eL)}),[]);let ek=o.useCallback(e=>{var l,i,t,o,r,d,s,c;let f=eh[e];if(W===m.yP.AUDIO_1V8||W===m.yP.AUDIO_1V8_STAGE||W===m.yP.AUDIO_GRID||W===m.yP.AUDIO_DOUBLE_C){let r=S(e,{isGroupFight:ep,isGuestBattle:eI,redGroupSeats:ex}),{giftIcon:d,giftStyle:s}=E(ev,X,null==f?void 0:f.user,{isGuestBattle:eI});return(0,n.jsx)(v.X,{user:null==f?void 0:f.user,isLock:(null==f?void 0:null===(l=f.info)||void 0===l?void 0:l.status)===u.U.LinkmicPositionStatus_Locked,giftLabelBackgroundColor:[ew,eC].some(Boolean)&&0!==e?ex.includes(e)?"rgba(248, 42, 116, 1)":"rgba(24, 158, 254, 1)":void 0,dynamic:!ep&&(0,F.D)().includes(Number(en)),joinText:r,giftLabelIcon:d,giftLabelStyle:s,setFloatModal:()=>null,showAnchorLabel:(0,P.ic)(eh)&&String(null===(o=eh[e])||void 0===o?void 0:null===(t=o.user)||void 0===t?void 0:null===(i=t.user)||void 0===i?void 0:i.id_str)===String(a),audioPower:er.current})}if(W===m.yP.VIDEO_1V6||W===m.yP.VIDEO_1V8||W===m.yP.VIDEO_2V4V4||W===m.yP.VIDEO_DYNAMIC||W===m.yP.VIDEO_GRID||W===m.yP.VIDEO_6V6||W===m.yP.VIDEO_DYNAMIC_FLOAT||W===m.yP.VIDEO_1_V_8||W===m.yP.VIDEO_1_V_6||W===m.yP.VIDEO_1_V_3||W===m.yP.VIDEO_T1_V_B8||W===m.yP.MATE_CUSTOM)return W!==m.yP.MATE_CUSTOM||(null==f?void 0:f.user)?(0,n.jsx)(_.W,{idx:e,isLock:(null==f?void 0:null===(r=f.info)||void 0===r?void 0:r.status)===u.U.LinkmicPositionStatus_Locked,user:null==f?void 0:f.user,layout:W,position:e,isPreview:!0,setFloatModal:()=>null,showAnchorLabel:(0,P.ic)(eh)&&String(null===(c=eh[e])||void 0===c?void 0:null===(s=c.user)||void 0===s?void 0:null===(d=s.user)||void 0===d?void 0:d.id_str)===String(a),joinText:S(e,{isGroupFight:ep,isGuestBattle:eI,redGroupSeats:ex}),audioPower:er.current,style:"1"===T&&(0,F.D)().includes(en)?{border:"2px solid #140731"}:void 0}):null;return null},[W,eh,ev,X,ep,eI,a,en]),eT=(0,V.R)(Y,a,W),eS=o.useMemo(()=>F.dr.includes(Number(en)),[en]);if(ep)return W===m.yP.VIDEO_T1_V_B8?(0,n.jsx)(M.PY,{layout:W,count:Object.keys(Y).length,renderElement:ek,teamfightInfo:ec,statusText:eb,micSeats:Y,roomId:w,backgroundImg:p,isPreview:!0}):(0,n.jsx)(I.s,{className:C,layout:W,count:Object.keys(Y).length,renderElement:ek,statusText:eb,isPreview:!0});return(0,n.jsx)(n.Fragment,{children:eS?(0,n.jsx)(R.X0,{idPrefix:"preview",className:C,renderElement:ek,layout:en,linkers:eT,incomingPlayer:z}):(0,n.jsx)(f.S,{className:C,layout:W,count:Object.keys(Y).length,renderElement:ek,isGuestBattle:eI,backgroundImg:eI?A:[m.yP.AUDIO_1V8_STAGE,m.yP.AUDIO_1V8,m.yP.AUDIO_GRID,m.yP.AUDIO_DOUBLE_C].includes(W)&&em?s:[m.yP.AUDIO_1V8_STAGE,m.yP.AUDIO_1V8,m.yP.AUDIO_GRID,m.yP.AUDIO_DOUBLE_C].includes(W)&&!em?D:null,micSeats:eh,ext:{showVideoDynamicFloatLayoutJoinBtn:!1},linkers:eT,uiLayout:en,linkmicVideoEqualLayoutFrameOpt:T,disableClairvoyance:$})})};var $=Z},697041:function(e,l,i){i.d(l,{Y:function(){return u},m:function(){return c}});var t=i(620923),n=i(14108),o=i(854575),r=i(428775),a=i.n(r);let d=`${(0,n.Pe)()}`,s=a().create({baseURL:d});(0,o.U)(s);let u=async(e,l)=>{let i=s.get("/webcast/distribution/check_user_live_status/",{withCredentials:!0,params:{user_ids:e,aid:6383,distribution_scenes:l,device_platform:"webapp"}});return i.then(i=>{var n,o,r;let{status_code:a,data:d=[]}=(null==i?void 0:i.data)||{},s=null==i?void 0:null===(n=i.headers)||void 0===n?void 0:n["x-tt-logid"];null===(r=(0,t.OK)())||void 0===r||null===(o=r.sendEvent)||void 0===o||o.call(r,{name:"check_live_status_live_success",categories:{status_code:a,data:d,logId:s,userId:e,scene:l},type:"event"})}),i.catch(i=>{var n,o;null===(o=(0,t.OK)())||void 0===o||null===(n=o.sendEvent)||void 0===n||n.call(o,{name:"check_live_status_error",categories:{userId:e,scene:l,err:i},type:"event"})}),i},c=(e,l)=>s.get("/webcast/linkmic_audience/list/v2/",{withCredentials:!0,params:{room_id:e,aid:6383,anchor_id:l,live_id:1,device_platform:"web",language:navigator.language}})},172589:function(e,l,i){i.r(l),i.d(l,{default:function(){return x},VipLiveBoundaryPlugin:function(){return C}});var t=i("563097"),n=i("88648"),o=i("755111"),r=i("725215"),a=i("58655"),d=i("240026"),s=i("645260"),u=i.n(s),c=i("358003"),v=i("31243"),m=i("652541"),f=i("299271"),_=i("637005");let h=()=>{let{vipStore:e,roomStore:{roomInfo:l}}=(0,a.o)();(0,n.useEffect)(()=>{let i=()=>{var i,t;let n=null==l?void 0:null===(i=l.anchor)||void 0===i?void 0:i.id_str,o=null==l?void 0:null===(t=l.room)||void 0===t?void 0:t.id_str;if(!!n)(0,v.GT)({room_id:o,anchor_id:n}).then(l=>{var i,t,n;let{data:o}=l;e.setVipEmojiConfig(o.data);let r=null==o?void 0:null===(t=o.data)||void 0===t?void 0:null===(i=t.user_data)||void 0===i?void 0:i.expired_time,a=1e3*r,d=null==o?void 0:null===(n=o.data)||void 0===n?void 0:n.is_member,s=new Date().getTime();e.setIsVip(a>s&&d),e.setVipLiveStatus(r?f.L[(0,m.j$)(r)]:f.L[f.vz.BEFORE]),e.setVipInfoLoaded(!0)})};i();let t=_.listen(_.EVENT.VipRechargeSuccess,()=>{i()});return()=>{null==t||t()}},[l])};var g=i("859231"),p=i("582493"),w=i("655631");let C=(0,r.Pi)(e=>{let{onShowVipLiveBoundary:l,paidLiveData:i,roomId:n,roomStatus:r,messageInstance:a,onBtnClick:d,isInLivingRoom:s,roomInfo:u,customContent:c,abTestData:v}=e;return(0,t.jsx)(o.ZP,{roomId:n,roomStatus:r,messageInstance:a,onBtnClick:d,paidLiveData:i,onShowBoundary:l,isInLivingRoom:s,roomInfo:u,customContent:c,abTestData:v})});var x=(0,r.Pi)(()=>{let{singletonStore:{message:e},paidLiveStore:{paidLiveData:l},roomStore:{roomInfo:i,roomStatus:o,hideBanner:r},vipStore:{setShowVipLiveBoundary:s,setIsShowVipPanel:v,showVipLiveBoundary:m,isShowVipPanel:f},userStore:{headerUserInfo:_},feedStore:{isActive:x},rightPanelStore:{openItem:b}}=(0,a.o)();h();let I=u()(i,"room.id_str"),y=(0,d.T)(),j=()=>!1;return(0,n.useEffect)(()=>{x&&(o!==g.LV.END||m)&&f&&(!r||m)&&b(p.k.Vip)},[x,o,m,f,r,m]),(0,t.jsx)(C,{messageInstance:e,paidLiveData:l,isInLivingRoom:!0,roomInfo:i,roomId:I,abTestData:y,roomStatus:o,onShowVipLiveBoundary:e=>{s(e)},onBtnClick:()=>{if(null==_?void 0:_.isLogin)(0,w.Z)("live");else{var e,l;(0,c.default)({success:()=>{!j()&&window.location.reload()},enterMethod:"",headerText:"登录后查看更多作品",next:`https://${null===(l=window)||void 0===l?void 0:null===(e=l.location)||void 0===e?void 0:e.host}`})}}})})},652541:function(e,l,i){i.d(l,{HS:function(){return u},T3:function(){return v},ZK:function(){return m},cI:function(){return d},j$:function(){return s},m1:function(){return f},p8:function(){return c}});var t=i(520739),n=i(878389);i(268917);var o=i(299271);let r=(e,l,i)=>e===o.Nl.FuliType&&l===o.D$.VIRTUAL&&i===o.lW.DONE?o.lW.VIRTUAL_DONE:i||0,a=e=>{if(e.type===o.Nl.CourseType){var l,i;return e.privilege_switch===o.oH.OFF?o.Bn[e.type]:`${null!==(i=null===(l=e.discount_course_info)||void 0===l?void 0:l.free_course_number)&&void 0!==i?i:0}个免费课程`}return null==e?void 0:e.content},d=function(e,l){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],t=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(l===o.Nl.LinkmicType)return"";if(l===o.Nl.FuliType||l===o.Nl.LinkmicType)return o.eS[e];if(l===o.Nl.EmojiType)return"去使用";if(l===o.Nl.GroupType)return o.I$[e];if(l===o.Nl.CourseType)return"查看";if(l===o.Nl.Ask){if(i)return"去提问";if(t)return"查看"}return l===o.Nl.ShortVideo&&n?"查看":""},s=e=>{let l=1e3*Number(e),i=l-new Date().getTime();if(0===e)return o.vz.BEFORE;if(i>0&&i<6048e5)return o.vz.AFTER_SEVEN;if(i>0)return o.vz.AFTER;if(i<0&&i>-6048e5)return o.vz.EXPIRED_FEWDAY;else if(i<0)return o.vz.EXPIRED;return o.vz.BEFORE},u=(e,l,i,t)=>!!l&&!!e&&!(e.length<=0)&&!!i&&!!t&&(!!i[e]||!!t[e]),c=(e,l)=>{var i,u,c,v,m,f;if(!e)return[];let _=[],h=e.advanced_privilege||[],g=e.is_member,p=s(null!==(u=e.expired_time)&&void 0!==u?u:0),w=(null!==(c=null===(i=e.short_video_info)||void 0===i?void 0:i.short_video_count)&&void 0!==c?c:0)>0;for(let i=0;i<h.length;i++){let{type:s}=h[i],u=r(s,h[i].bonus_type,h[i].received),c=!0;if(s===o.Nl.Ask){let{answered_ask_num:e=0}=h[i];c=e>0}let p=(0,n._)((0,t._)({},h[i]),{isGradient:!g,btnText:(g||s===o.Nl.CourseType||s===o.Nl.Ask||s===o.Nl.ShortVideo)&&d(u,s,g,c,w),handleClick:function(e,l,i,t){var n,r;let{type:a,status:d,isMember:s}=e;if(a===o.Nl.EmojiType||a===o.Nl.LinkmicType||a===o.Nl.CourseType||a===o.Nl.Ask)return t;let u=(null!==(r=null==l?void 0:null===(n=l.short_video_info)||void 0===n?void 0:n.short_video_count)&&void 0!==r?r:0)>0;return a===o.Nl.ShortVideo,t}({type:null===(v=h[i])||void 0===v?void 0:v.type,bonusType:null===(m=h[i])||void 0===m?void 0:m.bonus_type,status:u,prizeId:null===(f=h[i])||void 0===f?void 0:f.prize_id,item:h[i],isMember:g},e,0,l),content:a(h[i]),privilege_tags:e.privilege_tags});_.push(p)}return _},v=e=>{for(let l=0;l<e.length;l++)if(e[l].type===o.Nl.FuliType)return{fuliStatus:"in_effect",fuliType:e[l].schema_url?"real":"virtual",fuliId:e[l].prize_id};return{fuliStatus:"nonactivated",fuliType:"",fuliId:0}},m=e=>{let l=new Date(e),i=l.getFullYear(),t=l.getMonth()+1<10?`${l.getMonth()+1}`:l.getMonth()+1,n=10>l.getDate()?`${l.getDate()}`:l.getDate();return`${i}-${t}-${n}`},f=e=>{if(1===e.length)return e[0];if(e.length>1){let l=e.find(e=>e.apply_status===o.aJ.ALREADY_IN);if(l)return l;let i=e.find(e=>e.apply_status===o.aJ.JOIN_NOW);if(i)return i;let t=e.find(e=>e.apply_status===o.aJ.APPLYING);if(t)return t;let n=e.find(e=>e.apply_status===o.aJ.APPLY_TO_JOIN||e.apply_status===o.aJ.NOT_APPLY);if(n)return n;let r=e.find(e=>e.apply_status===o.aJ.VIEW_CONDITION);if(r)return r;let a=e.find(e=>e.apply_status===o.aJ.GROUP_IS_FULL);if(a)return a}return e[0]}},459049:function(e,l,i){i.d(l,{h:function(){return r}});var t=i(14108),n=i(567754);let o=`${(0,t.Pe)()}`,r=(e,l)=>`${o}/${e}${l?"?":""}${(0,n.stringify)(l)}`},225520:function(e,l,i){i.d(l,{Dx:function(){return _},Hw:function(){return h},zT:function(){return g}}),i(284961),i(826893),i(874386),i(954372);var t=i(563097),n=i(88648),o=i(713097),r=i.n(o),a=i(304036),d=i(253714),s=i(474162),u=i(906499),c=i(411362),v=i(422959),m=i(473677);let f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/\n/g,"")},_=e=>{let{url:l,text:i,textSize:o="normal",clamp:a=2,showTip:s=!1,onVideoClick:c,className:m}=e,[_,h]=(0,n.useState)(!1),g=f(i);return(0,t.jsxs)(u.a,{target:"_blank",rel:"noopener noreferrer",href:l,onClick:c,className:r()(d.default.link,d.default.titleWrapper),isNeedSeoOpt:!0,children:[(0,t.jsx)("h2",{onMouseEnter:e=>{let l=e.currentTarget;s&&l.scrollHeight>l.clientHeight&&h(!0)},onMouseLeave:()=>s&&h(!1),className:r()(d.default.title,m,{[d.default.titleClamp1]:1===a,[d.default.titleSizeSmall]:"small"===o,[d.default.titleSizeNormal]:"normal"===o}),children:(0,t.jsx)(v.Z,{text:g})}),_&&(0,t.jsx)("div",{className:d.default.dialog,children:(0,t.jsx)(v.Z,{text:g})})]})},h=e=>{let{url:l,avatar:i,avatarType:n="extraExtraSmall",userName:o,nameSize:a="normal",time:m,timeSize:_="normal",onAuthorClick:h,followStatus:g}=e;return(0,t.jsxs)("div",{className:d.default.source,children:[(0,t.jsxs)(u.a,{target:"_blank",rel:"noopener noreferrer",href:l,className:r()(d.default.link,d.default.userInfo),onClick:h,isNeedSeoOpt:!0,children:[i&&(0,t.jsx)(s.q,{type:n,src:i,alt:`${o}头像`}),(0,t.jsx)("p",{className:r()(d.default.name,{[d.default.nameGap]:!!i,[d.default.nameSizeSmall]:"small"===a,[d.default.nameSizeNormal]:"normal"===a}),children:(0,t.jsx)(v.Z,{text:f(o)})}),!!g&&(0,t.jsx)(c.Xg,{className:d.default.followStatus})]}),m&&(0,t.jsx)("span",{className:r()(d.default.time,{[d.default.timeSizeSmall]:"small"===_,[d.default.timeSizeNormal]:"normal"===_}),children:m})]})},g=e=>{let{size:l="normal",titleClamp:i=2,className:n,hideSource:o}=e;return(0,t.jsxs)("div",{className:d.default.imgContentSkeleton,children:[(0,t.jsx)("div",{className:r()(d.default.imgWrapper,n),children:(0,t.jsx)("div",{className:d.default.imgSkeleton,children:(0,t.jsx)(m.Z,{width:"small"===l?74:105,height:"small"===l?85:120,needRenderInSSR:!0,src:a.Z,viewBox:"0 0 105 120"})})}),(0,t.jsx)("div",{className:d.default.titleSkeleton}),i>=2&&(0,t.jsx)("div",{className:r()(d.default.titleSkeleton,d.default.titleSkeletonSecond)}),!o&&(0,t.jsx)("div",{className:d.default.sourceSkeleton})]})}},372311:function(e,l,i){i.d(l,{P:function(){return m}});var t=i("563097"),n=i("88648"),o=i("713097"),r=i.n(o),a=i("304036"),d=i("520739"),s=i("878389");let u=(0,n.forwardRef)((e,l)=>(0,t.jsx)("svg",(0,s._)((0,d._)({width:114,height:114,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:(0,t.jsx)("path",{d:"M91.638 22.852c-6.101-4.005-10.508-10.41-11.883-17.876A27.433 27.433 0 0 1 79.295 0H59.818l-.034 78.542c-.325 8.794-7.521 15.854-16.34 15.854-2.738 0-5.32-.69-7.594-1.892-5.209-2.762-8.778-8.258-8.778-14.584 0-9.082 7.347-16.475 16.373-16.475 1.684 0 3.3.282 4.833.763V42.202a35.857 35.857 0 0 0-4.833-.35C23.68 41.852 7.6 58.034 7.6 77.926c0 12.205 6.062 23.004 15.307 29.534 5.82 4.111 12.904 6.54 20.543 6.54 19.77 0 35.85-16.182 35.85-36.074v-39.83a46.117 46.117 0 0 0 27.1 8.766V27.263a26.843 26.843 0 0 1-14.762-4.411z",fill:"#33343F"})})));var c=i("962178"),v=i("473677");let m=e=>{let{style:l,className:i,imgBoxClassName:n,infoBoxClassName:o,imgBoxStyle:d,useNewLogo:s=!1}=e;return(0,t.jsxs)("div",{style:l,className:r()(c.default.PlaceholderCard,i),children:[(0,t.jsx)("div",{className:r()(c.default.imgBox,n),style:d,children:(0,t.jsx)("div",{className:r()(c.default.imgContainer),children:s?(0,t.jsx)(v.Z,{width:114,height:114,viewBox:"0 0 114 114",src:u,className:c.default.newIcon}):(0,t.jsx)(v.Z,{width:105,height:120,viewBox:"0 0 105 120",src:a.Z,className:c.default.icon})})}),(0,t.jsxs)("div",{className:r()(c.default.infoBox,o),children:[(0,t.jsx)("div",{style:{width:"100px"},className:r()(c.default.rect,c.default.first)}),(0,t.jsx)("div",{className:r()(c.default.rect,c.default.second)}),(0,t.jsx)("div",{className:r()(c.default.rect,c.default.third)})]})]})}},417069:function(e,l,i){i.d(l,{B:function(){return c}});var t=i(520739),n=i(878389),o=i(368200),r=i(563097);i(88648);var a=i(713097),d=i.n(a),s=i(47946),u=i(906499);function c(e){let{isUseALink:l=!0,children:i,className:a}=e,c=(0,o._)(e,["isUseALink","children","className"]);if(!l){let{onClick:e}=c;return(0,r.jsx)("div",(0,n._)((0,t._)({className:d()(s.default.aLink,a),onClick:e},c),{children:i}))}return(0,r.jsx)(u.a,(0,n._)((0,t._)({className:a},c),{children:i}))}},71104:function(e,l,i){i.d(l,{h:function(){return p},n:function(){return g}});var t=i(91907),n=i(562017),o=i(260211),r=i(134761);i(990921),i(874386),i(675373),i(268917),i(209955);var a=i(866674),d=i.n(a),s=i(877639),u=i.n(s),c=i(918294),v=i.n(c),m=i(212138),f=i.n(m),_=new WeakMap,h=new WeakMap;class g{add(e){return new Promise((l,i)=>{this.runList.push({param:e,resolve:l,reject:i}),(0,t._)(this,_).call(this)})}constructor({max:e,timeWait:l,runOperation:i}){(0,r._)(this,"max",0),(0,r._)(this,"runList",[]),(0,r._)(this,"runOperation",e=>{}),(0,n._)(this,_,{writable:!0,value:()=>{(0,t._)(this,h).call(this)}}),(0,n._)(this,h,{writable:!0,value:()=>{let e=this.runList;this.runList=[];let l=(null==e?void 0:e.length)||0,{max:i}=this;if(i<=0||l<=i){this.runOperation(e);return}for(let t=0;t<l;t+=i){let l=v()(e,t,t+i);if(null==l?void 0:l.length)this.runOperation(l);else break}}}),this.max=e||0;if(!i)throw Error("MultiRun runOperation 执行函数必须设置");if(!d()(i))throw Error("MultiRun runOperation 执行函数必须为函数形式");this.runOperation=i,(0,o._)(this,_,u()(()=>{(0,t._)(this,h).call(this)},l||300,{leading:!1,trailing:!0}))}}let p=(e,l)=>{f()(e,e=>{var i;null==e||null===(i=e.reject)||void 0===i||i.call(e,l||"error")})}},237652:function(e,l,i){i.d(l,{AB:function(){return L},n5:function(){return j},q:function(){return I},xD:function(){return b}});var t=i(520739),n=i(878389);i(675373),i(268917);var o=i(496349),r=i(738363),a=i(231755),d=i(71104),s=i(212138),u=i.n(s),c=i(377530),v=i.n(c),m=i(138871),f=i.n(m),_=i(812307),h=i(497730),g=i(871212);let{COMMON_SEARCH_PARAMS:p,DISABLE_SECRET_VIDEO_PARAMS:w,CHANNEL_PC_WEB:C}=o||{},{ERROR_CODE:x}=r||{};async function b(e){let{cursor:l=0,count:i=50,groupId:o="1"}=e;return arguments.length>1&&void 0!==arguments[1]&&arguments[1],await (0,a.U2)("/aweme/v1/web/im/resources/emoticon/trending",(0,n._)((0,t._)({},p),{cursor:l,count:i,groupId:o}))}async function I(e){let{itemIds:l,from:i,requestSource:n=g.AWEME_PC_RESOURCE_TYPE,originType:o=h.F.General}=e;return(0,_.Ex)("/aweme/v1/web/multi/aweme/detail/",i),await (0,a.v_)("/aweme/v1/web/multi/aweme/detail/",(0,t._)({},p),{aweme_ids:`[${l.join(",")}]`,request_source:n,origin_type:o})}(0,_.m)("/aweme/v1/web/multi/aweme/detail/",500);let y=new d.n({max:40,timeWait:300,runOperation:e=>{let l=[];u()(e,e=>{let{param:i}=e;i&&l.push(i)}),I({itemIds:v()(l),from:"multiRunGetAwemeInfo",originType:h.F.Chat,requestSource:g.AWEME_IM_RESOURCE_TYPE}).then(l=>{if((null==l?void 0:l.status_code)===0){let i=(null==l?void 0:l.aweme_details)||[],t=(null==l?void 0:l.filter_list)||[],n={};u()(i,(e,l)=>{let{aweme_id:i,external_video_type:t}=e;if(i){let l=i;t&&(l+=`:${t}`),n[l]=e}});let o={};u()(t,(e,l)=>{let{aweme_id:i,external_video_type:t}=e;if(i){let l=i;t&&(l+=`:${t}`),o[l]=e}}),u()(e,e=>{let{param:l,reject:i,resolve:t}=e;t({aweme_details:n[l]?[n[l]]:null,filter_list:o[l]?[o[l]]:null})})}else(0,d.h)(e,"")}).catch(l=>{(0,d.h)(e,l)})}});async function j(e){return y.add(e)}async function L(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return await (0,a.v_)("/aweme/v1/web/im_communication/msg_read_switch/",(0,t._)({},p),f().stringify((0,n._)((0,t._)({},p),{source:"msg_tab",is_retry:l,msg_ids:e})),{headers:{"Content-Type":"application/json"},isDataUseJson:!0,transformResponse:[function(e){return f().parse(e)}]})}},649368:function(e,l,i){var t=i(520739),n=i(878389),o=i(563097),r=i(88648);let a=(0,r.forwardRef)((e,l)=>(0,o.jsx)("svg",(0,n._)((0,t._)({width:12,height:13,fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:l},e),{children:(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.102 10.42a.563.563 0 0 1 0-.795l3.353-3.352L4.101 2.92a.562.562 0 1 1 .796-.795l3.75 3.75c.22.22.22.576 0 .795l-3.75 3.75a.563.563 0 0 1-.796 0z",fill:"currentColor",fillOpacity:".9"})})));l.Z=a}}]);
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).xss={})}(this,function(t){"use strict";var e=function(){return(e=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function n(t,e,n){if(n||2==arguments.length)for(var i,r=0,o=e.length;r<o;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var i=/[^a-zA-Z0-9\\_:.-]/gim,r=/</g,o=/>/g,a=/&#([a-zA-Z0-9]*);?/gim,s=/&quot;/g,u=/&colon;?/gim,c=/&newline;?/gim,l=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,f=/u\s*r\s*l\s*\(.*/gi,h=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,p=/"/g,d=function(t){return t.replace(r,"&lt;").replace(o,"&gt;")},y={indexOf:function(t,e){var n,i;for(n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return -1},forEach:function(t,e,n){var i,r;for(i=0,r=t.length;i<r;i++)e.call(n,t[i],i,t)},some:function(t,e,n){var i,r;for(i=0,r=t.length;i<r;i++)if(e.call(n,t[i],i,t))return!0;return!1},trim:function(t){return t.replace(/(^\s*)|(\s*$)/g,"")},includes:function(t,e){if("string"==typeof t)return -1!==t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1},spaceIndex:function(t){var e=/\s|\n|\t/.exec(t);return e?e.index:-1},uniq:function(t){for(var e={},n=[],i=0;i<t.length;i++)e[t[i]]||(n.push(t[i]),e[t[i]]=!0);return n},from:function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e},keys:function(t){var e=[];for(var n in t)e.push(n);return e}};function v(t){return null==t}function g(t){var e;return'"'===(e=t)[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]?t.substr(1,t.length-2):t}function m(t){var e,n,i,r,o,a,s,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",l=0;for(t=function(t){t=t.replace(/rn/g,"n");for(var e="",n=0;n<t.length;n++){var i=t.charCodeAt(n);i<128?e+=String.fromCharCode(i):i>127&&i<2048?e+=String.fromCharCode(i>>6|192)+String.fromCharCode(63&i|128):e+=String.fromCharCode(i>>12|224)+String.fromCharCode(i>>6&63|128)+String.fromCharCode(63&i|128)}return e}(t);l<t.length;)r=(e=t.charCodeAt(l++))>>2,o=(3&e)<<4|(n=t.charCodeAt(l++))>>4,a=(15&n)<<2|(i=t.charCodeAt(l++))>>6,s=63&i,isNaN(n)?a=s=64:isNaN(i)&&(s=64),c=c+u.charAt(r)+u.charAt(o)+u.charAt(a)+u.charAt(s);return c}function b(t){var e,n,i,r,o,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;for(t=t.replace(/[^A-Za-z0-9+/=]/g,"");c<t.length;)e=s.indexOf(t.charAt(c++))<<2|(r=s.indexOf(t.charAt(c++)))>>4,n=(15&r)<<4|(o=s.indexOf(t.charAt(c++)))>>2,i=(3&o)<<6|(a=s.indexOf(t.charAt(c++))),u+=String.fromCharCode(e),64!==o&&(u+=String.fromCharCode(n)),64!==a&&(u+=String.fromCharCode(i));return function(t){for(var e="",n=0,i=0,r=0,o=0;n<t.length;)(i=t.charCodeAt(n))<128?(e+=String.fromCharCode(i),n++):i>191&&i<224?(e+=String.fromCharCode((31&i)<<6|63&(o=t.charCodeAt(n+1))),n+=2):(o=t.charCodeAt(n+1),e+=String.fromCharCode((15&i)<<12|(63&o)<<6|63&(r=t.charCodeAt(n+2))),n+=3);return e}(u)}function w(t,e,n){var i="",r=0,o=!1,a=!1,s=0,u=t.length,c="",l="";t:for(s=0;s<u;s++){var f=t.charAt(s);if(!1===o){if("<"===f){o=s;continue}}else if(!1===a){if("<"===f){i+=n(t.slice(r,s)),o=s,r=s;continue}if(">"===f||s===u-1){i+=n(t.slice(r,o)),c=function(t){var e,n=y.spaceIndex(t);return e=-1===n?t.slice(1,-1):t.slice(1,n+1),"/"===(e=y.trim(e).toLowerCase()).slice(0,1)&&(e=e.slice(1)),"/"===e.slice(-1)&&(e=e.slice(0,-1)),e}(l=t.slice(o,s+1)),i+=e(o,i.length,c,l,"</"===l.slice(0,2)),r=s+1,o=!1;continue}if('"'===f||"'"===f)for(var h=1,p=t.charAt(s-h);""===p.trim()||"="===p;){if("="===p){a=f;continue t}p=t.charAt(s-++h)}}else if(f===a){a=!1;continue}}return r<u&&(i+=n(t.substr(r))),i}function k(t,e){var n=0,r=0,o=[],a=!1,s=t.length;function u(t,n){if(!((t=(t=y.trim(t)).replace(i,"").toLowerCase()).length<1)){var r=e(t,n||"");r&&o.push(r)}}for(var c=0;c<s;c++){var l=t.charAt(c),f=void 0;if(!1!==a||"="!==l){if(!1===a||c!==r){if(/\s|\n|\t/.test(l)){if(t=t.replace(/\s|\n|\t/g," "),!1===a){if(-1===(f=function(t,e){for(;e<t.length;e++){var n=t[e];if(" "!==n)return"="===n?e:-1}return -1}(t,c))){u(y.trim(t.slice(n,c))),a=!1,n=c+1;continue}c=f-1;continue}if(-1===(f=function(t,e){for(;e>0;e--){var n=t[e];if(" "!==n)return"="===n?e:-1}return -1}(t,c-1))){u(a,g(y.trim(t.slice(n,c)))),a=!1,n=c+1;continue}}}else{if(-1===(f=t.indexOf(l,c+1)))break;u(a,y.trim(t.slice(r+1,f))),a=!1,n=(c=f)+1}}else a=t.slice(n,c),n=c+1,r='"'===t.charAt(n)||"'"===t.charAt(n)?n:function(t,e){for(;e<t.length;e++){var n=t[e];if(" "!==n)return"'"===n||'"'===n?e:-1}return -1}(t,c+1)}return n<t.length&&(!1===a?u(t.slice(n)):u(a,g(y.trim(t.slice(n))))),y.trim(o.join(" "))}function _(t,e,n){if(n=function(t){return t=function(t){for(var e="",n=0,i=t.length;n<i;n++)e+=32>t.charCodeAt(n)?" ":t.charAt(n);return y.trim(e)}(t=(t=(t=t.replace(s,'"')).replace(a,function(t,e){return"x"===e[0]||"X"===e[0]?String.fromCharCode(parseInt(e.substr(1),16)):String.fromCharCode(parseInt(e,10))})).replace(u,":").replace(c," "))}(n),"href"===e||"src"===e){if("#"===(n=y.trim(n)))return"#";if("http://"!==n.substr(0,7)&&"https://"!==n.substr(0,8)&&"mailto:"!==n.substr(0,7)&&"tel:"!==n.substr(0,4)&&"data:image/"!==n.substr(0,11)&&"ftp://"!==n.substr(0,6)&&"./"!==n.substr(0,2)&&"../"!==n.substr(0,3)&&"#"!==n[0]&&"/"!==n[0])return""}else if("background"===e){if(l.lastIndex=0,l.test(n))return""}else if("style"===e&&(h.lastIndex=0,h.test(n)||(f.lastIndex=0,f.test(n)&&(l.lastIndex=0,l.test(n)))))return"";return n=function(t){return t=d(t=t.replace(p,"&quot;"))}(n)}var S=function(t){return"string"==typeof t?t.replace(/'/g,'"').replace('=""',"").replace(/\s+/g,"").toLowerCase():""},P=function(){function t(t){var e=function(t){var e={};for(var n in t)e[n]=t[n];return e}(t||{});e.stripIgnoreTag&&(e.onIgnoreTag,e.onIgnoreTag=function(){return""}),e.whiteList={},e.onTag=function(){},e.onTagAttr=function(){},e.onIgnoreTag=function(){},e.onIgnoreTagAttr=function(){},e.safeAttrValue=_,e.escapeHtml=d,this.options=Object.assign(e,t)}return t.prototype.process=function(t){if(!(t=(t=t||"").toString()))return"";var e,n,i,r,o,a,s=this.options,u=s.whiteList,c=s.onTag,l=s.onIgnoreTag,f=s.onTagAttr,h=s.onIgnoreTagAttr,p=s.safeAttrValue,d=s.escapeHtml;s.stripBlankChar&&(t=(e=(e=t.split("")).filter(function(t){var e=t.charCodeAt(0);return!(127===e||e<=31&&10!==e&&13!==e)})).join("")),s.allowCommentTag||(t=function(t){for(var e="",n=0;n<t.length;){var i=t.indexOf("\x3c!--",n);if(-1===i){e+=t.slice(n);break}e+=t.slice(n,i);var r=t.indexOf("--\x3e",i);if(-1===r)break;n=r+3}return e}(t));var v=!1;s.stripIgnoreTagBody&&(n=s.stripIgnoreTagBody,"function"!=typeof(i=l)&&(i=function(){}),r=!Array.isArray(n),o=[],a=!1,l=(v={onIgnoreTag:function(t,e,s){var u;if(u=t,r||-1!==y.indexOf(n,u)){if(s.isClosing){var c="[/removed]",l=s.position+c.length;return o.push([!1!==a?a:s.position,l]),a=!1,c}return a||(a=s.position),"[removed]"}return i(t,e,s)},remove:function(t){var e="",n=0;return y.forEach(o,function(i){e+=t.slice(n,i[0]),n=i[1]}),e+=t.slice(n)}}).onIgnoreTag);var g=w(t,function(t,e,n,i,r){var o={sourcePosition:t,position:e,isClosing:r,isWhite:Object.prototype.hasOwnProperty.call(u,n)},a=c(n,i,o);if(null!=a)return a;if(o.isWhite){if(o.isClosing)return"</".concat(n,">");var s=function(t){var e=y.spaceIndex(t);if(-1===e)return{html:"",closing:"/"===t[t.length-2]};var n="/"===(t=y.trim(t.slice(e+1,-1)))[t.length-1];return n&&(t=y.trim(t.slice(0,-1))),{html:t,closing:n}}(i),v=u[n],g=k(s.html,function(t,e){var i=-1!==y.indexOf(v,t),r=f(n,t,e,i);return null==r?i?(e=p(n,t,e,null))?"".concat(t,'="').concat(e,'"'):t:null==(r=h(n,t,e,i))?void 0:r:r});return i="<".concat(n),g&&(i+=" ".concat(g)),s.closing&&(i+=" /"),i+=">"}return null==(a=l(n,i,o))?d(i):a},d);return v&&(g=v.remove(g)),g},t}(),O=Function("\nvar _checkXSS = function (it) {\n  return it && it.Math == Math && it;\n};\nreturn _checkXSS(typeof globalThis === 'object' && globalThis) ||\n_checkXSS(typeof window === 'object' && window) ||\n_checkXSS(typeof self === 'object' && self) ||\n_checkXSS(typeof global === 'object' && global) ||\nFunction('return this')();\n")(),T=new(function(){function t(){var t=this;this.batchData=[],this.uniqKeys=new Set,this.timeout=2e3,this.lock=!1,this.getSlardarBid=function(){var e,n,i="douyin_web";if(!y.includes(i,"bid"))return i;if(t.config&&t.config.bid)return t.config.bid;if(O&&O._xssBid)return O._xssBid;if(O&&O.slardar&&"function"==typeof O.slardar.config){var r=(O.slardar.config()||{}).bid;if(r)return r}if(O&&O.Slardar&&"function"==typeof O.Slardar.config){var o=(O.Slardar.config()||{}).bid;if(o)return o}return(null===(n=null===(e=null==O?void 0:O.Slardar)||void 0===e?void 0:e._baseParams)||void 0===n?void 0:n.bid)||"argus"},this.getConfigRegion=function(){var e;return y.includes("cn","region")?t.config&&t.config.region?t.config.region:((null===(e=null==O?void 0:O.gfdatav1)||void 0===e?void 0:e.region)||"cn").toLowerCase():"cn"},this.gerReportUrl=function(){var e={cn:b("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boe:b("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),ttp:b("aHR0cHM6Ly9tb24udXMudGlrdG9rdi5jb20vbW9uaXRvcl9icm93c2VyL2NvbGxlY3QvYmF0Y2gvc2VjdXJpdHkvP2JpZD0="),va:b("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),maliva:b("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),sg:b("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boei18n:b("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9")}[t.getConfigRegion()];if(e)return e+t.getSlardarBid()}}return t.prototype.setConfig=function(t){this.config=t},t.prototype.upload=function(){var t=this,e=this.gerReportUrl();!this.lock&&e&&0!==this.batchData.length&&(this.lock=!0,setTimeout(function(){var n=t.batchData.slice(0,100);t.batchData=t.batchData.slice(100),O.fetch(e,{method:"post",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).catch(function(t){}),t.lock=!1,t.upload()},this.timeout))},t.prototype.generateKey=function(t){return t.collectKey?[t.collectMode,t.collectKey].join("___"):""},t.prototype.push=function(t){this.batchData.push(t),this.upload()},t.prototype.report=function(t){var e=this.generateKey(t);if(O.fetch&&t.collectKey){var n="object"==typeof window?window.location.href:"SSR";t.documentUrl=n;var i={age:Math.floor(Date.now()),type:"xss",url:n,body:t,"user-agent":""};"enforce"===t.disposition&&"SSR"!==n||(i.url=e),"SSR"===n&&(i.url="SSR___".concat(i.url),i.body.ssr=!0),this.push(i)}},t}()),E=function(t){for(var e=0,n=function(n){Array.isArray(t[n])?0===t[n].length?delete t[n]:(t[n]=y.from(y.uniq(t[n])),e+=t[n].length):0===y.keys(t[n]).length?delete t[n]:y.keys(t[n]).forEach(function(i){t[n][i]=y.from(y.uniq(t[n][i])),e+=t[n][i].length})},i=0,r=y.keys(t);i<r.length;i++)n(r[i]);return{count:e,ret:t}};function C(t,e){return T.setConfig(e),new P(e).process(t)}function x(t){var e,n=(e=/\s|\n|\t/.exec(t))?e.index:-1;if(-1===n)return{html:"",closing:"/"===t[t.length-2]};var i="/"===(t=t.slice(n+1,-1).trim())[t.length-1];return i&&(t=t.slice(0,-1).trim()),{html:t,closing:i}}var j=function(t){return -1===(t=(t=(t=(t=t.replace(/&colon;/gi,":")).replace(/&tab;/gi,"")).replace(/&newline;/gi,"")).replace(/(\t|\n|\r)/g,"")).indexOf("&#")?t.trim().toLowerCase():t.trim().replace(/&#(?:(x)([0-9a-f]+)|([0-9]+));?/gi,function(t,e,n,i){return String.fromCharCode(e?parseInt(n,16):parseInt(i))}).replace(/(\t|\n|\r)/g,"").toLowerCase()};function R(t,e){if(void 0===t&&(t=""),"string"!=typeof t)return!0;if(t=j(t),y.includes(t,"base64")&&!function(t){if(""===t||""===t.trim())return!0;try{return!y.includes(t,"data:text/html;base64")}catch(t){return!0}}(t))return e&&e("data:text/html;base64"),!1;var n=["expression(","behavior:","view-source:"];if(y.some(n,function(e){return -1!==t.indexOf(e)}))return y.forEach(n,function(n){-1!==t.indexOf(n)&&e&&e(n)}),!1;var i=["data:application","data:javascript","data:text/html","data:texthtml"];if(y.some(i,function(e){return -1!==t.indexOf(e)}))return y.forEach(i,function(n){-1!==t.indexOf(n)&&e&&e(n)}),!1;if(t.indexOf("javascript:")>0)return e&&e("javascript:"),!1;if(/^javascript:/i.test(t)){var r=t.slice(11).replace(/\s/g,"").trim();return!!y.some(["void","void(0)","void0","false","undefined",";"],function(t){return t===r})||(e&&e("javascript:"),!1)}return!0}var A=function(t,e){var n,i,r="<%= isSaveValidUrl =>";if("string"!=typeof t||(i=Number("<%= urlLimit =>"),void 0!==n&&(i=n),"NaN"!==t.toString()&&-1!==i&&t.length>=i)||R(t,e))return t;try{if(!0===(r=JSON.parse(r))||"true"===r){var o=new URL(t);return o.origin+o.pathname}}catch(t){}return"#"};function L(t,e,i){if(void 0===t&&(t=""),void 0===e&&(e=[]),"string"!=typeof t)return!0;if(!R(t=j(t)))return!1;var r,o={url:(r=t.match(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/)||[])[0],scheme:r[1],slash:r[2],host:r[3],port:r[4],path:r[5],query:r[6],hash:r[7]},a=o.scheme,s=o.host;return i?!!i(t):!(!a||!s)&&(!y.includes(["http","https","file"],a)||("object"==typeof window&&window&&(e=n(n([],e,!0),[location.host],!1)),y.some(e,function(t){return!!(t instanceof RegExp&&t.test(s))||t===s})))}var I={a:["target","title","spellcheck","rel"],canvas:[],abbr:["title"],address:[],area:["shape","coords","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:["dir"],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["alt","title","width","height","decoding"],ins:["datetime"],li:[],mark:[],nav:[],ol:["start"],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],delete:[],form:[],strong:[],mask:["maskunits","x","y","width","height","fill"],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],wbr:[],video:["autoplay","controls","loop","preload","height","width"],svg:["viewBox","version","xmlns","fill","width","height","stroke","stroke-width","style"],path:["d","fill","opacity","stroke","p-id","fill-rule","clip-rule","stroke-width","stroke-linecap","stroke-linejoin","fill-opacity","mask"],rect:["x","y","width","height","fill","stroke","rx"],g:[]},D={collect:null,initCollect:function(){this.collect={whiteList:{},filterProtocol:[]}},removeCollect:function(){var t=E(this.collect),e=t.count,n=t.ret;return this.collect=null,{collectKey:0===e?null:JSON.stringify(n),collectMode:"white"}},onIgnoreTagAttr:function(t,e,i){return t&&y.indexOf(["href","src"],e)>-1?D.domainWhiteList&&Array.isArray(D.domainWhiteList)&&D.domainWhiteList.length>0&&!L(i,n([],D.domainWhiteList,!0))?"":"".concat(e,'="').concat(A(i,function(t){var e;null===(e=D.collect)||void 0===e||e.filterProtocol.push(t)}),'"'):t&&(y.indexOf(["style","class","id"],e)>-1||e.indexOf("data-")>-1)?"".concat(e,'="').concat(i,'"'):(D.collect.whiteList[t]=D.collect.whiteList[t]||[],void D.collect.whiteList[t].push(e))},onIgnoreTag:function(t,e){if("style"===t)return e;w(e,function(t,e,n,i){k(x(i).html.replace("/",""),function(t){D.collect.whiteList[n]=D.collect.whiteList[n]||[],D.collect.whiteList[n].push(t)})},d)},whiteList:I,mergeWhiteList:function(t){for(var e,n={},i=0,r=y.keys(I);i<r.length;i++)n[e=r[i]]=y.from(I[e]);for(var o=0,a=y.keys(t);o<a.length;o++)n[e=a[o]]=e in I?I[e].concat(t[e]):y.from(t[e]);return n},setWhiteList:function(t){for(var e=0,n=y.keys(t);e<n.length;e++){var i=n[e];this.whiteList[i]=i in I?I[i].concat(t[i]):y.from(t[i])}}};try{var N={},M="merge";y.includes(M,"override")&&(D.whiteList=N.whiteList),y.includes(M,"merge")&&D.setWhiteList(N.whiteList)}catch(t){}var B=function(t,e){for(var n={},i=0,r=y.keys(t);i<r.length;i++){var o=r[i];Array.isArray(t[o])?n[o]=y.from(t[o]):n[o]=B({},t[o])}for(var a=0,s=y.keys(e);a<s.length;a++)(o=s[a])in t?Array.isArray(t[o])?n[o]=t[o].concat(e[o]):n[o]=B(t[o],e[o]):Array.isArray(e[o])?n[o]=y.from(e[o]):n[o]=B({},e[o]);return n},F={blackList:{a:["folder"],meta:["content"],iframe:["srcdoc"],input:["pattern"],vmlframe:["xmlns"]},blackTags:["script","xml","embed","isindex","object","base","set","handler","animate","payload","import"],blackAttrs:["charset","ns","namespace","formaction","xlink:href","xmlns:xlink","handler","repeat","repeat-start","repeat-end"],blackAttrRegExps:[/^on/],filterList:{param:["value"],video:["poster"],form:["action"]},filterAttrs:["href","src","background","style","dynsrc","lowsrc","content"]};try{var H={};H.blackAttrRegExps&&(H.blackAttrRegExps=H.blackAttrRegExps.map(function(t){return new RegExp(t.toString().slice(1,t.toString().length-1))}));var U="merge";y.includes(U,"override")&&(F=H),y.includes(U,"merge")&&(F=B(F,H))}catch(t){}var W={mode:"black",whiteList:{},blackConfig:F,collect:null,initCollect:function(){W.collect={blackList:{},blackTags:[],blackAttrs:[],blackAttrRegExps:[],filterAttrs:[],filterList:{},filterProtocol:[]}},removeCollect:function(){var t=E(W.collect),e=t.count,n=t.ret;return W.collect=null,{collectKey:0===e?null:JSON.stringify(n),collectMode:"black"}},onIgnoreTag:function(t,e){var n;if(!y.includes(F.blackTags,t))return w(e,function(t,e,n,i,r){if(-1!==n.indexOf("/"))return d(i);if(r)return"</".concat(n,">");var o=x(i),a=k(o.html,function(t,e){var i,r=0;if(F.blackList[n]&&y.includes(F.blackList[n],t)&&(W.collect.blackList[n]=W.collect.blackList[n]||[],W.collect.blackList[n].push(t),r++),F.blackAttrRegExps.length&&F.blackAttrRegExps.some(function(e){return e.test(t)})&&y.forEach(F.blackAttrRegExps,function(e){e.test(t)&&(W.collect.blackAttrRegExps.push("".concat(e.toString(),"->").concat(t)),r++)}),F.blackAttrs.length&&y.includes(F.blackAttrs,t)&&(F.blackAttrs.push(t),r++),!r){if(F.filterList&&F.filterList[n]&&y.includes(F.filterList[n],t)){var o=A(e,function(t){var e;null===(e=W.collect)||void 0===e||e.filterProtocol.push(t)});return o!==e&&(W.collect.filterList[n]=W.collect.filterList[n]||[],W.collect.filterList[n].push(t)),e?"".concat(t,"='").concat(o,"'"):t}return F.filterAttrs&&y.includes(F.filterAttrs,t)?((o=A(e,function(t){var e;null===(e=W.collect)||void 0===e||e.filterProtocol.push(t)}))!==e&&(null===(i=W.collect)||void 0===i||i.filterAttrs.push(t)),e?"".concat(t,"='").concat(o,"'"):t):e?"".concat(t,"='").concat(e,"'"):t}});return i="<".concat(n),a&&(i+=" ".concat(a)),o.closing&&(i+=" /"),i+=">"},d);null===(n=W.collect)||void 0===n||n.blackTags.push(t)}},V=function(t){var e=t.reportOnly,n=void 0===e||e,i=t.block;return n&&"all"===n?"report":("string"==typeof n&&("true"===n&&(n=!0),"false"===n&&(n=!1)),i?"enforce":n?"report":"enforce")},G=function(t){return function(n,i,r){if(!n||"string"!=typeof n)return n;var o=i;t===C&&(o=D).initCollect();var a=t(n,o);if(S(a)===S(n))return n;if(!r)return a;var s=r.logType,u=V(r),c=o.removeCollect();return T.report(e(e({type:s,disposition:u},c),{sourceText:m(n),filterText:m(a)})),"enforce"===u?a:n}},z=G(function(t,e){return void 0===e&&(e={}),e&&e.whiteList||(e.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}),new P(e).process(t)}),K=G(C),Y=function(t,e,n){var i=[],r=A(t,function(t){i.push(t)});if(r===t)return t;i=y.from(y.uniq(i));var o=e||n||{};if(!o)return r;var a=o.logType,s=V(n);return T.report({type:a,disposition:s,collectKey:i.join("___"),collectData:JSON.stringify(i),collectMode:"black",sourceText:m(t),filterText:m(r)}),"enforce"===s?r:t},X=O._xssProject||{},q=O.xssNamespace||{},J="3.0.26",Z={FilterXSS:P,version:J,webpackPluginVersion:"<%= webpackPluginVersion =>",reportOnly:"<%= reportOnly =>",filterXSS:z,_filterXSS:K,filterUrl:Y,Config:D,BlackConfig:W,project:X,setProjectName:function(t){X[t]=this,O._xssProjectName=t}};q.douyin_web=Z,O.xssNamespace=q,O.Math&&!O.Math.xssNamespace&&(O.Math.xssNamespace=q),X[J]=Z,O.globalThis=O,O.getFilterXss=function(){return void 0!==this._xssProjectName?this._xssProject[this._xssProjectName]:Z},O.xss=Z,O.isSafeUrl=L,O.isSafeDomain=L,O.isSafeProtocol=R,O._xssProject=X,O._xssProjectName&&(X[O._xssProjectName]=Z);var $=Z.setProjectName.bind(Z);t.BlackConfig=W,t.Config=D,t.FilterXSS=P,t._filterXSS=K,t.filterUrl=Y,t.filterXSS=z,t.isSafeDomain=L,t.isSafeProtocol=R,t.isSafeUrl=L,t.project=X,t.setProjectName=$,t.setXssNamespace=function(t){var e=t.appId,n=t.bid,i=t.region;q[e]=Z;D.bid=n,D.region=i,D.enabled=!0},t.xssNamespace=q,Object.defineProperty(t,"__esModule",{value:!0})}),!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.pace=e():t.pace=e()}(self,function(){return function(){var t={66839:function(t){if("undefined"!=typeof Element&&!Element.prototype.matches){var e=Element.prototype;e.matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}t.exports=function(t,e){for(;t&&9!==t.nodeType;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}},97720:function(t,e,n){var i=n(66839);function r(t,e,n,i,r){var a=o.apply(this,arguments);return t.addEventListener(n,a,r),{destroy:function(){t.removeEventListener(n,a,r)}}}function o(t,e,n,r){return function(n){n.delegateTarget=i(n.target,e),n.delegateTarget&&r.call(t,n)}}t.exports=function(t,e,n,i,o){return"function"==typeof t.addEventListener?r.apply(null,arguments):"function"==typeof n?r.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,function(t){return r(t,e,n,i,o)}))}},3812:function(t){var e,n;e=0,n=function(){return function t(e,n,i){var r,o,a=window,s="application/octet-stream",u=i||s,c=e,l=!n&&!i&&c,f=document.createElement("a"),h=function(t){return String(t)},p=a.Blob||a.MozBlob||a.WebKitBlob||h,d=n||"download";if(p=p.call?p.bind(a):Blob,"true"===String(this)&&(u=(c=[c,u])[0],c=c[1]),l&&l.length<2048&&(d=l.split("/").pop().split("?")[0],f.href=l,-1!==f.href.indexOf(l))){var y=new XMLHttpRequest;return y.open("GET",l,!0),y.responseType="blob",y.onload=function(e){t(e.target.response,d,s)},setTimeout(function(){y.send()},0),y}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(c)){if(!(c.length>2096103.424)||p===h)return navigator.msSaveBlob?navigator.msSaveBlob(b(c),d):w(c);u=(c=b(c)).type||s}else if(/([\x80-\xff])/.test(c)){for(var v=0,g=new Uint8Array(c.length),m=g.length;v<m;++v)g[v]=c.charCodeAt(v);c=new p([g],{type:u})}function b(t){for(var e=t.split(/[:;,]/),n=e[1],i=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),r=i.length,o=0,a=new Uint8Array(r);o<r;++o)a[o]=i.charCodeAt(o);return new p([a],{type:n})}function w(t,e){if("download"in f)return f.href=t,f.setAttribute("download",d),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout(function(){f.click(),document.body.removeChild(f),!0===e&&setTimeout(function(){a.URL.revokeObjectURL(f.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,s)),!window.open(t)&&confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var n=document.createElement("iframe");document.body.appendChild(n),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,s)),n.src=t,setTimeout(function(){document.body.removeChild(n)},333)}if(r=c instanceof p?c:new p([c],{type:u}),navigator.msSaveBlob)return navigator.msSaveBlob(r,d);if(a.URL)w(a.URL.createObjectURL(r),!0);else{if("string"==typeof r||r.constructor===h)try{return w("data:"+u+";base64,"+a.btoa(r))}catch(t){return w("data:"+u+","+encodeURIComponent(r))}(o=new FileReader).onload=function(t){w(this.result)},o.readAsDataURL(r)}return!0}},"function"==typeof define&&define.amd?define([],n):t.exports=n()},3493:function(t){"use strict";var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,i,o,a){if("function"!=typeof i)throw TypeError("The listener must be a function");var s=new r(i,o||t,a),u=n?n+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),!new i().__proto__&&(n=!1)),s.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},s.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,o=i.length,a=Array(o);r<o;r++)a[r]=i[r].fn;return a},s.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},s.prototype.emit=function(t,e,i,r,o,a){var s=n?n+t:t;if(!this._events[s])return!1;var u,c,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,i),!0;case 4:return l.fn.call(l.context,e,i,r),!0;case 5:return l.fn.call(l.context,e,i,r,o),!0;case 6:return l.fn.call(l.context,e,i,r,o,a),!0}for(c=1,u=Array(f-1);c<f;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var h,p=l.length;for(c=0;c<p;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,i);break;case 4:l[c].fn.call(l[c].context,e,i,r);break;default:if(!u)for(h=1,u=Array(f-1);h<f;h++)u[h-1]=arguments[h];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,i,r){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn===e&&(!r||s.once)&&(!i||s.context===i)&&a(this,o);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==e||r&&!s[u].once||i&&s[u].context!==i)&&c.push(s[u]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&a(this,e)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s;t.exports=s}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,n),o.exports}return n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.rv=function(){return"1.0.0-canary-8758c59-20240816041638"},n.ruid="bundler=rspack@1.0.0-canary-8758c59-20240816041638",!function(){"use strict";var t,e,i,r,o,a,s={};n.r(s),n.d(s,{ABORT:function(){return X},AFTER_DEFINITION_CHANGE:function(){return ty},AUTOPLAY_PREVENTED:function(){return te},AUTOPLAY_STARTED:function(){return tt},BEFORE_DEFINITION_CHANGE:function(){return td},BUFFER_CHANGE:function(){return q},BUFFER_CONTROLS:function(){return ts},CANPLAY:function(){return N},CANPLAY_THROUGH:function(){return M},COMPLETE:function(){return tn},CSS_FULLSCREEN_CHANGE:function(){return tf},DEFINITION_CHANGE:function(){return tp},DEGRADE:function(){return tL},DESTROY:function(){return tr},DOWNLOAD_SPEED_CHANGE:function(){return ta},DURATION_CHANGE:function(){return B},EMPTIED:function(){return z},ENDED:function(){return x},ERROR:function(){return R},FPS_STUCK:function(){return tA},FULLSCREEN_CHANGE:function(){return tl},FULLSCREEN_REQUEST:function(){return tc},LOADED_DATA:function(){return H},LOADED_METADATA:function(){return U},LOAD_START:function(){return G},MINI_STATE_CHANGE:function(){return th},PAUSE:function(){return j},PIP_CHANGE:function(){return tb},PLAY:function(){return E},PLAYER_BLUR:function(){return Z},PLAYER_FOCUS:function(){return J},PLAYING:function(){return C},PLAYNEXT:function(){return t_},PLAY_ABORTED:function(){return tu},PROGRESS:function(){return V},RATE_CHANGE:function(){return W},READY:function(){return $},REPLAY:function(){return ti},RESET:function(){return tT},RETRY:function(){return tg},ROTATE:function(){return tw},SCREEN_SHOT:function(){return tk},SEEKED:function(){return L},SEEKING:function(){return A},SEI_PARSED:function(){return tv},SHORTCUT:function(){return tS},SOURCE_ERROR:function(){return tE},SOURCE_SUCCESS:function(){return tC},STALLED:function(){return K},STATS_EVENTS:function(){return tR},SUSPEND:function(){return Y},SWITCH_SUBTITLE:function(){return tx},TIME_UPDATE:function(){return I},URL_CHANGE:function(){return to},URL_NULL:function(){return Q},USER_ACTION:function(){return tO},VIDEO_EVENTS:function(){return tj},VIDEO_RESIZE:function(){return tm},VOLUME_CHANGE:function(){return F},WAITING:function(){return D},XGLOG:function(){return tP}});var u={};n.r(u),n.d(u,{BUFFER_CONTROL_TYPES:function(){return er},BasePlugin:function(){return e_},Errors:function(){return T},Events:function(){return s},I18N:function(){return e8},InstManager:function(){return na},PAUSE_TYPES:function(){return ei},Plugin:function(){return eD},STATE_CLASS:function(){return eW},SimplePlayer:function(){return n_},Sniffer:function(){return tZ},TestSpeed:function(){return sT},Util:function(){return k},default:function(){return sV}});var c=n("3493"),l=n.n(c),f=JSON.parse('"3.0.0-alpha.171"'),h="undefined"!=typeof window&&window.location&&window.location.href.indexOf("xgplayerdebugger=1")>-1,p={info:"color: #525252; background-color: #90ee90;",error:"color: #525252; background-color: red;",warn:"color: #525252; background-color: yellow; "},d="%c[xgplayer]",y={config:{debug:h?3:1},logInfo:function(t){for(var e,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.config.debug>=3&&(e=console).log.apply(e,[d,p.info,t].concat(i))},logWarn:function(t){for(var e,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.config.debug>=1&&(e=console).warn.apply(e,[d,p.warn,t].concat(i))},logError:function(t){if(!(this.config.debug<1)){for(var e,n=this.config.debug>=2?"trace":"error",i=arguments.length,r=Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];(e=console)[n].apply(e,[d,p.error,t].concat(r))}}};function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==v(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==v(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===v(e)?e:String(e)}(i.key),i)}}var m=function(){var t,e,n;function i(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),this.bufferedList=t}return t=i,e=[{key:"start",value:function(t){return this.bufferedList[t].start}},{key:"end",value:function(t){return this.bufferedList[t].end}},{key:"length",get:function(){return this.bufferedList.length}}],g(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var k={};k.createDom=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=document.createElement(t);return r.className=i,r.innerHTML=e,Object.keys(n).forEach(function(e){var i=n[e];"video"===t||"audio"===t||"live-video"===t?i&&r.setAttribute(e,i):r.setAttribute(e,i)}),r},k.createDomFromHtml=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{var i=document.createElement("div");i.innerHTML=t;var r=i.children;if(i=null,r.length>0)return r=r[0],n&&k.addClass(r,n),e&&Object.keys(e).forEach(function(t){r.setAttribute(t,e[t])}),r;return null}catch(t){return y.logError("util.createDomFromHtml",t),null}},k.hasClass=function(t,e){if(!t||!e)return!1;try{return Array.prototype.some.call(t.classList,function(t){return t===e})}catch(i){var n=t.className&&"object"===w(t.className)?t.getAttribute("class"):t.className;return n&&!!n.match(RegExp("(\\s|^)"+e+"(\\s|$)"))}},k.addClass=function(t,e){if(!!t&&!!e)try{e.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(e){e&&t.classList.add(e)})}catch(n){!k.hasClass(t,e)&&(t.className&&"object"===w(t.className)?t.setAttribute("class",t.getAttribute("class")+" "+e):t.className+=" "+e)}},k.removeClass=function(t,e){if(!!t&&!!e)try{e.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(e){e&&t.classList.remove(e)})}catch(n){k.hasClass(t,e)&&e.split(/\s+/g).forEach(function(e){var n=RegExp("(\\s|^)"+e+"(\\s|$)");t.className&&"object"===w(t.className)?t.setAttribute("class",t.getAttribute("class").replace(n," ")):t.className=t.className.replace(n," ")})}},k.toggleClass=function(t,e){if(!!t)e.split(/\s+/g).forEach(function(e){k.hasClass(t,e)?k.removeClass(t,e):k.addClass(t,e)})},k.classNames=function(){for(var t=arguments,e=[],n=function(n){"String"===k.typeOf(t[n])?e.push(t[n]):"Object"===k.typeOf(t[n])&&Object.keys(t[n]).map(function(i){t[n][i]&&e.push(i)})},i=0;i<arguments.length;i++)n(i);return e.join(" ")},k.findDom=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,n=arguments.length>1?arguments[1]:void 0;try{t=e.querySelector(n)}catch(i){y.logError("util.findDom",i),0===n.indexOf("#")&&(t=e.getElementById(n.slice(1)))}return t},k.getCss=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,!1)[e]},k.padStart=function(t,e,n){for(var i=String(n),r=e>>0,o=Math.ceil(r/i.length),a=[],s=String(t);o--;)a.push(i);return a.join("").substring(0,r-s.length)+s},k.format=function(t){if(window.isNaN(t))return"";t=Math.round(t);var e=k.padStart(Math.floor(t/3600),2,0),n=k.padStart(Math.floor((t-3600*e)/60),2,0),i=k.padStart(Math.floor(t-3600*e-60*n),2,0);return("00"===e?[n,i]:[e,n,i]).join(":")},k.event=function(t){if(t.touches){var e=t.touches[0]||t.changedTouches[0];t.clientX=e.clientX||0,t.clientY=e.clientY||0,t.offsetX=e.pageX-e.target.offsetLeft,t.offsetY=e.pageY-e.target.offsetTop}t._target=t.target||t.srcElement},k.typeOf=function(t){return Object.prototype.toString.call(t).match(/([^\s.*]+)(?=]$)/g)[0]},k.deepCopy=function(t,e){if("Object"===k.typeOf(e)&&"Object"===k.typeOf(t))return Object.keys(e).forEach(function(n){"Object"!==k.typeOf(e[n])||e[n]instanceof Node?"Array"===k.typeOf(e[n])?t[n]="Array"===k.typeOf(t[n])?t[n].concat(e[n]):e[n]:t[n]=e[n]:void 0===t[n]||void 0===t[n]?t[n]=e[n]:k.deepCopy(t[n],e[n])}),t},k.deepMerge=function(t,e){return Object.keys(e).map(function(n){if("Array"===k.typeOf(e[n])&&"Array"===k.typeOf(t[n])){if("Array"===k.typeOf(t[n])){var i,r;(i=t[n]).push.apply(i,function(t){if(Array.isArray(t))return b(t)}(r=e[n])||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return b(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(t,e)}}(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}}else k.typeOf(t[n])!==k.typeOf(e[n])||null===t[n]||"Object"!==k.typeOf(t[n])||e[n]instanceof window.Node?null!==e[n]&&(t[n]=e[n]):k.deepMerge(t[n],e[n])}),t},k.getBgImage=function(t){var e=(t.currentStyle||window.getComputedStyle(t,null)).backgroundImage;if(!e||"none"===e)return"";var n=document.createElement("a");return n.href=e.replace(/url\("|"\)/g,""),n.href},k.copyDom=function(t){if(!t||1!==t.nodeType)return"";var e=document.createElement(t.tagName);return Array.prototype.forEach.call(t.attributes,function(t){e.setAttribute(t.name,t.value)}),t.innerHTML&&(e.innerHTML=t.innerHTML),e},k.setInterval=function(t,e,n,i){!t._interval[e]&&(t._interval[e]=window.setInterval(n.bind(t),i))},k.clearInterval=function(t,e){clearInterval(t._interval[e]),t._interval[e]=null},k.setTimeout=function(t,e,n){!t._timers&&(t._timers=[]);var i=setTimeout(function(){e(),k.clearTimeout(t,i)},n);return t._timers.push(i),i},k.clearTimeout=function(t,e){var n=t._timers;if("Array"===k.typeOf(n)){for(var i=0;i<n.length;i++)if(n[i]===e){n.splice(i,1),clearTimeout(e);break}}else clearTimeout(e)},k.clearAllTimers=function(t){var e=t._timers;"Array"===k.typeOf(e)&&(e.map(function(t){clearTimeout(t)}),t._timerIds=[])},k.createImgBtn=function(t,e,n,i){var r,o,a,s=k.createDom("xg-".concat(t),"",{},"xgplayer-".concat(t,"-img"));return s.style.backgroundImage='url("'.concat(e,'")'),n&&i&&(["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(t){return!(n.indexOf(t)>-1&&i.indexOf(t)>-1)||(r=parseFloat(n.slice(0,n.indexOf(t)).trim()),o=parseFloat(i.slice(0,i.indexOf(t)).trim()),a=t,!1)}),s.style.width="".concat(r).concat(a),s.style.height="".concat(o).concat(a),s.style.backgroundSize="".concat(r).concat(a," ").concat(o).concat(a),"start"===t?s.style.margin="-".concat(o/2).concat(a," auto auto -").concat(r/2).concat(a):s.style.margin="auto 5px auto 5px"),s},k.Hex2RGBA=function(t,e){var n=[];if(/^\#[0-9A-F]{3}$/i.test(t)){var i="#";t.replace(/[0-9A-F]/ig,function(t){i+=t+t}),t=i}return/^#[0-9A-F]{6}$/i.test(t)?(t.replace(/[0-9A-F]{2}/ig,function(t){n.push(parseInt(t,16))}),"rgba(".concat(n.join(","),", ").concat(e,")")):"rgba(255, 255, 255, 0.1)"},k.getFullScreenEl=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},k.checkIsFunction=function(t){return t&&"function"==typeof t},k.checkIsObject=function(t){return null!==t&&"object"===w(t)},k.hide=function(t){t.style.display="none"},k.show=function(t,e){t.style.display=e||"block"},k.isUndefined=function(t){if(null==t)return!0},k.setStyleFromCsstext=function(t,e){if(!!e)"String"===k.typeOf(e)?e.replace(/\s+/g,"").split(";").map(function(e){if(e){var n=e.split(":");n.length>1&&(t.style[n[0]]=n[1])}}):Object.keys(e).map(function(n){t.style[n]=e[n]})};function _(t){var e=w(t);return null!==t&&("object"===e||"function"===e)}k.filterStyleFromText=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["width","height","top","left","bottom","right","position","z-index","padding","margin","transform"],n=t.style.cssText;if(!n)return{};var i=n.replace(/\s+/g,"").split(";"),r={},o={};return i.map(function(t){if(t){var n=t.split(":");n.length>1&&(function(t,e){for(var n=0,i=e.length;n<i;n++)if(t.indexOf(e[n])>-1)return!0;return!1}(n[0],e)?r[n[0]]=n[1]:o[n[0]]=n[1])}}),t.setAttribute("style",""),Object.keys(o).map(function(e){t.style[e]=o[e]}),r},k.getStyleFromCsstext=function(t){var e=t.style.cssText;if(!e)return{};var n=e.replace(/\s+/g,"").split(";"),i={};return n.map(function(t){if(t){var e=t.split(":");e.length>1&&(i[e[0]]=e[1])}}),i},k.preloadImg=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(!!t){var i=new window.Image;i.onload=function(t){i=null,e&&e(t)},i.onerror=function(t){i=null,n&&n(t)},i.src=t}},k.stopPropagation=function(t){t&&(t.stopPropagation(),t.cancelable&&t.preventDefault())},k.scrollTop=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},k.scrollLeft=function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0},k.checkTouchSupport=function(){return"ontouchstart"in window},k.getBuffered2=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=[],i=0;i<t.length;i++)n.push({start:.5>t.start(i)?0:t.start(i),end:t.end(i)});n.sort(function(t,e){var n=t.start-e.start;return n?n:e.end-t.end});var r=[];if(e)for(var o=0;o<n.length;o++){var a=r.length;if(a){var s=r[a-1].end;n[o].start-s<e?n[o].end>s&&(r[a-1].end=n[o].end):r.push(n[o])}else r.push(n[o])}else r=n;return new m(r)},k.getBufferByCurrentTime=function(t,e){var n={start:0,end:0,include:0,diff:0,cur:e};if(!t||t.length<1)return n;for(var i=-1,r=-1,o=parseInt(1e3*e,10),a=t.length-1;a>-1;a--){var s=parseInt(1e3*t.start(a),10),u=parseInt(1e3*t.end(a),10);if(o>=s&&o<=u){n.include=1,n.start=s/1e3,n.end=u/1e3,n.diff=(u-o)/1e3;break}o<s&&(i<0||s-o<i)?(i=(s-o)/1e3,r=a):o>u&&(i<0||o-u<i)&&(i=(o-u)/1e3,r=a)}return 1!==n.include&&(r<0&&(r=t.length-1),n.start=parseInt(1e3*t.start(r),10)/1e3,n.end=parseInt(1e3*t.end(r),10)/1e3,n.diff=(parseInt(1e3*n.end,10)-o)/1e3),n},k.getEventPos=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.touches&&t.touches.length>0&&(t=t.touches[0]),{x:t.x/e,y:t.y/e,clientX:t.clientX/e,clientY:t.clientY/e,offsetX:t.offsetX/e,offsetY:t.offsetY/e,pageX:t.pageX/e,pageY:t.pageY/e}},k.requestAnimationFrame=function(t){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(e)return e(t)},k.getHostFromUrl=function(t){if("String"!==k.typeOf(t))return"";var e=t.split("/"),n="";return e.length>3&&e[2]&&(n=e[2]),n},k.cancelAnimationFrame=function(t){var e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.cancelRequestAnimationFrame;e&&e(t)},k.isMSE=function(t){return t.media&&(t=t.media),!!(t&&t instanceof HTMLMediaElement)&&(/^blob/.test(t.currentSrc)||/^blob/.test(t.src))},k.isBlob=function(t){return"string"==typeof t&&/^blob/.test(t)},k.generateSessionId=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=new Date().getTime();try{t=parseInt(t)}catch(e){t=0}return e+=t,window.performance&&"function"==typeof window.performance.now&&(e+=parseInt(window.performance.now())),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})},k.adjustTimeByDuration=function(t,e,n){return e&&t?t>e||n&&t<e?e:t:t},k.getTransformStyle=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,scale:1,rotate:0},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={scale:"".concat(t.scale||1),translate:"".concat(t.x||0,"%, ").concat(t.y||0,"%"),rotate:"".concat(t.rotate||0,"deg")};return Object.keys(n).forEach(function(t){var i=RegExp("".concat(t,"\\([^\\(]+\\)"),"g"),r="".concat(t,"(").concat(n[t],")");i.test(e)?(i.lastIndex=-1,e=e.replace(i,r)):e+="".concat(r," ")}),e},k.convertDeg=function(t){return 1>=Math.abs(t)?360*t:t%360};function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==S(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==S(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===S(e)?e:String(e)}(i.key),i)}}var O={1:"network",2:"network",3:"decoder",4:"format"};var T=(t=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{errorType:"",errorCode:0,errorMessage:"",originError:"",ext:{},mediaError:null,src:null};!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,t);var i=e&&e.i18n?e.i18n.ERROR_TYPES:null;if(null!=e&&e.video){var r=n.mediaError?n.mediaError:e.video.error||{},o=e.duration,a=e.currentTime,s=e.ended,u=e.src,c=e.currentSrc,l=e.video,h=l.readyState,p=l.networkState,d={playerVersion:f,domain:document.domain,currentTime:a,duration:o,ended:s,readyState:h,networkState:p,src:n.src||u||c,errorType:n.errorType,errorCode:n.errorCode||r.code,message:n.errorMessage||r.message,mediaError:r,originError:n.originError?n.originError.stack:"",host:k.getHostFromUrl(u||c)};return n.ext&&Object.keys(n.ext).map(function(t){d[t]=n.ext[t]}),d}if(arguments.length>1){for(var y={playerVersion:f,domain:document.domain},v=["errorType","currentTime","duration","networkState","readyState","src","currentSrc","ended","errd","errorCode","mediaError"],g=0;g<arguments.length;g++)y[v[g]]=arguments[g];return y.ex=i?(i[arguments[0]]||{}).msg:"",y}},Object.defineProperty(t,"prototype",{writable:!1}),t),E="play",C="playing",x="ended",j="pause",R="error",A="seeking",L="seeked",I="timeupdate",D="waiting",N="canplay",M="canplaythrough",B="durationchange",F="volumechange",H="loadeddata",U="loadedmetadata",W="ratechange",V="progress",G="loadstart",z="emptied",K="stalled",Y="suspend",X="abort",q="bufferedChange",J="focus",Z="blur",$="ready",Q="urlNull",tt="autoplay_started",te="autoplay_was_prevented",tn="complete",ti="replay",tr="destroy",to="urlchange",ta="download_speed_change",ts="buffer_control",tu="AbortError",tc="fullscreen_request",tl="fullscreen_change",tf="cssFullscreen_change",th="mini_state_change",tp="definition_change",td="before_definition_change",ty="after_definition_change",tv="SEI_PARSED",tg="retry",tm="video_resize",tb="pip_change",tw="rotate",tk="screenShot",t_="playnext",tS="shortcut",tP="xglog",tO="user_action",tT="reset",tE="source_error",tC="source_success",tx="switch_subtitle",tj=["play","playing","ended","pause","error","seeking","seeked","timeupdate","waiting","canplay","canplaythrough","durationchange","volumechange","loadeddata","loadedmetadata","ratechange","progress","loadstart","emptied","stalled","suspend","abort","lowdecode","mseAttaching","mseAttached","mseDetaching","mseDetached"],tR={STATS_INFO:"stats_info",STATS_DOWNLOAD:"stats_download",STATS_RESET:"stats_reset"},tA="fps_stuck",tL="degrade",tI={android:/(Android)\s([\d.]+)/,ios:/(Version)\/([\d.]+)/},tD=["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"],tN={get device(){return tN.os.isPc?"pc":"mobile"},get browser(){if("undefined"==typeof navigator)return"";var tM=navigator.userAgent.toLowerCase(),tB={ie:/rv:([\d.]+)\) like gecko/,firefox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(tB).filter(function(t){return tB[t].test(tM)}))[0]},get os(){if("undefined"==typeof navigator)return{};var tF=navigator.userAgent,tH=/(?:Windows Phone)/.test(tF),tU=/(?:SymbianOS)/.test(tF)||tH,tW=/(?:Android)/.test(tF),tV=/(?:Firefox)/.test(tF),tG=/(?:iPad|PlayBook)/.test(tF)||tW&&!/(?:Mobile)/.test(tF)||tV&&/(?:Tablet)/.test(tF),tz=/(?:iPhone)/.test(tF)&&!tG,tK=/(?:iPad|PlayBook)/.test(tF);return{isTablet:tG,isPhone:tz,isIpad:tK,isIos:tz||tK,isAndroid:tW,isPc:!tz&&!tW&&!tU&&!tG,isSymbian:tU,isWindowsPhone:tH,isFireFox:tV}},get osVersion(){if("undefined"==typeof navigator)return 0;var tY=navigator.userAgent,tX="",tq=(tX=/(?:iPhone)|(?:iPad|PlayBook)/.test(tY)?tI.ios:tI.android)?tX.exec(tY):[];if(tq&&tq.length>=3){var tJ=tq[2].split(".");return tJ.length>0?parseInt(tJ[0]):0}return 0},get isWeixin(){if("undefined"==typeof navigator)return!1;if(/(micromessenger)\/([\d.]+)/.exec(navigator.userAgent.toLocaleLowerCase()))return!0;return!1},isSupportMP4:function(){var t={isSupport:!1,mime:""};if("undefined"==typeof document)return t;if(this.supportResult)return this.supportResult;var e=document.createElement("video");return"function"==typeof e.canPlayType&&tD.map(function(n){"probably"===e.canPlayType('video/mp4; codecs="'.concat(n,'"'))&&(t.isSupport=!0,t.mime+="||".concat(n))}),this.supportResult=t,e=null,t},isHevcSupported:function(){return"undefined"!=typeof MediaSource&&!!MediaSource.isTypeSupported&&(MediaSource.isTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.3.E.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.4.10.L120.90"'))},probeConfigSupported:function(t){var e={supported:!1,smooth:!1,powerEfficient:!1};if(!t||"undefined"==typeof navigator)return Promise.resolve(e);if(navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo)return navigator.mediaCapabilities.decodingInfo(t);var n=t.video||{},i=t.audio||{};try{var r=MediaSource.isTypeSupported(n.contentType),o=MediaSource.isTypeSupported(i.contentType);return Promise.resolve({supported:r&&o,smooth:!1,powerEfficient:!1})}catch(t){return Promise.resolve(e)}},isHdrSupported:function(){if("function"==typeof matchMedia){var t=matchMedia("(dynamic-range: high)"),e=matchMedia("not supported query");return t.media!==e.media&&!0===t.matches}return!1}},tZ=tN;function t$(t){return(t$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tQ(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,t0(i.key),i)}}function t0(t){var e=function(t,e){if("object"!==t$(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==t$(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===t$(e)?e:String(e)}function t1(){return(t1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=t3(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function t2(t,e){return(t2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function t3(t){return(t3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function t4(t,e){if(!!this&&!!this.emit)"error"===t?this.errorHandler(t,e.error):this.emit(t,e)}var t6=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&t2(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=t3(e);return t=n?Reflect.construct(i,arguments,t3(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===t$(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),(e=a.call(this,t))._hasStart=!1,e._currentTime=0,e._duration=0,e._internalOp={},e._lastMuted=!1,e.vtype=t.vtype||"MP4",e.bizType="number"==typeof t.bizType&&t.bizType>=0?t.bizType:0,e._rate=-1,e.videoConfig=Object.assign({},{controls:!1,autoplay:t.autoplay,playsinline:t.playsinline,"x5-playsinline":t.playsinline,"webkit-playsinline":t.playsinline,"x5-video-player-fullscreen":t["x5-video-player-fullscreen"]||t.x5VideoPlayerFullscreen,"x5-video-orientation":t["x5-video-orientation"]||t.x5VideoOrientation,airplay:t.airplay,"webkit-airplay":t.airplay,tabindex:0|t.tabindex,mediaType:t.mediaType||"video","data-index":-1},t.videoConfig,t.videoAttributes);var e,n=t["x5-video-player-type"]||t.x5VideoPlayerType;return tZ.isWeixin&&tZ.os.isAndroid&&n&&(e.videoConfig["x5-video-player-type"]=n,delete e.videoConfig.playsinline,delete e.videoConfig["webkit-playsinline"],delete e.videoConfig["x5-playsinline"]),t.loop&&(e.videoConfig.loop="loop"),e.video=k.createDom(e.videoConfig.mediaType,"",e.videoConfig,""),t.defaultPlaybackRate&&(e.video.defaultPlaybackRate=e.video.playbackRate=t.defaultPlaybackRate),"Number"===k.typeOf(t.volume)&&(e.volume=t.volume),t.autoplayMuted&&(e.video.muted=!0,e._lastMuted=!0),t.autoplay&&(e.video.autoplay=!0),e._interval={},e.videoEventMiddleware={},e.attachVideoEvents(),e}return i=s,r=[{key:"setEventsMiddleware",value:function(t){var e=this;Object.keys(t).map(function(n){e.videoEventMiddleware[n]=t[n]})}},{key:"removeEventsMiddleware",value:function(t){var e=this;Object.keys(t).map(function(t){delete e.videoEventMiddleware[t]})}},{key:"attachVideoEvents",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!this.evHandlers&&(this._evHandlers=tj.map(function(t){var n,i,r,o,a,s;return o={},a=t,s=(n=t,(i=e)[r="on".concat(n.charAt(0).toUpperCase()).concat(n.slice(1))]&&"function"==typeof i[r]&&i.on(n,i[r]),function(t,e){var r={player:i,eventName:n,originalEvent:t,detail:t.detail||{},timeStamp:t.timeStamp,currentTime:i.currentTime,duration:i.duration,paused:i.paused,ended:i.ended,isInternalOp:!!i._internalOp[t.type],muted:i.muted,volume:i.volume,host:k.getHostFromUrl(i.currentSrc),vtype:i.vtype};if(i.removeInnerOP(t.type),"timeupdate"===n&&(i._currentTime=i.video&&i.video.currentTime),"ratechange"===n){var o=i.video?i.video.playbackRate:0;if(o&&i._rate===o)return;i._rate=i.video&&i.video.playbackRate}if("durationchange"===n&&(i._duration=i.video.duration),"volumechange"===n&&(r.isMutedChange=i._lastMuted!==i.muted,i._lastMuted=i.muted),"error"===n&&(r.error=e||i.video.error),i.videoEventMiddleware[n]){var a=t4.bind(i,n,r);try{i.videoEventMiddleware[n].call(i,r,a)}catch(t){throw t4.call(i,n,r),t}}else t4.call(i,n,r)}),(a=t0(a))in o?Object.defineProperty(o,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[a]=s,o})),!t&&(t=this.video),this._evHandlers.forEach(function(e){var i=Object.keys(e)[0];(0===n.length||n.indexOf(i)>-1)&&t.addEventListener(i,e[i],!1)})}},{key:"detachVideoEvents",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!t&&(t=this.video),this._evHandlers.forEach(function(n){var i=Object.keys(n)[0];(0===e.length||e.indexOf(i)>-1)&&t.removeEventListener(i,n[i],!1)})}},{key:"_attachSourceEvents",value:function(t,e){var n=this;t.removeAttribute("src"),t.load(),t.removeEventListener("loadeddata",this._vLoadeddata),e.forEach(function(t){n.video.appendChild(k.createDom("source","",{src:"".concat(t.src),type:"".concat(t.type||"")}))});var i=t.children;if(!!i){this._videoSourceCount=i.length,this._vLoadeddata=function(t){n.emit(tC,{src:t.target.currentSrc,host:k.getHostFromUrl(t.target.currentSrc)})};for(var r=null,o=0;o<this._evHandlers.length;o++)if("error"===Object.keys(this._evHandlers[o])[0]){r=this._evHandlers[o];break}this._sourceError||(this._sourceError=function(t){if(n._videoSourceCount--,0===n._videoSourceCount){var e={code:4,message:"sources_load_error"};r?r.error(t,e):n.errorHandler("error",e)}var i=O["4"];n.emit(tE,new T(n,{errorType:i,errorCode:4,errorMessage:"sources_load_error",mediaError:{code:4,message:"sources_load_error"},src:t.target.src}))});for(var a=0;a<i.length;a++)i[a].addEventListener("error",this._sourceError);t.addEventListener("loadeddata",this._vLoadeddata)}}},{key:"_detachSourceEvents",value:function(t){var e=t.children;if(!!e&&0!==e.length&&!!this._sourceError){for(var n=0;n<e.length;n++)e[n].removeEventListener("error",this._sourceError);for(;e.length>0;)t.removeChild(e[0]);this._vLoadeddata&&t.removeEventListener("loadeddata",this._vLoadeddata)}}},{key:"errorHandler",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.video&&(this.video.error||e)){var n=this.video.error||e,i=n.code?O[n.code]:"other",r=n.message||"";!this.video.currentSrc&&(n={code:6,message:r="empty_src_".concat(n.message)}),this.emit(t,new T(this,{errorType:i,errorCode:n.code,errorMessage:n.message||"",mediaError:n}))}}},{key:"hasStart",get:function(){return this._hasStart},set:function(t){"boolean"==typeof t&&(this._hasStart=t,this.emit("hasstart"))}},{key:"destroy",value:function(){var t=this;for(var e in this.video&&(this.video.pause&&(this.video.pause(),this.video.muted=!0),this.video.removeAttribute("src"),this.video.load()),this._currentTime=0,this._duration=0,this._hasStart=!1,this.videoConfig=null,this._interval)Object.prototype.hasOwnProperty.call(this._interval,e)&&(clearInterval(this._interval[e]),this._interval[e]=null);this.detachVideoEvents(),this._evHandlers.map(function(e){var n=Object.keys(e)[0],i="on".concat(n.charAt(0).toUpperCase()).concat(n.slice(1));"function"==typeof t[i]&&t.off(n,t[i])}),this._evHandlers=null,this.video=null,this.videoEventMiddleware={},this.removeAllListeners()}},{key:"play",value:function(){return this.video?this.video.play():null}},{key:"pause",value:function(){this.video&&this.video.pause()}},{key:"load",value:function(){this.video&&this.video.load()}},{key:"canPlayType",value:function(t){return!!this.video&&this.video.canPlayType(t)}},{key:"getBufferedRange",value:function(t){var e=[0,0];if(!this.video)return e;!t&&(t=this.video.buffered);var n=this.video.currentTime;if(t)for(var i=0,r=t.length;i<r&&(e[0]=t.start(i),e[1]=t.end(i),!(e[0]<=n)||!(n<=e[1]));i++);return e[0]-n<=0&&n-e[1]<=0?e:[0,0]}},{key:"autoplay",get:function(){return!!this.video&&this.video.autoplay},set:function(t){this.video&&(this.video.autoplay=t)}},{key:"buffered",get:function(){return this.video?this.video.buffered:null}},{key:"buffered2",get:function(){return this.video?k.getBuffered2(this.video.buffered):null}},{key:"bufferedPoint",get:function(){var t={start:0,end:0};if(!this.video)return t;var e=this.video.buffered;if(!e||0===e.length)return t;for(var n=0;n<e.length;n++)if((e.start(n)<=this.currentTime||.1>e.start(n))&&e.end(n)>=this.currentTime)return{start:e.start(n),end:e.end(n)};return t}},{key:"crossOrigin",get:function(){return this.video?this.video.crossOrigin:""},set:function(t){this.video&&(this.video.crossOrigin=t)}},{key:"currentSrc",get:function(){return this.video?this.video.currentSrc:""},set:function(t){this.video&&(this.video.currentSrc=t)}},{key:"currentTime",get:function(){return this.video?void 0!==this.video.currentTime?this.video.currentTime:this._currentTime:0},set:function(t){this.video&&(this.video.currentTime=t)}},{key:"defaultMuted",get:function(){return!!this.video&&this.video.defaultMuted},set:function(t){this.video&&(this.video.defaultMuted=t)}},{key:"duration",get:function(){return this._duration}},{key:"ended",get:function(){return!!this.video&&this.video.ended}},{key:"error",get:function(){return this.video&&this.video.error?["MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED"][this.video.error.code-1]:null}},{key:"loop",get:function(){return!!this.video&&this.video.loop},set:function(t){this.video&&(this.video.loop=t)}},{key:"muted",get:function(){return!!this.video&&this.video.muted},set:function(t){if(!!this.video&&this.video.muted!==t)this._lastMuted=this.video.muted,this.video.muted=t}},{key:"networkState",get:function(){return this.video?this.video.networkState:0}},{key:"paused",get:function(){return!this.video||this.video.paused}},{key:"playbackRate",get:function(){return this.video?this.video.playbackRate:0},set:function(t){if(!!this.video&&t!==1/0)this.video.defaultPlaybackRate=t,this.video.playbackRate=t}},{key:"played",get:function(){return this.video?this.video.played:null}},{key:"preload",get:function(){return!!this.video&&this.video.preload},set:function(t){this.video&&(this.video.preload=t)}},{key:"readyState",get:function(){return this.video?this.video.readyState:0}},{key:"seekable",get:function(){return!!this.video&&this.video.seekable}},{key:"seeking",get:function(){return!!this.video&&this.video.seeking}},{key:"src",get:function(){return this.video?this.video.src:""},set:function(t){this.video.src=t}},{key:"volume",get:function(){return this.video?this.video.volume:0},set:function(t){if("number"==typeof t&&!(t<0)&&!(t>1)&&!!this.video)this.video.volume=t}},{key:"addInnerOP",value:function(t){this._internalOp[t]=!0}},{key:"removeInnerOP",value:function(t){delete this._internalOp[t]}},{key:"emit",value:function(t,e){for(var n,i=arguments.length,r=Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=t1(t3(s.prototype),"emit",this)).call.apply(n,[this,t,e].concat(r))}},{key:"on",value:function(t,e){for(var n,i=arguments.length,r=Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=t1(t3(s.prototype),"on",this)).call.apply(n,[this,t,e].concat(r))}},{key:"once",value:function(t,e){for(var n,i=arguments.length,r=Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=t1(t3(s.prototype),"once",this)).call.apply(n,[this,t,e].concat(r))}},{key:"off",value:function(t,e){for(var n,i=arguments.length,r=Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=t1(t3(s.prototype),"off",this)).call.apply(n,[this,t,e].concat(r))}},{key:"offAll",value:function(){t1(t3(s.prototype),"removeAllListeners",this).call(this)}}],tQ(i.prototype,r),Object.defineProperty(i,"prototype",{writable:!1}),s}(l());function t5(t){return(t5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function t9(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==t5(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==t5(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===t5(e)?e:String(e)}(i.key),i)}}var t8=function(){var t,e,n;function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"xgplayer",version:1,db:null,ojstore:{name:"xg-m4a",keypath:"vid"}};!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),this.indexedDB=window.indexedDB||window.webkitindexedDB,this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,this.myDB=t}return t=i,e=[{key:"openDB",value:function(t){var e=this,n=this,i=this.myDB.version||1,r=n.indexedDB.open(n.myDB.name,i);r.onerror=function(t){},r.onsuccess=function(i){e.myDB.db=i.target.result,t.call(n)},r.onupgradeneeded=function(t){var e,i=t.target.result;t.target.transaction,!i.objectStoreNames.contains(n.myDB.ojstore.name)&&i.createObjectStore(n.myDB.ojstore.name,{keyPath:n.myDB.ojstore.keypath})}}},{key:"deletedb",value:function(){this.indexedDB.deleteDatabase(this.myDB.name)}},{key:"closeDB",value:function(){this.myDB.db.close()}},{key:"addData",value:function(t,e){for(var n,i=this.myDB.db.transaction(t,"readwrite").objectStore(t),r=0;r<e.length;r++)(n=i.add(e[r])).onerror=function(){},n.onsuccess=function(){}}},{key:"putData",value:function(t,e){for(var n,i=this.myDB.db.transaction(t,"readwrite").objectStore(t),r=0;r<e.length;r++)(n=i.put(e[r])).onerror=function(){},n.onsuccess=function(){}}},{key:"getDataByKey",value:function(t,e,n){var i=this,r=this.myDB.db.transaction(t,"readwrite").objectStore(t).get(e);r.onerror=function(){n.call(i,null)},r.onsuccess=function(t){var e=t.target.result;n.call(i,e)}}},{key:"deleteData",value:function(t,e){this.myDB.db.transaction(t,"readwrite").objectStore(t).delete(e)}},{key:"clearData",value:function(t){this.myDB.db.transaction(t,"readwrite").objectStore(t).clear()}}],t9(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),t7=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],et=["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],ee=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],en="data-xgplayerid",ei={BUFFER_CONTROLS:"buffer_control"},er={PLAYING:"playing",WAITING:"waiting"};function eo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function ea(t,e,n){for(var i=arguments.length,r=Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];var a=e.call.apply(e,[t].concat(r));if(!!n&&"function"==typeof n)a&&a.then?a.then(function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];n.call.apply(n,[t].concat(i))}):n.call.apply(n,[t].concat(r))}function es(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{pre:null,next:null};return!this.__hooks&&(this.__hooks={}),this.__hooks[t]||(this.__hooks[t]=null),(function(){var i=arguments,r=this;if(n.pre)try{(o=n.pre).call.apply(o,[this].concat(Array.prototype.slice.call(arguments)))}catch(e){throw e.message="[pluginName: ".concat(this.pluginName,":").concat(t,":pre error] >> ").concat(e.message),e}if(this.__hooks&&this.__hooks[t])try{var o,a,s=(a=this.__hooks[t]).call.apply(a,[this,this].concat(Array.prototype.slice.call(arguments)));s?s.then?s.then(function(t){if(!1!==t){var o;ea.apply(void 0,[r,e,n.next].concat((o=i,function(t){if(Array.isArray(t))return eo(t)}(o)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||function(t,e){if(t){if("string"==typeof t)return eo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eo(t,e)}}(o)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())))}}).catch(function(t){throw t}):ea.apply(void 0,[this,e,n.next].concat(Array.prototype.slice.call(arguments))):void 0===s&&ea.apply(void 0,[this,e,n.next].concat(Array.prototype.slice.call(arguments)))}catch(e){throw e.message="[pluginName: ".concat(this.pluginName,":").concat(t,"] >> ").concat(e.message),e}else ea.apply(void 0,[this,e,n.next].concat(Array.prototype.slice.call(arguments)))}).bind(this)}function eu(t,e){var n=this.__hooks;return n?!!n.hasOwnProperty(t)&&(n&&(n[t]=e),!0):void 0}function ec(t,e){var n=this.__hooks;if(!n||!Array.isArray(n[t]))return -1;for(var i=n[t],r=0;r<i.length;r++)if(i[r]===e)return r;return -1}function el(t,e){var n=this.__hooks;if(!!n)if(Array.isArray(n[t])){var i=n[t],r=ec.call(this,t,e);-1!==r&&i.splice(r,1)}else n[t]&&(n[t]=null)}function ef(t){if(!!this.plugins&&!!this.plugins[t.toLowerCase()]){for(var e=this.plugins[t.toLowerCase()],n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return e.useHooks&&e.useHooks.apply(e,i)}}function eh(t){if(!!this.plugins&&!!this.plugins[t.toLowerCase()]){var e=this.plugins[t.toLowerCase()];if(e){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return e.removeHooks&&e.removeHooks.apply(e,i)}}}function ep(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.__hooks={},e&&e.map(function(e){t.__hooks[e]=null}),Object.defineProperty(t,"hooks",{get:function(){return t.__hooks&&Object.keys(t.__hooks).map(function(e){if(t.__hooks[e])return e})}})}function ed(t){t.__hooks=null}function ey(t,e,n){for(var i=arguments.length,r=Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];if(!t.__hooks||!t.__hooks[e])return n.call.apply(n,[t,t].concat(r));var a,s=(a=t.__hooks[e]).call.apply(a,[t,t].concat(r));if(s&&s.then)s.then(function(e){return!1===e?null:n.call.apply(n,[t,t].concat(r))}).catch(function(t){});else if(!1!==s)return n.call.apply(n,[t,t].concat(r))}function ev(t){return(ev="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function em(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?eg(Object(n),!0).forEach(function(e){(function(t,e,n){(e=ew(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n})(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):eg(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function eb(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,ew(i.key),i)}}function ew(t){var e=function(t,e){if("object"!==ev(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==ev(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ev(e)?e:String(e)}function ek(t,e){y.logError("[".concat(t,"] event or callback cant be undefined or null when call ").concat(e))}var e_=function(){var t,e,n;function i(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),k.checkIsFunction(this.beforeCreate)&&this.beforeCreate(t),ep(this),this.__args=t,this.__events={},this.__onceEvents={},this.config=t.config||{},this.player=null,this.playerConfig={},this.pluginName="",this.__init(t)}return t=i,e=[{key:"beforeCreate",value:function(t){}},{key:"afterCreate",value:function(){}},{key:"beforePlayerInit",value:function(){}},{key:"onPluginsReady",value:function(){}},{key:"afterPlayerInit",value:function(){}},{key:"destroy",value:function(){}},{key:"__init",value:function(t){this.player=t.player,this.playerConfig=t.player&&t.player.config,this.pluginName=t.pluginName?t.pluginName.toLowerCase():this.constructor.pluginName.toLowerCase(),this.logger=t.player&&t.player.logger}},{key:"reInitialize",value:function(){this.__init(this.__args)}},{key:"updateLang",value:function(t){!t&&(t=this.lang)}},{key:"lang",get:function(){return this.player.lang}},{key:"i18n",get:function(){return this.player.i18n}},{key:"i18nKeys",get:function(){return this.player.i18nKeys}},{key:"domEventType",get:function(){var t,e=k.checkTouchSupport()?"touch":"mouse";return["compatible","touch","mouse"].indexOf(null===(t=this.playerConfig)||void 0===t?void 0:t.domEventType)>-1&&(e=this.playerConfig.domEventType),e}},{key:"on",value:function(t,e){var n=this;if(!t||!e||!this.player){ek(this.pluginName,"plugin.on(event, callback)");return}"string"==typeof t?(this.__events[t]=e,this.player.on(t,e)):Array.isArray(t)&&t.forEach(function(t){n.__events[t]=e,n.player.on(t,e)})}},{key:"once",value:function(t,e){var n=this;if(!t||!e||!this.player){ek(this.pluginName,"plugin.once(event, callback)");return}"string"==typeof t?(this.__onceEvents[t]=e,this.player.once(t,e)):Array.isArray(t)&&t.forEach(function(i){n.__onceEvents[i]=e,n.player.once(t,e)})}},{key:"off",value:function(t,e){var n=this;if(!t||!e||!this.player){ek(this.pluginName,"plugin.off(event, callback)");return}"string"==typeof t?(delete this.__events[t],this.player.off(t,e)):Array.isArray(t)&&t.forEach(function(i){delete n.__events[t],n.player.off(i,e)})}},{key:"offAll",value:function(){var t=this;["__events","__onceEvents"].forEach(function(e){Object.keys(t[e]).forEach(function(n){t[e][n]&&t.off(n,t[e][n]),n&&delete t[e][n]})}),this.__events={},this.__onceEvents={}}},{key:"emit",value:function(t){var e;if(!!this.player){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(e=this.player).emit.apply(e,[t].concat(i))}}},{key:"emitUserAction",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!!this.player){var i=em(em({},n),{},{pluginName:this.pluginName});this.player.emitUserAction(t,e,i)}}},{key:"hook",value:function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2],es.call.apply(es,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(t,e){for(var n=arguments.length,i=Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return eu.call.apply(eu,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(t,e){for(var n=arguments.length,i=Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return el.call.apply(el,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"registerPlugin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!!this.player)return n&&(e.pluginName=n),this.player.registerPlugin({plugin:t,options:e})}},{key:"getPlugin",value:function(t){return this.player?this.player.getPlugin(t):null}},{key:"__destroy",value:function(){var t=this,e=this.player,n=this.pluginName;this.offAll(),k.clearAllTimers(this),k.checkIsFunction(this.destroy)&&this.destroy(),["player","playerConfig","pluginName","logger","__args","__hooks"].map(function(e){t[e]=null}),e.unRegisterPlugin(n),ed(this)}}],n=[{key:"defineGetterOrSetter",value:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&Object.defineProperty(t,n,e[n])}},{key:"defaultConfig",get:function(){return{}}},{key:"pluginName",get:function(){return"pluginName"}}],e&&eb(t.prototype,e),n&&eb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(),eS=n("97720"),eP=n.n(eS);function eO(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==ex(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==ex(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ex(e)?e:String(e)}(i.key),i)}}function eT(){return(eT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=eC(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function eE(t,e){return(eE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function eC(t){return(eC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ex(t){return(ex="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var ej={CONTROLS:"controls",ROOT:"root"},eR={ROOT:"root",ROOT_LEFT:"rootLeft",ROOT_RIGHT:"rootRight",ROOT_TOP:"rootTop",CONTROLS_LEFT:"controlsLeft",CONTROLS_RIGTH:"controlsRight",CONTROLS_RIGHT:"controlsRight",CONTROLS_CENTER:"controlsCenter",CONTROLS:"controls"},eA="xg-icon-disable";function eL(t){return!!t&&t.indexOf&&/^(?:http|data:|\/)/.test(t)}function eI(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=null;if(t instanceof window.Element)return k.addClass(t,n),Object.keys(i).map(function(e){t.setAttribute(e,i[e])}),t;if(eL(t)||eL(t.url))return i.src=eL(t)?t:t.url||"",o=k.createDom(t.tag||"img","",i,"xg-img ".concat(n));if("function"==typeof t)try{if((o=t())instanceof window.Element)return k.addClass(o,n),Object.keys(i).map(function(t){o.setAttribute(t,i[t])}),o;y.logWarn("warn>>icons.".concat(e," in config of plugin named [").concat(r,"] is a function mast return an Element Object"));return null}catch(t){return y.logError("Plugin named [".concat(r,"]:createIcon"),t),null}return"string"==typeof t?k.createDomFromHtml(t,i,n):(y.logWarn("warn>>icons.".concat(e," in config of plugin named [").concat(r,"] is invalid")),null)}var eD=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eE(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=eC(e);return t=n?Reflect.construct(i,arguments,eC(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===ex(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).__delegates=[],t}return i=s,r=[{key:"__init",value:function(t){if(eT(eC(s.prototype),"__init",this).call(this,t),!!t.root){var e=t.root,n=null;this.icons={},this.root=null,this.parent=null,!function(t,e){var n=e.config.icons||e.playerConfig.icons;Object.keys(t).map(function(i){var r,o,a,s,u=t[i],c=u&&u.class?u.class:"",l=u&&u.attr?u.attr:{},f=null;if(n&&n[i]){;r=n[i],o=c,c="object"===ex(r)&&r.class&&"string"==typeof r.class?"".concat(o," ").concat(r.class):o,a=n[i],s=l,"object"===ex(a)&&a.attr&&"object"===ex(a.attr)&&Object.keys(a.attr).map(function(t){s[t]=a.attr[t]}),l=s,f=eI(n[i],i,c,l,e.pluginName)}!f&&u&&(f=eI(u.icon?u.icon:u,l,c,{},e.pluginName)),e.icons[i]=f})}(this.registerIcons()||{},this),this.langText={},!function(t,e){Object.keys(t).map(function(n){Object.defineProperty(e.langText,n,{get:function(){var i=e.lang,r=e.i18n;return r[n]?r[n]:t[n]&&t[n][i]||""}})})}(this.registerLanguageTexts()||{},this);var i="";try{i=this.render()}catch(t){throw y.logError("Plugin:".concat(this.pluginName,":render"),t),Error("Plugin:".concat(this.pluginName,":render:").concat(t.message))}if(i)(n=s.insert(i,e,t.index)).setAttribute("data-index",t.index);else{if(!t.tag)return;(n=k.createDom(t.tag,"",t.attr,t.name)).setAttribute("data-index",t.index),e.appendChild(n)}this.root=n,this.parent=e;var r=this.config.attr||{},o=this.config.style||{};this.setAttr(r),this.setStyle(o),this.config.index&&this.root.setAttribute("data-index",this.config.index),this.__registerChildren()}}},{key:"__registerChildren",value:function(){var t=this;if(!!this.root){this._children=[];var e=this.children();e&&"object"===ex(e)&&Object.keys(e).length>0&&Object.keys(e).map(function(n){var i,r,o=e[n],a={root:t.root};"function"==typeof o?(i=t.config[n]||{},r=o):"object"===ex(o)&&"function"==typeof o.plugin&&(i=o.options?k.deepCopy(t.config[n]||{},o.options):t.config[n]||{},r=o.plugin),a.config=i,void 0!==i.index&&(a.index=i.index),i.root&&(a.root=i.root),t.registerPlugin(r,a,n)})}}},{key:"updateLang",value:function(t){!t&&(t=this.lang);var e=this.root,n=this.i18n,i=this.langText;e&&!function t(e,n){for(var i=0;i<e.children.length;i++)e.children[i].children.length>0?t(e.children[i],n):n(e.children[i])}(e,function(e){var r=e.getAttribute&&e.getAttribute("lang-key");if(!!r){var o=n[r.toUpperCase()]||i[r];o&&(e.innerHTML="function"==typeof o?o(t):o)}})}},{key:"lang",get:function(){return this.player.lang}},{key:"changeLangTextKey",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.i18n||{},i=this.langText;t.setAttribute&&t.setAttribute("lang-key",e);var r=n[e]||i[e]||"";r&&(t.innerHTML=r)}},{key:"plugins",value:function(){return this._children}},{key:"disable",value:function(){this.config.disable=!0,k.addClass(this.find(".xgplayer-icon"),eA)}},{key:"enable",value:function(){this.config.disable=!1,k.removeClass(this.find(".xgplayer-icon"),eA)}},{key:"children",value:function(){return{}}},{key:"registerPlugin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e.root=e.root||this.root;var i=eT(eC(s.prototype),"registerPlugin",this).call(this,t,e,n);return this._children.push(i),i}},{key:"unregisterPlugin",value:function(t){if(this._children instanceof Array){var e=function(t,e){if(t instanceof Array){for(var n=0;n<t.length;n++)if(e.call(null,t[n],n,t))return n}return -1}(this._children,function(e){return e===t||e.pluginName&&e.pluginName===t.pluginName});e>-1&&this._children.splice(e,1)}}},{key:"registerIcons",value:function(){return{}}},{key:"registerLanguageTexts",value:function(){return{}}},{key:"find",value:function(t){if(!!this.root)return this.root.querySelector(t)}},{key:"bind",value:function(t,e,n){var i=this;if(arguments.length<3&&"function"==typeof e)Array.isArray(t)?t.forEach(function(t){i.bindEL(t,e)}):this.bindEL(t,e);else{var r=s.delegate.call(this,this.root,t,e,n);this.__delegates=this.__delegates.concat(r)}}},{key:"unbind",value:function(t,e){var n=this;if(arguments.length<3&&"function"==typeof e)Array.isArray(t)?t.forEach(function(t){n.unbindEL(t,e)}):this.unbindEL(t,e);else{for(var i="".concat(t,"_").concat(e),r=0;r<this.__delegates.length;r++)if(this.__delegates[r].key===i){this.__delegates[r].destroy(),this.__delegates.splice(r,1);break}}}},{key:"setStyle",value:function(t,e){var n=this;if(!!this.root){if("String"===k.typeOf(t))return this.root.style[t]=e;"Object"===k.typeOf(t)&&Object.keys(t).map(function(e){n.root.style[e]=t[e]})}}},{key:"setAttr",value:function(t,e){var n=this;if(!!this.root){if("String"===k.typeOf(t))return this.root.setAttribute(t,e);"Object"===k.typeOf(t)&&Object.keys(t).map(function(e){n.root.setAttribute(e,t[e])})}}},{key:"setHtml",value:function(t,e){if(!!this.root)this.root.innerHTML=t,"function"==typeof e&&e()}},{key:"bindEL",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!!this.root)"on".concat(t) in this.root&&"function"==typeof e&&this.root.addEventListener(t,e,n)}},{key:"unbindEL",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!!this.root)"on".concat(t) in this.root&&"function"==typeof e&&this.root.removeEventListener(t,e,n)}},{key:"show",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!!this.root){if(this.root.style.display=void 0!==t?t:"block",e&&"none"===window.getComputedStyle(this.root,null).getPropertyValue("display"))return this.root.style.display="block"}}},{key:"hide",value:function(){this.root&&(this.root.style.display="none")}},{key:"appendChild",value:function(t,e){if(!this.root)return null;if(arguments.length<2&&arguments[0]instanceof window.Element)return this.root.appendChild(arguments[0]);if(!e||!(e instanceof window.Element))return null;try{if("string"==typeof t)return this.find(t).appendChild(e);return t.appendChild(e)}catch(t){return y.logError("Plugin:appendChild",t),null}}},{key:"render",value:function(){return""}},{key:"destroy",value:function(){}},{key:"__destroy",value:function(){var t=this,e=this.player;this.__delegates.map(function(t){t.destroy()}),this.__delegates=[],this._children instanceof Array&&(this._children.forEach(function(t){e.unRegisterPlugin(t.pluginName)}),this._children=null),this.root&&(this.root.hasOwnProperty("remove")?this.root.remove():this.root.parentNode&&this.root.parentNode.removeChild(this.root)),eT(eC(s.prototype),"__destroy",this).call(this),this.icons={},["root","parent"].map(function(e){t[e]=null})}}],o=[{key:"insert",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=e.children.length,r=Number(n),o=t instanceof window.Node;if(!i)return o?e.appendChild(t):e.insertAdjacentHTML("beforeend",t),e.children[e.children.length-1];for(var a=0,s=null,u="";a<i;a++){var c=Number((s=e.children[a]).getAttribute("data-index"));if(c>=r){u="beforebegin";break}c<r&&(u="afterend")}return o?"afterend"===u?e.appendChild(t):e.insertBefore(t,s):s.insertAdjacentHTML(u,t),"afterend"===u?e.children[e.children.length-1]:e.children[a]}},{key:"defaultConfig",get:function(){return{}}},{key:"delegate",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=[];if(t instanceof window.Node&&"function"==typeof i){if(Array.isArray(n))n.forEach(function(n){var a=eP()(t,e,n,i,r);a.key="".concat(e,"_").concat(n),o.push(a)});else{var a=eP()(t,e,n,i,r);a.key="".concat(e,"_").concat(n),o.push(a)}}return o}},{key:"ROOT_TYPES",get:function(){return ej}},{key:"POSITIONS",get:function(){return eR}}],r&&eO(i.prototype,r),o&&eO(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(e_);function eN(t){return(eN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eM(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,eB(i.key),i)}}function eB(t){var e=function(t,e){if("object"!==eN(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==eN(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===eN(e)?e:String(e)}var eF=function(){var t,e,n;function i(){var t,e,n,r=this;if(!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),t=this,e="__trigger",n=function(t){var e=new Date().getTime();r.timeStamp=e;for(var n=0;n<t.length;n++)r.__runHandler(t[n].target)},(e=eB(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,this.__handlers=[],this.timeStamp=0,this.observer=null,!!window.ResizeObserver)try{this.observer=new window.ResizeObserver(function(t,e,n){var i=!0,r=!0;if("function"!=typeof t)throw TypeError("Expected a function");return _(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),function(t,e,n){var i,r,o,a,s,u,c=0,l=!1,f=!1,h=!0,p=!e&&0!==e&&"function"==typeof window.requestAnimationFrame;if("function"!=typeof t)throw TypeError("Expected a function");function d(e){var n=i,o=r;return i=r=void 0,c=e,a=t.apply(o,n)}function y(t,e){return p?(window.cancelAnimationFrame(s),window.requestAnimationFrame(t)):setTimeout(t,e)}e=+e||0,_(n)&&(l=!!n.leading,o=(f="maxWait"in n)?Math.max(+n.maxWait||0,e):o,h="trailing"in n?!!n.trailing:h);function v(t){var n=t-u,i=t-c;return void 0===u||n>=e||n<0||f&&i>=o}function g(){var t,n,i,r,a=Date.now();if(v(a))return m(a);s=y(g,(n=(t=a)-u,i=t-c,r=e-n,f?Math.min(r,o-i):r))}function m(t){return(s=void 0,h&&i)?d(t):(i=r=void 0,a)}function b(){for(var t,n=Date.now(),o=v(n),h=arguments.length,p=Array(h),m=0;m<h;m++)p[m]=arguments[m];if(i=p,r=this,u=n,o){if(void 0===s){;return c=t=u,s=y(g,e),l?d(t):a}if(f)return s=y(g,e),d(u)}return void 0===s&&(s=y(g,e)),a}return b.cancel=function(){void 0!==s&&!function(t){if(p)return window.cancelAnimationFrame(t);clearTimeout(t)}(s),c=0,i=u=r=s=void 0},b.flush=function(){return void 0===s?a:m(Date.now())},b.pending=function(){return void 0!==s},b}(t,100,{leading:i,trailing:r,maxWait:e})}(this.__trigger,100,{trailing:!0})),this.timeStamp=new Date().getTime()}catch(t){}}return t=i,e=[{key:"addObserver",value:function(t,e){if(!!this.observer){this.observer&&this.observer.observe(t);for(var n=t.getAttribute(en),i=this.__handlers,r=-1,o=0;o<i.length;o++)i[o]&&t===i[o].target&&(r=o);r>-1?this.__handlers[r].handler=e:this.__handlers.push({target:t,handler:e,playerId:n})}}},{key:"unObserver",value:function(t){var e=-1;this.__handlers.map(function(n,i){t===n.target&&(e=i)});try{this.observer&&this.observer.unobserve(t)}catch(t){}this.observer&&this.observer.unobserve(t),e>-1&&this.__handlers.splice(e,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(t){for(var e=this.__handlers,n=0;n<e.length;n++)if(e[n]&&t===e[n].target){try{e[n].handler(t)}catch(t){}return!0}return!1}}],eM(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),eH=null,eU={pluginGroup:{},init:function(t){var e,n,i=t._pluginInfoId;!i&&(i=new Date().getTime(),t._pluginInfoId=i),t.config.closeResizeObserver||(e=t.root,n=function(){t.getVideoSize()},eH||(eH=new eF),eH.addObserver(e,n)),this.pluginGroup[i]={_originalOptions:t.config||{},_plugins:{}}},formatPluginInfo:function(t,e){var n=null,i=null;return t.plugin&&"function"==typeof t.plugin?(n=t.plugin,i=t.options):(n=t,i={}),e&&(i.config=e||{}),{PLUFGIN:n,options:i}},checkPluginIfExits:function(t,e){for(var n=0;n<e.length;n++)if(t.toLowerCase()===e[n].pluginName.toLowerCase())return!0;return!1},getRootByConfig:function(t,e){for(var n=Object.keys(e),i=null,r=0;r<n.length;r++)if(t.toLowerCase()===n[r].toLowerCase()){i=e[n[r]];break}return"Object"===k.typeOf(i)?{root:i.root,position:i.position}:{}},lazyRegister:function(t,e){var n=this,i=e.timeout||1500;return Promise.race([e.loader().then(function(e){var i;i=e&&e.__esModule?e.default:e,n.register(t,i,e.options)}),new Promise(function(t,e){setTimeout(function(){e(Error("timeout"))},i)})])},register:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||!e||"function"!=typeof e||void 0===e.prototype)return;var i=t._pluginInfoId;if(!i||!this.pluginGroup[i])return;!this.pluginGroup[i]._plugins&&(this.pluginGroup[i]._plugins={});var r=this.pluginGroup[i]._plugins,o=this.pluginGroup[i]._originalOptions;n.player=t;var a=n.pluginName||e.pluginName;if(!a)throw Error("The property pluginName is necessary");if(!e.isSupported||!!e.isSupported()){!n.config&&(n.config={});for(var s=Object.keys(o),u=0;u<s.length;u++)if(a.toLowerCase()===s[u].toLowerCase()){var c=o[s[u]];"Object"===k.typeOf(c)&&(n.config=Object.assign({},n.config,o[s[u]]));break}e.defaultConfig&&Object.keys(e.defaultConfig).forEach(function(t){void 0===n.config[t]&&(n.config[t]=e.defaultConfig[t])}),n.root?"string"==typeof n.root&&(n.root=t[n.root]):n.root=t.root,n.index=n.config.index||0;try{r[a.toLowerCase()]&&this.unRegister(i,a.toLowerCase());var l=new e(n);return r[a.toLowerCase()]=l,r[a.toLowerCase()].func=e,l&&"function"==typeof l.afterCreate&&l.afterCreate(),l}catch(t){throw t}}},unRegister:function(t,e){t._pluginInfoId&&(t=t._pluginInfoId),e=e.toLowerCase();var n=null;try{(n=this.pluginGroup[t]._plugins[e])&&(n.pluginName&&n.__destroy(),delete this.pluginGroup[t]._plugins[e])}catch(t){}return n},deletePlugin:function(t,e){var n=t._pluginInfoId;n&&this.pluginGroup[n]&&this.pluginGroup[n]._plugins&&delete this.pluginGroup[n]._plugins[e]},getPlugins:function(t){var e=t._pluginInfoId;return e&&this.pluginGroup[e]?this.pluginGroup[e]._plugins:{}},findPlugin:function(t,e){var n=t._pluginInfoId;if(!n||!this.pluginGroup[n])return null;var i=e.toLowerCase();return this.pluginGroup[n]._plugins[i]},beforeInit:function(t){var e=this;function n(t){return t&&t.then?t:new Promise(function(t){t()})}return new Promise(function(i){var r;if(!!e.pluginGroup)return(r=t._loadingPlugins&&t._loadingPlugins.length?Promise.all(t._loadingPlugins):Promise.resolve()).then(function(){var r=t._pluginInfoId;if(!e.pluginGroup[r]){i();return}var o=e.pluginGroup[r]._plugins,a=[];Object.keys(o).forEach(function(t){if(o[t]&&o[t].beforePlayerInit)try{var e=o[t].beforePlayerInit();a.push(n(e))}catch(t){throw a.push(n(null)),t}}),Promise.all([].concat(a)).then(function(){i()}).catch(function(t){i()})})})},afterInit:function(t){var e=t._pluginInfoId;if(!!e&&!!this.pluginGroup[e]){var n=this.pluginGroup[e]._plugins;Object.keys(n).forEach(function(t){n[t]&&n[t].afterPlayerInit&&n[t].afterPlayerInit()})}},setLang:function(t,e){var n=e._pluginInfoId;if(!!n&&!!this.pluginGroup[n]){var i=this.pluginGroup[n]._plugins;Object.keys(i).forEach(function(e){if(i[e].updateLang)i[e].updateLang(t);else try{i[e].lang=t}catch(t){}})}},reRender:function(t){var e=this,n=t._pluginInfoId;if(!!n&&!!this.pluginGroup[n]){var i=[],r=this.pluginGroup[n]._plugins;Object.keys(r).forEach(function(t){"controls"!==t&&r[t]&&(i.push({plugin:r[t].func,options:r[t].__args}),e.unRegister(n,t))}),i.forEach(function(n){e.register(t,n.plugin,n.options)})}},onPluginsReady:function(t){var e=t._pluginInfoId;if(!!e&&!!this.pluginGroup[e]){var n=this.pluginGroup[e]._plugins||{};Object.keys(n).forEach(function(t){n[t].onPluginsReady&&"function"==typeof n[t].onPluginsReady&&n[t].onPluginsReady()})}},destroy:function(t){var e,n,i=t._pluginInfoId;if(!!this.pluginGroup[i]){e=t.root,eH.unObserver(e,void 0);for(var r=this.pluginGroup[i]._plugins,o=0,a=Object.keys(r);o<a.length;o++){var s=a[o];this.unRegister(i,s)}delete this.pluginGroup[i],delete t._pluginInfoId}}},eW={DEFAULT:"xgplayer",DEFAULT_SKIN:"xgplayer-skin-default",ENTER:"xgplayer-is-enter",PAUSED:"xgplayer-pause",PLAYING:"xgplayer-playing",ENDED:"xgplayer-ended",CANPLAY:"xgplayer-canplay",LOADING:"xgplayer-isloading",ERROR:"xgplayer-is-error",REPLAY:"xgplayer-replay",NO_START:"xgplayer-nostart",ACTIVE:"xgplayer-inactive",FULLSCREEN:"xgplayer-is-fullscreen",CSS_FULLSCREEN:"xgplayer-is-cssfullscreen",PARENT_FULLSCREEN:"xgplayer-fullscreen-parent",ROTATE_FULLSCREEN:"xgplayer-rotate-fullscreen",PARENT_ROTATE_FULLSCREEN:"xgplayer-rotate-parent",INNER_FULLSCREEN:"xgplayer-inner-fullscreen",NO_CONTROLS:"no-controls",FLEX_CONTROLS:"flex-controls",CONTROLS_FOLLOW:"controls-follow",AUTOHIDE:"xgplayer_autohide",NOT_ALLOW_AUTOPLAY:"not-allow-autoplay",SEEKING:"seeking",PC:"xgplayer-pc",MOBILE:"xgplayer-mobile",MINI:"xgplayer-mini"};function eV(){var t;return{id:"",el:null,url:"",domEventType:"default",nullUrlStart:!1,width:600,height:337.5,fluid:!1,fitVideoSize:"fixed",videoFillMode:"auto",volume:.6,autoplay:!1,autoplayMuted:!1,loop:!1,isLive:!1,zoom:1,videoInit:!0,poster:"",isMobileSimulateMode:!1,defaultPlaybackRate:1,execBeforePluginsCall:null,allowSeekAfterEnded:!0,enableContextmenu:!0,closeVideoClick:!1,closeVideoDblclick:!1,closePlayerBlur:!1,closeDelayBlur:!1,leavePlayerTime:3e3,closePlayVideoFocus:!1,closePauseVideoFocus:!1,closeFocusVideoFocus:!0,closeControlsBlur:!0,topBarAutoHide:!0,videoAttributes:{},startTime:0,seekedStatus:"play",miniprogress:!1,disableSwipeHandler:function(){},enableSwipeHandler:function(){},preProcessUrl:null,ignores:[],whitelist:[],inactive:3e3,lang:("zh-cn"===(t=(document.documentElement.getAttribute("lang")||navigator.language||"zh-cn").toLocaleLowerCase())&&(t="zh"),t),controls:!0,marginControls:!1,fullscreenTarget:null,screenShot:!1,rotate:!1,pip:!1,download:!1,mini:!1,cssFullscreen:!0,keyShortcut:!0,presets:[],plugins:[],playbackRate:1,definition:{list:[]},playsinline:!0,customDuration:0,timeOffset:0,icons:{},i18n:[],tabindex:0,thumbnail:null,videoConfig:{},isHideTips:!1,minWaitDelay:200,commonStyle:{progressColor:"",playedColor:"",cachedColor:"",sliderBtnStyle:{},volumeColor:""}}}function eG(t){return function(t){if(Array.isArray(t))return ez(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ez(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ez(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ez(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var eK=function(t,e){var n,i,r,o=r=e.preset&&e.options?new e.preset(e.options,t.config):new e({},t.config),a=o.plugins,s=o.ignores,u=o.icons,c=void 0===u?{}:u,l=o.i18n,f=void 0===l?[]:l;!t.config.plugins&&(t.config.plugins=[]),!t.config.ignores&&(t.config.ignores=[]),(n=t.config.plugins).push.apply(n,eG(void 0===a?[]:a)),(i=t.config.ignores).push.apply(i,eG(void 0===s?[]:s)),Object.keys(c).map(function(e){!t.config.icons[e]&&(t.config.icons[e]=c[e])});var h=t.config.i18n||[];f.push.apply(f,eG(h)),t.config.i18n=f};function eY(t){return(eY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eX(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,e0(i.key),i)}}function eq(){return(eq="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=e$(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function eJ(t,e){return(eJ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function eZ(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function e$(t){return(e$=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eQ(t,e,n){return(e=e0(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e0(t){var e=function(t,e){if("object"!==eY(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==eY(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===eY(e)?e:String(e)}var e1=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eJ(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=e$(e);return t=n?Reflect.construct(i,arguments,e$(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===eY(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return eZ(t)}(this,t)});function s(){var t;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return eQ(eZ(t=a.call.apply(a,[this].concat(n))),"onMouseEnter",function(e){var n=eZ(t),i=n.player;n.playerConfig.closeControlsBlur&&i.focus({autoHide:!1})}),eQ(eZ(t),"onMouseLeave",function(){eZ(t).player.focus()}),t}return i=s,o=[{key:"pluginName",get:function(){return"controls"}},{key:"defaultConfig",get:function(){return{disable:!1,autoHide:!0,mode:"",initShow:!1}}}],r=[{key:"beforeCreate",value:function(t){"boolean"==typeof t.player.config.controls&&(t.config.disable=!t.player.config.controls),!t.config.mode&&"mobile"===tZ.device&&(t.config.mode="flex"),t.player.config.marginControls&&(t.config.autoHide=!1)}},{key:"afterCreate",value:function(){var t=this,e=this.config,n=e.disable,i=e.height,r=e.mode,o=e.autoHide;if(!n){"flex"===r&&this.player.addClass(eW.FLEX_CONTROLS),o&&this.player.addClass(eW.AUTOHIDE);var a={height:"".concat(i,"px")};Object.keys(a).map(function(e){t.root.style[e]=a[e]}),this.left=this.find("xg-left-grid"),this.center=this.find("xg-center-grid"),this.right=this.find("xg-right-grid"),this.innerRoot=this.find("xg-inner-controls"),this.on(th,function(e){e?k.addClass(t.root,"mini-controls"):k.removeClass(t.root,"mini-controls")});var s=this.playerConfig.isMobileSimulateMode;"mobile"!==tZ.device&&"mobile"!==s&&(this.bind("mouseenter",this.onMouseEnter),this.bind("mouseleave",this.onMouseLeave))}}},{key:"focus",value:function(){this.player.focus({autoHide:!1})}},{key:"unFocus",value:function(){this.player.focus({autoHide:!0})}},{key:"blur",value:function(){this.player.blur({ignorePaused:!0})}},{key:"recoverAutoHide",value:function(){this.config.autoHide&&k.addClass(this.root,"control_autohide")}},{key:"pauseAutoHide",value:function(){k.removeClass(this.root,"control_autohide")}},{key:"show",value:function(){this.root.style.display="",this.player.focus()}},{key:"hide",value:function(){this.root.style.display="none"}},{key:"mode",get:function(){return this.config.mode}},{key:"registerPlugin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(!!this.root){var i=t.defaultConfig||{};if(!e.root){switch(e.position?e.position:e.config&&e.config.position?e.config.position:i.position){case eR.CONTROLS_LEFT:e.root=this.left;break;case eR.CONTROLS_RIGHT:e.root=this.right;break;case eR.CONTROLS_CENTER:e.root=this.center;break;case eR.CONTROLS:e.root=this.root;break;default:e.root=this.left}return eq(e$(s.prototype),"registerPlugin",this).call(this,t,e,n)}}}},{key:"destroy",value:function(){"mobile"!==tZ.device&&(this.unbind("mouseenter",this.onMouseEnter),this.unbind("mouseleave",this.onMouseLeave))}},{key:"render",value:function(){var t=this.config,e=t.mode,n=t.autoHide,i=t.initShow;if(!t.disable){var r=k.classNames({"xgplayer-controls":!0},{"flex-controls":"flex"===e},{"bottom-controls":"bottom"===e},{control_autohide:n},{controls_permanent:!n},{"xgplayer-controls-initshow":i||!n});return'<xg-controls class="'.concat(r,'" unselectable="on">\n    <xg-inner-controls class="xg-inner-controls xg-pos">\n      <xg-left-grid class="xg-left-grid">\n      </xg-left-grid>\n      <xg-center-grid class="xg-center-grid"></xg-center-grid>\n      <xg-right-grid class="xg-right-grid">\n      </xg-right-grid>\n    </xg-inner-controls>\n    </xg-controls>')}}}],eX(i.prototype,r),o&&eX(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function e2(t){return function(t){if(Array.isArray(t))return e3(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return e3(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e3(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e3(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var e4={lang:{},langKeys:[],textKeys:[]};function e6(t,e){return Object.keys(e).forEach(function(n){var i,r=k.typeOf(e[n]),o=k.typeOf(t[n]);"Array"===r?("Array"!==o&&(t[n]=[]),(i=t[n]).push.apply(i,e2(e[n]))):"Object"===r?("Object"!==o&&(t[n]={}),e6(t[n],e[n])):t[n]=e[n]}),t}function e5(){Object.keys(e4.lang.en).map(function(t){e4.textKeys[t]=t})}function e9(t,e){var n=t.LANG;if(!e&&(e=e4),!!e.lang){var i=t.TEXT||{};"zh"===n&&(n="zh-cn"),e.lang[n]?e6(e.lang[n],i):(e.langKeys.push(n),e.lang[n]=i),e5()}}e9({LANG:"en",TEXT:{ERROR_TYPES:{network:{code:1,msg:"video download error"},mse:{code:2,msg:"stream append error"},parse:{code:3,msg:"parsing error"},format:{code:4,msg:"wrong format"},decoder:{code:5,msg:"decoding error"},runtime:{code:6,msg:"grammatical errors"},timeout:{code:7,msg:"play timeout"},other:{code:8,msg:"other errors"}},HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",OPEN:"Open",MINI_DRAG:"Click and hold to drag",MINISCREEN:"Miniscreen",REFRESH_TIPS:"Please Try",REFRESH:"Refresh",FORWARD:"forward",LIVE_TIP:"Live"}});var e8={get textKeys(){return e4.textKeys},get langKeys(){return e4.langKeys},get lang(){var e7={};return e4.langKeys.map(function(t){e7[t]=e4.lang[t]}),e4.lang["zh-cn"]&&(e7.zh=e4.lang["zh-cn"]||{}),e7},extend:function(t,e){var n=[];if(!e&&(e=e4),!!e.lang){n="Array"!==k.typeOf(t)?Object.keys(t).map(function(e){return{LANG:"zh"===e?"zh-cn":e,TEXT:t[e]}}):t;var i=e.lang;n.map(function(t){"zh"===t.LANG&&(t.LANG="zh-cn"),i[t.LANG]?e6(i[t.LANG]||{},t.TEXT||{}):e9(t,e)}),e5()}},use:e9,init:function(t){var e,n={lang:{},langKeys:[],textKeys:{},pId:t};return e6(n.lang,e4.lang),(e=n.langKeys).push.apply(e,e2(e4.langKeys)),e6(n.textKeys,e4.textKeys),n}};function nt(t){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ne(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==nt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==nt(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===nt(e)?e:String(e)}(i.key),i)}}function nn(t,e){return(nn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ni(t){return(ni=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var nr={},no=null,na=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nn(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=ni(e);return t=n?Reflect.construct(i,arguments,ni(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===nt(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,r=[{key:"add",value:function(t){if(!!t)nr[t.playerId]=t,1===Object.keys(nr).length&&this.setActive(t.playerId,!0)}},{key:"remove",value:function(t){if(!!t){var e=t.isUserActive;delete nr[t.playerId]}}},{key:"_iterate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var n in nr)if(Object.prototype.hasOwnProperty.call(nr,n)){var i=nr[n];if(e){if(t(i))break}else t(i)}}},{key:"forEach",value:function(t){this._iterate(t)}},{key:"find",value:function(t){var e=null;return this._iterate(function(n){var i=t(n);return i&&(e=n),i},!0),e}},{key:"findAll",value:function(t){var e=[];return this._iterate(function(n){t(n)&&e.push(n)}),e}},{key:"setActive",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!!nr[t]){if(e){var n=!1;this.forEach(function(e){t===e.playerId?(!e.isUserActive&&(n=!0),e.isUserActive=!0,e.isInstNext=!1):e.isUserActive=!1}),n&&this.emit("activeChanged")}else nr[t].isUserActive=e;return t}}},{key:"getActiveId",value:function(){for(var t=Object.keys(nr),e=0;e<t.length;e++){var n=nr[t[e]];if(n&&n.isUserActive)return t[e]}return null}},{key:"setNext",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!!nr[t])return e?this.forEach(function(e){t===e.playerId?(e.isUserActive=!1,e.isInstNext=!0):e.isInstNext=!1}):nr[t].isInstNext=e,t}}],o=[{key:"getInstance",value:function(){return no||(no=new s),no}}],r&&ne(i.prototype,r),o&&ne(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(c.EventEmitter);function ns(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function nu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ns(Object(n),!0).forEach(function(e){nv(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ns(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function nc(t){return(nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,ng(i.key),i)}}function nf(){return(nf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ny(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function nh(t,e){return(nh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function np(t,e){if(e&&("object"===nc(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return nd(t)}function nd(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ny(t){return(ny=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nv(t,e,n){return(e=ng(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ng(t){var e=function(t,e){if("object"!==nc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==nc(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===nc(e)?e:String(e)}var nm=["play","pause","replay","retry","playnext"],nb=0,nw=0,nk=null,n_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nh(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=ny(e);return t=n?Reflect.construct(i,arguments,ny(this).constructor):i.apply(this,arguments),np(this,t)});function s(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);var e,n,i=k.deepMerge(eV(),t);nv(nd(n=a.call(this,i)),"canPlayFunc",function(){if(!!n.config){var t=n.config,e=t.autoplay,i=t.startTime,r=t.defaultPlaybackRate;y.logInfo("player","canPlayFunc, startTime",i),i&&(n.currentTime=i>n.duration?n.duration:i,n.config.startTime=0),n.playbackRate=r,e&&n.videoPlay(),n.off(N,n.canPlayFunc),n.removeClass(eW.ENTER)}}),nv(nd(n),"onFullscreenChange",function(t,e){var i=function(){k.setTimeout(nd(n),function(){n.getVideoSize()},100)},r=k.getFullScreenEl();n._fullActionFrom?n._fullActionFrom="":n.emit(tO,{eventType:"system",action:"switch_fullscreen",pluginName:"player",currentTime:n.currentTime,duration:n.duration,props:[{prop:"fullscreen",from:!0,to:!1}]});var o=function(t,e,n){if(!!t){var i=t.getAttribute(n);return!!i&&i===e&&("VIDEO"===t.tagName||"AUDIO"===t.tagName)||!1}}(r,n.playerId,en);if(e||r&&(r===n._fullscreenEl||o))i(),n.config.closeFocusVideoFocus||n.video.focus(),n.fullscreen=!0,n.emit(tl,!0,n._fullScreenOffset),n.cssfullscreen&&n.exitCssFullscreen();else if(n.fullscreen){i();var a=nd(n),s=a._fullScreenOffset;a.config.needFullscreenScroll?(window.scrollTo(s.left,s.top),k.setTimeout(nd(n),function(){n.fullscreen=!1,n._fullScreenOffset=null},100)):(n.config.closeFocusVideoFocus||n.video.focus(),n.fullscreen=!1,n._fullScreenOffset=null),n.cssfullscreen?n.removeClass(eW.FULLSCREEN):n.recoverFullStyle(n.root,n._fullscreenEl,eW.FULLSCREEN),n._fullscreenEl=null,n.emit(tl,!1)}}),nv(nd(n),"_onWebkitbeginfullscreen",function(t){n._fullscreenEl=n.video,n.onFullscreenChange(t,!0)}),nv(nd(n),"_onWebkitendfullscreen",function(t){n.onFullscreenChange(t,!1)}),ep(nd(n),nm),n.config=i,n._pluginInfoId=k.generateSessionId(),(e=nd(n)).logInfo=y.logInfo.bind(e),e.logWarn=y.logWarn.bind(e),e.logError=y.logError.bind(e);var r=n.constructor.defaultPreset;if(n.config.presets.length){var o=n.config.presets.indexOf("default");o>=0&&r&&(n.config.presets[o]=r)}else r&&n.config.presets.push(r);return(n.userTimer=null,n.waitTimer=null,n.isReady=!1,n.isPlaying=!1,n.isError=!1,n.isSeeking=!1,n.isCanplay=!1,n._runPending=!1,n.rotateDeg=0,n.isActive=!1,n.isBufferControlPaused=!1,n.isCssfullScreen=!1,n.fullscreen=!1,n._fullscreenEl=null,n._cssfullscreenEl=null,n.curDefinition=null,n._orgCss="",n._fullScreenOffset=null,n._videoHeight=0,n._videoWidth=0,n.videoPos={pi:1,scale:0,rotate:-1,x:0,y:0,h:-1,w:-1,vy:0,vx:0},n.sizeInfo={width:0,height:0,left:0,top:0},n._accPlayed={t:0,acc:0,loopAcc:0},n.innerContainer=null,n.controls=null,n.topBar=null,n.topBar=null,n.root=null,n.__i18n=e8.init(),tZ.os.isAndroid&&tZ.osVersion>0&&tZ.osVersion<6&&(n.config.autoplay=!1),n.database=new t8,n.isUserActive=!1,n._onceSeekCanplay=null,n._isPauseBeforeSeek=0,n.innerStates={isActiveLocked:!1},n.instManager=nk,n._initDOM())?(n._bindEvents(),n._registerPresets(),n._registerPlugins(),eU.onPluginsReady(nd(n)),k.setTimeout(nd(n),function(){n.emit($),n.onReady&&n.onReady(),n.isReady=!0},0),n.getInitDefinition(),n.syncFullstate(),(n.config.videoInit||n.config.autoplay)&&!n.hasStart&&n.start(),n):np(n)}return i=s,r=[{key:"_initDOM",value:function(){var t,e=this;if(this.root=this.config.id?document.getElementById(this.config.id):null,!this.root){var n=this.config.el;if(!n||1!==n.nodeType)return this.emit(R,new T("use",this.config.vid,{line:32,handle:"Constructor",msg:"container id can't be empty"})),!1;this.root=n}var i=function(t){for(var e=Object.keys(nr),n=0;n<e.length;n++){var i=nr[e[n]];if(i.root===t)return i}return null}(this.root);i&&(y.logWarn("The is an Player instance already exists in this.root, destroy it and reinitialize"),i.destroy()),this.root.setAttribute(en,this.playerId),null===(t=nk)||void 0===t||t.add(this),eU.init(this),this._initBaseDoms();var r=this.constructor.XgVideoProxy;if(r&&this.videoConfig.mediaType===r.mediaType){var o=this.innerContainer||this.root;this.detachVideoEvents(this.video);var a=new r(o,this.config,this.videoConfig);this.attachVideoEvents(a),this.video=a}if(this.video.setAttribute(en,this.playerId),this.config.controls){var s=eU.register(this,e1);this.controls=s}var u="mobile"===this.config.isMobileSimulateMode?"mobile":tZ.device;if(this.addClass("".concat(eW.DEFAULT," ").concat(eW.ACTIVE," xgplayer-").concat(u," ").concat(this.config.controls?"":eW.NO_CONTROLS)),this.config.autoplay?this.addClass(eW.ENTER):this.addClass(eW.NO_START),this.config.fluid){var c={"max-width":"100%",width:"100%",height:"0","padding-top":"".concat(100*this.config.height/this.config.width,"%"),position:"position",top:"0",left:"0"};Object.keys(c).map(function(t){e.root.style[t]=c[t]})}else["width","height"].map(function(t){e.config[t]&&("number"!=typeof e.config[t]?e.root.style[t]=e.config[t]:e.root.style[t]="".concat(e.config[t],"px"))});var l=this.root.getBoundingClientRect(),f=l.width,h=l.height,p=l.left,d=l.top;return this.sizeInfo.width=f,this.sizeInfo.height=h,this.sizeInfo.left=p,this.sizeInfo.top=d,!0}},{key:"_initBaseDoms",value:function(){this.topBar=k.createDom("xg-bar","",{"data-index":-1},"xg-top-bar"),this.leftBar=k.createDom("xg-bar","",{"data-index":-1},"xg-left-bar"),this.rightBar=k.createDom("xg-bar","",{"data-index":-1},"xg-right-bar"),this.config.marginControls&&(this.innerContainer=k.createDom("xg-video-container","",{"data-index":-1},"xg-video-container"),this.root.appendChild(this.innerContainer)),this.root.appendChild(this.topBar),this.root.appendChild(this.leftBar),this.root.appendChild(this.rightBar)}},{key:"_bindEvents",value:function(){var t=this;["focus","blur"].forEach(function(e){t.on(e,t["on"+e.charAt(0).toUpperCase()+e.slice(1)])}),t7.forEach(function(e){document&&document.addEventListener(e,t.onFullscreenChange)}),tZ.os.isIos&&(this.video.addEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.video.addEventListener("webkitendfullscreen",this._onWebkitendfullscreen)),this.once("loadeddata",this.getVideoSize),this.playFunc=function(){!t.config.closeFocusVideoFocus&&t.video.focus()},this.once("play",this.playFunc),this.on(ts,this.onBufferControl)}},{key:"_unbindEvents",value:function(){var t=this;this.root.removeEventListener("mousemove",this.mousemoveFunc),t7.forEach(function(e){document.removeEventListener(e,t.onFullscreenChange)}),this.playFunc&&this.off("play",this.playFunc),this.off("canplay",this.canPlayFunc),this.video.removeEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.video.removeEventListener("webkitendfullscreen",this._onWebkitendfullscreen)}},{key:"_startInit",value:function(t){var e=this;if(!!this.video&&(!!t&&""!==t&&("Array"!==k.typeOf(t)||0!==t.length)||(t="",this.emit(Q),y.logWarn("config.url is null, please get url and run player._startInit(url)"),!this.config.nullUrlStart))){this._detachSourceEvents(this.video),"Array"===k.typeOf(t)&&t.length>0?this._attachSourceEvents(this.video,t):this.video.src&&this.video.src===t?!t&&this.video.removeAttribute("src"):this.video.src=t,"Number"===k.typeOf(this.config.volume)&&(this.volume=this.config.volume);var n=this.innerContainer?this.innerContainer:this.root;this.video instanceof window.Element&&!n.contains(this.video)&&n.insertBefore(this.video,n.firstChild);var i=this.video.readyState;y.logInfo("_startInit readyState",i),this.config.autoplay&&(k.isMSE(this.video)||this.load(),(tZ.os.isIpad||tZ.os.isPhone)&&this.videoPlay()),i>=2?this.canPlayFunc():this.once(N,this.canPlayFunc),k.setTimeout(this,function(){e.isComplete=!0,e.emit(tn)},1),!this.hasStart&&eU.afterInit(this),this.hasStart=!0}}},{key:"_registerPlugins",value:function(){var t=this,e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this._loadingPlugins=[];var n=this.config.ignores||[],i=this.config.plugins||[],r=this.config.i18n||[];e&&e8.extend(r,this.__i18n);var o=n.join("||").toLowerCase().split("||"),a=this.plugins;i.forEach(function(n){try{var i=n.plugin?n.plugin.pluginName:n.pluginName;if(!i)return;var r=i.toLowerCase(),s=t.config[r]||t.config[i];if("Boolean"===k.typeOf(s)&&!s||o.indexOf(r)>-1||!e&&a[r])return;if(n.lazy&&n.loader){var u=eU.lazyRegister(t,n);n.forceBeforeInit&&(u.then(function(){t._loadingPlugins.splice(t._loadingPlugins.indexOf(u),1)}).catch(function(e){y.logError("_registerPlugins:loadingPlugin",e),t._loadingPlugins.splice(t._loadingPlugins.indexOf(u),1)}),t._loadingPlugins.push(u));return}return t.registerPlugin(n)}catch(t){y.logError("_registerPlugins:",t)}})}},{key:"_registerPresets",value:function(){var t=this;this.config.presets.forEach(function(e){eK(t,e)})}},{key:"_getRootByPosition",value:function(t){var e=null;switch(t){case eR.ROOT_RIGHT:e=this.rightBar;break;case eR.ROOT_LEFT:e=this.leftBar;break;case eR.ROOT_TOP:e=this.topBar;break;default:e=this.innerContainer||this.root}return e}},{key:"registerPlugin",value:function(t,e){var n=eU.formatPluginInfo(t,e),i=n.PLUFGIN,r=n.options,o=this.config.plugins;eU.checkPluginIfExits(i.pluginName,o)||o.push(i);var a=eU.getRootByConfig(i.pluginName,this.config);a.root&&(r.root=a.root),a.position&&(r.position=a.position);var s=r.position?r.position:r.config&&r.config.position||i.defaultConfig&&i.defaultConfig.position;return!r.root&&"string"==typeof s&&s.indexOf("controls")>-1?this.controls&&this.controls.registerPlugin(i,r,i.pluginName):(!r.root&&(r.root=this._getRootByPosition(s)),eU.register(this,i,r))}},{key:"deregister",value:function(t){var e,n,i=eU.unRegister(this,"string"==typeof t?t:t.pluginName);i&&null!==(e=this.config)&&void 0!==e&&e.unregisterPluginFromControls&&(null===(n=this.controls)||void 0===n||n.unregisterPlugin(i))}},{key:"unRegisterPlugin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!!t)this.deregister(t),e&&this.removePluginFromConfig(t)}},{key:"removePluginFromConfig",value:function(t){var e;if("string"==typeof t?e=t:t instanceof e_&&(e=t.pluginName),!!e){for(var n=this.config.plugins.length-1;n>-1;n--)if(this.config.plugins[n].pluginName.toLowerCase()===e.toLowerCase()){this.config.plugins.splice(n,1);break}}}},{key:"plugins",get:function(){return eU.getPlugins(this)}},{key:"getPlugin",value:function(t){var e=eU.findPlugin(this,t);return e&&e.pluginName?e:null}},{key:"addClass",value:function(t){if(!!this.root)!k.hasClass(this.root,t)&&k.addClass(this.root,t)}},{key:"removeClass",value:function(t){if(!!this.root)k.removeClass(this.root,t)}},{key:"hasClass",value:function(t){if(!!this.root)return k.hasClass(this.root,t)}},{key:"setAttribute",value:function(t,e){if(!!this.root)this.root.setAttribute(t,e)}},{key:"removeAttribute",value:function(t,e){if(!!this.root)this.root.removeAttribute(t,e)}},{key:"start",value:function(t){var e=this;if(!this.hasStart)return!t&&!this.config.url&&this.getInitDefinition(),this.hasStart=!0,this._registerPlugins(!1),eU.beforeInit(this).then(function(){if(!!e.config){!t&&(t=e.url||e.config.url);var n=e.preProcessUrl(t);return e._startInit(n.url)}}).catch(function(t){throw t.fileName="player",t.lineNumber="236",y.logError("start:beforeInit:",t),t})}},{key:"switchURL",value:function(t){var e=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];var n=t;"Object"===k.typeOf(t)&&(n=t.url);var i=this.currentTime,r=this.paused&&!this.isError;return this.src=n,new Promise(function(t){var n=function(){e.currentTime=i,r&&e.once("canplay",function(){e.pause()}),t()};tZ.os.isAndroid?e.once("timeupdate",function(){n()}):e.once("canplay",function(){n()}),e.play()})}},{key:"videoPlay",value:function(){var t=this;if(!this.hasStart){this.removeClass(eW.NO_START),this.addClass(eW.ENTER);var e=this.start();e&&e.then(function(e){t.config.autoplay||t.videoPlay()});return}!this.isPlaying&&(this.removeClass(eW.NO_START),this.isCanplay||this.addClass(eW.ENTER));var n=nf(ny(s.prototype),"play",this).call(this);return void 0!==n&&n&&n.then?n.then(function(){t.removeClass(eW.NOT_ALLOW_AUTOPLAY),t.addClass(eW.PLAYING),!t.isPlaying&&(y.logInfo(">>>>playPromise.then"),t.isPlaying=!0,t.emit(tt))}).catch(function(e){if(y.logWarn(">>>>playPromise.catch",e.name),t.video&&t.video.error){t.onError(),t.removeClass(eW.ENTER);return}"NotAllowedError"===e.name&&(t._errorTimer=k.setTimeout(t,function(){t._errorTimer=null,t.emit(te),t.addClass(eW.NOT_ALLOW_AUTOPLAY),t.removeClass(eW.ENTER),t.pause()},0)),"AbortError"===e.name&&(t._errorTimer=k.setTimeout(t,function(){t._errorTimer=null,t.emit(tu)},0))}):(y.logWarn("video.play not return promise"),!this.isPlaying&&(this.isPlaying=!0,this.removeClass(eW.NOT_ALLOW_AUTOPLAY),this.removeClass(eW.NO_START),this.removeClass(eW.ENTER),this.addClass(eW.PLAYING),this.emit(tt))),n}},{key:"videoPause",value:function(){nf(ny(s.prototype),"pause",this).call(this)}},{key:"play",value:function(){var t=this;this.removeClass(eW.PAUSED),ey(this,"play",function(){t.videoPlay()})}},{key:"pause",value:function(t){var e=this;ey(this,"pause",function(){t===ei.BUFFER_CONTROLS?!e.isBufferControlPaused&&(e.isBufferControlPaused=!0,e.emit(ts,{type:er.WAITING})):e.isBufferControlPaused&&(e.isBufferControlPaused=!1,e.emit(ts,{type:er.PLAYING})),nf(ny(s.prototype),"pause",e).call(e)},t)}},{key:"seek",value:function(t,e){var n=this;if(!(!this.video||Number.isNaN(Number(t)))&&!!this.hasStart){var i=this.config,r=i.isSeekedPlay,o=i.seekedStatus,a=e||(r?"play":o);t=t<0?0:t>this.duration?parseInt(this.duration,10):t,this._isPauseBeforeSeek||(this._isPauseBeforeSeek=this.paused?2:1),this._onceSeekCanplay&&this.off(L,this._onceSeekCanplay),this._onceSeekCanplay=function(){switch(n.removeClass(eW.ENTER),n.isSeeking=!1,a){case"play":n.play();break;case"pause":n.pause();break;default:n._isPauseBeforeSeek>1||n.paused?n.pause():n.play()}n._isPauseBeforeSeek=0,n._onceSeekCanplay=null},this.once(L,this._onceSeekCanplay),this.isPlaying?this.currentTime=t:(this.removeClass(eW.NO_START),this.currentTime=t,this.play())}}},{key:"getInitDefinition",value:function(){var t=this,e=this.config,n=e.definition;!e.url&&n&&n.list&&n.list.length>0&&n.defaultDefinition&&n.list.map(function(e){e.definition===n.defaultDefinition&&(t.config.url=e.url,t.curDefinition=e.definition)})}},{key:"changeDefinition",value:function(t,e){var n=this,i=this.config.definition;if(Array.isArray(null==i?void 0:i.list)&&i.list.forEach(function(e){(null==t?void 0:t.definition)===e.definition&&(n.curDefinition=e)}),null!=t&&t.bitrate&&"number"!=typeof t.bitrate&&(t.bitrate=parseInt(t.bitrate,10)||0),this.emit(tp,{from:e,to:t}),!this.hasStart){this.config.url=t.url;return}var r=this.switchURL(t.url);r&&r.then?r.then(function(){n.emit(ty,{from:e,to:t})}):this.emit(ty,{from:e,to:t})}},{key:"reload",value:function(){this.load(),this.reloadFunc=function(){this.play()},this.once("loadeddata",this.reloadFunc)}},{key:"resetState",value:function(){var t=this,e=eW.NOT_ALLOW_AUTOPLAY,n=eW.PLAYING,i=eW.NO_START,r=eW.PAUSED,o=eW.REPLAY,a=eW.ENTER,s=eW.ENDED,u=eW.ERROR,c=eW.LOADING;this.hasStart=!1,this.isError=!1,this.isPlaying=!1,this.videoPause(),this._accPlayed.acc=0,this._accPlayed.t=0,this._accPlayed.loopAcc=0,[e,n,i,r,o,a,s,u,c].forEach(function(e){t.removeClass(e)}),this.addClass(eW.ENTER),this.emit(tT)}},{key:"reset",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;if(this.resetState(),!!this.plugins){if(e.map(function(e){t.deregister(e)}),n){var i=eV();Object.keys(this.config).keys(function(e){"undefined"!==t.config[e]&&("plugins"===e||"presets"===e||"el"===e||"id"===e)&&(t.config[e]=i[e])})}}}},{key:"destroy",value:function(){var t,e=this,n=this.innerContainer,i=this.root,r=this.video;if(!!i&&!!r){if(i.removeAttribute(en),this.updateAcc("destroy"),this._unbindEvents(),this._detachSourceEvents(this.video),k.clearAllTimers(this),this.emit(tr),null===(t=nk)||void 0===t||t.remove(this),eU.destroy(this),ed(this),nf(ny(s.prototype),"destroy",this).call(this),this.fullscreen&&this._fullscreenEl===this.root)try{this.exitFullscreen()}catch(t){}if(n){for(var o=n.children,a=0;a<o.length;a++)n.removeChild(o[a])}!n&&r instanceof window.Node&&i.contains(r)&&r.parentNode.removeChild(r),["topBar","leftBar","rightBar","innerContainer"].map(function(t){e[t]&&i.removeChild(e[t]),e[t]=null});var u=i.className.split(" ");u.length>0?i.className=u.filter(function(t){return 0>t.indexOf("xgplayer")}).join(" "):i.className="",this.removeAttribute("data-xgfill"),["isReady","isPlaying","isSeeking","isCanplay","isActive","isCssfullScreen","fullscreen"].map(function(t){e[t]=!1})}}},{key:"replay",value:function(){var t=this;this.removeClass(eW.ENDED),this.currentTime=0,this.isSeeking=!1,ey(this,"replay",function(){t.once(L,function(){var e=t.videoPlay();e&&e.catch&&e.catch(function(t){})}),t.play(),t.emit(ti),t.onPlay()})}},{key:"retry",value:function(){var t=this;this.removeClass(eW.ERROR),this.addClass(eW.LOADING),ey(this,"retry",function(){var e=t.currentTime;t.src=t.config.url,t.config.isLive||(t.currentTime=e),t.once(N,function(){t.videoPlay()})})}},{key:"syncFullstate",value:function(){var t=k.getFullScreenEl();t&&t===this.config.fullscreenTarget&&(this.fullscreen=!0,this._fullscreenEl=t,!this._orgPCss&&(this._orgPCss=k.filterStyleFromText(t)))}},{key:"changeFullStyle",value:function(t,e,n,i){if(!!t)!i&&(i=eW.PARENT_FULLSCREEN),!this._orgCss&&(this._orgCss=k.filterStyleFromText(t)),k.addClass(t,n),e&&e!==t&&!this._orgPCss&&(this._orgPCss=k.filterStyleFromText(e),k.addClass(e,i),e.setAttribute(en,this.playerId))}},{key:"recoverFullStyle",value:function(t,e,n,i){!i&&(i=eW.PARENT_FULLSCREEN),this._orgCss&&(k.setStyleFromCsstext(t,this._orgCss),this._orgCss=""),k.removeClass(t,n),e&&e!==t&&this._orgPCss&&(k.setStyleFromCsstext(e,this._orgPCss),this._orgPCss="",k.removeClass(e,i),e.removeAttribute(en))}},{key:"getFullscreen",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.fullscreenTarget,n=this.root,i=this.video;if(!e&&(e=n),this._fullScreenOffset={top:k.scrollTop(),left:k.scrollLeft()},this._fullscreenEl=e,this._fullActionFrom="get",this.emit(tc),k.getFullScreenEl()===this._fullscreenEl)return this.onFullscreenChange(),Promise.resolve();try{for(var r=0;r<et.length;r++){var o=function(){var n=et[r];if(e[n]){var i="webkitRequestFullscreen"===n?e.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):e[n]();return i&&i.then?(i.then(function(){"get"===t._fullActionFrom&&t.changeFullStyle(t.root,e,eW.FULLSCREEN)}).catch(function(t){y.logWarn("".concat(n,": ").concat((null==t?void 0:t.message)||"getFullscreen fail"))}),{v:i}):(t.changeFullStyle(t.root,e,eW.FULLSCREEN),{v:Promise.resolve()})}}();if("object"===nc(o))return o.v}if(i.fullscreenEnabled||i.webkitSupportsFullscreen)return i.webkitEnterFullscreen(),Promise.resolve();return Promise.reject(Error("call getFullscreen fail"))}catch(t){return Promise.reject(t)}}},{key:"exitFullscreen",value:function(t){if(!!this._fullscreenEl||!!k.getFullScreenEl()){var e=this.root,n=this.video;t&&(t=e),this._fullActionFrom="exit";for(var i=0;i<ee.length;i++){var r=ee[i];if(document[r]){var o=document[r]();if(o&&o.then)return o;return Promise.resolve()}}return n&&n.webkitSupportsFullscreen?(n.webkitExitFullScreen(),Promise.resolve()):Promise.reject(Error("call exitFullscreen fail"))}}},{key:"getCssFullscreen",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.fullscreenTarget;this.fullscreen&&this.exitFullscreen(),this._cssfullscreenEl=t,this.changeFullStyle(this.root,t,t?eW.INNER_FULLSCREEN:eW.CSS_FULLSCREEN),this.isCssfullScreen=!0,this.emit(tf,!0)}},{key:"exitCssFullscreen",value:function(){var t=this._cssfullscreenEl?eW.INNER_FULLSCREEN:eW.CSS_FULLSCREEN;this.fullscreen?this.removeClass(t):this.recoverFullStyle(this.root,this._cssfullscreenEl,t),this._cssfullscreenEl=null,this.isCssfullScreen=!1,this.emit(tf,!1)}},{key:"focus",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{autoHide:!this.config.closeDelayBlur,delay:this.config.inactive};if(this.isActive){this.onFocus(t);return}this.emit(J,nu({paused:this.paused,ended:this.ended},t))}},{key:"blur",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{ignorePaused:!1};if(!this.isActive){this.onBlur(t);return}this.emit(Z,nu({paused:this.paused,ended:this.ended},t))}},{key:"onFocus",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{autoHide:!0,delay:3e3},n=this.innerStates;if(this.isActive=!0,this.removeClass(eW.ACTIVE),this.userTimer&&(k.clearTimeout(this,this.userTimer),this.userTimer=null),void 0!==e.isLock&&(n.isActiveLocked=e.isLock),!1===e.autoHide||!0===e.isLock||n.isActiveLocked){this.userTimer&&(k.clearTimeout(this,this.userTimer),this.userTimer=null);return}var i=e&&e.delay?e.delay:this.config.inactive;this.userTimer=k.setTimeout(this,function(){t.userTimer=null,t.blur()},i)}},{key:"onBlur",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{ignorePaused:!1};if(!!this.isActive&&!this.innerStates.isActiveLocked){var e=this.config.closePauseVideoFocus;this.isActive=!1,(t.ignorePaused||e||!this.paused&&!this.ended)&&this.addClass(eW.ACTIVE)}}},{key:"onEmptied",value:function(){this.updateAcc("emptied")}},{key:"onCanplay",value:function(){this.hasStart&&this.removeClass(eW.ENTER),this.isBufferControlPaused||this.removeClass(eW.LOADING),this.isCanplay=!0,this.waitTimer&&k.clearTimeout(this,this.waitTimer)}},{key:"onLoadeddata",value:function(){this.isError=!1}},{key:"onPlay",value:function(){this.removeClass(eW.PAUSED),this.ended&&this.removeClass(eW.ENDED),this.config.closePlayVideoFocus||this.focus()}},{key:"onPause",value:function(){this.isBufferControlPaused||this.addClass(eW.PAUSED),this.updateAcc("pause"),!this.config.closePauseVideoFocus&&(this.userTimer&&(k.clearTimeout(this,this.userTimer),this.userTimer=null),this.focus())}},{key:"onEnded",value:function(){this.isBufferControlPaused=!1,this.updateAcc("ended"),this.addClass(eW.ENDED)}},{key:"onError",value:function(){this.isBufferControlPaused=!1,this.isError=!0,this.updateAcc("error"),this.removeClass(eW.NOT_ALLOW_AUTOPLAY),this.removeClass(eW.NO_START),this.removeClass(eW.ENTER),this.removeClass(eW.LOADING),this.addClass(eW.ERROR)}},{key:"onSeeking",value:function(){!this.isSeeking&&this.updateAcc("seeking"),this.isSeeking=!0,this.addClass(eW.SEEKING)}},{key:"onSeeked",value:function(){this.isSeeking=!1,this.waitTimer&&k.clearTimeout(this,this.waitTimer),this.removeClass(eW.LOADING),this.removeClass(eW.SEEKING)}},{key:"onWaiting",value:function(){var t=this;this.waitTimer&&k.clearTimeout(this,this.waitTimer),this.updateAcc("waiting"),this.waitTimer=k.setTimeout(this,function(){t.addClass(eW.LOADING),k.clearTimeout(t,t.waitTimer),t.waitTimer=null},200)}},{key:"onPlaying",value:function(){var t=this;this.isError=!1;var e=eW.NO_START,n=eW.PAUSED,i=eW.ENDED,r=eW.ERROR,o=eW.REPLAY,a=eW.LOADING;[e,n,i,r,o,a].forEach(function(e){t.removeClass(e)})}},{key:"onTimeupdate",value:function(){this._videoHeight||this.getVideoSize(),(this.waitTimer||this.hasClass(eW.LOADING))&&this.video.readyState>2&&(this.isBufferControlPaused||this.removeClass(eW.LOADING),k.clearTimeout(this,this.waitTimer),this.waitTimer=null),!this.paused&&!this.isPlaying&&this.duration&&(this.isPlaying=!0,this.emit(tt)),!this._accPlayed.t&&!this.paused&&!this.ended&&(this._accPlayed.t=new Date().getTime())}},{key:"onVolumechange",value:function(){"Number"===k.typeOf(this.config.volume)&&(this.config.volume=this.volume)}},{key:"onRatechange",value:function(){this.config.defaultPlaybackRate=this.playbackRate}},{key:"onBufferControl",value:function(t){if(!!this.isPlaying)"waiting"===t.type?(this.isBufferControlPaused=!0,this.addClass(eW.LOADING),this.removeClass(eW.PAUSED)):"playing"===t.type&&(this.isBufferControlPaused=!1,this.removeClass(eW.LOADING),this.paused&&this.addClass(eW.PAUSED))}},{key:"emitUserAction",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!!this.video&&!!e&&!!t){var i="String"===k.typeOf(t)?t:t.type||"";"switch_play_pause"===e&&("Undefined"===k.typeOf(n.paused)&&(n.paused=this.paused),n.isFirstStart=!this.playing),this.emit(tO,nu({eventType:i,action:e,currentTime:this.currentTime,duration:this.duration,ended:this.ended,event:t},n))}}},{key:"updateAcc",value:function(t){if(this._accPlayed.t){var e=new Date().getTime(),n=e-this._accPlayed.t;if(!(n<0))this._accPlayed.acc+=n,this._accPlayed.t="get"===t?e:0,("ended"===t||this.ended)&&(this._accPlayed.loopAcc=this._accPlayed.acc)}}},{key:"checkBuffer",value:function(t){var e=this.video.buffered;if(!e||0===e.length||!this.duration)return!0;for(var n=parseInt(1e3*(t||this.video.currentTime||0),10),i=e.length,r=0;r<i;r++)if(parseInt(1e3*e.start(r),10)+200<=n&&parseInt(1e3*e.end(r),10)-200>n)return!0;return!1}},{key:"resizePosition",value:function(){var t=this.videoPos,e=t.rotate,n=t.vy,i=t.vx,r=t.h,o=t.w;if(e<0&&r<0&&o<0)return;var a=this.videoPos._pi;if(!a&&this.video.videoHeight&&(a=this.video.videoWidth/this.video.videoHeight*100),!!a){this.videoPos.pi=a;var s={},u=0,c=0,l=1,f=e<0?0:Math.abs(e/90),h=this.root,p=this.innerContainer,d=h.offsetWidth,y=p?p.offsetHeight:h.offsetHeight,v=y,g=d,m={width:d,height:y};if(f%2==0)l=r>0?100/r:o>0?100/o:1,s.scale=l,u=n>0?(100-r)/2-n:0,s.y=2===f?0-u:u,c=i>0?(100-o)/2-i:0,s.x=2===f?0-c:c,m.width=g,m.height=v;else if(f%2==1){g=y,v=d;var b=y-d;c=-b/2/g*100,s.x=3===f?c+n/2:c-n/2,u=b/2/v*100,s.y=3===f?u+i/2:u-i/2,s.scale=l,m.width=g,m.height=v}var w=this.video;e>=0&&["width","height"].forEach(function(t){w.style[t]="".concat(m[t],"px")}),s.rotate=e<0?0:e;var _=k.getTransformStyle(s,this.video.style.transform||this.video.style.webkitTransform);w.style.transform=_,w.style.webkitTransform=_}}},{key:"position",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{h:0,y:0,x:0,w:0};if(!!this.video&&!!t&&!!t.h){var e=this.videoPos;e.h=100*t.h||0,e.w=100*t.w||0,e.vx=100*t.x||0,e.vy=100*t.y||0,this.resizePosition()}}},{key:"setConfig",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{deepMerge:!1};if(!!t)Object.keys(t).map(function(i){if("plugins"!==i){n.deepMerge&&"Object"===k.typeOf(e.config[i])?k.deepMerge(e.config[i],t[i]):e.config[i]=t[i];var r=e.plugins[i.toLowerCase()];r&&"Function"===k.typeOf(r.setConfig)&&r.setConfig(t[i],n)}})}},{key:"playNext",value:function(t){var e=this;this.resetState(),this._currentTime=0,this._duration=0,this.isPlaying=!1,this.setConfig(t),this.vtype="MP4",ey(this,"playnext",function(){e.start(),e.emit(t_,t)})}},{key:"getVideoSize",value:function(){var t=this;if(!this.video)return;var e=this.root.getBoundingClientRect();this.sizeInfo.width=e.width,this.sizeInfo.height=e.height,this.sizeInfo.left=e.left,this.sizeInfo.top=e.top;var n=this.video,i=n.videoWidth,r=n.videoHeight,o=this.config,a=o.fitVideoSize,s=o.videoFillMode;if(("fill"===s||"cover"===s||"contain"===s)&&this.setAttribute("data-xgfill",s),!!r&&!!i){this._videoHeight=r,this._videoWidth=i;var u=this.controls&&this.innerContainer?this.controls.root.getBoundingClientRect().height:0,c=e.width,l=e.height-u,f=parseInt(i/r*1e3,10),h=parseInt(c/l*1e3,10),p=c,d=l,y={};"auto"===a&&h>f||"fixWidth"===a?(d=c/f*1e3,this.config.fluid?y.paddingTop="".concat(100*d/p,"%"):y.height="".concat(d+u,"px")):("auto"===a&&h<f||"fixHeight"===a)&&(p=f*l/1e3,y.width="".concat(p,"px")),!this.fullscreen&&!this.cssfullscreen&&Object.keys(y).forEach(function(e){t.root.style[e]=y[e]}),("fillHeight"===s&&h<f||"fillWidth"===s&&h>f)&&this.setAttribute("data-xgfill","cover");var v={videoScale:f,vWidth:p,vHeight:d,cWidth:p,cHeight:d+u};this.resizePosition(),this.emit(tm,v)}}},{key:"updateObjectPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.video.updateObjectPosition){this.video.updateObjectPosition(t,e);return}this.video.style.objectPosition="".concat(100*t,"% ").concat(100*e,"%")}},{key:"preProcessUrl",value:function(t,e){var n=this.config,i=n.preProcessUrl,r=Object.assign({},n.preProcessUrlOptions,e);return k.isBlob(t)||"function"!=typeof i?{url:t}:i(t,r)}},{key:"src",get:function(){return this.video?this.video.src:""},set:function(t){if(!!this.video){if(this.emit(to,t),this.emit(D),this._currentTime=0,this._duration=0,k.isMSE(this.video)){this.onWaiting();return}t=this.preProcessUrl(t).url,this._detachSourceEvents(this.video),"Array"===k.typeOf(t)?this._attachSourceEvents(this.video,t):t?this.video.src=t:this.video.removeAttribute("src"),this.load()}}},{key:"definitionList",get:function(){return this.config&&this.config.definition&&this.config.definition.list||[]},set:function(t){var e=this,n=this.config.definition;n.list=t,this.emit("resourceReady",t);var i=null,r=null;t.map(function(t){e.curDefinition===t.definition&&(i=t),n.defaultDefinition===t.definition&&(r=t)}),!r&&t.length>0&&(r=t[0]),i?this.changeDefinition(i):r&&this.changeDefinition(r)}},{key:"videoFrameInfo",get:function(){var t={total:0,dropped:0,corrupted:0,droppedRate:0,droppedDuration:0};if(!this.video||!this.video.getVideoPlaybackQuality)return t;var e=this.video.getVideoPlaybackQuality();return t.dropped=e.droppedVideoFrames||0,t.total=e.totalVideoFrames||0,t.corrupted=e.corruptedVideoFrames||0,t.total>0&&(t.droppedRate=t.dropped/t.total*100,t.droppedDuration=parseInt(this.cumulateTime/t.total*t.dropped,0)),t}},{key:"lang",get:function(){return this.config.lang},set:function(t){if(0!==e8.langKeys.filter(function(e){return e===t}).length||"zh"===t)this.config.lang=t,eU.setLang(t,this)}},{key:"i18n",get:function(){var t=this.config.lang;return"zh"===t&&(t="zh-cn"),this.__i18n.lang[t]||this.__i18n.lang.en}},{key:"i18nKeys",get:function(){return this.__i18n.textKeys||{}}},{key:"version",get:function(){return f}},{key:"playerId",get:function(){return this._pluginInfoId}},{key:"url",get:function(){return this.__url||this.config.url},set:function(t){this.__url=t}},{key:"poster",get:function(){return this.plugins.poster?this.plugins.poster.config.poster:this.config.poster},set:function(t){this.plugins.poster&&this.plugins.poster.update(t)}},{key:"readyState",get:function(){var t=nf(ny(s.prototype),"readyState",this);return this.i18n[t]||t}},{key:"error",get:function(){var t=nf(ny(s.prototype),"error",this);return this.i18n[t]||t}},{key:"networkState",get:function(){var t=nf(ny(s.prototype),"networkState",this);return this.i18n[t]||t}},{key:"fullscreenChanging",get:function(){return null!==this._fullScreenOffset}},{key:"cumulateTime",get:function(){var t=this._accPlayed;return this.updateAcc("get"),t.acc}},{key:"zoom",get:function(){return this.config.zoom},set:function(t){this.config.zoom=t}},{key:"videoRotateDeg",get:function(){return this.videoPos.rotate},set:function(t){if((t=k.convertDeg(t))%90==0&&t!==this.videoPos.rotate)this.videoPos.rotate=t,this.resizePosition()}},{key:"avgSpeed",get:function(){return nw},set:function(t){nw=t}},{key:"realTimeSpeed",get:function(){return nb},set:function(t){nb=t}},{key:"hook",value:function(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2],es.call.apply(es,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(t,e){return eu.call.apply(eu,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(t,e){return el.call.apply(el,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"usePluginHooks",value:function(t,e,n){for(var i=arguments.length,r=Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];return ef.call.apply(ef,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removePluginHooks",value:function(t,e,n){for(var i=arguments.length,r=Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];return eh.call.apply(eh,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"setUserActive",value:function(t,e){var n;"boolean"==typeof e&&e!==this.muted&&(this.addInnerOP("volumechange"),this.muted=e),null===(n=nk)||void 0===n||n.setActive(this.playerId,t)}}],o=[{key:"debugger",get:function(){return y.config.debug},set:function(t){y.config.debug=t}},{key:"instManager",get:function(){return nk},set:function(t){nk=t}},{key:"pluginsManager",get:function(){return eU}},{key:"getCurrentUserActivePlayerId",value:function(){var t;return null===(t=nk)||void 0===t?void 0:t.getActiveId()}},{key:"setCurrentUserActive",value:function(t,e){var n;null===(n=nk)||void 0===n||n.setActive(t,e)}},{key:"isHevcSupported",value:function(){return tZ.isHevcSupported()}},{key:"probeConfigSupported",value:function(t){return tZ.probeConfigSupported(t)}},{key:"install",value:function(t,e){!s.plugins&&(s.plugins={}),!s.plugins[t]&&(s.plugins[t]=e)}},{key:"use",value:function(t,e){!s.plugins&&(s.plugins={}),s.plugins[t]=e}}],r&&nl(i.prototype,r),o&&nl(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(t6);function nS(t){return(nS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nP(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function nO(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nP(Object(n),!0).forEach(function(e){nj(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nP(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}nv(n_,"defaultPreset",null),nv(n_,"XgVideoProxy",null),n_.instManager=na.getInstance();function nT(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,nR(i.key),i)}}function nE(t,e){return(nE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function nC(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nx(t){return(nx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nj(t,e,n){return(e=nR(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nR(t){var e=function(t,e){if("object"!==nS(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==nS(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===nS(e)?e:String(e)}function nA(){return new Date().getTime()}var nL={LOAD_START:"loadstart",LOADED_DATA:"loadeddata",FIRST_FRAME:"firstFrame",WAIT_START:"waitingStart",WAIT_END:"waitingEnd",SEEK_START:"seekStart",SEEK_END:"seekEnd",WAIT_END_EXT:"waitingEndExt",SEEK_END_EXT:"seekEndEndExt"},nI="[xgLogger]",nD=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nE(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=nx(e);return t=n?Reflect.construct(i,arguments,nx(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===nS(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return nC(t)}(this,t)});function s(){var t;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return nj(nC(t=a.call.apply(a,[this].concat(n))),"_onLoadedMetaData",function(){var e=t._state,n=e.isLs,i=e.autoplayStart,r=e.isFFSend,o=e.isLoadStartDelay;y.logInfo(nI,"LOAD_START Delay","autoplayStart:".concat(i," isFFSend:").concat(r," startCostTime:").concat(t.startCostTime," newPointTime:").concat(t.newPointTime,", vtype:").concat(t.player.vtype)),t.playerConfig.loadStartDelay&&n&&!o&&"MP4_MSE"===t.player.vtype&&(t._state.isLoadStartDelay=!0,t.emitLog(nL.LOAD_START,{}))}),nj(nC(t),"_onLoadStart",function(){var e=nC(t)._state,n=e.autoplayStart,i=e.isFFSend;if(t.startCostTime=nA()-t.newPointTime,y.logInfo(nI,"LOAD_START","autoplayStart:".concat(n," isFFSend:").concat(i," startCostTime:").concat(t.startCostTime," newPointTime:").concat(t.newPointTime,", vtype:").concat(t.player.vtype)),!i)!e.isLs&&(!t.playerConfig.loadStartDelay||"MP4_MSE"!==t.player.vtype)&&(e.isLoadStartDelay=!0,t.emitLog(nL.LOAD_START,{})),e.isLs=!0,e.isTimeUpdate=!1,e.isFFLoading=!0,t.pt=nA(),t.vt=0,t.fvt=0,t._initOnceEvents()}),nj(nC(t),"_onLoadedData",function(){t.vt=nA(),t.fvt=t.vt-t.pt,t.loadedCostTime=t.vt-t.newPointTime,t._updateBuffer();var e=t._state,n=e.isTimeUpdate,i=e.isFFSend,r=e.autoplayStart;y.logInfo(nI,"LOADED_DATA","fvt:".concat(t.fvt," isTimeUpdate:").concat(t._state.isTimeUpdate," loadedCostTime:").concat(t.loadedCostTime)),(n||r)&&t._sendFF("loadedData"),!i&&t.emitLog(nL.LOADED_DATA,{})}),nj(nC(t),"_onTimeupdate",function(){var e=nC(t)._state;e.isTimeUpdate=!0,e.time=t.player.currentTime,t._state.autoplayStart&&!e.isFFSend&&t._sendFF("onTimeupdate")}),nj(nC(t),"_onPlay",function(){var e=t.player.buffered,n=nC(t).levelInfo;y.logInfo(nI,"_onPlay playPos:".concat(n.startBuffer)),n.startBuffer<0&&(n.startBuffer=e.length>0?parseInt(1e3*e.end(0),10):0,n.startType="onplay")}),nj(nC(t),"_onAutoplayStart",function(){y.logInfo(nI,"_onAutoplayStart"),t._state.autoplayStart=!0,t.vt&&t._sendFF("onAutoplayStart")}),nj(nC(t),"_onReset",function(){t._state={time:0,autoplayStart:!1,isFFLoading:!1,isTimeUpdate:!1,isFFSend:!1,isLs:!1,isLoadStartDelay:!1},t.vt=0,t.pt=0,t.fvt=0,t.newPointTime=nA(),t.loadedCostTime=0,t.startCostTime=0,t.seekingStart=0,t.seekData={startTime:0,lastTime:0,timeBefore:0,timeAfter:0,inBuffer:0,diffStart:0,interval:-1},t.waitData={startTime:0,lastTime:0,interval:-1,diffStart:0},t.waitingStart=0,t.fixedWaitingStart=0,t.ffsendTime=0,t.levelInfo={diff:0,buffer:-1,startBuffer:-1,startType:""},t._isWaiting=!1,t._waitTimer&&k.clearTimeout(nC(t),t._waitTimer),t._waittTimer&&k.clearTimeout(nC(t),t._waittTimer),t._waitTimer=null,t._waittTimer=null,t._waitType=0}),nj(nC(t),"_onSeeking",function(){var e=nC(t),n=e.seekData,i=e._state;if(!n.startTime){var r=t.player,o=r.buffered,a=r.currentTime;n.startTime=nA(),n.timeBefore=i.time,n.timeAfter=a;var s=k.getBufferByCurrentTime(o,a);y.logInfo(nI,"onSeeking",a,s),n.inBuffer=s.include,n.diffStart=1e3*s.diff,n.lastTime>0?n.interval=n.startTime-n.lastTime:n.interval=-1,y.logInfo(nI,"onSeeking",n),t.suspendWaitingStatus("seek");var u=t._getSeekInfo();t.emitLog(nL.SEEK_START,nO({start:nA()},u))}}),nj(nC(t),"_onSeeked",function(){y.logInfo(nI,"onSeeked"),t.suspendSeekingStatus("seeked")}),nj(nC(t),"_onWaitingLoadStart",function(){if(!t._isWaiting&&!t.vt)t._isWaiting=!0,t.waitingStart=nA(),t.fixedWaitingStart=nA(),t._waitType=1,t.emitLog(nL.WAIT_START,{fixedStart:t.fixedWaitingStart,start:t.waitingStart,type:1,endType:"loadstart"})}),nj(nC(t),"_onWaiting",function(){if(!t._isWaiting&&!!t.vt){t._isWaiting=!0;var e=nC(t),n=e.waitData,i=e.seekData;e._state.isTimeUpdate||0!==i.startTime?i.startTime?t._waitType=2:t._waitType=0:t._waitType=1,t.fixedWaitingStart=nA(),y.logInfo(nI,"_onWaiting"),n.lastTime>0?n.interval=t.fixedWaitingStart-n.lastTime:n.interval=-1;var r=t.player,o=r.buffered,a=r.currentTime,s=k.getBufferByCurrentTime(o,a);n.diffStart=1e3*s.diff,t._waitTimer=k.setTimeout(nC(t),function(){y.logInfo(nI,"_onWaiting real");var e=nC(t).waitData;t._isWaiting?(t.waitingStart=nA(),k.clearTimeout(nC(t),t._waitTimer),e.lastTime=t.fixedWaitingStart,t._waitTimer=null,t._startWaitTimeout(),t.emitLog(nL.WAIT_START,{fixedStart:t.fixedWaitingStart,start:t.waitingStart,type:t._waitType,endType:2===t._waitType?"seek":"playing",diffStart:e.diffStart,interval:e.interval})):(e.interval=-1,e.diffStart=0)},200)}}),nj(nC(t),"_onError",function(){t.suspendSeekingStatus("error"),t.suspendWaitingStatus("error")}),nj(nC(t),"_onWaitingTimeout",function(e){t.suspendWaitingStatus(e||"timeout"),k.clearTimeout(nC(t),t._waittTimer),t._waittTimer=null}),nj(nC(t),"_onProgress",function(){y.logInfo(nI,"_onProgress")}),nj(nC(t),"_onPlaying",function(){y.logInfo(nI,"_onPlaying"),t._isWaiting&&t.suspendWaitingStatus("playing")}),t}return i=s,o=[{key:"pluginName",get:function(){return"xgLogger"}},{key:"defaultConfig",get:function(){return{waitTimeout:1e4}}}],r=[{key:"afterCreate",value:function(){var t=this;this._onReset(),this._waitType=-1,this._initOnceEvents(),this.newPointTime=nA(),this.loadedCostTime=0,this.startCostTime=0,this.ffsendTime=0,this.on(U,this._onLoadedMetaData),this.on(G,this._onLoadStart),this.on(H,this._onLoadedData),this.on(A,this._onSeeking),this.on(L,this._onSeeked),this.on(tr,function(){t.endState("destroy")}),this.on(x,function(){t.endState("ended")}),this.on(j,function(){t.endState("pause")}),this.on(E,this._onPlay),this.on(to,function(){t.endState("urlChange"),y.logInfo(nI,"URL_CHANGE"),t._state.isFFSend&&t._onReset()}),this.on([C,N],this._onPlaying),this.on(D,this._onWaiting),this.on(R,this._onError),this.on(tT,function(){y.logInfo(nI,"RESET"),t.endState("reset"),t._initOnceEvents(),t._onReset();var e=t.levelInfo;t.playerConfig.autoplay&&(e.startType="onreset",e.startBuffer=0)})}},{key:"_initOnceEvents",value:function(){this.off(tt,this._onAutoplayStart),this.off(I,this._onTimeupdate),this.once(tt,this._onAutoplayStart),this.on(I,this._onTimeupdate)}},{key:"_sendFF",value:function(t){var e=this._state,n=e.isFFLoading,i=e.isFFSend;if(y.logInfo(nI,"_sendFF","".concat(t," fvt:").concat(this.fvt," isFFLoading:").concat(n," !isFFSend:").concat(!i)),this.vt>0&&n&&!i){this.ffsendTime=nA();var r,o=this.levelInfo,a=o.buffer,s=o.startBuffer,u=o.startType;y.logInfo(nI,"emitLog_firstFrame",t,"startBuffer:".concat(s," startType:").concat(u," buffer:").concat(a," ")),this._state.isFFLoading=!1,this._state.isFFSend=!0;var c=this.fvt+((null===(r=this.player)||void 0===r?void 0:r.beforeLoadStartCostTime)||0);this.emitLog(nL.FIRST_FRAME,{fvt:this.fvt,costTime:c,vt:this.vt,startCostTime:this.startCostTime,loadedCostTime:this.loadedCostTime,buffer:a,startBuffer:s,endType:t})}}},{key:"_updateBuffer",value:function(){var t=this.player,e=t.buffered,n=t.currentTime,i=k.getBufferByCurrentTime(e,n);y.logInfo(nI,"_updateBuffer",i);var r=this.levelInfo;r.buffer=1e3*i.end,r.diff=1e3*i.diff}},{key:"_getSeekInfo",value:function(){var t=this.seekData;return{interval:t.interval,timeBefore:t.timeBefore,timeAfter:t.timeAfter,inBuffer:t.inBuffer,diffStart:t.diffStart}}},{key:"_startWaitTimeout",value:function(){this._waittTimer&&k.clearTimeout(this,this._waittTimer),this._waittTimer=k.setTimeout(this,this._onWaitingTimeout,this.config.waitTimeout)}},{key:"endState",value:function(t){var e=this.player,n=e.currentTime,i=e.duration,r=i-n,o=!(i>0&&n>0&&r<1);y.logInfo(nI,"endState:".concat(t," duration - currentTime:").concat(r," _emit:").concat(o)),this.suspendWaitingStatus(t,o),this.suspendSeekingStatus(t,o)}},{key:"suspendSeekingStatus",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=this.seekData;if(!!n.startTime){var i=nA(),r=i-n.startTime,o=this.player,a=o.buffered,s=o.currentTime,u=k.getBufferByCurrentTime(a,s);y.logInfo(nI,"suspendSeekingStatus",s,r),n.lastTime=n.startTime,n.startTime=0;var c=e?nL.SEEK_END:nL.SEEK_END_EXT,l=this._getSeekInfo();this.emitLog(c,nO(nO({end:i,costTime:r,endType:t},l),{},{diffEnd:1e3*u.diff}))}}},{key:"suspendWaitingStatus",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(this._waitTimer&&(k.clearTimeout(this,this._waitTimer),this._waitTimer=null),this._waittTimer&&(k.clearTimeout(this,this._waittTimer),this._waittTimer=null),this._isWaiting=!1,!!this.waitingStart){var n=this.waitData,i=nA(),r=i-this.waitingStart,o=i-this.fixedWaitingStart,a=this.config.waitTimeout;this._isWaiting=!1,this.waitingStart=0,this.fixedWaitingStart=0;var s=this.player,u=s.buffered,c=s.currentTime,l=k.getBufferByCurrentTime(u,c),f=e?nL.WAIT_END:nL.WAIT_END_EXT;this.emitLog(f,{fixedCostTime:o>a?a:o,costTime:r>a?a:r,type:"loadeddata"===t?1:this._waitType,endType:2===this._waitType?"seek":t,diffStart:n.diffStart,diffEnd:1e3*l.diff,interval:n.interval})}}},{key:"emitLog",value:function(t,e){var n=this.player,i=n.video,r=i.readyState,o=i.networkState;this.emit(tP,nO({t:nA(),host:k.getHostFromUrl(n.currentSrc),vtype:n.vtype,eventType:t,currentTime:n.currentTime,readyState:r,networkState:o},e))}}],nT(i.prototype,r),o&&nT(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function nN(t){return(nN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nM(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==nN(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==nN(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===nN(e)?e:String(e)}(i.key),i)}}function nB(t,e){return(nB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function nF(t){return(nF=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var nH=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nB(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=nF(e);return t=n?Reflect.construct(i,arguments,nF(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===nN(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,o=[{key:"pluginName",get:function(){return"replay"}},{key:"defaultConfig",get:function(){return{disable:!1}}}],r=[{key:"registerIcons",value:function(){return{replay:'<svg class="xgplayer-replay-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 78 78" width="78" height="78"><path fill="#fff" d="M28.227 33.876l3.04-1.229a1 1 0 011.303.553l.374.927a1 1 0 01-.552 1.302l-5.564 2.247-.927.375a1 1 0 01-1.302-.553l-2.622-6.49a1 1 0 01.553-1.302l.927-.374a1 1 0 011.302.552l.92 2.278A15.005 15.005 0 0139.5 23c8.284 0 15 6.716 15 15 0 8.284-6.716 15-15 15a14.955 14.955 0 01-10.63-4.417 1.5 1.5 0 112.126-2.116A11.956 11.956 0 0039.5 50c6.627 0 12-5.373 12-12s-5.373-12-12-12a12.005 12.005 0 00-11.273 7.876z"/></svg>'}}},{key:"afterCreate",value:function(){var t=this;eD.insert(this.icons.replay,this.root,0),this.__handleReplay=this.hook("replayHandler",function(){t.player.replay()},{pre:function(t){t.preventDefault(),t.stopPropagation()}}),this.bind(".xgplayer-replay",["click","touchend"],this.__handleReplay),this.on(x,function(){if(!t.playerConfig.loop&&k.addClass(t.player.root,"replay"),!t.config.disable){t.show();var e=t.root.querySelector("path");if(e){var n=window.getComputedStyle(e).getPropertyValue("transform");if("string"==typeof n&&n.indexOf("none")>-1)return null;e.setAttribute("transform",n)}}}),this.on(E,function(){t.hide()})}},{key:"handleReplay",value:function(t){t.preventDefault(),t.stopPropagation(),this.player.replay(),k.removeClass(this.player.root,"replay")}},{key:"show",value:function(){if(!this.config.disable)this.root.style.display="flex"}},{key:"enable",value:function(){this.config.disable=!1}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){this.unbind(".xgplayer-replay",["click","touchend"],this.__handleReplay)}},{key:"render",value:function(){return'<xg-replay class="xgplayer-replay">\n      <xg-replay-txt class="xgplayer-replay-txt" lang-key="'.concat(this.i18nKeys.REPLAY,'">').concat(this.i18n.REPLAY,"</xg-replay-txt>\n    </xg-replay>")}}],nM(i.prototype,r),o&&nM(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function nU(t){return(nU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nW(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==nU(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==nU(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===nU(e)?e:String(e)}(i.key),i)}}function nV(t,e){return(nV=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function nG(t){return(nG=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var nz=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nV(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=nG(e);return t=n?Reflect.construct(i,arguments,nG(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===nU(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,o=[{key:"pluginName",get:function(){return"poster"}},{key:"defaultConfig",get:function(){return{isEndedShow:!0,hideCanplay:!1,poster:""}}}],r=[{key:"isEndedShow",get:function(){return this.config.isEndedShow},set:function(t){this.config.isEndedShow=t}},{key:"hide",value:function(){k.addClass(this.root,"hide")}},{key:"show",value:function(){k.removeClass(this.root,"hide")}},{key:"beforeCreate",value:function(t){"string"==typeof t.player.config.poster&&(t.config.poster=t.player.config.poster)}},{key:"afterCreate",value:function(){var t=this;this.on(x,function(){t.isEndedShow&&k.removeClass(t.root,"hide")}),this.config.hideCanplay?(this.once(I,function(){t.onTimeUpdate()}),this.on(to,function(){k.removeClass(t.root,"hide"),k.addClass(t.root,"xg-showplay"),t.once(I,function(){t.onTimeUpdate()})})):this.on(E,function(){k.addClass(t.root,"hide")})}},{key:"onTimeUpdate",value:function(){var t=this;this.player.currentTime?k.removeClass(this.root,"xg-showplay"):this.once(I,function(){t.onTimeUpdate()})}},{key:"update",value:function(t){if(!!t)this.config.poster=t,this.root.style.backgroundImage="url(".concat(t,")")}},{key:"render",value:function(){var t=this.config,e=t.poster,n=t.hideCanplay;return'<xg-poster class="xgplayer-poster '.concat(n?"xg-showplay":"",'" style="').concat(e?"background-image:url(".concat(e,");"):"",'">\n    </xg-poster>')}}],nW(i.prototype,r),o&&nW(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function nK(t){return(nK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nY(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,n$(i.key),i)}}function nX(t,e){return(nX=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function nq(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nJ(t){return(nJ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nZ(t,e,n){return(e=n$(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n$(t){var e=function(t,e){if("object"!==nK(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==nK(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===nK(e)?e:String(e)}var nQ={},n0=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nX(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=nJ(e);return t=n?Reflect.construct(i,arguments,nJ(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===nK(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return nq(t)}(this,t)});function s(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),nZ(nq(e=a.call(this,t)),"onPlayerReset",function(){e.autoPlayStart=!1;var t="auto"===e.config.mode?"auto-hide":"hide";e.setAttr("data-state","play"),k.removeClass(e.root,t),e.show()}),nZ(nq(e),"onAutoplayStart",function(){if(!e.autoPlayStart){var t="auto"===e.config.mode?"auto-hide":"hide";k.addClass(e.root,t),e.autoPlayStart=!0,e.onPlayPause("play")}}),e.autoPlayStart=!1,e._lastState="",e}return i=s,o=[{key:"pluginName",get:function(){return"start"}},{key:"defaultConfig",get:function(){return{isShowPause:!1,isShowEnd:!1,disableAnimate:!1,mode:"hide"}}}],r=[{key:"afterCreate",value:function(){var t=this,e=this.player,n=this.playerConfig;this.initIcons(),this.once($,function(){n&&(n.lang&&"en"===n.lang?k.addClass(e.root,"lang-is-en"):"jp"===n.lang&&k.addClass(e.root,"lang-is-jp"))}),this.on(tt,this.onAutoplayStart),!n.autoplay&&this.show(),this.on(te,function(){var e="auto"===t.config.mode?"auto-hide":"hide";t.setAttr("data-state","play"),k.removeClass(t.root,e),t.show()}),this.on(E,function(){t.onPlayPause("play")}),this.on(j,function(){t.onPlayPause("pause")}),this.on(ts,function(){t.onPlayPause(e.paused?"pause":"play")}),this.on(tT,function(){t.onPlayerReset()}),this.clickHandler=this.hook("click",this.switchPausePlay,{pre:function(e){e.cancelable&&e.preventDefault(),e.stopPropagation(),t.emitUserAction(e,"switch_play_pause")}}),this.bind(["click","touchend"],this.clickHandler)}},{key:"registerIcons",value:function(){return{startPlay:{icon:'<svg class="play" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40"><path fill="#fff" d="M18.468 11.639l7.503 4.777-7.503 4.777zM10.965 6.86l7.503 4.778v9.554l-7.503 4.778z"/></svg>',class:"xg-icon-play"},startPause:{icon:'<svg class="pause" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40"><path fill="#fff" d="M19.173 6.861h5.451v19.11h-5.45V6.86zM8.208 25.971V6.86h5.45v19.11h-5.45z"/></svg>',class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var t=this.icons;this.appendChild("xg-start-inner",t.startPlay),this.appendChild("xg-start-inner",t.startPause)}},{key:"hide",value:function(){k.addClass(this.root,"hide")}},{key:"show",value:function(){k.removeClass(this.root,"hide")}},{key:"focusHide",value:function(){k.addClass(this.root,"focus-hide")}},{key:"recover",value:function(){k.removeClass(this.root,"focus-hide")}},{key:"switchStatus",value:function(t){t?this.setAttr("data-state",this.player.paused?"pause":"play"):this.setAttr("data-state",this.player.paused?"play":"pause")}},{key:"animate",value:function(t){var e=this;!function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{start:null,end:null};nQ[t]&&window.clearTimeout(nQ[t].id),nQ[t]={},n.start&&n.start(),nQ[t].id=window.setTimeout(function(){n.end&&n.end(),window.clearTimeout(nQ[t].id),delete nQ[t]},e)}("pauseplay",400,{start:function(){k.addClass(e.root,"interact"),e.show(),e.switchStatus(!0)},end:function(){k.removeClass(e.root,"interact"),t||e.hide()}})}},{key:"switchPausePlay",value:function(t){var e=this.player;if(t.cancelable&&t.preventDefault(),t.stopPropagation(),!!e.isReady)!this.player.paused&&e.isPlaying?e.pause():e.play()}},{key:"onPlayPause",value:function(t){var e=this.config,n=this.player;if(!!n.isPlaying&&!!this.autoPlayStart&&("pause"!==t||this._lastState!==t&&!n.isBufferControlPaused)){if(this._lastState=t,"show"===e.mode){this.switchStatus(),this.show();return}if("auto"===e.mode){this.switchStatus();return}if(e.isShowPause&&n.paused&&!n.ended||e.isShowEnd&&n.ended){this.switchStatus(),this.show();return}if(e.disableAnimate){this.switchStatus(),this.hide();return}if("play"===t)this.autoPlayStart?this.animate():this.hide();else{if(!this.autoPlayStart||n.ended)return;this.animate()}}}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.clickHandler),Object.keys(nQ).map(function(t){window.clearTimeout(nQ[t].id),delete nQ[t]})}},{key:"render",value:function(){var t=this.playerConfig.autoplay?"auto"===this.config.mode?"auto-hide":"hide":"";return'\n    <xg-start class="xgplayer-start '.concat(t,'">\n    <xg-start-inner></xg-start-inner>\n    </xg-start>')}}],nY(i.prototype,r),o&&nY(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function n1(t){return(n1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n2(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==n1(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==n1(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===n1(e)?e:String(e)}(i.key),i)}}function n3(t,e){return(n3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function n4(t){return(n4=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var n6=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n3(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=n4(e);return t=n?Reflect.construct(i,arguments,n4(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===n1(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,o=[{key:"pluginName",get:function(){return"enter"}},{key:"defaultConfig",get:function(){return{innerHtml:"",logo:""}}}],r=[{key:"render",value:function(){var t=this.config.innerHtml,e=k.createDom("xg-enter","",{},"xgplayer-enter");if(t&&t instanceof window.HTMLElement)e.appendChild(t);else if(t&&"string"==typeof t)e.innerHTML=t;else{for(var n="",i=1;i<=12;i++)n+='<div class="xgplayer-enter-bar'.concat(i,'"></div>');e.innerHTML='<div class="xgplayer-enter-spinner">'.concat(n,"</div>")}return e}}],n2(i.prototype,r),o&&n2(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function n5(t){return(n5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n9(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==n5(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==n5(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===n5(e)?e:String(e)}(i.key),i)}}function n8(t,e){return(n8=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function n7(t){return(n7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var it=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n8(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=n7(e);return t=n?Reflect.construct(i,arguments,n7(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===n5(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,r=[{key:"afterCreate",value:function(){this.getMini=this.getMini.bind(this),this.exitMini=this.exitMini.bind(this),this.bind("click",this.getMini)}},{key:"getMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"exitMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.getMini)}},{key:"render",value:function(){var t="MINISCREEN";return'\n      <xg-icon class="xgplayer-miniicon">\n      <div class="xgplayer-icon btn-text"><span class="icon-text" lang-key="'.concat(this.i18nKeys[t],'">').concat(this.i18n[t],"</span></div>\n      </xg-icon>")}}],o=[{key:"pluginName",get:function(){return"miniscreenIcon"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_RIGHT,index:10}}}],r&&n9(i.prototype,r),o&&n9(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function ie(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==ia(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==ia(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ia(e)?e:String(e)}(i.key),i)}}function ii(t,e){return(ii=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ir(t,e){if(e&&("object"===ia(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function io(t){return(io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ia(t){return(ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function is(t){var e=parseFloat(t);return -1===t.indexOf("%")&&!Number.isNaN(e)&&e}var iu=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],ic=iu.length;function il(t){if("string"==typeof t&&(t=document.querySelector(t)),!!t&&"object"===ia(t)&&!!t.nodeType){var e,n=(e=t,window.getComputedStyle(e));if("none"===n.display)return function(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;e<ic;e++)t[iu[e]]=0;return t}();var i={};i.width=t.offsetWidth,i.height=t.offsetHeight;for(var r=i.isBorderBox="border-box"===n.boxSizing,o=0;o<ic;o++){var a=iu[o],s=parseFloat(n[a]);i[a]=Number.isNaN(s)?0:s}var u=i.paddingLeft+i.paddingRight,c=i.paddingTop+i.paddingBottom,l=i.marginLeft+i.marginRight,f=i.marginTop+i.marginBottom,h=i.borderLeftWidth+i.borderRightWidth,p=i.borderTopWidth+i.borderBottomWidth,d=is(n.width);!1!==d&&(i.width=d+(r?0:u+h));var y=is(n.height);return!1!==y&&(i.height=y+(r?0:c+p)),i.innerWidth=i.width-(u+h),i.innerHeight=i.height-(c+p),i.outerWidth=i.width+l,i.outerHeight=i.height+f,i}}function ih(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(i.identifier===e)return i}}var ip={START:"dragStart",MOVE:"dragMove",ENDED:"dragEnded"},id={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]},iy=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ii(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=io(e);return t=n?Reflect.construct(i,arguments,io(this).constructor):i.apply(this,arguments),ir(this,t)});function s(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),(e=a.call(this)).isEnabled=!0,e.isDragging=!1,e.isDown=!1,e.position={},e.downPoint={},e.dragPoint={x:0,y:0},e.startPos={x:0,y:0},e._root=t instanceof Element?t:document.querySelector(t),e._handlerDom=n.handle instanceof Element?n.handle:document.querySelector(n.handle),e._root&&e._handlerDom)?(e._bindStartEvent(),e):ir(e)}return i=s,r=[{key:"_bindStartEvent",value:function(){var t=this;"ontouchstart"in window?this._startKey="touchstart":this._startKey="mousedown",this["on".concat(this._startKey)]=this["on".concat(this._startKey)].bind(this),this._handlerDom.addEventListener(this._startKey,this["on".concat(this._startKey)]),id[this._startKey].map(function(e){t["on".concat(e)]=t["on".concat(e)].bind(t)})}},{key:"_unbindStartEvent",value:function(){this._handlerDom.removeEventListener(this._startKey,this["on".concat(this._startKey)])}},{key:"_bindPostStartEvents",value:function(t){var e=this;if(!!t){var n=id[this._startKey];n.map(function(t){window.addEventListener(t,e["on".concat(t)])}),this._boundPointerEvents=n}}},{key:"_unbindPostStartEvents",value:function(){var t=this;if(!!this._boundPointerEvents)this._boundPointerEvents.map(function(e){window.removeEventListener(e,t["on".concat(e)])}),delete this._boundPointerEvents}},{key:"enable",value:function(){this.isEnabled=!0}},{key:"disable",value:function(){this.isEnabled=!1,this.isDragging&&this.onUp()}},{key:"onDocUp",value:function(t){this.onUp()}},{key:"animate",value:function(){var t=this;if(!!this.isDragging)this.positionDrag(),window.requestAnimationFrame(function(){t.animate()})}},{key:"positionDrag",value:function(){var t="translate3d(".concat(this.dragPoint.x,"px, ").concat(this.dragPoint.y,"px, 0)");this._root.style.transform=t,this._root.style.webKitTransform=t}},{key:"setLeftTop",value:function(){this._root.style.left=this.position.x+"px",this._root.style.top=this.position.y+"px"}},{key:"onmousedown",value:function(t){this.dragStart(t,t)}},{key:"onmousemove",value:function(t){this.dragMove(t,t)}},{key:"onmouseup",value:function(t){this.dragEnd(t,t)}},{key:"ontouchstart",value:function(t){var e=t.changedTouches[0];this.dragStart(t,e),this.touchIdentifier=void 0!==e.pointerId?e.pointerId:e.identifier,t.preventDefault()}},{key:"ontouchmove",value:function(t){var e=ih(t.changedTouches,this.touchIdentifier);e&&this.dragMove(t,e)}},{key:"ontouchend",value:function(t){var e=ih(t.changedTouches,this.touchIdentifier);e&&this.dragEnd(t,e),t.preventDefault()}},{key:"ontouchcancel",value:function(t){var e=ih(t.changedTouches,this.touchIdentifier);e&&this.dragCancel(t,e)}},{key:"dragStart",value:function(t,e){if(!!this._root&&!this.isDown&&!!this.isEnabled){this.downPoint=e,this.dragPoint.x=0,this.dragPoint.y=0,this._getPosition();var n=il(this._root);this.startPos.x=this.position.x,this.startPos.y=this.position.y,this.startPos.maxY=window.innerHeight-n.height,this.startPos.maxX=window.innerWidth-n.width,this.setLeftTop(),this.isDown=!0,this._bindPostStartEvents(t)}}},{key:"dragRealStart",value:function(t,e){this.isDragging=!0,this.animate(),this.emit(ip.START,this.startPos)}},{key:"dragEnd",value:function(t,e){if(!!this._root)this._unbindPostStartEvents(),this.isDragging&&(this._root.style.transform="",this.setLeftTop(),this.emit(ip.ENDED)),this.presetInfo()}},{key:"_dragPointerMove",value:function(t,e){var n={x:e.pageX-this.downPoint.pageX,y:e.pageY-this.downPoint.pageY};return!this.isDragging&&this.hasDragStarted(n)&&this.dragRealStart(t,e),n}},{key:"dragMove",value:function(t,e){if(t=t||window.event,!!this.isDown){var n=this.startPos,i=n.x,r=n.y,o=this._dragPointerMove(t,e),a=o.x,s=o.y;a=this.checkContain("x",a,i),s=this.checkContain("y",s,r),this.position.x=i+a,this.position.y=r+s,this.dragPoint.x=a,this.dragPoint.y=s,this.emit(ip.MOVE,this.position)}}},{key:"dragCancel",value:function(t,e){this.dragEnd(t,e)}},{key:"presetInfo",value:function(){this.isDragging=!1,this.startPos={x:0,y:0},this.dragPoint={x:0,y:0},this.isDown=!1}},{key:"destroy",value:function(){this._unbindStartEvent(),this._unbindPostStartEvents(),this.isDragging&&this.dragEnd(),this.removeAllListeners(),this._handlerDom=null}},{key:"hasDragStarted",value:function(t){return Math.abs(t.x)>3||Math.abs(t.y)>3}},{key:"checkContain",value:function(t,e,n){return e+n<0?0-n:"x"===t&&e+n>this.startPos.maxX?this.startPos.maxX-n:"y"===t&&e+n>this.startPos.maxY?this.startPos.maxY-n:e}},{key:"_getPosition",value:function(){var t=window.getComputedStyle(this._root),e=this._getPositionCoord(t.left,"width"),n=this._getPositionCoord(t.top,"height");this.position.x=Number.isNaN(e)?0:e,this.position.y=Number.isNaN(n)?0:n,this._addTransformPosition(t)}},{key:"_addTransformPosition",value:function(t){var e=t.transform;if(0===e.indexOf("matrix")){var n=e.split(","),i=0===e.indexOf("matrix3d")?12:4,r=parseInt(n[i],10),o=parseInt(n[i+1],10);this.position.x+=r,this.position.y+=o}}},{key:"_getPositionCoord",value:function(t,e){if(-1!==t.indexOf("%")){var n=il(this._root.parentNode);return n?parseFloat(t)/100*n[e]:0}return parseInt(t,10)}}],ie(i.prototype,r),Object.defineProperty(i,"prototype",{writable:!1}),s}(l());function iv(t){return(iv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ig(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i_(i.key),i)}}function im(t,e){return(im=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ib(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iw(t){return(iw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ik(t,e,n){return(e=i_(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i_(t){var e=function(t,e){if("object"!==iv(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==iv(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===iv(e)?e:String(e)}var iS=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&im(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=iw(e);return t=n?Reflect.construct(i,arguments,iw(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===iv(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return ib(t)}(this,t)});function s(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),ik(ib(e=a.call(this,t)),"onCancelClick",function(t){e.exitMini(),e.isClose=!0}),ik(ib(e),"onCenterClick",function(t){var n=ib(e).player;n.paused?n.play():n.pause()}),ik(ib(e),"onScroll",function(t){if(!(!window.scrollY&&0!==window.scrollY||50>Math.abs(window.scrollY-e.pos.scrollY))){var n=parseInt(k.getCss(e.player.root,"height"));n+=e.config.scrollTop,e.pos.scrollY=window.scrollY,window.scrollY>n+5?e.isMini||e.isClose||e.getMini():window.scrollY<=n&&(e.isMini&&e.exitMini(),e.isClose=!1)}}),e.isMini=!1,e.isClose=!1;var e,n=ib(e).config;return e.pos={left:n.left<0?window.innerWidth-n.width-20:n.left,top:n.top<0?window.innerHeight-n.height-20:n.top,height:e.config.height,width:e.config.width,scrollY:window.scrollY||0},e.lastStyle=null,e}return i=s,o=[{key:"pluginName",get:function(){return"miniscreen"}},{key:"defaultConfig",get:function(){return{index:10,disable:!1,width:320,height:180,left:-1,top:-1,isShowIcon:!1,isScrollSwitch:!1,scrollTop:0,disableDrag:!1}}}],r=[{key:"beforeCreate",value:function(t){"boolean"==typeof t.player.config.mini&&(t.config.isShowIcon=t.player.config.mini)}},{key:"afterCreate",value:function(){var t=this;this.initIcons(),this.on(j,function(){t.setAttr("data-state","pause")}),this.on(E,function(){t.setAttr("data-state","play")})}},{key:"onPluginsReady",value:function(){var t=this,e=this.player;if(!this.config.disable){this.config.isShowIcon&&e.controls.registerPlugin(it,{config:{onClick:function(){t.getMini()}}},it.pluginName);var n=k.checkTouchSupport()?"touchend":"click";this.bind(".mini-cancel-btn",n,this.onCancelClick),this.bind(".play-icon",n,this.onCenterClick),!this.config.disableDrag&&(this._draggabilly=new iy(this.player.root,{handle:this.root})),this.config.isScrollSwitch&&window.addEventListener("scroll",this.onScroll)}}},{key:"registerIcons",value:function(){return{play:{icon:'<svg class="play" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40"><path fill="#fff" d="M18.468 11.639l7.503 4.777-7.503 4.777zM10.965 6.86l7.503 4.778v9.554l-7.503 4.778z"/></svg>',class:"xg-icon-play"},pause:{icon:'<svg class="pause" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40"><path fill="#fff" d="M19.173 6.861h5.451v19.11h-5.45V6.86zM8.208 25.971V6.86h5.45v19.11h-5.45z"/></svg>',class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var t=this.icons;this.appendChild(".play-icon",t.play),this.appendChild(".play-icon",t.pause)}},{key:"getMini",value:function(){var t=this;if(!this.isMini){var e=this.player,n=this.playerConfig,i=this.config.target||this.player.root;this.lastStyle={},k.addClass(e.root,"xgplayer-mini"),["width","height","top","left"].map(function(e){t.lastStyle[e]=i.style[e],i.style[e]="".concat(t.pos[e],"px")}),n.fluid&&(i.style["padding-top"]=""),this.emit(th,!0),e.isMini=this.isMini=!0}}},{key:"exitMini",value:function(){var t=this;if(!this.isMini)return!1;var e=this.player,n=this.playerConfig,i=this.config.target||this.player.root;k.removeClass(e.root,"xgplayer-mini"),this.lastStyle&&Object.keys(this.lastStyle).map(function(e){i.style[e]=t.lastStyle[e]}),this.lastStyle=null,n.fluid&&(e.root.style.width="100%",e.root.style.height="0",e.root.style["padding-top"]="".concat(100*n.height/n.width,"%")),this.emit(th,!1),this.isMini=e.isMini=!1}},{key:"destroy",value:function(){window.removeEventListener("scroll",this.onScroll);var t=k.checkTouchSupport()?"touchend":"click";this.unbind(".mini-cancel-btn",t,this.onCancelClick),this.unbind(".play-icon",t,this.onCenterClick),this._draggabilly&&this._draggabilly.destroy(),this._draggabilly=null,this.exitMini()}},{key:"render",value:function(){if(!this.config.disable)return'\n      <xg-mini-layer class="xg-mini-layer">\n      <xg-mini-header class="xgplayer-mini-header">\n      <div lang-key="'.concat(this.i18nKeys.MINI_DRAG,'">').concat(this.i18n.MINI_DRAG,'</div>\n      </xg-mini-header>\n      <div class="mini-cancel-btn">\n        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n          <path fill="#fff" fill-rule="evenodd" d="M3.99 3.49a1 1 0 0 1 1.414 0L10 8.085l4.596-4.595a1 1 0 1 1 1.414 1.414L11.414 9.5l4.596 4.596a1 1 0 0 1 .084 1.32l-.084.094a1 1 0 0 1-1.414 0L10 10.914 5.404 15.51a1 1 0 0 1-1.414-1.414L8.585 9.5 3.99 4.904a1 1 0 0 1-.084-1.32z"></path>\n        </svg>\n      </div>\n      <div class="play-icon">\n      </div>\n      </xg-mini-layer>')}}],ig(i.prototype,r),o&&ig(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function iP(t){return(iP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function iO(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,ij(i.key),i)}}function iT(t,e){return(iT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function iE(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iC(t){return(iC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ix(t,e,n){return(e=ij(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ij(t){var e=function(t,e){if("object"!==iP(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==iP(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===iP(e)?e:String(e)}var iR={mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousemove:"onMouseMove"},iA=["videoClick","videoDbClick"],iL=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iT(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=iC(e);return t=n?Reflect.construct(i,arguments,iC(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===iP(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return iE(t)}(this,t)});function s(){var t;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return ix(iE(t=a.call.apply(a,[this].concat(n))),"onMouseMove",function(e){var n=iE(t),i=n.player,r=n.playerConfig;!i.isActive&&(i.focus({autoHide:!r.closeDelayBlur}),r.closeFocusVideoFocus||i.video.focus())}),ix(iE(t),"onMouseEnter",function(e){var n=iE(t),i=n.playerConfig,r=n.player;i.closeFocusVideoFocus||r.video.focus(),i.closeDelayBlur?r.focus({autoHide:!1}):r.focus()}),ix(iE(t),"onMouseLeave",function(e){var n=t.playerConfig,i=n.closePlayerBlur,r=n.leavePlayerTime,o=n.closeDelayBlur;!i&&!o&&(r?t.player.focus({autoHide:!0,delay:r}):t.player.blur())}),ix(iE(t),"onVideoClick",function(e){var n=iE(t),i=n.player,r=n.playerConfig;if(!e.target||!r.closeVideoClick)(e.target===i.video||e.target===i.innerContainer||e.target===i.video.__canvas)&&(e.preventDefault(),!r.closeVideoStopPropagation&&e.stopPropagation(),t._clickCount++,t.clickTimer&&(clearTimeout(t.clickTimer),t.clickTimer=null),t.clickTimer=setTimeout(function(){if(!!t._clickCount)t._clickCount--,ey(iE(t),iA[0],function(e,n){t.switchPlayPause(n.e)},{e:e,paused:i.paused}),clearTimeout(t.clickTimer),t.clickTimer=null},300))}),ix(iE(t),"onVideoDblClick",function(e){var n=iE(t),i=n.player;if(!n.playerConfig.closeVideoDblclick&&!!e.target&&(e.target===i.video||e.target===i.video.__canvas)){if(t._clickCount<2){t._clickCount=0;return}t._clickCount=0,t.clickTimer&&(clearTimeout(t.clickTimer),t.clickTimer=null),e.preventDefault(),e.stopPropagation(),ey(iE(t),iA[1],function(e,n){t.emitUserAction(n.e,"switch_fullscreen",{fullscreen:i.fullscreen}),i.fullscreen?i.exitFullscreen():i.getFullscreen()},{e:e,fullscreen:i.fullscreen})}}),t}return i=s,o=[{key:"pluginName",get:function(){return"pc"}},{key:"defaultConfig",get:function(){return{}}}],r=[{key:"afterCreate",value:function(){var t=this;if(this._clickCount=0,iA.map(function(e){t.__hooks[e]=null}),"mobile"!==this.playerConfig.isMobileSimulateMode&&("mobile"!==tZ.device||!!tZ.os.isIpad))this.initEvents()}},{key:"initEvents",value:function(){var t=this,e=this.player,n=e.video,i=e.root,r=this.playerConfig.enableContextmenu;n&&n.addEventListener("click",this.onVideoClick,!1),n&&n.addEventListener("dblclick",this.onVideoDblClick,!1),Object.keys(iR).map(function(e){i.addEventListener(e,t[iR[e]],!1)}),r&&n&&n.addEventListener("contextmenu",this.onContextmenu,!1)}},{key:"switchPlayPause",value:function(t){var e=this.player;this.emitUserAction(t,"switch_play_pause"),e.ended?e.duration!==1/0&&e.duration>0&&e.replay():e.paused?e.play():e.pause()}},{key:"onContextmenu",value:function(t){(t=t||window.event).preventDefault&&t.preventDefault(),t.stopPropagation?t.stopPropagation():(t.returnValue=!1,t.cancelBubble=!0)}},{key:"destroy",value:function(){var t=this,e=this.player,n=e.video,i=e.root;this.clickTimer&&clearTimeout(this.clickTimer),n.removeEventListener("click",this.onVideoClick,!1),n.removeEventListener("dblclick",this.onVideoDblClick,!1),n.removeEventListener("contextmenu",this.onContextmenu,!1),Object.keys(iR).map(function(e){i.removeEventListener(e,t[iR[e]],!1)})}}],iO(i.prototype,r),o&&iO(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(e_);function iI(t){return(iI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function iD(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,iM(i.key),i)}}function iN(t,e,n){return(e=iM(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iM(t){var e=function(t,e){if("object"!==iI(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==iI(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===iI(e)?e:String(e)}var iB={PRESS:"press",PRESS_END:"pressend",DOUBlE_CLICK:"doubleclick",CLICK:"click",TOUCH_MOVE:"touchmove",TOUCH_START:"touchstart",TOUCH_END:"touchend"},iF={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},iH={start:"mousedown",end:"mouseup",move:"mousemove",cancel:"mouseleave"};function iU(t){return t&&t.length>0?t[t.length-1]:null}function iW(t){var e=navigator.userAgent;/(?:iPhone|iPad)/.test(e)&&t.cancelable&&t.preventDefault()}var iV=function(){var t,e,n;function i(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{eventType:"touch"};!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),iN(this,"onTouchStart",function(t){var n=e._pos,i=e.root;e.config.needPreventDefault&&iW(t);var r=iU(t.touches);n.x=r?parseInt(r.pageX,10):t.pageX,n.y=r?parseInt(r.pageX,10):t.pageX,n.start=!0,e.__setPress(t),i.addEventListener(e.events.end,e.onTouchEnd),i.addEventListener(e.events.cancel,e.onTouchCancel),i.addEventListener(e.events.move,e.onTouchMove),e.trigger(iB.TOUCH_START,t)}),iN(this,"onTouchCancel",function(t){e.onTouchEnd(t)}),iN(this,"onTouchEnd",function(t){var n=e._pos,i=e.root;e.config.needPreventDefault&&iW(t),e.__clearPress(),i.removeEventListener(e.events.cancel,e.onTouchCancel),i.removeEventListener(e.events.end,e.onTouchEnd),i.removeEventListener(e.events.move,e.onTouchMove),t.moving=n.moving,t.press=n.press,n.press&&e.trigger(iB.PRESS_END,t),e.trigger(iB.TOUCH_END,t),n.press||n.moving||e.__setDb(t),n.press=!1,n.start=!1,n.moving=!1}),iN(this,"onTouchMove",function(t){var n=e._pos,i=e.config,r=iU(t.touches),o=r?parseInt(r.pageX,10):t.pageX,a=r?parseInt(r.pageY,10):t.pageX,s=o-n.x;if(!(Math.abs(a-n.y)<i.miniStep&&Math.abs(s)<i.miniStep))e.__clearPress(),n.press&&e.trigger(iB.PRESS_END,t),n.press=!1,n.moving=!0,e.trigger(iB.TOUCH_MOVE,t)}),this._pos={moving:!1,start:!1,x:0,y:0},this.config={pressDelay:600,dbClickDelay:200,disablePress:!1,disableDbClick:!1,miniStep:2,needPreventDefault:!0},Object.keys(n).map(function(t){e.config[t]=n[t]}),this.root=t,this.events="mouse"===n.eventType?iH:iF,this.pressIntrvalId=null,this.dbIntrvalId=null,this.__handlers={},this._initEvent()}return t=i,e=[{key:"_initEvent",value:function(){this.root.addEventListener(this.events.start,this.onTouchStart)}},{key:"__setPress",value:function(t){var e=this,n=this.config;this.pressIntrvalId&&this.__clearPress(),this.pressIntrvalId=setTimeout(function(){e.trigger(iB.PRESS,t),e._pos.press=!0,e.__clearPress()},n.pressDelay)}},{key:"__clearPress",value:function(){window.clearTimeout(this.pressIntrvalId),this.pressIntrvalId=null}},{key:"__setDb",value:function(t){var e=this,n=this.config;if(this.dbIntrvalId){this.__clearDb(),this.trigger(iB.DOUBlE_CLICK,t);return}this.dbIntrvalId=setTimeout(function(){e.__clearDb(),!e._pos.start&&!e._pos.press&&!e._pos.moving&&e.trigger(iB.CLICK,t)},n.dbClickDelay)}},{key:"__clearDb",value:function(){clearTimeout(this.dbIntrvalId),this.dbIntrvalId=null}},{key:"on",value:function(t,e){!this.__handlers[t]&&(this.__handlers[t]=[]),this.__handlers[t].push(e)}},{key:"off",value:function(t,e){if(!!this.__handlers[t]){for(var n=this.__handlers[t],i=-1,r=0;r<n.length;r++)if(n[r]===e){i=r;break}i>=0&&this.__handlers[t].splice(i,1)}}},{key:"trigger",value:function(t,e){if(!!this.__handlers[t])this.__handlers[t].map(function(t){try{t(e)}catch(t){}})}},{key:"destroy",value:function(){var t=this,e={touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"};Object.keys(e).forEach(function(n){t.root.removeEventListener(n,t[e[n]])})}}],iD(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function iG(t){return(iG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function iz(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,iJ(i.key),i)}}function iK(t,e){return(iK=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function iY(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iX(t){return(iX=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function iq(t,e,n){return(e=iJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iJ(t){var e=function(t,e){if("object"!==iG(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==iG(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===iG(e)?e:String(e)}var iZ={AUTO:"auto",SEEKING:"seeking",PLAYBACK:"playbackrate"},i$=["videoClick","videoDbClick"],iQ=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iK(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=iX(e);return t=n?Reflect.construct(i,arguments,iX(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===iG(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return iY(t)}(this,t)});function s(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),iq(iY(e=a.call(this,t)),"onTouchStart",function(t){var n=iY(e),i=n.player,r=n.config,o=n.pos,a=n.playerConfig,s=e.getTouche(t);if(s&&!r.disableGesture&&e.duration>0&&!i.ended){o.isStart=!0,k.checkIsFunction(a.disableSwipeHandler)&&a.disableSwipeHandler(),e.find(".xg-dur").innerHTML=k.format(e.duration);var u=e.root.getBoundingClientRect();90===i.rotateDeg?(o.top=u.left,o.left=u.top,o.width=u.height,o.height=u.width):(o.top=u.top,o.left=u.left,o.width=u.width,o.height=u.height);var c=parseInt(s.pageX-o.left,10),l=parseInt(s.pageY-o.top,10);o.x=90===i.rotateDeg?l:c,o.y=90===i.rotateDeg?c:l,o.scopeL=r.scopeL*o.width,o.scopeR=(1-r.scopeR)*o.width,o.scopeM1=o.width*(1-r.scopeM)/2,o.scopeM2=o.width-o.scopeM1}}),iq(iY(e),"onTouchMove",function(t){var n=e.getTouche(t),i=iY(e),r=i.pos,o=i.config,a=i.player;if(!!n&&!o.disableGesture&&!!e.duration&&!!r.isStart){var s=o.miniMoveStep,u=o.hideControlsActive,c=parseInt(n.pageX-r.left,10),l=parseInt(n.pageY-r.top,10),f=90===a.rotateDeg?l:c,h=90===a.rotateDeg?c:l;if(Math.abs(f-r.x)>s||Math.abs(h-r.y)>s){var p=f-r.x,d=h-r.y,y=r.scope;if(-1===y&&(0===(y=e.checkScope(f,h,p,d,r))&&(u?a.blur():a.focus({autoHide:!1}),r.time||(r.time=parseInt(1e3*a.currentTime,10)+1e3*e.timeOffset)),r.scope=y),-1===y||y>0&&!o.gestureY||0===y&&!o.gestureX)return;t.cancelable&&t.preventDefault(),e.executeMove(p,d,y,r.width,r.height),r.x=f,r.y=h}}}),iq(iY(e),"onTouchEnd",function(t){var n=iY(e),i=n.player,r=n.pos,o=n.playerConfig;if(!!r.isStart)r.scope>-1&&t.cancelable&&t.preventDefault(),e.endLastMove(r.scope),setTimeout(function(){i.getPlugin("progress")&&i.getPlugin("progress").resetSeekState()},10),r.scope=-1,e.resetPos(),k.checkIsFunction(o.enableSwipeHandler)&&o.enableSwipeHandler(),e.changeAction(iZ.AUTO)}),iq(iY(e),"onRootTouchMove",function(t){if(!e.config.disableGesture&&!!e.config.gestureX)e.checkIsRootTarget(t)&&(t.stopPropagation(),e.pos.isStart?e.onTouchMove(t):e.onTouchStart(t))}),iq(iY(e),"onRootTouchEnd",function(t){if(e.pos.isStart&&e.checkIsRootTarget(t)){t.stopPropagation(),e.onTouchEnd(t);var n=e.player.controls;n&&n.recoverAutoHide()}}),e.pos={isStart:!1,x:0,y:0,time:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1},e.timer=null,e}return i=s,o=[{key:"pluginName",get:function(){return"mobile"}},{key:"defaultConfig",get:function(){return{stopPropagation:!0,index:0,disableGesture:!1,gestureX:!0,gestureY:!0,updateGesture:function(){},onTouchStart:function(){},onTouchEnd:function(){},gradient:"normal",isTouchingSeek:!1,miniMoveStep:5,miniYPer:5,scopeL:.25,scopeR:.25,scopeM:.9,pressRate:2,darkness:!0,maxDarkness:.8,disableActive:!1,disableTimeProgress:!1,hideControlsActive:!1,hideControlsEnd:!1,moveDuration:36e4,closedbClick:!1,disablePress:!0,disableSeekIcon:!1,focusVideoClick:!1}}}],r=[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"registerIcons",value:function(){return{seekTipIcon:{icon:'<svg width="20" height="9" viewBox="0 0 8 9" fill="none" xmlns="http://www.w3.org/2000/svg"><path opacity=".54" d="M7.5 3.634a1 1 0 010 1.732l-6 3.464A1 1 0 010 7.964V1.036A1 1 0 011.5.17l6 3.464z" fill="#fff"/><path d="M12.5 3.634a1 1 0 010 1.732l-6 3.464A1 1 0 015 7.964V1.036A1 1 0 016.5.17l6 3.464z" fill="#fff"/></svg>',class:"xg-seek-pre"}}}},{key:"afterCreate",value:function(){var t=this;i$.map(function(e){t.__hooks[e]=null});var e=this.playerConfig,n=this.config,i=this.player;!0===e.closeVideoDblclick&&(n.closedbClick=!0),this.resetPos(),!k.isUndefined(e.disableGesture)&&(n.disableGesture=!!e.disableGesture),this.appendChild(".xg-seek-icon",this.icons.seekTipIcon),this.xgMask=k.createDom("xg-mask","",{},"xgmask"),i.root.appendChild(this.xgMask),this.initCustomStyle(),this.registerThumbnail();var r="mouse"===this.domEventType?"mouse":"touch";this.touch=new iV(this.root,{eventType:r,needPreventDefault:!this.config.disableGesture}),this.root.addEventListener("contextmenu",function(t){t.preventDefault()}),i.root.addEventListener("touchmove",this.onRootTouchMove,!0),i.root.addEventListener("touchend",this.onRootTouchEnd,!0),this.on(B,function(){var e=t.player,n=t.config;1e3*e.duration<n.moveDuration&&(n.moveDuration=1e3*e.duration)}),this.on([N,x],function(){var e=t.pos,n=e.time;!e.isStart&&n>0&&(t.pos.time=0)});var o={touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",press:"onPress",pressend:"onPressEnd",click:"onClick",doubleclick:"onDbClick"};if(Object.keys(o).forEach(function(e){t.touch.on(e,function(n){t[o[e]](n)})}),!n.disableActive){var a=i.plugins.progress;a&&(a.addCallBack("dragmove",function(e){t.activeSeekNote(e.currentTime,e.forward)}),a.addCallBack("dragend",function(){t.changeAction(iZ.AUTO)}),a.addCallBack("click",function(){t.changeAction(iZ.AUTO)}))}}},{key:"registerThumbnail",value:function(){var t=this.player.plugins.thumbnail;if(t&&t.usable){this.thumbnail=t.createThumbnail(null,"mobile-thumbnail");var e=this.find(".time-preview");e.insertBefore(this.thumbnail,e.children[0])}}},{key:"initCustomStyle",value:function(){var t=(this.playerConfig||{}).commonStyle,e=t.playedColor,n=t.progressColor;e&&(this.find(".xg-curbar").style.backgroundColor=e,this.find(".xg-cur").style.color=e),n&&(this.find(".xg-bar").style.backgroundColor=n,this.find(".time-preview").style.color=n),this.config.disableTimeProgress&&k.addClass(this.find(".xg-timebar"),"hide")}},{key:"resetPos",value:function(){var t=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.pos?(this.pos.isStart=!1,this.pos.scope=-1,["x","y","width","height","scopeL","scopeR","scopeM1","scopeM2"].map(function(e){t.pos[e]=0})):this.pos={isStart:!1,x:0,y:0,volume:0,rate:1,light:0,width:0,height:0,scopeL:0,scopeR:0,scopeM1:0,scopeM2:0,scope:-1,time:0}}},{key:"changeAction",value:function(t){var e=this.player;this.root.setAttribute("data-xg-action",t);var n=e.plugins.start;n&&n.recover()}},{key:"getTouche",value:function(t){var e=this.player.rotateDeg,n=t.touches&&t.touches.length>0?t.touches[t.touches.length-1]:t;return{pageX:n.pageX,pageY:n.pageY}}},{key:"checkScope",value:function(t,e,n,i,r){var o=r.width,a=-1;if(t<0||t>o)return a;var s=0===i?Math.abs(n):Math.abs(n/i);return Math.abs(n)>0&&s>=1.73&&t>r.scopeM1&&t<r.scopeM2?a=0:(0===Math.abs(n)||s<=.57)&&(a=t<r.scopeL?1:t>r.scopeR?2:3),a}},{key:"executeMove",value:function(t,e,n,i,r){switch(n){case 0:this.updateTime(t/i*this.config.scopeM);break;case 1:this.updateBrightness(e/r);break;case 2:!tZ.os.isIos&&this.updateVolume(e/r)}}},{key:"endLastMove",value:function(t){var e=this,n=this.pos,i=this.player,r=this.config,o=(n.time-this.timeOffset)/1e3;if(0===t)i.seek(Number(o).toFixed(1)),r.hideControlsEnd?i.blur():i.focus(),this.timer=setTimeout(function(){e.pos.time=0},500);this.changeAction(iZ.AUTO)}},{key:"checkIsRootTarget",value:function(t){var e=this.player.plugins||{};return!(e.progress&&e.progress.root.contains(t.target))&&(e.start&&e.start.root.contains(t.target)||e.controls&&e.controls.root.contains(t.target))}},{key:"clickHandler",value:function(t){var e=this.player,n=this.config,i=this.playerConfig;if(!e.isPlaying){!i.closeVideoClick&&(this.emitUserAction("click","switch_play_pause"),e.play());return}!n.closedbClick||i.closeVideoClick?e.isActive?e.blur():e.focus():!i.closeVideoClick&&((e.isActive||n.focusVideoClick)&&(this.emitUserAction("click","switch_play_pause"),this.switchPlayPause()),e.focus())}},{key:"dbClickHandler",value:function(t){var e=this.config,n=this.player;!e.closedbClick&&n.isPlaying&&(this.emitUserAction("dblclick","switch_play_pause"),this.switchPlayPause())}},{key:"onClick",value:function(t){var e=this,n=this.player;ey(this,i$[0],function(t,n){e.clickHandler(n.e)},{e:t,paused:n.paused})}},{key:"onDbClick",value:function(t){var e=this,n=this.player;ey(this,i$[1],function(t,n){e.dbClickHandler(n.e)},{e:t,paused:n.paused})}},{key:"onPress",value:function(t){var e=this.pos,n=this.config,i=this.player;if(!n.disablePress)e.rate=this.player.playbackRate,this.emitUserAction("press","change_rate",{from:i.playbackRate,to:n.pressRate}),i.playbackRate=n.pressRate,this.changeAction(iZ.PLAYBACK)}},{key:"onPressEnd",value:function(t){var e=this.pos,n=this.config,i=this.player;if(!n.disablePress)this.emitUserAction("pressend","change_rate",{from:i.playbackRate,to:e.rate}),i.playbackRate=e.rate,e.rate=1,this.changeAction(iZ.AUTO)}},{key:"updateTime",value:function(t){var e=this.player,n=this.config,i=this.player.duration,r=parseInt((t=Number(t.toFixed(4)))*n.moveDuration,10)+this.timeOffset;r+=this.pos.time,r=r<0?0:r>1e3*i?1e3*i-200:r,e.getPlugin("time")&&e.getPlugin("time").updateTime(r/1e3),e.getPlugin("progress")&&e.getPlugin("progress").updatePercent(r/1e3/this.duration,!0),this.activeSeekNote(r/1e3,t>0),n.isTouchingSeek&&e.seek(Number((r-this.timeOffset)/1e3).toFixed(1)),this.pos.time=r}},{key:"updateVolume",value:function(t){this.player.rotateDeg&&(t=-t);var e=this.player,n=this.pos;if(t=parseInt(100*t,10),n.volume+=t,!(10>Math.abs(n.volume))){var i=parseInt(10*e.volume,10)-parseInt(n.volume/10,10);i=i>10?10:i<1?0:i,e.volume=i/10,n.volume=0}}},{key:"updateBrightness",value:function(t){this.player.rotateDeg&&(t=-t);var e=this.pos,n=this.config,i=this.xgMask,r=e.light+.8*t;r=r>n.maxDarkness?n.maxDarkness:r<0?0:r,i&&(i.style.backgroundColor="rgba(0,0,0,".concat(r,")")),e.light=r}},{key:"activeSeekNote",value:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=this.player,i=this.config,r=!(this.duration!==1/0&&this.duration>0);if(!!t&&"number"==typeof t&&!r&&!i.disableActive){t<0?t=0:t>n.duration&&(t=n.duration-.2),this.changeAction(iZ.SEEKING);var o=n.plugins.start;o&&o.focusHide(),this.find(".xg-dur").innerHTML=k.format(this.duration),this.find(".xg-cur").innerHTML=k.format(t),this.find(".xg-curbar").style.width="".concat(t/this.duration*100,"%"),e?k.removeClass(this.find(".xg-seek-show"),"xg-back"):k.addClass(this.find(".xg-seek-show"),"xg-back"),this.updateThumbnails(t)}}},{key:"updateThumbnails",value:function(t){var e=this.player.plugins.thumbnail;e&&e.usable&&this.thumbnail&&e.update(this.thumbnail,t,160,90)}},{key:"switchPlayPause",value:function(){var t=this.player;if(!t.hasStart)return!1;!t.ended&&(t.paused?t.play():t.pause())}},{key:"disableGesture",value:function(){this.config.disableGesture=!1}},{key:"enableGesture",value:function(){this.config.disableGesture=!0}},{key:"destroy",value:function(){var t=this.player;this.timer&&clearTimeout(this.timer),this.thumbnail=null,t.root.removeChild(this.xgMask),this.xgMask=null,this.touch&&this.touch.destroy(),this.touch=null,t.root.removeEventListener("touchmove",this.onRootTouchMove,!0),t.root.removeEventListener("touchend",this.onRootTouchEnd,!0)}},{key:"render",value:function(){var t="normal"!==this.config.gradient?"gradient ".concat(this.config.gradient):"gradient";return'\n     <xg-trigger class="trigger">\n     <div class="'.concat(t,'"></div>\n        <div class="time-preview">\n            <div class="xg-seek-show ').concat(this.config.disableSeekIcon?" hide-seek-icon":"",'">\n              <i class="xg-seek-icon"></i>\n              <span class="xg-cur">00:00</span>\n              <span>/</span>\n              <span class="xg-dur">00:00</span>\n            </div>\n              <div class="xg-bar xg-timebar">\n                <div class="xg-curbar"></div>\n              </div>\n        </div>\n        <div class="xg-playbackrate xg-top-note">\n            <span><i>').concat(this.config.pressRate,"X</i>").concat(this.i18n.FORWARD,"</span>\n        </div>\n     </xg-trigger>\n    ")}}],iz(i.prototype,r),o&&iz(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function i0(t){return(i0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function i2(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i9(i.key),i)}}function i3(t,e){return(i3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function i4(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function i6(t){return(i6=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i5(t,e,n){return(e=i9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i9(t){var e=function(t,e){if("object"!==i0(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==i0(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===i0(e)?e:String(e)}function i8(t){var e=t.tagName;return"INPUT"===e||"TEXTAREA"===e||!!t.isContentEditable||!1}var i7=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i3(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=i6(e);return t=n?Reflect.construct(i,arguments,i6(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===i0(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return i4(t)}(this,t)});function s(){var t;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return i5(i4(t=a.call.apply(a,[this].concat(n))),"onBodyKeyDown",function(e){if(!!t.player){var n=e||window.event,i=n.target,r=n.keyCode,o=i4(t),a=o._keyState,s=o.player,u=t.config,c=u.disable,l=u.disableBodyTrigger,f=u.isIgnoreUserActive,h=i.ownerDocument;if(c||l||!s.isUserActive&&!f||i8(i)||!t.checkIsVisible()||n.metaKey||n.altKey||n.ctrlKey){a.isBodyKeyDown=!1;return}!e.repeat&&!a.isKeyDown&&((i===h.body||t.config.isGlobalTrigger&&!i8(i))&&t.checkCode(r,!0)&&(a.isBodyKeyDown=!0),h.addEventListener("keyup",t.onBodyKeyUp)),a.isBodyKeyDown&&t.handleKeyDown(n)}}),i5(i4(t),"onBodyKeyUp",function(e){if(!!t.player)(e||window.event).target.ownerDocument.removeEventListener("keyup",t.onBodyKeyUp),t.handleKeyUp(e)}),i5(i4(t),"onKeydown",function(e){if(!t.player)return;var n=e||window.event,i=i4(t)._keyState;if(!n.repeat){if(t.config.disable||t.config.disableRootTrigger||n.metaKey||n.altKey||n.ctrlKey||!t.player.isUserActive&&!t.config.isIgnoreUserActive)return;n&&(37===n.keyCode||t.checkCode(n.keyCode))&&(n.target===t.player.root||n.target===t.player.video||n.target===t.player.controls.el)&&(i.isKeyDown=!0),t.player.root.addEventListener("keyup",t.onKeyup)}if(!!i.isKeyDown)t.handleKeyDown(n)}),i5(i4(t),"onKeyup",function(e){if(!!t.player)t.player.root.removeEventListener("keyup",t.onKeyup),t.handleKeyUp(e)}),t}return i=s,o=[{key:"pluginName",get:function(){return"keyboard"}},{key:"defaultConfig",get:function(){return{seekStep:10,checkVisible:!1,disableBodyTrigger:!1,disableRootTrigger:!1,isGlobalTrigger:!1,keyCodeMap:{},disable:!1,playbackRate:2,isIgnoreUserActive:!1}}}],r=[{key:"setConfig",value:function(t,e){var n=this;if(!t)return;var i=Object.keys(t);if(!(i.length<1))i.forEach(function(i){e.deepMerge&&"Object"===k.typeOf(n.config[i])?k.deepMerge(n.config[i],t[i]):n.config[i]=t[i]}),this.mergekeyCodeMap()}},{key:"mergekeyCodeMap",value:function(){var t=this,e=this.config.keyCodeMap;e&&Object.keys(e).map(function(n){t.keyCodeMap[n]?["keyCode","action","disable","pressAction","disablePress","isBodyTarget"].map(function(i){e[n][i]&&(t.keyCodeMap[n][i]=e[n][i])}):t.keyCodeMap[n]=e[n]})}},{key:"afterCreate",value:function(){this.config.disable=!this.playerConfig.keyShortcut;var t="function"==typeof this.config.seekStep?this.config.seekStep(this.player):this.config.seekStep;!(!t||"number"!=typeof t)&&(this.seekStep=t),this.keyCodeMap={space:{keyCode:32,action:"playPause",disable:!1,disablePress:!1,noBodyTarget:!1},up:{keyCode:38,action:"upVolume",disable:!1,disablePress:!1,noBodyTarget:!0},down:{keyCode:40,action:"downVolume",disable:!1,disablePress:!1,noBodyTarget:!0},left:{keyCode:37,action:"seekBack",disablePress:!1,disable:!1},right:{keyCode:39,action:"seek",pressAction:"changePlaybackRate",disablePress:!1,disable:!1},esc:{keyCode:27,action:"exitFullscreen",disablePress:!0,disable:!1}},this.mergekeyCodeMap(),this._keyState={isKeyDown:!1,isBodyKeyDown:!1,isPress:!1,tt:0,playbackRate:0},this.player.root.addEventListener("keydown",this.onKeydown),document.addEventListener("keydown",this.onBodyKeyDown)}},{key:"checkIsVisible",value:function(){if(!this.config.checkVisible)return!0;var t=this.player.root.getBoundingClientRect(),e=t.height,n=t.top,i=t.bottom,r=window.innerHeight;return(!(n<0)||!(n<0-.9*e))&&(!(i>0)||!(i-r>.9*e))&&!0}},{key:"checkCode",value:function(t,e){var n=this,i=!1;return Object.keys(this.keyCodeMap).map(function(r){n.keyCodeMap[r]&&t===n.keyCodeMap[r].keyCode&&!n.keyCodeMap[r].disable&&(i=!e||e&&!n.keyCodeMap[r].noBodyTarget)}),i}},{key:"downVolume",value:function(t){var e=this.player;if(!(e.volume<=0)){var n=parseFloat((e.volume-.1).toFixed(1)),i={volume:{from:e.volume,to:n}};this.emitUserAction(t,"change_volume",{props:i}),n>=0?e.volume=n:e.volume=0}}},{key:"upVolume",value:function(t){var e=this.player;if(!(e.volume>=1)){var n=parseFloat((e.volume+.1).toFixed(1)),i={volume:{from:e.volume,to:n}};this.emitUserAction(t,"change_volume",{props:i}),n<=1?e.volume=n:e.volume=1}}},{key:"seek",value:function(t){var e=this.player,n=e.currentTime,i=e.duration,r=n,o=t.repeat&&this.seekStep>=4?parseInt(this.seekStep/2,10):this.seekStep;r=n+o<=i?n+o:i;var a={currentTime:{from:n,to:r}};this.emitUserAction(t,"seek",{props:a}),this.player.currentTime=r}},{key:"seekBack",value:function(t){var e=this.player.currentTime,n=t.repeat?parseInt(this.seekStep/2,10):this.seekStep,i=0;e-n>=0&&(i=e-n);var r={currentTime:{from:e,to:i}};this.emitUserAction(t,"seek",{props:r}),this.player.currentTime=i}},{key:"changePlaybackRate",value:function(t){var e=this._keyState,n=this.config,i=this.player;0===e.playbackRate&&(e.playbackRate=i.playbackRate,i.playbackRate=n.playbackRate)}},{key:"playPause",value:function(t){var e=this.player;if(!!e)this.emitUserAction(t,"switch_play_pause"),e.paused?e.play():e.pause()}},{key:"exitFullscreen",value:function(t){var e=this.player,n=e.fullscreen,i=e.cssfullscreen;n&&(this.emitUserAction("keyup","switch_fullscreen",{prop:"fullscreen",from:n,to:!n}),e.exitFullscreen()),i&&(this.emitUserAction("keyup","switch_css_fullscreen",{prop:"cssfullscreen",from:i,to:!i}),e.exitCssFullscreen())}},{key:"handleKeyDown",value:function(t){var e,n=this._keyState;if(t.repeat){n.isPress=!0;var i=Date.now();if(i-n.tt<200)return;n.tt=i}(e=t).preventDefault(),e.returnValue=!1,this.handleKeyCode(t.keyCode,t,n.isPress)}},{key:"handleKeyUp",value:function(t){var e=this._keyState;e.playbackRate>0&&(this.player.playbackRate=e.playbackRate,e.playbackRate=0),e.isKeyDown=!1,e.isPress=!1,e.tt=0}},{key:"handleKeyCode",value:function(t,e,n){for(var i=Object.keys(this.keyCodeMap),r=0;r<i.length;r++){var o=this.keyCodeMap[i[r]];if(!!o){var a=o.action,s=o.keyCode,u=o.disable,c=o.pressAction,l=o.disablePress;if(s===t){if(!u&&!(n&&l)){var f=n&&c||a;"function"==typeof f?a(e,this.player,n):"string"==typeof f&&"function"==typeof this[f]&&this[f](e,this.player,n),this.emit(tS,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i1(Object(n),!0).forEach(function(e){i5(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i1(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({key:i[r],target:e.target,isPress:n},this.keyCodeMap[i[r]]))}break}}}}},{key:"destroy",value:function(){this.player.root.removeEventListener("keydown",this.onKeydown),document.removeEventListener("keydown",this.onBodyKeyDown),this.player.root.removeEventListener("keyup",this.onKeyup),document.removeEventListener("keyup",this.onBodyKeyUp)}},{key:"disable",value:function(){this.config.disable=!0}},{key:"enable",value:function(){this.config.disable=!1}}],i2(i.prototype,r),o&&i2(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(e_);function rt(t){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function re(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==rt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==rt(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rt(e)?e:String(e)}(i.key),i)}}function rn(t,e){return(rn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ri(t){return(ri=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var rr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rn(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=ri(e);return t=n?Reflect.construct(i,arguments,ri(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===rt(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,r=[{key:"registerIcons",value:function(){return{loadingIcon:'<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="-5 -5 110 110"><path d="M100 50A50 50 0 1150 0" stroke-width="5" stroke="#ddd" stroke-dasharray="236" fill="none"/></svg>'}}},{key:"afterCreate",value:function(){this.appendChild("xg-loading-inner",this.icons.loadingIcon)}},{key:"render",value:function(){return'\n    <xg-loading class="xgplayer-loading">\n      <xg-loading-inner></xg-loading-inner>\n    </xg-loading>'}}],o=[{key:"pluginName",get:function(){return"loading"}},{key:"defaultConfig",get:function(){return{position:eR.ROOT}}}],r&&re(i.prototype,r),o&&re(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function ro(t){return(ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ra(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==ro(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==ro(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ro(e)?e:String(e)}(i.key),i)}}var rs=[{tag:"xg-cache",className:"xgplayer-progress-cache",styleKey:"cachedColor"},{tag:"xg-played",className:"xgplayer-progress-played",styleKey:"playedColor"}],ru=function(){var t,e,n;function i(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),this.fragments=t.fragments||[],0===this.fragments.length&&this.fragments.push({percent:1}),this._callBack=t.actionCallback,this.fragConfig={fragFocusClass:t.fragFocusClass||"inner-focus-point",fragAutoFocus:!!t.fragAutoFocus,fragClass:t.fragClass||""},this.style=t.style||{playedColor:"",cachedColor:"",progressColor:""},this.duration=0,this.cachedIndex=0,this.playedIndex=0,this.focusIndex=-1}return t=i,e=[{key:"updateDuration",value:function(t){var e=this;this.duration=t;var n=0,i=this.fragments;this.fragments=i.map(function(t){return t.start=parseInt(n,10),t.end=parseInt(n+t.percent*e.duration,10),t.duration=parseInt(t.percent*e.duration,10),n+=t.percent*e.duration,t})}},{key:"updateProgress",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"played",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{newIndex:0,curIndex:0,millisecond:0},n=this.progressList,i=this.fragments;if(!(n.length<1)){var r=e.newIndex,o=e.curIndex,a=e.millisecond;r!==o&&n.map(function(e,n){n<r?e[t].style.width="100%":n>r&&(e[t].style.width=0)});var s=i[r],u=0===a?0:(a-s.start)/s.duration;n[r][t].style.width=u<0?0:"".concat(100*u,"%")}}},{key:"updateFocus",value:function(t){if(!!this.fragConfig.fragAutoFocus&&!(this.fragments.length<2)){if(!t){if(this.focusIndex>-1){this.unHightLight(this.focusIndex);var e={index:-1,preIndex:this.focusIndex,fragment:null};this._callBack&&this._callBack(e),this.focusIndex=-1}return}var n=this.findIndex(1e3*t.currentTime,this.focusIndex);if(n>=0&&n!==this.focusIndex){this.focusIndex>-1&&this.unHightLight(this.focusIndex),this.setHightLight(n);var i={index:n,preIndex:this.focusIndex,fragment:this.fragments[this.focusIndex]};this.focusIndex=n,this._callBack&&this._callBack(i)}}}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cached:0,played:0},e=arguments.length>1?arguments[1]:void 0;if(!this.duration||parseInt(1e3*e,10)!==this.duration){if(!e&&0!==e)return;this.updateDuration(parseInt(1e3*e,10))}var n=this.playedIndex,i=this.cachedIndex;if("Undefined"!==k.typeOf(t.played)){var r=this.findIndex(1e3*t.played,n);if(r<0)return;this.updateProgress("played",{newIndex:r,curIndex:n,millisecond:parseInt(1e3*t.played,10)}),this.playedIndex=r}if("Undefined"!==k.typeOf(t.cached)){var o=this.findIndex(1e3*t.cached,i);if(o<0)return;this.updateProgress("cached",{newIndex:o,curIndex:i,millisecond:parseInt(1e3*t.cached,10)}),this.cachedIndex=o}}},{key:"findIndex",value:function(t,e){var n=this.fragments;if(!n||0===n.length)return -1;if(1===n.length)return 0;if(e>-1&&e<n.length&&t>n[e].start&&t<n[e].end)return e;if(t>n[n.length-1].start)return n.length-1;for(var i=0;i<n.length;i++)if(t>n[i].start&&t<=n[i].end){e=i;break}return e}},{key:"findHightLight",value:function(){for(var t=this.root.children,e=0;e<t.length;e++)if(k.hasClass(t[e],this.fragConfig.fragFocusClass))return{dom:t[e],pos:t[e].getBoundingClientRect()}}},{key:"findFragment",value:function(t){var e=this.root.children;return t<0||t>=e.length?null:{dom:e[t],pos:e[t].getBoundingClientRect()}}},{key:"unHightLight",value:function(){for(var t=this.root.children,e=0;e<t.length;e++)k.removeClass(t[e],this.fragConfig.fragFocusClass)}},{key:"setHightLight",value:function(t){var e=this.root.children;if(t<e.length)return k.addClass(e[t],this.fragConfig.fragFocusClass),{dom:e[t],pos:e[t].getBoundingClientRect()}}},{key:"destroy",value:function(){this.progressList=null,this.fragments=null,this.root.innerHTML=""}},{key:"reset",value:function(t){var e=this;if(Object.keys(this.fragConfig).forEach(function(n){void 0!==t[n]&&(e.fragConfig[n]=t[n])}),t.fragments){if(this.fragments=0===t.fragments.length?[{percent:1}]:t.fragments,this.updateDuration(this.duration),this.playedIndex=0,this.cachedIndex=0,this.root){for(var n=this.root.children;n.length>0;)this.root.removeChild(n[0])}this.render()}}},{key:"render",value:function(){var t=this,e=this.style.progressColor;if(!this.root&&(this.root=k.createDom("xg-inners","",{},"progress-list")),this.fragments){var n=this.fragConfig,i=n.fragClass,r=n.fragFocusClass;this.progressList=this.fragments.map(function(n){var o=k.createDom("xg-inner","",{style:e?"background:".concat(e,"; flex: ").concat(n.percent):"flex: ".concat(n.percent)},"".concat(n.isFocus?r:""," xgplayer-progress-inner ").concat(i));return t.root.appendChild(o),rs.forEach(function(e){o.appendChild(k.createDom(e.tag,"",{style:e.styleKey?"background: ".concat(t.style[e.styleKey],"; width:0;"):"width:0;"},e.className))}),{cached:o.children[0],played:o.children[1]}})}return this.root}}],ra(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function rc(t){return(rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rl(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function rf(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rl(Object(n),!0).forEach(function(e){rv(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rl(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function rh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,rg(i.key),i)}}function rp(t,e){return(rp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function rd(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ry(t){return(ry=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rv(t,e,n){return(e=rg(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rg(t){var e=function(t,e){if("object"!==rc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==rc(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rc(e)?e:String(e)}var rm={POINT:"inner-focus-point",HIGHLIGHT:"inner-focus-highlight"},rb=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rp(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=ry(e);return t=n?Reflect.construct(i,arguments,ry(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===rc(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return rd(t)}(this,t)});function s(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),rv(rd(e=a.call(this,t)),"onMoveOnly",function(t,n){var i=rd(e),r=i.pos,o=i.config,a=i.player,s=n;if(t){k.event(t);var u=k.getEventPos(t,a.zoom),c=90===a.rotateDeg?u.clientY:u.clientX;if(r.moving&&Math.abs(r.x-c)<o.miniMoveStep)return;r.moving=!0,r.x=c,s=e.computeTime(t,c)}e.triggerCallbacks("dragmove",s,t),e._updateInnerFocus(s)}),rv(rd(e),"onBodyClick",function(t){t.preventDefault(),t.stopPropagation()}),rv(rd(e),"_mouseDownHandler",function(t,n){e._state.time=n.currentTime,e.updateWidth(n.currentTime,n.percent,0),e._updateInnerFocus(n)}),rv(rd(e),"_mouseUpHandler",function(t,n){rd(e).pos.moving&&e.updateWidth(n.currentTime,n.percent,2)}),rv(rd(e),"_mouseMoveHandler",function(t,n){var i=rd(e),r=i._state,o=i.pos,a=i.config,s=i.player;r.time<n.currentTime?n.forward=!0:n.forward=!1,r.time=n.currentTime,o.isDown&&!o.moving&&(o.moving=!0,a.isPauseMoving&&s.pause(),e.triggerCallbacks("dragstart",n,t),e.emitUserAction("drag","dragstart",n)),e.updateWidth(n.currentTime,n.percent,1),e.triggerCallbacks("dragmove",n,t),e._updateInnerFocus(n)}),rv(rd(e),"onMouseDown",function(t){var n=rd(e),i=n._state,r=n.player,o=n.pos,a=n.config,s=n.playerConfig,u=n.root,c=k.getEventPos(t,r.zoom),l=90===r.rotateDeg?c.clientY:c.clientX;if(!r.isMini&&!a.closeMoveSeek&&(!!s.allowSeekAfterEnded||!r.ended)){t.stopPropagation(),e.focus(),k.checkIsFunction(s.disableSwipeHandler)&&s.disableSwipeHandler(),k.checkIsFunction(a.onMoveStart)&&a.onMoveStart(),k.event(t),o.x=l,o.isDown=!0,o.moving=!1,i.prePlayTime=r.currentTime,r.focus({autoHide:!1}),e.isProgressMoving=!0,k.addClass(e.progressBtn,"active");var f=e.computeTime(t,l);return f.prePlayTime=i.prePlayTime,e._mouseDownHandlerHook(t,f),"touchstart"===t.type?(u.addEventListener("touchmove",e.onMouseMove),u.addEventListener("touchend",e.onMouseUp),u.addEventListener("touchcancel",e.onMouseUp)):(e.unbind("mousemove",e.onMoveOnly),u.ownerDocument.addEventListener("mousemove",e.onMouseMove,!1),u.ownerDocument.addEventListener("mouseup",e.onMouseUp,!1),r.root.addEventListener("click",e.onBodyClick,!1)),!0}}),rv(rd(e),"onMouseUp",function(t){var n=rd(e),i=n.player,r=n.config,o=n.pos,a=n.playerConfig,s=n._state,u=n.root;t.stopPropagation(),t.preventDefault(),k.checkIsFunction(a.enableSwipeHandler)&&a.enableSwipeHandler(),k.checkIsFunction(r.onMoveEnd)&&r.onMoveEnd(),k.event(t),k.removeClass(e.progressBtn,"active");var c=e.computeTime(t,o.x);c.prePlayTime=s.prePlayTime,o.moving?(e.triggerCallbacks("dragend",c,t),e.emitUserAction("drag","dragend",c)):(e.triggerCallbacks("click",c,t),e.emitUserAction("click","click",c)),e._mouseUpHandlerHook(t,c),o.moving=!1,o.isDown=!1,o.x=0,o.y=0,s.prePlayTime=0,s.time=0;var l=t.type;"touchend"===l||"touchcancel"===l?(u.removeEventListener("touchmove",e.onMouseMove),u.removeEventListener("touchend",e.onMouseUp),u.removeEventListener("touchcancel",e.onMouseUp),e.blur()):(u.ownerDocument.removeEventListener("mousemove",e.onMouseMove,!1),u.ownerDocument.removeEventListener("mouseup",e.onMouseUp,!1),i.root.removeEventListener("click",e.onBodyClick,!1),o.isEnter?"mobile"!==a.isMobileSimulateMode&&e.bind("mousemove",e.onMoveOnly):e.onMouseLeave(t)),k.setTimeout(rd(e),function(){e.resetSeekState()},10),i.focus()}),rv(rd(e),"onMouseMove",function(t){var n=rd(e),i=n._state,r=n.pos,o=n.player,a=n.config;k.checkTouchSupport()&&t.preventDefault(),k.event(t);var s=k.getEventPos(t,o.zoom),u=90===o.rotateDeg?s.clientY:s.clientX,c=Math.abs(r.x-u);if((!r.moving||!(c<a.miniMoveStep))&&(!!r.moving||!(c<a.miniStartStep))){r.x=u;var l=e.computeTime(t,u);l.prePlayTime=i.prePlayTime,e._mouseMoveHandlerHook(t,l)}}),rv(rd(e),"onMouseOut",function(t){e.triggerCallbacks("mouseout",null,t)}),rv(rd(e),"onMouseOver",function(t){e.triggerCallbacks("mouseover",null,t)}),rv(rd(e),"onMouseEnter",function(t){var n=rd(e),i=n.player,r=n.pos;if(!r.isDown&&!r.isEnter&&!i.isMini&&(!!i.config.allowSeekAfterEnded||!i.ended)){r.isEnter=!0,e.bind("mousemove",e.onMoveOnly),e.bind("mouseleave",e.onMouseLeave),k.event(t);var o=k.getEventPos(t,i.zoom),a=90===i.rotateDeg?o.clientY:o.clientX,s=e.computeTime(t,a);e.triggerCallbacks("mouseenter",s,t),e.focus()}}),rv(rd(e),"onMouseLeave",function(t){e.triggerCallbacks("mouseleave",null,t),e.unlock(),e._updateInnerFocus(null),e.triggerCallbacks("mouseleaveFinished",null,t)}),rv(rd(e),"onVideoResize",function(){var t=e.pos,n=t.x,i=t.isDown;if(t.isEnter&&!i){var r=e.computeTime(null,n);e.onMoveOnly(null,r)}}),e.useable=!1,e.isProgressMoving=!1,e.__dragCallBacks=[],e._state={now:-1,direc:0,time:0,prePlayTime:-1},e._disableBlur=!1,e}return i=s,r=[{key:"duration",get:function(){return this.playerConfig.customDuration||this.player.duration}},{key:"timeOffset",get:function(){return this.playerConfig.timeOffset||0}},{key:"statistic",get:function(){return rf({hasActive:k.hasClass(this.root,"active"),disableBlur:this._disableBlur},this.pos||{})}},{key:"changeState",value:function(){var t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.useable=t}},{key:"beforeCreate",value:function(t){"boolean"==typeof t.player.config.progress&&(t.config.disable=!t.player.config.progress)}},{key:"_initInner",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(!e||0===e.length)&&(e=[{percent:1}]);var i=rf(rf({fragments:e},n),{},{actionCallback:function(e){t.emitUserAction("fragment_focus","fragment_focus",e)}});this.innerList?this.innerList.reset(i):(this.innerList=new ru(i),this.outer.insertBefore(this.innerList.render(),this.outer.children[0]),["findHightLight","unHightLight","setHightLight","findFragment"].map(function(e){t[e]=t.innerList[e].bind(t.innerList)}))}},{key:"_updateInnerFocus",value:function(t){this.innerList&&this.innerList.updateFocus(t)}},{key:"afterCreate",value:function(){var t=this;if(!this.config.disable&&!this.playerConfig.isLive){this.pos={x:0,y:0,moving:!1,isDown:!1,isEnter:!1},this.outer=this.find("xg-outer");var e=this.config,n=e.fragFocusClass,i=e.fragAutoFocus,r=e.fragClass;this._initInner(this.config.fragments,{fragFocusClass:n,fragAutoFocus:i,fragClass:r,style:this.playerConfig.commonStyle||{}}),"mobile"===tZ.device&&(this.config.isDragingSeek=!1,this.isMobile=!0),this.progressBtn=this.find(".xgplayer-progress-btn"),this.on(B,function(){t.onMouseLeave()}),this.on(I,function(){t.onTimeupdate()}),this.on(L,function(){t.onTimeupdate(),t.onCacheUpdate()}),this.on(V,function(){t.onCacheUpdate()}),this.on(x,function(){t.onCacheUpdate(!0),t.onTimeupdate(!0),t._state.now=0}),this.on(z,function(){t.onReset()}),this.on(tm,function(){t.onVideoResize()}),this.on(tT,function(){t.config.resetBlur&&t._disableBlur&&(t.enableBlur(),t.blur())}),this.bindDomEvents(),this.initCustomStyle()}}},{key:"setConfig",value:function(t){var e=this,n=null;Object.keys(t).forEach(function(i){e.config[i]=t[i],"fragments"===i&&(n=t[i])}),n&&this._initInner(n,t)}},{key:"initCustomStyle",value:function(){var t=(this.playerConfig||{}).commonStyle.sliderBtnStyle,e=this.progressBtn;t&&("string"==typeof t?e.style.boxShadow=t:"object"===rc(t)&&Object.keys(t).map(function(n){e.style[n]=t[n]}))}},{key:"triggerCallbacks",value:function(t,e,n){this.__dragCallBacks.length>0&&this.__dragCallBacks.map(function(i){if(i&&i.handler&&i.type===t)try{i.handler(e,n)}catch(t){}})}},{key:"addCallBack",value:function(t,e){e&&"function"==typeof e&&this.__dragCallBacks.push({type:t,handler:e})}},{key:"removeCallBack",value:function(t,e){var n=this.__dragCallBacks,i=-1;n.map(function(n,r){n&&n.type===t&&n.handler===e&&(i=r)}),i>-1&&n.splice(i,1)}},{key:"unlock",value:function(){var t=this.player,e=this.pos;if(e.isEnter=!1,!t.isMini){if(this.unbind("mousemove",this.onMoveOnly),e.isDown){this.unbind("mouseleave",this.onMouseLeave);return}this.blur()}}},{key:"bindDomEvents",value:function(){var t=this.player,e=t.controls,n=t.config;this._mouseDownHandlerHook=this.hook("dragstart",this._mouseDownHandler),this._mouseUpHandlerHook=this.hook("dragend",this._mouseUpHandler),this._mouseMoveHandlerHook=this.hook("drag",this._mouseMoveHandler),("touch"===this.domEventType||"compatible"===this.domEventType)&&(this.root.addEventListener("touchstart",this.onMouseDown),e&&(e.root&&e.root.addEventListener("touchmove",k.stopPropagation),e.center&&e.center.addEventListener("touchend",k.stopPropagation))),("mouse"===this.domEventType||"compatible"===this.domEventType)&&(this.bind("mousedown",this.onMouseDown),"mobile"!==n.isMobileSimulateMode&&this.bind("mouseenter",this.onMouseEnter),this.bind("mouseover",this.onMouseOver),this.bind("mouseout",this.onMouseOut))}},{key:"focus",value:function(){this.player.controls.pauseAutoHide(),k.addClass(this.root,"active")}},{key:"blur",value:function(){if(!this._disableBlur)this.player.controls.recoverAutoHide(),k.removeClass(this.root,"active")}},{key:"disableBlur",value:function(){this._disableBlur=!0}},{key:"enableBlur",value:function(){this._disableBlur=!1}},{key:"updateWidth",value:function(t,e,n){var i=this.config,r=this.player;if(i.isCloseClickSeek&&0===n)return;var o=t>=r.duration?r.duration-i.endedDiff:Number(t).toFixed(1);if(this.updatePercent(e),this.updateTime(t),1!==n||!!i.isDragingSeek&&"audio"!==r.videoConfig.mediaType)this._state.now=o,this._state.direc=o>r.currentTime?0:1,r.seek(o)}},{key:"computeTime",value:function(t,e){var n,i,r=this.player,o=this.root.getBoundingClientRect(),a=o.width,s=o.height,u=o.top,c=o.left;90===r.rotateDeg?(n=s,i=u):(n=a,i=c);var l=e-i,f=(l=l>n?n:l<0?0:l)/n,h=parseInt((f=f<0?0:f>1?1:f)*this.duration*1e3,10)/1e3;return{percent:f,currentTime:h,offset:l,width:n,left:i,e:t}}},{key:"updateTime",value:function(t){var e=this.player,n=this.duration;t>n?t=n:t<0&&(t=0);var i=e.plugins.time;i&&i.updateTime(t)}},{key:"resetSeekState",value:function(){this.isProgressMoving=!1;var t=this.player.plugins.time;t&&t.resetActive()}},{key:"updatePercent",value:function(t,e){if(this.isProgressMoving=!0,!this.config.disable){t=t>1?1:t<0?0:t,this.progressBtn.style.left="".concat(100*t,"%"),this.innerList.update({played:t*this.duration},this.duration);var n=this.player.plugins.miniprogress;n&&n.update({played:t*this.duration},this.duration)}}},{key:"onTimeupdate",value:function(t){var e=this.player,n=this._state,i=this.duration;if((!e.isSeeking||!e.video.seeking)&&!this.isProgressMoving&&!!e.hasStart){if(n.now>-1){var r=parseInt(1e3*n.now,10)-parseInt(1e3*e.currentTime,10);if(0===n.direc&&r>300||1===n.direc&&r>-300){n.now=-1;return}n.now=-1}var o=this.timeOffset+e.currentTime;o=k.adjustTimeByDuration(o,i,t),this.innerList.update({played:o},i),this.progressBtn.style.left="".concat(o/i*100,"%");var a=this.player.plugins.miniprogress;a&&a.update({played:o},i)}}},{key:"onCacheUpdate",value:function(t){var e=this.player,n=this.duration;if(!!e){var i=e.bufferedPoint.end;i=k.adjustTimeByDuration(i,n,t),this.innerList.update({cached:i},n);var r=this.player.plugins.miniprogress;r&&r.update({cached:i},n)}}},{key:"onReset",value:function(){this.innerList.update({played:0,cached:0},0);var t=this.player.plugins.miniprogress;t&&t.update({cached:0,played:0},0)}},{key:"destroy",value:function(){var t=this.player,e=t.controls;this.thumbnailPlugin=null,this.innerList.destroy(),this.innerList=null;var n=this.domEventType;("touch"===n||"compatible"===n)&&(this.root.removeEventListener("touchstart",this.onMouseDown),this.root.removeEventListener("touchmove",this.onMouseMove),this.root.removeEventListener("touchend",this.onMouseUp),e&&(e.root&&e.root.removeEventListener("touchmove",k.stopPropagation),e.center&&e.center.removeEventListener("touchend",k.stopPropagation))),("mouse"===n||"compatible"===n)&&(this.unbind("mousedown",this.onMouseDown),this.unbind("mouseenter",this.onMouseEnter),this.unbind("mousemove",this.onMoveOnly),this.unbind("mouseleave",this.onMouseLeave),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),t.root.removeEventListener("click",this.onBodyClick,!1))}},{key:"render",value:function(){if(!this.config.disable&&!this.playerConfig.isLive){var t=this.player.controls?this.player.controls.config.mode:"";return'\n    <xg-progress class="xgplayer-progress '.concat("bottom"===t?"xgplayer-progress-bottom":"",'">\n      <xg-outer class="xgplayer-progress-outer">\n        <xg-progress-btn class="xgplayer-progress-btn"></xg-progress-btn>\n      </xg-outer>\n    </xg-progress>\n    ')}}}],o=[{key:"pluginName",get:function(){return"progress"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_CENTER,index:0,disable:!1,isDragingSeek:!0,closeMoveSeek:!1,isPauseMoving:!1,isCloseClickSeek:!1,fragments:[{percent:1}],fragFocusClass:rm.POINT,fragClass:"",fragAutoFocus:!1,miniMoveStep:5,miniStartStep:2,onMoveStart:function(){},onMoveEnd:function(){},endedDiff:.2,resetBlur:!1}}},{key:"FRAGMENT_FOCUS_CLASS",get:function(){return rm}}],r&&rh(i.prototype,r),o&&rh(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function rw(t){return(rw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rk(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,rT(i.key),i)}}function r_(t,e){return(r_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function rS(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rP(t){return(rP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rO(t,e,n){return(e=rT(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rT(t){var e=function(t,e){if("object"!==rw(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==rw(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rw(e)?e:String(e)}var rE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r_(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=rP(e);return t=n?Reflect.construct(i,arguments,rP(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===rw(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return rS(t)}(this,t)});function s(){var t;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return rO(rS(t=a.call.apply(a,[this].concat(n))),"_onMouseenter",function(e){t.emit("icon_mouseenter",{pluginName:t.pluginName})}),rO(rS(t),"_onMouseLeave",function(e){t.emit("icon_mouseleave",{pluginName:t.pluginName})}),t}return i=s,r=[{key:"afterCreate",value:function(){this.bind("mouseenter",this._onMouseenter),this.bind("mouseleave",this._onMouseLeave),this.config.disable&&this.disable()}},{key:"destroy",value:function(){this.unbind("mouseenter",this._onMouseenter),this.unbind("mouseleave",this._onMouseLeave)}}],rk(i.prototype,r),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function rC(t){return(rC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rx(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,rI(i.key),i)}}function rj(){return(rj="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=rL(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function rR(t,e){return(rR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function rA(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rL(t){return(rL=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rI(t){var e=function(t,e){if("object"!==rC(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==rC(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rC(e)?e:String(e)}var rD=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rR(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=rL(e);return t=n?Reflect.construct(i,arguments,rL(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===rC(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return rA(t)}(this,t)});function s(){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var t,e,n,i,r=arguments.length,o=Array(r),u=0;u<r;u++)o[u]=arguments[u];return e=rA(t=a.call.apply(a,[this].concat(o))),n="btnClick",i=function(e){var n=rA(t),i=n.player;if(!n.config.disable)return e.preventDefault(),e.stopPropagation(),t.emitUserAction(e,"switch_play_pause"),i.ended?i.replay():i.paused&&!i.isBufferControlPaused?(i.play(),t.animate(!1)):(i.pause(),t.animate(!0)),!1},(n=rI(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,t}return i=s,r=[{key:"afterCreate",value:function(){var t=this;rj(rL(s.prototype),"afterCreate",this).call(this);var e=this.player;this.initIcons(),this.bind(["touchend","click"],this.btnClick),this.on([j,z,E],function(){t.animate(e.paused)}),this.on(ts,function(){t.animate(e.paused)}),this.animate(this.player.paused)}},{key:"registerIcons",value:function(){return{play:{icon:'<svg class="play" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40"><path fill="#fff" d="M18.468 11.639l7.503 4.777-7.503 4.777zM10.965 6.86l7.503 4.778v9.554l-7.503 4.778z"/></svg>',class:"xg-icon-play"},pause:{icon:'<svg class="pause" xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="3 -4 28 40"><path fill="#fff" d="M19.173 6.861h5.451v19.11h-5.45V6.86zM8.208 25.971V6.86h5.45v19.11h-5.45z"/></svg>',class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var t=this.icons;this.appendChild(".xgplayer-icon",t.play),this.appendChild(".xgplayer-icon",t.pause)}},{key:"animate",value:function(t){var e=this.i18nKeys,n=this.player;if(!t||!n.isBufferControlPaused)t?(this.setAttr("data-state","pause"),this.changeLangTextKey(this.find(".xg-tips"),e.PLAY_TIPS)):(this.setAttr("data-state","play"),this.changeLangTextKey(this.find(".xg-tips"),e.PAUSE_TIPS))}},{key:"destroy",value:function(){rj(rL(s.prototype),"destroy",this).call(this),this.unbind(["touchend","click"],this.btnClick)}},{key:"render",value:function(){return'<xg-icon class="xgplayer-play">\n    <div class="xgplayer-icon">\n    </div>\n    <div class="xg-tips" lang-key="'.concat(this.i18nKeys.PLAY_TIPS,'">').concat(this.i18n.PLAY_TIPS,"</div>\n    </xg-icon>")}}],o=[{key:"pluginName",get:function(){return"play"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_LEFT,index:0,disable:!1}}}],r&&rx(i.prototype,r),o&&rx(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(rE);function rN(t){return(rN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rM(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==rN(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==rN(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rN(e)?e:String(e)}(i.key),i)}}function rB(t,e){return(rB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function rF(t){return(rF=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var rH=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rB(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=rF(e);return t=n?Reflect.construct(i,arguments,rF(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===rN(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,r=[{key:"afterCreate",value:function(){var t=this;this.initIcons(),this.onClick=function(e){e.preventDefault(),e.stopPropagation(),t.config.onClick(e)},this.bind(["click","touchend"],this.onClick)}},{key:"registerIcons",value:function(){return{screenBack:{icon:'<svg width="32" height="40" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M11.237 14l6.382-6.381A.875.875 0 1016.38 6.38l-7 7a.875.875 0 000 1.238l7 7a.875.875 0 101.238-1.238L11.237 14z" fill="#FFF" fill-rule="evenodd"/></svg>',class:"xg-fullscreen-back"}}}},{key:"initIcons",value:function(){var t=this.icons;this.appendChild(this.root,t.screenBack)}},{key:"show",value:function(){k.addClass(this.root,"show")}},{key:"hide",value:function(){k.removeClass(this.root,"show")}},{key:"render",value:function(){return'<xg-icon class="xgplayer-back">\n    </xg-icon>'}}],o=[{key:"pluginName",get:function(){return"topbackicon"}},{key:"defaultConfig",get:function(){return{position:eR.ROOT_TOP,index:0}}}],r&&rM(i.prototype,r),o&&rM(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function rU(t){return(rU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rW(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,rY(i.key),i)}}function rV(){return(rV="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=rK(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function rG(t,e){return(rG=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function rz(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rK(t){return(rK=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rY(t){var e=function(t,e){if("object"!==rU(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==rU(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rU(e)?e:String(e)}var rX=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rG(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=rK(e);return t=n?Reflect.construct(i,arguments,rK(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===rU(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return rz(t)}(this,t)});function s(){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var t,e,n,i,r=arguments.length,o=Array(r),u=0;u<r;u++)o[u]=arguments[u];return e=rz(t=a.call.apply(a,[this].concat(o))),n="_onOrientationChange",i=function(e){t.player.fullscreen&&t.config.rotateFullscreen&&(90===window.orientation||-90===window.orientation?t.setRotateDeg(0):t.setRotateDeg(90))},(n=rY(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,t}return i=s,r=[{key:"afterCreate",value:function(){var t=this;rV(rK(s.prototype),"afterCreate",this).call(this);var e=this.config,n=this.playerConfig;e.target&&(this.playerConfig.fullscreenTarget=this.config.target);var i=k.getFullScreenEl();n.fullscreenTarget===i&&this.player.getFullscreen().catch(function(){}),this.initIcons(),this.handleFullscreen=this.hook("fullscreen_change",this.changeFullScreen,{pre:function(e){if(!t.config.disable)t.emitUserAction(e,"switch_fullscreen",{fullscreen:t.player.fullscreen})}}),this.bind(".xgplayer-fullscreen",["touchend","click"],this.handleFullscreen),this.on(tl,function(e){t.changeLangTextKey(t.find(".xg-tips"),e?t.i18nKeys.EXITFULLSCREEN_TIPS:t.i18nKeys.FULLSCREEN_TIPS),t.animate(e),t.config.needBackIcon&&t.show()}),this.config.needBackIcon&&(this.topBackIcon=this.player.registerPlugin({plugin:rH,options:{config:{onClick:function(e){t.handleFullscreen(e)}}}})),"mobile"===tZ.device&&window.addEventListener("orientationchange",this._onOrientationChange)}},{key:"registerIcons",value:function(){return{fullscreen:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40"><path fill="#fff" d="M19.173 6.861h6.798v6.798h-2.694V9.555h-4.104V6.86zm4.104 16.416v-4.104h2.694v6.798h-6.798v-2.694h4.104zM6.861 13.66V6.86h6.798v2.694H9.555v4.104H6.86zm2.694 5.514v4.104h4.104v2.694H6.86v-6.798h2.694z"/></svg>',class:"xg-get-fullscreen"},exitFullscreen:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="2 -4 28 40"><path fill="#fff" d="M21.867 10.965h4.104v2.694h-6.798V6.86h2.694v4.104zm-2.694 15.006v-6.798h6.798v2.694h-4.104v4.104h-2.694zm-8.208-15.006V6.861h2.694v6.798H6.86v-2.694h4.104zM6.861 21.867v-2.694h6.798v6.798h-2.694v-4.104H6.861z"/></svg>',class:"xg-exit-fullscreen"}}}},{key:"destroy",value:function(){rV(rK(s.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon","mobile"===tZ.device?"touchend":"click",this.handleFullscreen),"mobile"===tZ.device&&window.removeEventListener("orientationchange",this._onOrientationChange)}},{key:"initIcons",value:function(){var t=this.icons;this.appendChild(".xgplayer-icon",t.fullscreen),this.appendChild(".xgplayer-icon",t.exitFullscreen)}},{key:"setRotateDeg",value:function(t){var e=this.player;90===window.orientation||-90===window.orientation?e.rotateDeg=0:e.rotateDeg=t}},{key:"getRotateFullscreen",value:function(t){var e=this.player;e.isCssfullScreen&&e.exitCssFullscreen(t);var n=t?eW.INNER_FULLSCREEN:eW.ROTATE_FULLSCREEN;e._fullscreenEl=t||e.root,e.changeFullStyle(e.root,t,n,eW.PARENT_ROTATE_FULLSCREEN),e.fullscreen=!0,this.setRotateDeg(90),this.emit(tl,!0)}},{key:"exitRotateFullscreen",value:function(t){var e=this.player;e.fullscreen=!1;var n=e._fullscreenEl!==e.root?eW.INNER_FULLSCREEN:eW.ROTATE_FULLSCREEN;e.recoverFullStyle(e.root,e._fullscreenEl,n,eW.PARENT_ROTATE_FULLSCREEN),this.setRotateDeg(0),this.emit(tl,!1)}},{key:"changeFullScreen",value:function(t){var e=this.player,n=this.config;if(!n.disable){t&&(t.preventDefault(),t.stopPropagation());var i=!1;if((!0===n.useCssFullscreen||"function"==typeof n.useCssFullscreen&&n.useCssFullscreen())&&(i=!0),i)e.fullscreen?(e.fullscreen=!1,e.exitCssFullscreen(),this.emit(tl,!1)):(e.fullscreen=!0,e.getCssFullscreen(),this.emit(tl,!0)),this.animate(e.fullscreen);else if(n.rotateFullscreen)e.fullscreen?this.exitRotateFullscreen():this.getRotateFullscreen(),this.animate(e.fullscreen);else{if(n.switchCallback&&"function"==typeof n.switchCallback){n.switchCallback(e.fullscreen);return}e.fullscreen?e.exitFullscreen():e.getFullscreen().catch(function(){})}}}},{key:"animate",value:function(t){t?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.topBackIcon&&(t?(this.topBackIcon.show(),this.hide()):(this.topBackIcon.hide(),this.show()))}},{key:"show",value:function(){rV(rK(s.prototype),"show",this).call(this)}},{key:"hide",value:function(){rV(rK(s.prototype),"hide",this).call(this)}},{key:"render",value:function(){var t="FULLSCREEN_TIPS";return'<xg-icon class="xgplayer-fullscreen">\n    <div class="xgplayer-icon">\n    </div>\n    <div class="xg-tips" lang-key="'.concat(this.i18nKeys[t],'">').concat(this.i18n[t],"</div>\n    </xg-icon>")}}],o=[{key:"pluginName",get:function(){return"fullscreen"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_RIGHT,index:0,useCssFullscreen:!1,rotateFullscreen:!1,switchCallback:null,target:null,disable:!1,needBackIcon:!1}}}],r&&rW(i.prototype,r),o&&rW(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(rE);function rq(t){return(rq="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rJ(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==rq(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==rq(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===rq(e)?e:String(e)}(i.key),i)}}function rZ(){return(rZ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=rQ(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function r$(t,e){return(r$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function rQ(t){return(rQ=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var r0=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r$(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=rQ(e);return t=n?Reflect.construct(i,arguments,rQ(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===rq(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),(e=a.call(this,t)).isActiving=!1,e.state={currentTime:0,duration:0},e}return i=s,r=[{key:"duration",get:function(){var t,e;return(null===(t=this.playerConfig)||void 0===t?void 0:t.customDuration)||(null===(e=this.player)||void 0===e?void 0:e.duration)||0}},{key:"timeOffset",get:function(){var t;return(null===(t=this.playerConfig)||void 0===t?void 0:t.timeOffset)||0}},{key:"afterCreate",value:function(){var t=this,e=this.player.controls.config.mode;if(this.mode="flex"===e?"flex":"normal",!this.config.disable)"flex"===this.mode&&(this.createCenterTime(),this.hide()),this.durationDom=this.find(".time-duration"),this.timeDom=this.find(".time-current"),this.on([B,L,I],function(e){"durationchange"===e.eventName&&(t.isActiving=!1),t.onTimeUpdate()}),this.on(x,function(){t.onTimeUpdate(!0)}),this.on(z,function(){t.onReset()})}},{key:"afterPlayerInit",value:function(){var t,e=this.config;if(this.state={currentTime:0,duration:0},this.duration===1/0||null!==(t=this.playerConfig)&&void 0!==t&&t.isLive?(k.hide(this.durationDom),k.hide(this.timeDom),k.hide(this.find(".time-separator")),k.show(this.find(".time-live-tag"))):k.hide(this.find(".time-live-tag")),e.hide){this.hide();return}this.show()}},{key:"show",value:function(){if("flex"!==this.mode)rZ(rQ(s.prototype),"show",this).call(this)}},{key:"onTimeUpdate",value:function(t){var e=this.player,n=this.config,i=this.duration;if(!!e&&!!e.hasStart&&!n.disable&&!this.isActiving){var r="flex"===this.mode?this.centerCurDom:this.timeDom,o="flex"===this.mode?this.centerDurDom:this.durationDom,a=!1,s=!1,u=e.currentTime+this.timeOffset;u=k.adjustTimeByDuration(u,i,t);var c=k.format(u);this.state.currentTime!==c&&(this.state.currentTime=c,a=!0),this.state.duration!==i&&(this.state.duration=i,s=!0),n.smartRender?(a&&(r.textContent=c),s&&i!==1/0&&i>0&&(o.textContent=k.format(i))):(r.innerHTML=c,i!==1/0&&i>0&&(o.innerHTML=k.format(i)))}}},{key:"onReset",value:function(){var t="flex"===this.mode?this.centerCurDom:this.timeDom,e="flex"===this.mode?this.centerDurDom:this.durationDom;this.config.smartRender?(this.state.currentTime=0,this.state.duration=0,t.textContent=k.format(0),e.textContent=k.format(0)):(t.innerHTML=k.format(0),e.innerHTML=k.format(0))}},{key:"createCenterTime",value:function(){var t=this.player;if(!!t.controls&&!!t.controls.center){var e=t.controls.center;this.centerCurDom=k.createDom("xg-icon","00:00",{},"xgplayer-time left"),this.centerDurDom=k.createDom("xg-icon","00:00",{},"xgplayer-time right"),e.children.length>0?e.insertBefore(this.centerCurDom,e.children[0]):e.appendChild(this.centerCurDom),e.appendChild(this.centerDurDom)}}},{key:"changeLiveState",value:function(t){t?(k.hide(this.durationDom),k.hide(this.timeDom),k.hide(this.find(".time-separator")),k.show(this.find(".time-live-tag"))):(k.hide(this.find(".time-live-tag")),k.show(this.find(".time-separator")),k.show(this.durationDom),k.show(this.timeDom))}},{key:"updateTime",value:function(t){if(this.isActiving=!0,(!!t||0===t)&&!(t>this.duration)){var e="flex"===this.mode?this.centerCurDom:this.timeDom;this.config.smartRender?(this.state.currentTime=t,e.textContent=k.format(t)):e.innerHTML=k.format(t)}}},{key:"resetActive",value:function(){var t=this,e=this.player,n=function(){t.isActiving=!1};this.off(L,n),e.isSeeking&&e.video.seeking?this.once(L,n):this.isActiving=!1}},{key:"destroy",value:function(){var t=this.player.controls.center;this.centerCurDom&&t.removeChild(this.centerCurDom),this.centerCurDom=null,this.centerDurDom&&t.removeChild(this.centerDurDom),this.centerDurDom=null}},{key:"render",value:function(){if(!this.config.disable)return'<xg-icon class="xgplayer-time">\n    <span class="time-current">00:00</span>\n    <span class="time-separator">/</span>\n    <span class="time-duration">00:00</span>\n    <span class="time-live-tag">'.concat(this.i18n.LIVE_TIP,"</span>\n    </xg-icon>")}}],o=[{key:"pluginName",get:function(){return"time"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_LEFT,index:2,disable:!1,smartRender:!1}}}],r&&rJ(i.prototype,r),o&&rJ(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function r1(t){return(r1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r2(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r9(i.key),i)}}function r3(t,e){return(r3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function r4(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function r6(t){return(r6=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r5(t,e,n){return(e=r9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r9(t){var e=function(t,e){if("object"!==r1(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==r1(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===r1(e)?e:String(e)}var r8=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r3(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=r6(e);return t=n?Reflect.construct(i,arguments,r6(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===r1(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return r4(t)}(this,t)});function s(){var t;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return r5(r4(t=a.call.apply(a,[this].concat(n))),"onBarMousedown",function(e){var n=r4(t).player,i=t.find(".xgplayer-bar");k.event(e);var r=i.getBoundingClientRect(),o=k.getEventPos(e,n.zoom),a=r.height-(o.clientY-r.top);if(o.h=a,o.barH=r.height,t.pos=o,!(a<-2))return t.updateVolumePos(a,e),document.addEventListener("mouseup",t.onBarMouseUp),t._d.isStart=!0,!1}),r5(r4(t),"onBarMouseMove",function(e){var n=r4(t)._d;if(!n.isStart)return;var i=r4(t),r=i.pos,o=i.player;e.preventDefault(),e.stopPropagation(),k.event(e);var a=k.getEventPos(e,o.zoom);n.isMoving=!0;var s=r.h-a.clientY+r.clientY;if(!(s>r.barH))t.updateVolumePos(s,e)}),r5(r4(t),"onBarMouseUp",function(e){k.event(e),document.removeEventListener("mouseup",t.onBarMouseUp);var n=r4(t)._d;n.isStart=!1,n.isMoving=!1}),r5(r4(t),"onMouseenter",function(e){t._d.isActive=!0,t.focus(),t.emit("icon_mouseenter",{pluginName:t.pluginName})}),r5(r4(t),"onMouseleave",function(e){t._d.isActive=!1,t.unFocus(100,!1,e),t.emit("icon_mouseleave",{pluginName:t.pluginName})}),r5(r4(t),"onVolumeChange",function(e){if(!!t.player){var n=t.player,i=n.muted,r=n.volume;!t._d.isMoving&&(t.find(".xgplayer-drag").style.height=i||0===r?"4px":"".concat(100*r,"%"),t.config.showValueLabel&&t.updateVolumeValue()),t.animate(i,r)}}),r5(r4(t),"onIconHandle",function(e){t.changeMutedHandler(e)}),t}return i=s,r=[{key:"registerIcons",value:function(){return{volumeSmall:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40"><path fill="#fff" d="M7.907 7.907H3.39v6.778h4.518l5.648 5.648V2.259L7.907 7.907zM17.554 15.295L15.95 13.69c.612-.613.991-1.46.991-2.395s-.379-1.782-.991-2.395l1.604-1.604c1.03 1.02 1.669 2.435 1.669 3.999s-.638 2.979-1.669 3.998zm0 0L15.95 13.69c.612-.613.991-1.46.991-2.395s-.379-1.782-.991-2.395l1.604-1.604c1.03 1.02 1.669 2.435 1.669 3.999s-.638 2.979-1.669 3.998z"/></svg>',class:"xg-volume-small"},volumeLarge:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40"><path fill="#fff" d="M7.907 7.907H3.39v6.778h4.518l5.648 5.648V2.259L7.907 7.907zM20.753 18.48l-1.593-1.592c1.437-1.429 2.326-3.407 2.326-5.592s-.89-4.163-2.326-5.591l1.593-1.593c1.845 1.835 2.987 4.376 2.987 7.184s-1.142 5.349-2.987 7.184zm-3.199-3.185L15.95 13.69c.612-.613.991-1.46.991-2.395s-.379-1.782-.991-2.395l1.604-1.604c1.03 1.02 1.669 2.435 1.669 3.999s-.638 2.979-1.669 3.998z"/></svg>',class:"xg-volume"},volumeMuted:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="28" height="40" viewBox="0 -10 28 40"><path fill="#fff" d="M7.907 7.907H3.39v6.778h4.518l5.648 5.648V2.259L7.907 7.907zM20.306 9.703l-2.394-2.406-1.604 1.604 2.417 2.395-2.406 2.395 1.604 1.604 2.383-2.418 2.395 2.406 1.604-1.604-2.417-2.383 2.406-2.395-1.604-1.604-2.384 2.418z"/></svg>',class:"xg-volume-mute"}}}},{key:"afterCreate",value:function(){var t=this;this._timerId=null,this._d={isStart:!1,isMoving:!1,isActive:!1},this.initIcons();var e=this.playerConfig,n=e.commonStyle,i=e.volume;n.volumeColor&&(this.find(".xgplayer-drag").style.backgroundColor=n.volumeColor),this.changeMutedHandler=this.hook("mutedChange",function(e){t.changeMuted(e)},{pre:function(t){t.preventDefault(),t.stopPropagation()}}),this._onMouseenterHandler=this.hook("mouseenter",this.onMouseenter),this._onMouseleaveHandler=this.hook("mouseleave",this.onMouseleave),("mobile"!==tZ.device&&"mobile"!==this.playerConfig.isMobileSimulateMode||"compatible"===this.domEventType)&&(this.bind("mouseenter",this._onMouseenterHandler),this.bind(["blur","mouseleave"],this._onMouseleaveHandler),this.bind(".xgplayer-slider",["mousedown","touchstart"],this.onBarMousedown),this.bind(".xgplayer-slider",["mousemove","touchmove"],this.onBarMouseMove),this.bind(".xgplayer-slider",["mouseup","touchend"],this.onBarMouseUp)),this.bind(".xgplayer-icon",["touchend","click"],this.onIconHandle),this.on(F,this.onVolumeChange),this.once(H,this.onVolumeChange),("Number"!==k.typeOf(i)||i<0||i>1)&&(this.player.volume=this.config.default),this.onVolumeChange(),this.config.disable&&this.disable()}},{key:"updateVolumePos",value:function(t,e){var n=this.player,i=this.find(".xgplayer-drag"),r=this.find(".xgplayer-bar");if(!!r&&!!i){var o=Math.max(Math.min(t/r.getBoundingClientRect().height,1),0),a=parseInt(1e3*o,10),s={volume:{from:n.volume,to:a/1e3}};i.style.height="".concat(100*o,"%"),n.muted&&(s.muted={from:!0,to:!1}),this.emitUserAction(e,"change_volume",{muted:n.muted,volume:n.volume,props:s}),n.volume=Math.max(Math.min(a/1e3,1),0),n.muted&&(n.muted=!1),this.config.showValueLabel&&this.updateVolumeValue()}}},{key:"updateVolumeValue",value:function(){var t=this.player,e=t.volume,n=t.muted,i=this.find(".xgplayer-value-label"),r=Math.max(Math.min(e,1),0);i.innerText=n?0:Math.round(100*r)}},{key:"focus",value:function(){var t=this.player;if(!this.config.disable)t.focus({autoHide:!1}),this._timerId&&(k.clearTimeout(this,this._timerId),this._timerId=null),k.addClass(this.root,"slide-show")}},{key:"unFocus",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2?arguments[2]:void 0,r=this._d,o=this.player;if(!r.isActive)this._timerId&&(k.clearTimeout(this,this._timerId),this._timerId=null),this._timerId=k.setTimeout(this,function(){!r.isActive&&(n?o.blur():o.focus(),k.removeClass(t.root,"slide-show"),r.isStart&&t.onBarMouseUp(i)),t._timerId=null},e)}},{key:"changeMuted",value:function(t){if(!this.config.disable){t&&t.stopPropagation();var e=this.player;this._d.isStart&&this.onBarMouseUp(t),this.emitUserAction(t,"change_muted",{muted:e.muted,volume:e.volume,props:{muted:{from:e.muted,to:!e.muted}}}),e.volume>0&&(e.muted=!e.muted),e.volume<.01&&(e.volume=this.config.miniVolume)}}},{key:"animate",value:function(t,e){t||0===e?this.setAttr("data-state","mute"):e<.5&&this.icons.volumeSmall?this.setAttr("data-state","small"):this.setAttr("data-state","normal")}},{key:"initIcons",value:function(){var t=this.icons;this.appendChild(".xgplayer-icon",t.volumeSmall),this.appendChild(".xgplayer-icon",t.volumeLarge),this.appendChild(".xgplayer-icon",t.volumeMuted)}},{key:"destroy",value:function(){this._timerId&&(k.clearTimeout(this,this._timerId),this._timerId=null),this.unbind("mouseenter",this.onMouseenter),this.unbind(["blur","mouseleave"],this.onMouseleave),this.unbind(".xgplayer-slider",["mousedown","touchstart"],this.onBarMousedown),this.unbind(".xgplayer-slider",["mousemove","touchmove"],this.onBarMouseMove),this.unbind(".xgplayer-slider",["mouseup","touchend"],this.onBarMouseUp),document.removeEventListener("mouseup",this.onBarMouseUp),this.unbind(".xgplayer-icon","mobile"===tZ.device?"touchend":"click",this.onIconHandle)}},{key:"render",value:function(){var t=this.config.default||this.player.volume,e=this.config.showValueLabel;return'\n    <xg-icon class="xgplayer-volume" data-state="normal">\n      <div class="xgplayer-icon">\n      </div>\n      <xg-slider class="xgplayer-slider">\n        '.concat(e?'<div class="xgplayer-value-label">'.concat(100*t,"</div>"):"",'\n        <div class="xgplayer-bar">\n          <xg-drag class="xgplayer-drag" style="height: ').concat(100*t,'%"></xg-drag>\n        </div>\n      </xg-slider>\n    </xg-icon>')}}],o=[{key:"pluginName",get:function(){return"volume"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_RIGHT,index:1,disable:!1,showValueLabel:!1,default:.6,miniVolume:.2}}}],r&&r2(i.prototype,r),o&&r2(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function r7(t){return(r7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ot(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,oo(i.key),i)}}function oe(){return(oe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=or(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function on(t,e){return(on=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function oi(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function or(t){return(or=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oo(t){var e=function(t,e){if("object"!==r7(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==r7(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===r7(e)?e:String(e)}var oa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&on(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=or(e);return t=n?Reflect.construct(i,arguments,or(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===r7(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return oi(t)}(this,t)});function s(t){var e,n,i,r;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),n=oi(e=a.call(this,t)),i="onBtnClick",r=function(t){if(!e.config.disable)t.preventDefault(),t.stopPropagation(),e.emitUserAction(t,"rotate"),e.rotate(e.config.clockwise,e.config.innerRotate,1)},(i=oo(i))in n?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r,e.rotateDeg=e.config.rotateDeg||0,e}return i=s,r=[{key:"afterCreate",value:function(){var t=this;if(!this.config.disable){oe(or(s.prototype),"afterCreate",this).call(this),this.appendChild(".xgplayer-icon",this.icons.rotate),this.bind(".xgplayer-icon",["click","touchend"],this.onBtnClick),this.on(tm,function(){t.rotateDeg&&t.config.innerRotate&&k.setTimeout(t,function(){t.updateRotateDeg(t.rotateDeg,t.config.innerRotate)},100)});var e=this.player.root;this.rootWidth=e.style.width||e.offsetWidth||e.clientWidth,this.rootHeight=e.style.height||e.offsetHeight||e.clientHeight,this.rotateDeg&&this.updateRotateDeg(this.rotateDeg,this.config.innerRotate)}}},{key:"destroy",value:function(){oe(or(s.prototype),"destroy",this).call(this),this.unbind(".xgplayer-icon",["click","touchend"],this.onBtnClick)}},{key:"updateRotateDeg",value:function(t,e){!t&&(t=0);var n=this.player,i=this.rootWidth,r=this.rootHeight;if(e){n.videoRotateDeg=t;return}var o=this.player,a=o.root,s=o.innerContainer,u=o.video,c=a.offsetWidth,l=s&&e?s.offsetHeight:a.offsetHeight,f=i,h=r,p=0,d=0;(.75===t||.25===t)&&(f="".concat(l,"px"),h="".concat(c,"px"),p=-(l-c)/2,d=-(c-l)/2);var y="translate(".concat(p,"px,").concat(d,"px) rotate(").concat(t,"turn)"),v={transformOrigin:"center center",transform:y,webKitTransform:y,height:h,width:f},g=e?u:a,m=e?n.getPlugin("poster"):null;Object.keys(v).map(function(t){g.style[t]=v[t],m&&m.root&&(m.root.style[t]=v[t])})}},{key:"rotate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=this.player;!this.rotateDeg&&(this.rotateDeg=0);this.rotateDeg=(this.rotateDeg+1+.25*(t?1:-1)*n)%1,this.updateRotateDeg(this.rotateDeg,e),i.emit(tw,360*this.rotateDeg)}},{key:"registerIcons",value:function(){return{rotate:'<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="-4 -6 40 40" fill="none"><g clip-path="url(#clip0)" fill="#fff"><path d="M17.5 13.75H6.25A3.75 3.75 0 002.5 17.5v6.25a3.75 3.75 0 003.75 3.75H17.5a3.75 3.75 0 003.75-3.75V17.5a3.75 3.75 0 00-3.75-3.75z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M5.822 6.094a1.247 1.247 0 00.156 1.79l4.509 4.204a1.25 1.25 0 101.705-1.828L9.93 8.152l4.799-.018.039-.001a10 10 0 019.521 13.983 1.25 1.25 0 002.292.998 12.5 12.5 0 00-11.88-17.48l-5.05.019 2.293-2.46a1.25 1.25 0 10-1.829-1.705L5.854 6.06l-.032.036z"/></g><defs><clipPath id="RotateSvg-clip0"><path fill="#fff" d="M0 0h40v40H0z"/></clipPath></defs></svg>'}}},{key:"render",value:function(){return'\n    <xg-icon class="xgplayer-rotate">\n      <div class="xgplayer-icon">\n      </div>\n      <div class="xg-tips" lang-key="'.concat(this.i18nKeys.ROTATE_TIPS,'">\n      ').concat(this.i18n.ROTATE_TIPS,"\n      </div>\n    </xg-icon>")}}],o=[{key:"pluginName",get:function(){return"rotate"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_RIGHT,index:6,innerRotate:!0,clockwise:!1,rotateDeg:0,disable:!1}}}],r&&ot(i.prototype,r),o&&ot(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(rE);function os(t){return(os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ou(){ou=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=Object.create((e&&e.prototype instanceof h?e:h).prototype);return i(o,"_invoke",{value:function(t,e,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return O()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=function t(e,n){var i=n.method,r=e.iterator[i];if(void 0===r)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=void 0,t(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+i+"' method")),f;var o=l(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,f;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,f):a:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,f)}(a,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=l(t,e,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}(t,n,new S(r||[]))}),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var f={};function h(){}function p(){}function d(){}var y={};u(y,o,function(){return this});var v=Object.getPrototypeOf,g=v&&v(v(P([])));g&&g!==e&&n.call(g,o)&&(y=g);var m=d.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach(function(e){u(t,e,function(t){return this._invoke(e,t)})})}function w(t,e){var r;i(this,"_invoke",{value:function(i,o){function a(){return new e(function(r,a){!function i(r,o,a,s){var u=l(t[r],t,o);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==os(f)&&n.call(f,"__await")?e.resolve(f.__await).then(function(t){i("next",t,a,s)},function(t){i("throw",t,a,s)}):e.resolve(f).then(function(t){c.value=t,a(c)},function(t){return i("throw",t,a,s)})}s(u.arg)}(i,o,r,a)})}return r=r?r.then(a,a):a()}})}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function P(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:O}}function O(){return{value:void 0,done:!0}}return p.prototype=d,i(m,"constructor",{value:d,configurable:!0}),i(d,"constructor",{value:p,configurable:!0}),p.displayName=u(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},b(w.prototype),u(w.prototype,a,function(){return this}),t.AsyncIterator=w,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var a=new w(c(e,n,i,r),o);return t.isGeneratorFunction(n)?a:a.next().then(function(t){return t.done?t.value:a.next()})},b(m),u(m,s,"Generator"),u(m,o,function(){return this}),u(m,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return a.type="throw",a.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;_(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:P(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function oc(t,e,n,i,r,o,a){try{var s=t[o](a),u=s.value}catch(t){n(t);return}s.done?e(u):Promise.resolve(u).then(i,r)}function ol(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,oh(i.key),i)}}function of(t,e,n){return(e=oh(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oh(t){var e=function(t,e){if("object"!==os(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==os(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===os(e)?e:String(e)}function op(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}var od=new(function(){var t,e,n;function i(){var t=this;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),of(this,"_onLeave",function(){var e,n;t.detachEl(),t.detachPlayer(),null===(e=t.currentOptions_)||void 0===e||null===(n=e.onLeave)||void 0===n||n.call(e),t.currentOptions_=null,t.window=null,t._isStandaloneWindow=!1}),of(this,"_onBodyKeyDown",function(e){var n,i,r,o,a=null===(n=t.currentOptions_)||void 0===n?void 0:n.player;null==a||null===(i=a.plugins)||void 0===i||null===(r=i.keyboard)||void 0===r||null===(o=r.onBodyKeyDown)||void 0===o||o.call(r,e)}),this.currentOptions_=null,this.currentElement_=null,this._window=null,this._isStandaloneWindow=!1}return t=i,e=[{key:"window",get:function(){return this._window},set:function(t){var e=this._window;if(!e||e!==t)e&&(e.removeEventListener("pagehide",this._onLeave),e.document.removeEventListener("keydown",this._onBodyKeyDown)),t&&(t.addEventListener("pagehide",this._onLeave),t.document.addEventListener("keydown",this._onBodyKeyDown)),this._window=t||null}},{key:"isStandaloneWindow",get:function(){return this._isStandaloneWindow}},{key:"isSupported",value:function(){var t=/(metasr)/i.test(navigator.userAgent);return"documentPictureInPicture"in window&&/^(https|file)/.test(location.protocol)&&!t}},{key:"contains",value:function(t){var e;return!!(null!==(e=this.window)&&void 0!==e&&e.document.body.contains(t))}},{key:"requestWindow",value:function(t){var e,n,i=this,r=t.config,o=t.window,a=t.onEnter,s=t.onLeave,u=t.player;this.currentOptions_=t,this._isStandaloneWindow=!!r.alwaysKeepDocumentWindow;var c=new Promise(function(t){if(o)t(o);else{var e={};if(r.width&&r.height)e.width=r.width,e.height=r.height;else if(u){var n=u.root.getBoundingClientRect();e.width=n.width,e.height=n.height}"boolean"==typeof r.disallowReturnToOpener&&(e.disallowReturnToOpener=r.disallowReturnToOpener),"boolean"==typeof r.preferInitialWindowPlacement&&(e.preferInitialWindowPlacement=r.preferInitialWindowPlacement),r.docPiPTargetWindow?t(r.docPiPTargetWindow):documentPictureInPicture.requestWindow(e).then(function(e){t(e)})}});return c.then((n=(e=ou().mark(function t(e){var n,o,c,l,f,h;return ou().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.docPiPNode,o=r.docPiPStyle,c=n||(null==u?void 0:u.root)){t.next=4;break}return t.abrupt("return");case 4:return i.window=e,t.next=7,function(t){return new Promise(function(e){var n=document.createDocumentFragment(),i=[],r=[],o=0,a,s=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return op(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return op(t,e)}}(t))){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{!a&&null!=n.return&&n.return()}finally{if(s)throw o}}}}(document.styleSheets);try{for(s.s();!(a=s.n()).done;)!function(){var t=a.value;try{var n=Array.from(t.cssRules);n.length>0&&i.push(n.map(function(t){return t.cssText}).join(""))}catch(n){if(t.href){var s=document.createElement("link");s.rel="stylesheet",s.type=t.type||"text/css",s.media=t.media.mediaText||"all",s.href=t.href,s.onload=function(){o--,0===o&&e()},s.onerror=function(){o--,0===o&&e()},r.push(s),o++}}}()}catch(t){s.e(t)}finally{s.f()}if(r.forEach(function(t){return n.appendChild(t)}),i.length>0){var u=document.createElement("style");u.textContent=i.join("\n"),n.appendChild(u)}t.document.head.appendChild(n),0===o&&e()})}(e);case 7:l=document.createElement("style"),f=["body{padding:0; margin:0;}"],o?(h="","string"==typeof o?h=o:"function"==typeof o&&(h=o.call(r)),h&&f.push(h)):c===(null==u?void 0:u.root)&&f.push(".xgplayer{width: 100%!important; height: 100%!important;}"),l.textContent=f.join("\n"),e.document.head.append(l),i.attachPlayer(u,{element:c,window:e,onEnter:a,onLeave:s}),null==a||a({documentPictureInPictureWindow:e});case 14:case"end":return t.stop()}},t)}),function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function a(t){oc(o,i,r,a,s,"next",t)}function s(t){oc(o,i,r,a,s,"throw",t)}a(void 0)})}),function(t){return n.apply(this,arguments)})),c}},{key:"exit",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null===(t=this.window)||void 0===t||t.close(),e&&this._onLeave()}},{key:"attachEl",value:function(t){if(!!t&&!!this.window){var e=t.parentElement,n=t.nextSibling;this.window.document.body.append(t),this.currentElement_={element:t,parentNode:e,nextSibling:n}}}},{key:"detachEl",value:function(t){var e,n=this;if(!!this.currentElement_&&(!t||t===(null===(e=this.currentElement_)||void 0===e?void 0:e.element))){var i=this.currentElement_,r=i.element,o=i.parentNode,a=i.nextSibling;return o&&(o.isConnected?o.insertBefore(r,a):r.remove?r.remove():r.parentNode.removeChild(r)),Object.keys(this.currentElement_).forEach(function(t){n.currentElement_[t]=null}),this.currentElement_=null,r}}},{key:"attachPlayer",value:function(t,e){var n,i=e.element,r=e.window,o=e.onEnter,a=e.onLeave;if(!this.window||r===this.window)r&&(this.window=r),this.currentOptions_&&(o&&(this.currentOptions_.onEnter=o),a&&(this.currentOptions_.onLeave=a),t&&(this.currentOptions_.player=t)),i&&i!==(null===(n=this.currentElement_)||void 0===n?void 0:n.element)&&(this.detachEl(),this.attachEl(i))}},{key:"detachPlayer",value:function(t){var e,n;if(!!t)(null===(e=this.currentOptions_)||void 0===e?void 0:e.player)===t&&(this.currentOptions_.player=null),(null===(n=this.currentElement_)||void 0===n?void 0:n.element)===t.root&&this.detachEl()}}],ol(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}());function oy(t){return(oy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ov(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,ok(i.key),i)}}function og(){return(og="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ow(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function om(t,e){return(om=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ob(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ow(t){return(ow=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ok(t){var e=function(t,e){if("object"!==oy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==oy(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===oy(e)?e:String(e)}var o_={PIP:"picture-in-picture",INLINE:"inline",FULLSCREEN:"fullscreen"},oS=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&om(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=ow(e);return t=n?Reflect.construct(i,arguments,ow(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===oy(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return ob(t)}(this,t)});function s(){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var t,e,n,i,r=arguments.length,o=Array(r),u=0;u<r;u++)o[u]=arguments[u];return e=ob(t=a.call.apply(a,[this].concat(o))),n="switchPIP",i=function(e){if(!t.isPIPAvailable()||t.config.disable)return!1;e&&e instanceof Event&&e.stopPropagation(),t.isPip?(t.exitPIP(),t.emitUserAction(e,"change_pip",{from:"pip",to:"normal"}),t.setAttr("data-state","normal")):4===t.player.video.readyState&&(t.requestPIP(),t.emitUserAction(e,"change_pip",{from:"normal",to:"pip"}),t.setAttr("data-state","pip"))},(n=ok(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,t}return i=s,r=[{key:"setConfig",value:function(t){var e=this;if(!!t)Object.keys(t).map(function(n){e.config[n]=t[n]}),this.canShow()&&!this.root&&this.reInitialize(),this._initState()}},{key:"beforeCreate",value:function(t){"boolean"==typeof t.player.config.pip&&(t.config.showIcon=t.player.config.pip)}},{key:"afterCreate",value:function(){if(!!this.isPIPAvailable())og(ow(s.prototype),"afterCreate",this).call(this),this.pMode=o_.INLINE,this.pipWindow=null,this._initPipEvents(),this._initState({checkStyle:!0})}},{key:"canShow",value:function(){return this.config.showIcon&&this.isPIPAvailable()}},{key:"_initState",value:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.config.showIcon)this.initIcons(),n.checkStyle&&this.show("",!1);else{n.checkStyle&&this.hide();return}null!==(t=this.player)&&void 0!==t&&t.isComplete?this._checkIcon():this.once(tn,function(){return e._checkIcon()}),this.config.docPiPTargetWindow&&this.isDocPIPAvailable()&&this.requestPIP(),this.isPip&&this.setAttr("data-state","pip")}},{key:"_checkIcon",value:function(){this.config.showIcon&&(k.removeClass(this.find(".xgplayer-icon"),"xg-icon-disable"),this.bind("click",this.switchPIP))}},{key:"registerIcons",value:function(){return{pipIcon:{icon:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16.5 4.3h-13a.2.2 0 00-.2.2v11c0 .11.09.2.2.2h5v1.8h-5a2 2 0 01-2-2v-11a2 2 0 012-2h13a2 2 0 012 2v4h-1.8v-4a.2.2 0 00-.2-.2zM12 11.5a1 1 0 00-1 1v4a1 1 0 001 1h5.5a1 1 0 001-1v-4a1 1 0 00-1-1H12z" fill="#fff"/></svg>',class:"xg-get-pip"},pipIconExit:{icon:'<svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16.5 4.3h-13a.2.2 0 00-.2.2v11c0 .11.09.2.2.2h5v1.8h-5a2 2 0 01-2-2v-11a2 2 0 012-2h13a2 2 0 012 2v4h-1.8v-4a.2.2 0 00-.2-.2zM12 11.5a1 1 0 00-1 1v4a1 1 0 001 1h5.5a1 1 0 001-1v-4a1 1 0 00-1-1H12z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M9.5 7.7a.5.5 0 00.5-.5v-.7a.5.5 0 00-.5-.5h-4a.5.5 0 00-.5.5v3.96a.5.5 0 00.5.5h.7a.5.5 0 00.5-.5V8.83l2.07 2.109a.5.5 0 00.707.006l.5-.49a.5.5 0 00.006-.707L7.973 7.7H9.5z" fill="#fff"/></svg>',class:"xg-exit-pip"}}}},{key:"initIcons",value:function(){var t=this.icons;if(!this._isInitIcons)this.appendChild(".xgplayer-icon",t.pipIcon),this.appendChild(".xgplayer-icon",t.pipIconExit),this._isInitIcons=!0}},{key:"_initPipEvents",value:function(){var t=this,e=this.player;this.onBeforeFullscreenRequest=function(n){od.contains(e.root)&&od.detachEl(),t.exitPIP()},this.leavePIPCallback=function(){var n=e.paused;k.setTimeout(t,function(){n||e.videoPlay()},0),n||e.videoPlay(),t.setAttr("data-state","normal"),t.pipWindow=null,e.emit(tb,!1)},this.enterPIPCallback=function(n){t.setAttr("data-state","pip"),null!=n&&n.pictureInPictureWindow&&(t.pipWindow=n.pictureInPictureWindow),e.emit(tb,!0)},this.onWebkitpresentationmodechanged=function(n){var i=e.video.webkitPresentationMode;t.pMode===o_.FULLSCREEN&&i!==o_.FULLSCREEN&&e.onFullscreenChange(null,!1),t.pMode=i,i===o_.PIP?t.enterPIPCallback(n):i===o_.INLINE&&t.leavePIPCallback(n)},e.on(tc,this.onBeforeFullscreenRequest),e.video&&(e.video.addEventListener("enterpictureinpicture",this.enterPIPCallback),e.video.addEventListener("leavepictureinpicture",this.leavePIPCallback),s.checkWebkitSetPresentationMode(e.video)&&e.video.addEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged))}},{key:"requestPIP",value:function(t){var e=this.player,n=this.playerConfig,i=this.config;if(!!this.isPIPAvailable()&&!this.isPip)try{var r=n.poster;return r&&(e.video.poster="String"===k.typeOf(r)?r:r.poster),i.preferDocument&&this.isDocPIPAvailable()?od.requestWindow({config:i,window:t,player:e,onEnter:this.enterPIPCallback,onLeave:this.leavePIPCallback}):s.checkWebkitSetPresentationMode(e.video)?e.video.webkitSetPresentationMode("picture-in-picture"):e.video.requestPictureInPicture(),!0}catch(t){return!1}}},{key:"exitPIP",value:function(){var t=this.player;try{return this.isPIPAvailable()&&this.isPip&&(this.isDocPIPAvailable()&&this.getDocumentWindow()?od.exit():s.checkWebkitSetPresentationMode(t.video)?t.video.webkitSetPresentationMode("inline"):document.exitPictureInPicture()),!0}catch(t){return!1}}},{key:"isPip",get:function(){var t=this.player;return!!(this.isDocPIPAvailable()&&this.getDocumentWindow())||document.pictureInPictureElement&&document.pictureInPictureElement===t.video||t.video.webkitPresentationMode===o_.PIP}},{key:"isPIPAvailable",value:function(){var t=this.player.video;return("Boolean"!==k.typeOf(document.pictureInPictureEnabled)||document.pictureInPictureEnabled)&&("Boolean"===k.typeOf(t.disablePictureInPicture)&&!t.disablePictureInPicture||t.webkitSupportsPresentationMode&&"Function"===k.typeOf(t.webkitSetPresentationMode))||this.isDocPIPAvailable()}},{key:"isDocPIPAvailable",value:function(){return od.isSupported()}},{key:"getWindow",value:function(){return this.pipWindow}},{key:"getDocumentWindow",value:function(){return od.window}},{key:"attachDocumentWindow",value:function(t){var e,n=this.config.docPiPNode||(null===(e=this.player)||void 0===e?void 0:e.root);od.attachPlayer(this.player,{element:n,window:t,onEnter:this.enterPIPCallback,onLeave:this.leavePIPCallback})}},{key:"destroy",value:function(){og(ow(s.prototype),"destroy",this).call(this);var t=this.player,e=!(this.isPip&&this.getDocumentWindow()&&od.isStandaloneWindow);this.unbind("click",this.btnClick),t.off(tc,this.onBeforeFullscreenRequest),t.video.removeEventListener("enterpictureinpicture",this.enterPIPCallback),t.video.removeEventListener("leavepictureinpicture",this.leavePIPCallback),s.checkWebkitSetPresentationMode(t.video)&&t.video.removeEventListener("webkitpresentationmodechanged",this.onWebkitpresentationmodechanged),this.isPip&&this.getDocumentWindow()&&od.detachPlayer(t),e&&this.exitPIP(),this.pipWindow=null,!od.isStandaloneWindow&&(od.window=null)}},{key:"render",value:function(){if(!!this.canShow())return'<xg-icon class="xgplayer-pip">\n      <div class="xgplayer-icon xg-icon-disable">\n      </div>\n      <div class="xg-tips" lang-key="'.concat(this.i18nKeys.PIP,'">').concat(this.i18n.PIP,"</div>\n    </xg-icon>")}}],o=[{key:"pluginName",get:function(){return"pip"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_RIGHT,index:6,showIcon:!1,preferDocument:!1,width:void 0,height:void 0,docPiPTargetWindow:void 0,docPiPNode:void 0,docPiPStyle:void 0,alwaysKeepDocumentWindow:!1}}},{key:"checkWebkitSetPresentationMode",value:function(t){return"function"==typeof t.webkitSetPresentationMode}}],r&&ov(i.prototype,r),o&&ov(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(rE);function oP(t){return(oP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oO(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,ox(i.key),i)}}function oT(t,e){return(oT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function oE(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oC(t){return(oC=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ox(t){var e=function(t,e){if("object"!==oP(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==oP(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===oP(e)?e:String(e)}var oj=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oT(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=oC(e);return t=n?Reflect.construct(i,arguments,oC(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===oP(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return oE(t)}(this,t)});function s(t){var e,n,i,r;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),n=oE(e=a.call(this,t)),i="playNext",r=function(t){var n=oE(e).player;t.preventDefault(),t.stopPropagation(),e.idx+1<e.config.urlList.length?(e.idx++,n.emit(t_,e.idx+1),e.nextHandler(e.config.urlList[e.idx],e.idx)):(e.nextHandler(),n.emit(t_))},(i=ox(i))in n?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r,e.idx=-1,e}return i=s,r=[{key:"afterCreate",value:function(){if(!!this.config.urlList&&0!==this.config.urlList.length)this.appendChild(".xgplayer-icon",this.icons.playNext),this.initEvents()}},{key:"registerIcons",value:function(){return{playNext:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="40" viewBox="10 0 24 40"><path d="M30.4 10.64v21.504h-4.864v-9.856l-12.16 8.96V11.536l12.16 8.96V10.64z"/></svg>'}}},{key:"initEvents",value:function(){this.nextHandler=this.hook("playNext",this.changeSrc);var t="mobile"===tZ.device?"touchend":"click";this.bind(t,this.playNext),this.show()}},{key:"changeSrc",value:function(t){var e=this.player;if(!!t)e.pause(),e.currentTime=0,e.autoplay=!0,e.src=t}},{key:"destroy",value:function(){this.unbind(["touchend","click"],this.playNext)}},{key:"render",value:function(){if(!!this.config.urlList&&0!==this.config.urlList.length)return'\n     <xg-icon class="xgplayer-playnext">\n      <div class="xgplayer-icon">\n      </div>\n      <div class="xg-tips" lang-key="PLAYNEXT_TIPS">'.concat(this.i18n.PLAYNEXT_TIPS,"</div>\n     </xg-icon>\n    ")}}],o=[{key:"pluginName",get:function(){return"playNext"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_LEFT,index:1,url:null,urlList:[]}}}],r&&oO(i.prototype,r),o&&oO(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD),oR=n("3812"),oA=n.n(oR);function oL(t){return(oL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oI(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,oF(i.key),i)}}function oD(){return(oD="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=oB(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function oN(t,e){return(oN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function oM(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oB(t){return(oB=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oF(t){var e=function(t,e){if("object"!==oL(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==oL(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===oL(e)?e:String(e)}var oH=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oN(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=oB(e);return t=n?Reflect.construct(i,arguments,oB(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===oL(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return oM(t)}(this,t)});function s(t){var e,n,i,r;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),n=oM(e=a.call(this,t)),i="download",r=function(t){if(!e.isLock&&!e.config.disable){e.emitUserAction(t,"download");var n=e.getAbsoluteURL(e.player.src);oA()(n),e.isLock=!0,e.timer=window.setTimeout(function(){e.isLock=!1,window.clearTimeout(e.timer),e.timer=null},300)}},(i=oF(i))in n?Object.defineProperty(n,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[i]=r,e.timer=null,e.isLock=!1,e}return i=s,r=[{key:"afterCreate",value:function(){if(oD(oB(s.prototype),"afterCreate",this).call(this),!this.config.disable)this.appendChild(".xgplayer-icon",this.icons.download),this.bind(["click","touchend"],this.download)}},{key:"registerIcons",value:function(){return{download:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="#FFF" fill-rule="evenodd"><rect x="11" y="4" width="2" height="12" rx="1"/><rect x="3" y="18" width="18" height="2" rx="1"/><rect transform="rotate(90 4 17.5)" x="1.5" y="16.5" width="5" height="2" rx="1"/><rect transform="rotate(90 20 17.5)" x="17.5" y="16.5" width="5" height="2" rx="1"/><path d="M11.988 14.3l-4.243-4.242a1 1 0 00-1.414 1.414l4.95 4.95a1 1 0 001.414 0l4.95-4.95a1 1 0 10-1.414-1.414L11.988 14.3z"/></g></svg>'}}},{key:"getAbsoluteURL",value:function(t){if(!t.match(/^https?:\/\//)){var e=document.createElement("div");e.innerHTML='<a href="'.concat(t,'">x</a>'),t=e.firstChild.href}return t}},{key:"destroy",value:function(){oD(oB(s.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.download),window.clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){return'<xg-icon class="xgplayer-download">\n   <div class="xgplayer-icon">\n   </div>\n   <div class="xg-tips" lang-key="'.concat(this.i18nKeys.DOWNLOAD_TIPS,'">').concat(this.i18n.DOWNLOAD_TIPS,"</div>\n    </xg-icon>")}}],o=[{key:"pluginName",get:function(){return"download"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_RIGHT,index:3,disable:!0}}}],r&&oI(i.prototype,r),o&&oI(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(rE);function oU(t){return(oU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oW(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==oU(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==oU(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===oU(e)?e:String(e)}(i.key),i)}}function oV(){return(oV="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=oz(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function oG(t,e){return(oG=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function oz(t){return(oz=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var oK=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oG(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=oz(e);return t=n?Reflect.construct(i,arguments,oz(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===oU(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,r=[{key:"beforeCreate",value:function(t){"boolean"==typeof t.player.config.screenShot&&(t.config.disable=!t.player.config.screenShot)}},{key:"afterCreate",value:function(){oV(oz(s.prototype),"afterCreate",this).call(this),this.createCanvas(),this.appendChild(".xgplayer-icon",this.icons.screenshotIcon);var t=this.config;this.initSize=function(e){t.fitVideo&&(t.width=e.vWidth,t.height=e.vHeight)},this.once(tm,this.initSize)}},{key:"onPluginsReady",value:function(){this.show(),this.onClickBtn=this.onClickBtn.bind(this),this.bind(["click","touchend"],this.onClickBtn)}},{key:"saveScreenShot",value:function(t,e){var n=document.createElement("a");n.href=t,n.download=e;var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(i)}},{key:"createCanvas",value:function(t,e){var n=document.createElement("canvas");this.canvasCtx=n.getContext("2d"),this.canvas=n,n.width=t||this.config.width,n.height=e||this.config.height,this.config.canvasAdded&&this.player.root.appendChild(n)}},{key:"onClickBtn",value:function(t){var e=this;t.preventDefault(),t.stopPropagation(),this.emitUserAction(t,"shot"),this.shot().then(function(t){e.emit(tk,t),e.saveScreenShot(t,e.config.name+e.config.format)})}},{key:"shotArea",value:function(t,e,n,i){var r=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{quality:.92,type:"image/png"},a=this.config,s=this.player,u=o.quality||a.quality,c=o.type||a.type,l=s.video||s.media,f=this.canvas;return new Promise(function(o){var a,s=r.canvasCtx;f.width=n,f.height=i;var h={isContain:"contain"===(a=getComputedStyle(l)["object-fit"]),isCover:"cover"===a},p=h.isContain,d=h.isCover;if(p){var y=l.videoHeight/l.videoWidth,v=l.clientHeight/l.clientWidth,g=y;g=v>y?l.videoWidth/l.clientWidth:l.videoHeight/l.clientHeight,f.width=n,f.height=i,s.drawImage(l,t*g,e*g,n*g,i*g,0,0,n,i),o(f.toDataURL(c,u))}else if(d){var m=function(t,e,n,i){var r,o,a,s,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.5,l=t/e;return n/i>l?(a=i*l,s=i,r=(n-a)*u,o=0):(a=n,r=0,o=(i-(s=n/l))*c),{source:{x:r,y:o,width:a,height:s},destination:{x:0,y:0,width:t,height:e}}}(l.clientWidth,l.clientHeight,l.videoWidth,l.videoHeight),b=m.source,w=m.destination;f.width=w.width,f.height=w.height,s.drawImage(l,b.x,b.y,b.width,b.height,w.x,w.y,w.width,w.height);var k=f.toDataURL("image/png"),_=new Image(w.width,w.height);_.src=k,_.onload=function(){s.clearRect(0,0,f.width,f.height),f.width=n,f.height=i,s.drawImage(_,t,e,n,i,0,0,n,i),_.onload=null},s.drawImage(l,t,e,n,i,0,0,n,i),o(f.toDataURL(c,u))}})}},{key:"shot",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{quality:.92,type:"image/png"},r=this.config,o=this.player,a=i.quality||r.quality,s=i.type||r.type;return new Promise(function(i,u){n.canvas?(n.canvas.width=t||r.width,n.canvas.height=e||r.height):n.createCanvas(t,e),n.canvasCtx.drawImage(o.video,0,0,t||r.width,e||r.height);var c=n.canvas.toDataURL(s,a).replace(s,"image/octet-stream");i(c=c.replace(/^data:image\/[^;]+/,"data:application/octet-stream"))})}},{key:"registerIcons",value:function(){return{screenshotIcon:null}}},{key:"destroy",value:function(){oV(oz(s.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.onClickBtn),this.off(tm,this.initSize)}},{key:"render",value:function(){if(!this.config.disable&&!!this.config.showIcon){var t=this.icons.screenshotIcon?"xgplayer-icon":"xgplayer-icon btn-text",e="SCREENSHOT";return'\n      <xg-icon class="xgplayer-shot">\n      <div class="'.concat(t,'">\n      ').concat(this.icons.screenshotIcon?"":'<span lang-key="'.concat(this.i18nKeys[e],'">').concat(this.i18n[e],"</span>")," \n      </div>\n    </xg-icon>")}}}],o=[{key:"pluginName",get:function(){return"screenShot"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_RIGHT,index:5,quality:.92,type:"image/png",format:".png",width:600,height:337,fitVideo:!0,disable:!1,name:"screenshot",showIcon:!0,canvasCreated:!1,canvasAdded:!1}}}],r&&oW(i.prototype,r),o&&oW(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(rE);function oY(t){return(oY="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oX(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==oY(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==oY(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===oY(e)?e:String(e)}(i.key),i)}}var oq=function(){var t,e,n;function i(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,i),this.config=t.config,this.parent=t.root,this.root=k.createDom("ul","",{},"xg-options-list ".concat(this.config.className)),t.root.appendChild(this.root),this.onItemClick=this.onItemClick.bind(this),this.renderItemList();var e="touche"===this.config.domEventType?"touchend":"click";this._delegates=eD.delegate.call(this,this.root,"li",e,this.onItemClick)}return t=i,e=[{key:"renderItemList",value:function(t){var e=this,n=this.config,i=this.root;t?n.data=t:t=n.data,n.style&&Object.keys(n.style).map(function(t){i.style[t]=n[t]}),t.length>0&&(this.attrKeys=Object.keys(t[0])),this.root.innerHTML="",t.map(function(t,n){var i=t.selected?"option-item selected":"option-item";t["data-index"]=n,e.root.appendChild(k.createDom("li","<span>".concat(t.showText,"</span>"),t,i))})}},{key:"onItemClick",value:function(t){!t.delegateTarget&&(t.delegateTarget=t.target);var e=t.delegateTarget;if(e&&k.hasClass(e,"selected"))return!1;var n="function"==typeof this.config.onItemClick?this.config.onItemClick:null,i=this.root.querySelector(".selected");k.addClass(e,"selected"),i&&k.removeClass(i,"selected"),n(t,{from:i?this.getAttrObj(i,this.attrKeys):null,to:this.getAttrObj(e,this.attrKeys)})}},{key:"getAttrObj",value:function(t,e){if(!t||!e)return{};var n={};e.map(function(e){n[e]=t.getAttribute(e)});var i=t.getAttribute("data-index");return i&&(n.index=Number(i)),n}},{key:"show",value:function(){k.removeClass(this.root,"hide"),k.addClass(this.root,"active")}},{key:"hide",value:function(){k.removeClass(this.root,"active"),k.addClass(this.root,"hide")}},{key:"setStyle",value:function(t){var e=this;Object.keys(t).forEach(function(n){e.root.style[n]=t[n]})}},{key:"destroy",value:function(){this._delegates&&(this._delegates.map(function(t){t.destroy&&t.destroy()}),this._delegates=null),this.root.innerHTML=null,this.parent.removeChild(this.root),this.root=null}}],oX(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function oJ(t){return(oJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oZ(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,o2(i.key),i)}}function o$(t,e){return(o$=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function oQ(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function o0(t){return(o0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o1(t,e,n){return(e=o2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o2(t){var e=function(t,e){if("object"!==oJ(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==oJ(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===oJ(e)?e:String(e)}var o3="mobile"===tZ.device,o4=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o$(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=o0(e);return t=n?Reflect.construct(i,arguments,o0(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===oJ(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return oQ(t)}(this,t)});function s(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),o1(oQ(e=a.call(this,t)),"onEnter",function(t){t.preventDefault(),t.stopPropagation(),e.emit("icon_mouseenter",{pluginName:e.pluginName}),e.onToggle(!0)}),o1(oQ(e),"onLeave",function(t){t.preventDefault(),t.stopPropagation(),e.emit("icon_mouseleave",{pluginName:e.pluginName}),e.isActive&&e.onToggle(!1)}),e.isIcons=!1,e.isActive=!1,e.curValue=null,e.curIndex=0,e}return i=s,r=[{key:"updateLang",value:function(t){this.renderItemList(this.config.list,this.curIndex)}},{key:"afterCreate",value:function(){var t=this,e=this.config;this.initIcons(),o3=o3||"touch"===this.domEventType,"mobile"===tZ.device&&"middle"!==e.listType&&(e.listType="rightSide"),e.hidePortrait&&k.addClass(this.root,"portrait"),this.once(N,function(){e.list&&e.list.length>0&&(t.renderItemList(e.list),t.show())}),o3&&this.on(J,function(){if(!!t.isActive)t.optionsList&&t.optionsList.hide(),t.isActive=!1}),this.activeEvent=o3?"touchend":"mouseenter",this.bind(this.activeEvent,this.onEnter),this.bind("mouseleave",this.onLeave),this.isIcons&&this.bind("click",this.onIconClick),this.config.disable&&this.disable()}},{key:"initIcons",value:function(){var t=this,e=this.icons,n=Object.keys(e),i=!1;if(n.length>0&&(n.forEach(function(n){t.appendChild(".xgplayer-icon",e[n]),i||(i=e[n])}),this.isIcons=i),!i)this.appendChild(".xgplayer-icon",k.createDom("span","",{},"icon-text")),k.addClass(this.find(".xgplayer-icon"),"btn-text")}},{key:"show",value:function(){if(!!this.config.list&&!(this.config.list.length<1))k.addClass(this.root,"show")}},{key:"hide",value:function(){k.removeClass(this.root,"show")}},{key:"getTextByLang",value:function(t,e,n){if(void 0===t)return"";var i=this.config.list;n||(n=this.player.lang),e=!e||k.isUndefined(t[e])?"text":e,"number"==typeof t&&(t=i[t]);try{if("object"===oJ(t[e]))return t[e][n]||t[e].zh;return t[e]}catch(t){return""}}},{key:"onToggle",value:function(t){if(t!==this.isActive&&!this.config.disable){var e=this.player.controls,n=this.config.listType;t?("rightSide"===n?e.blur():e.focus(),this.optionsList&&this.optionsList.show()):("rightSide"===n?e.focus():e.unFocus(),this.optionsList&&this.optionsList.hide()),this.isActive=t}}},{key:"onItemClick",value:function(t,e){t.preventDefault(),t.stopPropagation();var n=this.config,i=n.listType,r=n.list;(o3||"rightSide"===i)&&this.onToggle(!1),this.curIndex=e.to.index,this.curItem=r[this.curIndex],this.changeCurrentText(),this.onToggle(!1)}},{key:"onIconClick",value:function(t){}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var t=this.config.list,e=this.curIndex<t.length?this.curIndex:0,n=t[e];n&&(this.find(".icon-text").innerHTML=this.getTextByLang(n,"iconText"))}}},{key:"renderItemList",value:function(t,e){var n=this,i=this.config,r=this.optionsList,o=this.player;if("number"==typeof e&&(this.curIndex=e,this.curItem=i.list[e]),r){r.renderItemList(t),this.changeCurrentText();return}var a={config:{data:t||[],className:"rightSide"===i.listType?"right-side":"",onItemClick:function(t,e){n.onItemClick(t,e)},domEventType:o3?"touche":"mouse"},root:"rightSide"===i.listType?o.root:this.root};this.config.isShowIcon&&(this.optionsList=new oq(a),this.changeCurrentText(),this.show())}},{key:"destroy",value:function(){this.unbind(this.activeEvent,this.onToggle),this.unbind("mouseleave",this.onToggle),this.optionsList&&(this.optionsList.destroy(),this.optionsList=null)}},{key:"render",value:function(){if(!!this.config.isShowIcon)return'<xg-icon class="xg-options-icon '.concat(this.config.className||"",'">\n    <div class="xgplayer-icon">\n    </div>\n   </xg-icon>')}}],o=[{key:"pluginName",get:function(){return"optionsIcon"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_RIGHT,index:100,list:[],listType:"middle",listStyle:{},hidePortrait:!0,isShowIcon:!1}}}],r&&oZ(i.prototype,r),o&&oZ(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function o6(t){return(o6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o5(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==o6(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==o6(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===o6(e)?e:String(e)}(i.key),i)}}function o9(){return(o9="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=o7(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function o8(t,e){return(o8=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function o7(t){return(o7=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var at=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o8(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=o7(e);return t=n?Reflect.construct(i,arguments,o7(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===o6(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),(e=a.call(this,t)).curTime=0,e.isPaused=!0,e}return i=s,r=[{key:"beforeCreate",value:function(t){var e=t.config.list;Array.isArray(e)&&e.length>0&&(t.config.list=e.map(function(t){return!t.text&&t.name&&(t.text=t.name),!t.text&&(t.text=t.definition),t}))}},{key:"afterCreate",value:function(){var t=this;o9(o7(s.prototype),"afterCreate",this).call(this);var e=this.config,n=e.list,i=e.defaultDefinition,r=this.playerConfig.defaultConfig;n.forEach(function(t){(t.definition===i||t.definition===r)&&(t.selected=!0)}),this.on("resourceReady",function(e){t.changeDefinitionList(e)}),this.on(tp,function(e){t.renderItemList(t.config.list,e.to)}),this.player.definitionList.length<2&&this.hide()}},{key:"initDefinition",value:function(){var t=this.config,e=t.list,n=t.defaultDefinition,i=this.playerConfig.defaultConfig;if(e.length>0){var r=null;e.map(function(t){(t.definition===n||t.definition===i)&&(r=t,t.selected=!0)}),!r&&(r=e[0]),this.changeDefinition(r)}}},{key:"renderItemList",value:function(t,e){var n=this,i=e&&e.definition?e.definition:"";e&&!Array.isArray(e)&&t.forEach(function(t){t.selected=!1});var r=0,o=t.map(function(t,e){var o={url:t.url,definition:t.definition||"",showText:n.getTextByLang(t)||t.definition,selected:!1};return(t.selected||!k.isUndefined(t.definition)&&t.definition===i)&&(o.selected=!0,r=e),o});o9(o7(s.prototype),"renderItemList",this).call(this,o,r)}},{key:"changeDefinitionList",value:function(t){if(!!Array.isArray(t)){var e=this.playerConfig,n=e.definition,i=e.defaultDefinition,r=n||this.config.defaultDefinition||"";this.config.list=t.map(function(t){return!t.text&&t.name&&(t.text=t.name),!t.text&&(t.text=t.definition),(t.definition===r||t.definition===i)&&(t.selected=!0),t}),n.list=t,this.renderItemList(t),this.config.list.length<2?this.hide():this.show()}}},{key:"changeDefinition",value:function(t,e){var n=this.player;n.switchURL?n.switchUrl(t.url):n.changeDefinition(t,e)}},{key:"onItemClick",value:function(t,e){var n=this.player.definitionList;o9(o7(s.prototype),"onItemClick",this).apply(this,arguments),this.emitUserAction(t,"change_definition",{from:e.from,to:e.to});for(var i=0;i<n.length;i++)e.to&&n[i].definition===e.to.definition&&(e.to.url=n[i].url),e.from&&n[i].definition===e.from.definition&&(e.from.url=n[i].url);this.player.changeDefinition(e.to,e.from)}}],o=[{key:"pluginName",get:function(){return"definition"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_RIGHT,index:3,list:[],defaultDefinition:"",disable:!1,hidePortrait:!1,className:"xgplayer-definition",isShowIcon:!0}}}],r&&o5(i.prototype,r),o&&o5(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(o4);function ae(t){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function an(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==ae(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==ae(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ae(e)?e:String(e)}(i.key),i)}}function ai(){return(ai="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ao(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function ar(t,e){return(ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ao(t){return(ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var aa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ar(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=ao(e);return t=n?Reflect.construct(i,arguments,ao(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===ae(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),(e=a.call(this,t)).curRate=1,e}return i=s,r=[{key:"beforeCreate",value:function(t){var e=t.player.config.playbackRate,n=e?Array.isArray(e)?e:t.config.list:[];Array.isArray(n)&&(t.config.list=n.map(function(t){return"number"==typeof t?t={rate:t,text:"".concat(t,"x")}:!t.text&&t.rate&&(t.text="".concat(t.rate,"x")),t}))}},{key:"afterCreate",value:function(){var t=this;ai(ao(s.prototype),"afterCreate",this).call(this),this.on(W,function(){if(t.curValue!==t.player.playbackRate)t.renderItemList()}),this.renderItemList()}},{key:"show",value:function(){if(!!this.config.list&&0!==this.config.list.length)ai(ao(s.prototype),"show",this).call(this)}},{key:"onItemClick",value:function(t,e){ai(ao(s.prototype),"onItemClick",this).apply(this,arguments);var n=Number(t.delegateTarget.getAttribute("rate"));if(!n||n===this.curValue)return!1;var i={playbackRate:{from:this.player.playbackRate,to:n}};this.emitUserAction(t,"change_rate",{props:i}),this.curValue=n,this.player.playbackRate=n}},{key:"renderItemList",value:function(){var t=this,e=this.player.playbackRate||1;this.curValue=e;var n=0,i=this.config.list.map(function(i,r){var o={rate:i.rate};return o.rate===e&&(o.selected=!0,n=r),o.showText=t.getTextByLang(i),o});ai(ao(s.prototype),"renderItemList",this).call(this,i,n)}},{key:"destroy",value:function(){ai(ao(s.prototype),"destroy",this).call(this)}}],o=[{key:"pluginName",get:function(){return"playbackRate"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_RIGHT,index:4,list:[2,1.5,1,.75,.5],className:"xgplayer-playbackrate",isShowIcon:!0,hidePortrait:!1}}}],r&&an(i.prototype,r),o&&an(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(o4);function as(t){return(as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function au(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==as(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==as(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===as(e)?e:String(e)}(i.key),i)}}function ac(){return(ac="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=af(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}}).apply(this,arguments)}function al(t,e){return(al=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function af(t){return(af=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ah=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&al(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=af(e);return t=n?Reflect.construct(i,arguments,af(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===as(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,r=[{key:"afterCreate",value:function(){var t=this;ac(af(s.prototype),"afterCreate",this).call(this),this.config.target&&(this.playerConfig.fullscreenTarget=this.config.target),this.initIcons(),this.on(tf,function(e){t.animate(e)}),this.btnClick=this.btnClick.bind(this),this.handleCssFullscreen=this.hook("cssFullscreen_change",this.btnClick,{pre:function(t){t.preventDefault(),t.stopPropagation()}}),this.bind(["click","touchend"],this.handleCssFullscreen)}},{key:"initIcons",value:function(){var t=this.icons,e=this.find(".xgplayer-icon");e.appendChild(t.cssFullscreen),e.appendChild(t.exitCssFullscreen)}},{key:"btnClick",value:function(t){if(!this.config.disable){t.preventDefault(),t.stopPropagation();var e=this.player.isCssfullScreen;this.emitUserAction(t,"switch_cssfullscreen",{cssfullscreen:e}),e?this.player.exitCssFullscreen():this.player.getCssFullscreen()}}},{key:"animate",value:function(t){if(!!this.root)t?this.setAttr("data-state","full"):this.setAttr("data-state","normal"),this.switchTips(t)}},{key:"switchTips",value:function(t){var e=this.i18nKeys;this.changeLangTextKey(this.find(".xg-tips"),t?e.EXITCSSFULLSCREEN_TIPS:e.CSSFULLSCREEN_TIPS)}},{key:"registerIcons",value:function(){return{cssFullscreen:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 -5 31 40"><path fill="#fff" class="path_full" d="M11.7 13v1.3a1.17 1.17 0 01-1.3 1.3 1.17 1.17 0 01-1.3-1.3v-2.6a1.17 1.17 0 011.3-1.3H13a1.17 1.17 0 011.3 1.3A1.17 1.17 0 0113 13zm7.8 5.2v-1.3a1.3 1.3 0 012.6 0v2.6a1.17 1.17 0 01-1.3 1.3h-2.6a1.3 1.3 0 010-2.6zm3.9-9.1H7.8v13h15.6zm2.6 0v13a2.6 2.6 0 01-2.6 2.6H7.8a2.6 2.6 0 01-2.6-2.6v-13a2.6 2.6 0 012.6-2.6h15.6A2.6 2.6 0 0126 9.1z"/></svg>',class:"xg-get-cssfull"},exitCssFullscreen:{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="31" height="40" viewBox="0 -5 31 40"><path fill="#fff" d="M11.7 13v-1.3a1.17 1.17 0 011.3-1.3 1.17 1.17 0 011.3 1.3v2.6a1.17 1.17 0 01-1.3 1.3h-2.6a1.17 1.17 0 01-1.3-1.3 1.17 1.17 0 011.3-1.3zm7.8 5.2v1.3a1.3 1.3 0 01-2.6 0v-2.6a1.17 1.17 0 011.3-1.3h2.6a1.3 1.3 0 010 2.6zm3.9-9.1H7.8v13h15.6zm2.6 0v13a2.6 2.6 0 01-2.6 2.6H7.8a2.6 2.6 0 01-2.6-2.6v-13a2.6 2.6 0 012.6-2.6h15.6A2.6 2.6 0 0126 9.1z"/></svg>',class:"xg-exit-cssfull"}}}},{key:"destroy",value:function(){ac(af(s.prototype),"destroy",this).call(this),this.unbind(["click","touchend"],this.btnClick)}},{key:"render",value:function(){return'<xg-icon class=\'xgplayer-cssfullscreen\'>\n    <div class="xgplayer-icon">\n    </div>\n    <div class="xg-tips" lang-key="'.concat(this.i18nKeys.CSSFULLSCREEN_TIPS,'">').concat(this.i18n.CSSFULLSCREEN_TIPS,"</div>\n    </xg-icon>")}}],o=[{key:"pluginName",get:function(){return"cssFullscreen"}},{key:"defaultConfig",get:function(){return{position:eR.CONTROLS_RIGHT,index:1,disable:!1,target:null}}}],r&&au(i.prototype,r),o&&au(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(rE);function ap(t){return(ap="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ad(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==ap(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==ap(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===ap(e)?e:String(e)}(i.key),i)}}function ay(t,e){return(ay=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function av(t){return(av=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ag=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ay(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=av(e);return t=n?Reflect.construct(i,arguments,av(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===ap(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,o=[{key:"pluginName",get:function(){return"error"}}],r=[{key:"afterCreate",value:function(){var t=this;this.clickHandler=this.hook("errorRetry",this.errorRetry,{pre:function(t){t.preventDefault(),t.stopPropagation()}}),this.onError=this.hook("errorHandler",this.handleError),this.bind(".xgplayer-error-refresh","click",this.clickHandler),this.on(N,function(){t.handleCanPlay()}),this.on(R,function(e){t.onError(e)})}},{key:"errorRetry",value:function(t){this.emitUserAction(t,"error_retry",{}),this.player.retry()}},{key:"handleCanPlay",value:function(){k.removeClass(this.player.root,"xgplayer-is-error")}},{key:"handleError",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.player,n=t.errorType,i=e.error;if(!i)switch(n){case"decoder":i=this.i18n.MEDIA_ERR_DECODE;break;case"network":i=this.i18n.MEDIA_ERR_NETWORK;break;default:i=this.i18n.MEDIA_ERR_SRC_NOT_SUPPORTED}this.find(".xgplayer-error-text").innerHTML=i,this.find(".xgplayer-error-tips").innerHTML="".concat(this.i18n.REFRESH_TIPS,'<span class="xgplayer-error-refresh">').concat(this.i18n.REFRESH,"</span>")}},{key:"destroy",value:function(){this.unbind(".xgplayer-error-refresh","click",this.clickHandler)}},{key:"render",value:function(){return'<xg-error class="xgplayer-error">\n      <div class="xgplayer-errornote">\n       <span class="xgplayer-error-text"></span>\n       <span class="xgplayer-error-tips"><em class="xgplayer-error-refresh"></em></span>\n      </div>\n    </xg-error>'}}],ad(i.prototype,r),o&&ad(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function am(t){return(am="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ab(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==am(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==am(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===am(e)?e:String(e)}(i.key),i)}}function aw(t,e){return(aw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ak(t){return(ak=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aw(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=ak(e);return t=n?Reflect.construct(i,arguments,ak(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===am(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,o=[{key:"pluginName",get:function(){return"prompt"}},{key:"defaultConfig",get:function(){return{interval:3e3,style:{},mode:"arrow",autoHide:!0,preventScreenOverflow:!1,detail:{text:"",highlight:""},onClick:function(){}}}}],r=[{key:"afterCreate",value:function(){var t=this;this.intervalId=0,this.customConfig=null,this.bind(".highlight",["click","touchend"],function(e){(t.config.onClick||t.customOnClick)&&(e.preventDefault(),e.stopPropagation(),t.customOnClick?t.customOnClick(e):t.config.onClick(e))}),this.player.showPrompt=function(){t.show.apply(t,arguments)},this.player.hidePrompt=function(){t.hide()}}},{key:"setStyle",value:function(t){var e=this;Object.keys(t).map(function(n){e.root.style[n]=t[n]})}},{key:"show",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(!!t){this.customOnClick=i;var r=this.config.interval;if(this.intervalId&&(clearTimeout(this.intervalId),this.intervalId=null),n.style&&this.setStyle(n.style),"string"==typeof t?this.find(".xgplayer-prompt-detail").innerHTML=t:this.find(".xgplayer-prompt-detail").innerHTML="".concat(t.text||"")+"".concat(t.highlight?'<i class="highlight">'.concat(t.highlight,"</i>"):""),"arrow"===n.mode&&k.addClass(this.root,"arrow"),n.preventScreenOverflow){var o=this.root.getBoundingClientRect(),a=o.left,s=o.right,u=document.documentElement.clientWidth||document.body.clientWidth;if(a<0){var c=Number((Math.abs(a)/u*100).toFixed(2));if(n.style.left){var l=parseInt(n.style.left);this.setStyle({left:"".concat(l+c+.5,"%")})}}if(s>=u){var f=Number(((Math.abs(s)-u)/u*100).toFixed(2));if(n.style.left){var h=parseInt(n.style.left);this.setStyle({left:"".concat(h-f-.5,"%")})}}}if(k.addClass(this.root,"show"),"boolean"==typeof n.autoHide?n.autoHide:this.config.autoHide){var p=n.interval||r;this.intervalId=setTimeout(function(){e.hide()},p)}}}},{key:"hide",value:function(){this.root&&(k.removeClass(this.root,"show"),k.removeClass(this.root,"arrow"),this.root.removeAttribute("style")),this.customOnClick=null}},{key:"render",value:function(){return'<xg-prompt class="xgplayer-prompt '.concat(eW.CONTROLS_FOLLOW,'">\n    <span class="xgplayer-prompt-detail"></span>\n    </xg-prompt>')}}],ab(i.prototype,r),o&&ab(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD),aS={time:0,text:"",id:1,duration:1,color:"#fff",style:{},width:6,height:6};function aP(t){Object.keys(aS).map(function(e){void 0===t[e]&&(t[e]=aS[e])})}var aO={initDots:function(){this.createDots(this._ispots,!1),this._ispotsInit=!0},createDots:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!!Array.isArray(e)&&!!e.length){var i=this.player.plugins.progress;if(i&&i.outer){var r=document.createDocumentFragment();e.forEach(function(e){var i=t._createDotElement(e,n);i&&r.appendChild(i)}),i.outer.appendChild(r)}}},createDot:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=this._createDotElement(t,e);if(n){var i=this.player.plugins.progress;i.outer&&i.outer.appendChild(n)}},_createDotElement:function(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!this.player.plugins.progress)return null;if(e&&(aP(t),this._ispots.push(t)),!this._ispotsInit&&e)return null;var n=this.calcuPosition(t.time,t.duration),i=t.style||{},r=t.stylePreferred;i.left=r&&void 0!==i.left?i.left:"".concat(n.left,"%"),i.width=r&&void 0!==i.width?i.width:"".concat(n.width,"%");var o="xgspot_".concat(t.id," xgplayer-spot");n.isMini&&(o+=" mini");var a=k.createDom("xg-spot",t.template||"",{"data-text":t.text,"data-time":t.time,"data-id":t.id},o);return Object.keys(i).forEach(function(t){a.style[t]=i[t]}),a},findDot:function(t){if(!!this.player.plugins.progress){var e=this._ispots.filter(function(e,n){return e.id===t});return e.length>0?e[0]:null}},updateDot:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.player.plugins.progress;if(!n)return;var i=this.findDot(t.id);if(i&&Object.keys(t).map(function(e){i[e]=t[e]}),!this._ispotsInit)return;var r=n.find('xg-spot[data-id="'.concat(t.id,'"]'));if(!!r){var o=this.calcuPosition(t.time,t.duration),a=t.style||{};a.left="".concat(o.left,"%"),a.width="".concat(o.width,"%"),r.setAttribute("data-text",t.text),r.setAttribute("data-time",t.time),o.isMini?k.addClass(r,"mini"):k.removeClass(r,"mini"),Object.keys(a).map(function(t){r.style[t]=a[t]}),e&&this.showDot(t.id)}},deleteDot:function(t){var e=this._ispots,n=this.player.plugins.progress;if(!!n){for(var i=[],r=0;r<e.length;r++)e[r].id===t&&i.push(r);for(var o=i.length,a=o-1;a>=0;a--)if(e.splice(i[a],1),this._ispotsInit){var s=n.find('xg-spot[data-id="'.concat(t,'"]'));s&&s.parentElement.removeChild(s)}}},deleteAllDots:function(){var t=this.player.plugins.progress;if(!!t){if(!this._ispotsInit){this._ispots=[];return}for(var e=t.root.getElementsByTagName("xg-spot"),n=e.length-1;n>=0;n--)t.outer.removeChild(e[n]);this._ispots=[]}},updateAllDots:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.player.plugins.progress;if(!!n){if(!this._ispotsInit){this._ispots=e;return}this._ispots=[];var i=n.root.getElementsByTagName("xg-spot"),r=i.length;if(r>e.length)for(var o=r-1;o>e.length-1;o--)n.outer.removeChild(i[o]);e.map(function(e,n){n<r?(i[n].setAttribute("data-id","".concat(e.id)),t._ispots.push(e),t.updateDot(e)):t.createDot(e)})}},updateAllDotsStyles:function(){var t=this,e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],n=this.player.plugins.progress;if(!!(null!=n&&n.root))for(var i=n.root.getElementsByTagName("xg-spot"),r=function(n){var r=(n=i[a]).getAttribute("data-id"),s=t.findDot(r);if(s&&s.activeStyle&&s.style&&s.stylePreferred){var u=e?null==s?void 0:s.activeStyle:null==s?void 0:s.style;u&&Object.keys(u).map(function(t){n.style[t]=u[t]})}o=n},o,a=0;a<i.length;a++)r(o)},getAllDotsDom:function(){var t=this.player.plugins.progress;return t?t.root.getElementsByTagName("xg-spot"):[]},getDotDom:function(t){var e=this.player.plugins.progress;if(!!e)return e.find('xg-spot[data-id="'.concat(t,'"]'))}};function aT(t){return(aT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function aE(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,aA(i.key),i)}}function aC(t,e){return(aC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ax(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aj(t){return(aj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function aR(t,e,n){return(e=aA(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aA(t){var e=function(t,e){if("object"!==aT(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==aT(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===aT(e)?e:String(e)}var aL={dragmove:"onProgressDragMove",dragstart:"onProgressDragStart",dragend:"onProgressDragEnd",click:"onProgressClick",mouseover:"onProgressMouseOver",mouseenter:"onProgressMouseEnter",mouseleave:"onProgressMouseLeave"},aI=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aC(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=aj(e);return t=n?Reflect.construct(i,arguments,aj(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===aT(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return ax(t)}(this,t)});function s(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),aR(ax(e=a.call(this,t)),"onMousemove",function(t){if(!e.config.disable){if(k.hasClass(t.target,"xg-spot-content")&&e.config.isHideThumbnailHover){e.player.plugins.progress.onMouseLeave(t);return}(e._state.f||k.hasClass(t.target,"xg-spot-content"))&&(k.event(t),t.stopPropagation())}}),aR(ax(e),"onMousedown",function(t){if(!e.config.disable)(e._state.f||k.hasClass(t.target,"xg-spot-content"))&&(k.event(t),t.stopPropagation())}),aR(ax(e),"onMouseup",function(t){if(!!e.isDrag){var n=e.player.plugins.progress;n&&n.pos&&(n.onMouseUp(t),n.pos.isEnter||n.onMouseLeave(t))}}),aR(ax(e),"onDotMouseLeave",function(t){if(!e.config.disable){e._curDot.removeEventListener("mouseleave",e.onDotMouseLeave),e.blurDot(t.target),e._curDot=null;var n=e.player.plugins.progress;n&&n.enableBlur(),e.show()}}),aR(ax(e),"onProgressMouseLeave",function(t,n){e.updateAllDotsStyles(!1)}),aR(ax(e),"onProgressMouseOver",function(t,n){if(!e.config.disable&&!!e.player){var i,r=n.target,o=e.player.plugins.progress,a=!!(null!=o&&null!==(i=o.config)&&void 0!==i&&i.resetBlur);if(k.hasClass(r,"xgplayer-spot")&&(!e._curDot||a&&!e._curDot.contains(r)&&e._curDot!==r)){var s=e._curDot;e._curDot=r,null==s||s.removeEventListener("mouseleave",e.onDotMouseLeave),e._curDot.addEventListener("mouseleave",e.onDotMouseLeave),e.focusDot(r),e._curDot.children.length>0&&e.hide(),null==o||o.disableBlur()}else a&&(null==o||o.enableBlur())}}),e._ispots=[],e.videoPreview=null,e.videothumbnail=null,e.thumbnail=null,e._state={now:0,f:!1},e}return i=s,o=[{key:"pluginName",get:function(){return"progresspreview"}},{key:"defaultConfig",get:function(){return{index:1,miniWidth:6,ispots:[],defaultText:"",isFocusDots:!0,isHideThumbnailHover:!0,isShowThumbnail:!0,isShowCoverPreview:!1,mode:"",disable:!1,width:160,height:90,isDotAdaptWidth:!0}}}],r=[{key:"beforeCreate",value:function(t){var e=t.player.plugins.progress;e&&(t.root=e.root)}},{key:"afterCreate",value:function(){var t,e,n,i,r=this;this._curDot=null,this.handlerSpotClick=this.hook("spotClick",function(t,e){e.time&&r.player.seek(e.time)}),t=this,e=t.config,n=t.player,Object.keys(aO).map(function(e){t[e]=aO[e].bind(t)}),i=n.config.progressDot||e.ispots||[],t._ispots=i.map(function(t){return aP(t),t}),t._ispotsInit=!1,n.once(B,function(){t.initDots()}),this.config.disable&&this.disable(),this.extTextRoot=this.find(".xg-spot-ext-text")}},{key:"setConfig",value:function(t){var e=this;if(!!t)Object.keys(t).map(function(n){e.config[n]=t[n]})}},{key:"onPluginsReady",value:function(){if(!!this.player.plugins.progress)this.previewLine=this.find(".xg-spot-line"),this.timePoint=this.find(".xgplayer-progress-point"),this.timeText=this.find(".xg-spot-time"),this.tipText=this.find(".spot-inner-text"),this._hasThumnail=!1,this.registerThumbnail(),this.bindEvents()}},{key:"bindEvents",value:function(){var t=this,e=this.player.plugins.progress;if(!!e){if(Object.keys(aL).map(function(n){t[aL[n]]=t[aL[n]].bind(t),e.addCallBack(n,t[aL[n]])}),"mobile"!==tZ.device){this.bind(".xg-spot-info","mousemove",this.onMousemove),this.bind(".xg-spot-info","mousedown",this.onMousedown),this.bind(".xg-spot-info","mouseup",this.onMouseup);var n=this.hook("previewClick",function(){});this.handlerPreviewClick=function(e){e.stopPropagation(),n(parseInt(1e3*t._state.now,10)/1e3,e)},this.bind(".xg-spot-content","mouseup",this.handlerPreviewClick)}}}},{key:"onProgressMouseEnter",value:function(t,e){this.onProgressMove(t,e),this.updateAllDotsStyles(!0)}},{key:"onProgressMove",value:function(t,e){if(!this.config.disable&&!!this.player.duration)this.updatePosition(t.offset,t.width,t.currentTime,t.e)}},{key:"onProgressDragMove",value:function(t,e){if(!this.config.disable&&!!this.player.duration)this.onProgressMove(t,e)}},{key:"onProgressDragStart",value:function(t){if(!this.config.disable&&!!this.player.duration)this.isDrag=!0,this.videoPreview&&k.addClass(this.videoPreview,"show")}},{key:"onProgressDragEnd",value:function(t){if(!this.config.disable&&!!this.player.duration)this.isDrag=!1,this.videoPreview&&k.removeClass(this.videoPreview,"show")}},{key:"onProgressClick",value:function(t,e){if(!this.config.disable){if(k.hasClass(e.target,"xgplayer-spot")){e.stopPropagation(),e.preventDefault();var n={};["time","id","text"].map(function(t){n[t]=e.target.getAttribute("data-".concat(t))}),n.time&&(n.time=Number(n.time)),this.handlerSpotClick(e,n)}}}},{key:"updateLinePos",value:function(t,e){var n,i,r=this.root,o=this.previewLine,a=this.timePoint,s=this.player,u=this.config,c="flex"===s.controls.mode,l=r.getBoundingClientRect().width;if(!!l||!this._hasThumnail){var f=a.getBoundingClientRect().width,h=t-(l=this._hasThumnail&&l<u.width?u.width:l)/2;h<0&&!c?(h=0,n=t-l/2,this.thumbnail||(i=t-l/2-f/2)):h>e-l&&!c?(n=h-(e-l),this.thumbnail||(i=h-(e-l)-f/2),h=e-l):(n=0,this.thumbnail||(i=-f/2)),void 0!==n&&(o.style.transform="translateX(".concat(n.toFixed(2),"px)")),void 0!==i&&(a.style.transform="translateX(".concat(i.toFixed(2),"px)")),r.style.transform="translateX(".concat(h.toFixed(2),"px) translateZ(0)")}}},{key:"updateTimeText",value:function(t){var e=this.timeText,n=this.timePoint;e.textContent=t,this.thumbnail||(n.textContent=t)}},{key:"updatePosition",value:function(t,e,n,i){var r=this.root,o=this.config,a=this._state;if(!!r){this.updateLinePos(t,e),a.now=n;var s=k.format(n);i&&i.target&&k.hasClass(i.target,"xgplayer-spot")?(this.showTips(i.target.getAttribute("data-text"),!1,s),this.focusDot(i.target),a.f=!0,o.isFocusDots&&a.f&&(a.now=parseInt(i.target.getAttribute("data-time"),10))):o.defaultText?(a.f=!1,this.showTips(o.defaultText,!0,s)):(a.f=!1,this.hideTips("")),this.updateTimeText(s),this.updateThumbnails(a.now)}}},{key:"updateThumbnails",value:function(t){var e=this.player,n=this.videoPreview,i=this.config,r=e.plugins.thumbnail;if(r&&r.usable){this.thumbnail&&r.update(this.thumbnail,t,i.width,i.height);var o=n&&n.getBoundingClientRect();this.videothumbnail&&r.update(this.videothumbnail,t,o.width,o.height)}}},{key:"registerThumbnail",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("mobile"!==tZ.device){var e=this.player,n=this.config,i=e.getPlugin("thumbnail");if(i&&i.setConfig(t),i&&i.usable&&n.isShowThumbnail)k.removeClass(this.root,"short-line no-thumbnail");else{k.addClass(this.root,"short-line no-thumbnail");return}"short"===n.mode&&k.addClass(this.root,"short-line"),this._hasThumnail=!0;var r=this.find(".xg-spot-thumbnail");this.thumbnail=i.createThumbnail(r,"progress-thumbnail"),n.isShowCoverPreview&&(this.videoPreview=k.createDom("xg-video-preview","",{},"xgvideo-preview"),e.root.appendChild(this.videoPreview),this.videothumbnail=i.createThumbnail(this.videoPreview,"xgvideo-thumbnail")),this.updateThumbnails(0)}}},{key:"calcuPosition",value:function(t,e){var n=this.player.plugins.progress,i=this.player;t+e>i.duration&&(e=i.duration-t);var r={left:t/i.duration*100,width:e/i.duration*100,isMini:!1};if(this.config.isDotAdaptWidth){var o=0;if(i.duration>0){var a=n.root.getBoundingClientRect().width;o=i.duration/a*6}r.isMini=o>e}else r.isMini=!0;return r}},{key:"showDot",value:function(t){var e=this.findDot(t);if(e){var n=this.root.getBoundingClientRect().width,i=e.time/this.player.duration*n;this.updatePosition(i,n,e.time)}}},{key:"focusDot",value:function(t,e){if(!!t)!e&&(e=t.getAttribute("data-id")),k.addClass(t,"active"),this._activeDotId=e}},{key:"blurDot",value:function(t){if(!t){var e=this._activeDotId;t=this.getDotDom(e)}if(!!t)k.removeClass(t,"active"),this._activeDotId=null}},{key:"showTips",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(k.addClass(this.root,"no-timepoint"),!!t)k.addClass(this.find(".xg-spot-content"),"show-text"),e&&"production"===this.config.mode?(k.addClass(this.root,"product"),this.tipText.textContent=t):(k.removeClass(this.root,"product"),this.tipText.textContent=this._hasThumnail?t:"".concat(n," ").concat(t))}},{key:"hideTips",value:function(){k.removeClass(this.root,"no-timepoint"),this.tipText.textContent="",k.removeClass(this.find(".xg-spot-content"),"show-text"),k.removeClass(this.root,"product")}},{key:"hide",value:function(){k.addClass(this.root,"hide")}},{key:"show",value:function(){k.removeClass(this.root,"hide")}},{key:"enable",value:function(){var t=this.config,e=this.playerConfig;this.config.disable=!1,this.show(),!this.thumbnail&&t.isShowThumbnail&&this.registerThumbnail(e.thumbnail||{})}},{key:"disable",value:function(){this.config.disable=!0,this.hide()}},{key:"destroy",value:function(){var t=this,e=this.player.plugins.progress;e&&Object.keys(aL).map(function(n){e.removeCallBack(n,t[aL[n]])}),this.videothumbnail=null,this.thumbnail=null,this.videoPreview&&this.player.root.removeChild(this.videoPreview),this.unbind(".xg-spot-info","mousemove",this.onMousemove),this.unbind(".xg-spot-info","mousedown",this.onMousedown),this.unbind(".xg-spot-info","mouseup",this.onMouseup),this.unbind(".xg-spot-content","mouseup",this.handlerPreviewClick)}},{key:"render",value:function(){return"mobile"===tZ.device||"mobile"===this.playerConfig.isMobileSimulateMode?"":'<div class="xg-spot-info '.concat("short"===this.config.mode?"short-line":"",'">\n      <div class="xg-spot-content">\n        <div class="xg-spot-thumbnail">\n          <span class="xg-spot-time"></span>\n        </div>\n        <div class="xg-spot-text"><span class="spot-inner-text"></span></div>\n      </div>\n      <div class="xgplayer-progress-point">00:00</div>\n      <div class="xg-spot-ext-text"></div>\n      <div class="xg-spot-line"></div>\n    </div>')}}],aE(i.prototype,r),o&&aE(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function aD(t){return(aD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function aN(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==aD(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==aD(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===aD(e)?e:String(e)}(i.key),i)}}function aM(t,e){return(aM=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function aB(t){return(aB=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var aF=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aM(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=aB(e);return t=n?Reflect.construct(i,arguments,aB(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===aD(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(t){var e;return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),(e=a.call(this,t)).ratio=1,e.interval=null,e._preloadMark={},e}return i=s,o=[{key:"pluginName",get:function(){return"thumbnail"}},{key:"defaultConfig",get:function(){return{isShow:!1,urls:[],pic_num:0,col:0,row:0,height:90,width:160,scale:1,className:"",hidePortrait:!1}}}],r=[{key:"afterCreate",value:function(){var t=this;this.usable&&this.initThumbnail(),this.on([B],function(){var e=t.config,n=e.pic_num,i=e.interval;t.usable&&(t.interval=i>0?i:Math.round(1e3*t.player.duration/n)/1e3)})}},{key:"setConfig",value:function(t){var e=this;if(!t)return;var n=Object.keys(t);if(!(n.length<1))n.forEach(function(n){e.config[n]=t[n]}),this.usable&&this.initThumbnail()}},{key:"usable",get:function(){var t=this.config,e=t.urls,n=t.pic_num;return e&&e.length>0&&n>0}},{key:"initThumbnail",value:function(){var t=this.config,e=t.width,n=t.height,i=t.pic_num,r=t.interval;this.ratio=e/n*100,this.interval=r||Math.round(this.player.duration/i),this._preloadMark={}}},{key:"getUrlByIndex",value:function(t){return t>=0&&t<this.config.urls.length?this.config.urls[t]:""}},{key:"preload",value:function(t){var e=this;if(!this._preloadMark[t]){var n=this.config.urls,i=n.length,r=[];t>0&&r.push(t-1),r.push(t),t>0&&t<i-1&&r.push(t+1),r.map(function(t){!e._preloadMark[t]&&t>=0&&t<i&&(e._preloadMark[t]=1,k.preloadImg(n[t],function(){e._preloadMark[t]=2}))})}}},{key:"getPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.config,r=i.pic_num,o=i.row,a=i.col,s=i.width,u=i.height;this.interval=Math.round(this.player.duration/r);var c=Math.ceil(t/this.interval),l=(c=c>r?r:c)<o*a?0:Math.ceil(c/(o*a))-1,f=c-a*o*l,h=f>0?Math.ceil(f/a)-1:0,p=f>0?f-h*a-1:0,d=0,y=0;e&&n?e/n<s/u?d=s/u*(y=n):y=(d=e)/(s/u):n?!e&&(y=n||u,d=s/u*y):y=(d=e||s)/(s/u);var v=this.getUrlByIndex(l);return{urlIndex:l,rowIndex:h,colIndex:p,url:v,height:y,width:d,style:{backgroundImage:"url(".concat(v,")"),backgroundSize:"".concat(d*a,"px auto"),backgroundPosition:"-".concat(p*d,"px -").concat(h*y,"px"),width:"".concat(d,"px"),height:"".concat(y,"px")}}}},{key:"update",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=this.config,a=o.pic_num,s=o.urls;if(!(a<=0)&&!!s&&0!==s.length){var u=this.getPosition(e,n,i);this.preload(u.urlIndex),Object.keys(u.style).map(function(e){t.style[e]=u.style[e]}),Object.keys(r).map(function(e){t.style[e]=r[e]})}}},{key:"changeConfig",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setConfig(t)}},{key:"createThumbnail",value:function(t,e){var n=k.createDom("xg-thumbnail","",{},"thumbnail ".concat(e));return t&&t.appendChild(n),n}}],aN(i.prototype,r),o&&aN(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function aH(t){return(aH="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function aU(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==aH(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==aH(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===aH(e)?e:String(e)}(i.key),i)}}function aW(t,e){return(aW=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function aV(t){return(aV=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var aG=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aW(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=aV(e);return t=n?Reflect.construct(i,arguments,aV(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===aH(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,o=[{key:"pluginName",get:function(){return"MiniProgress"}},{key:"defaultConfig",get:function(){return{}}}],r=[{key:"afterCreate",value:function(){}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cached:0,played:0},e=arguments.length>1?arguments[1]:void 0;if(!!e&&!!this.root)t.cached&&(this.find("xg-mini-progress-cache").style.width="".concat(t.cached/e*100,"%")),t.played&&(this.find("xg-mini-progress-played").style.width="".concat(t.played/e*100,"%"))}},{key:"render",value:function(){if(!!this.playerConfig.progress&&!!this.playerConfig.miniprogress)return'<xg-mini-progress class="xg-mini-progress">\n    <xg-mini-progress-cache class="xg-mini-progress-cache"></xg-mini-progress-cache>\n    <xg-mini-progress-played class="xg-mini-progress-played"></xg-mini-progress-played>\n    </xg-mini-progress>'}}],aU(i.prototype,r),o&&aU(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function az(t){return(az="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function aK(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,aZ(i.key),i)}}function aY(t,e){return(aY=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function aX(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aq(t){return(aq=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function aJ(t,e,n){return(e=aZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aZ(t){var e=function(t,e){if("object"!==az(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==az(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===az(e)?e:String(e)}var a$={REAL_TIME:"realtime",FIRST_FRAME:"firstframe",POSTER:"poster"},aQ=null,a0=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aY(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=aq(e);return t=n?Reflect.construct(i,arguments,aq(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===az(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return aX(t)}(this,t)});function s(){var t;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return aJ(aX(t=a.call.apply(a,[this].concat(n))),"onLoadedData",function(e){if(!!t.player)t._frameCount=t.config.startFrameCount,t.stop(),t.renderOnTimeupdate(e),t.off(I,t.renderOnTimeupdate),t.on(I,t.renderOnTimeupdate)}),aJ(aX(t),"onVisibilitychange",function(e){"visible"===document.visibilityState?t._checkIfCanStart()&&t.start():"hidden"===document.visibilityState&&t.stop()}),aJ(aX(t),"renderOnTimeupdate",function(e){if(t._frameCount>0)t.renderOnce(),t._frameCount--;else{t._isLoaded=!0,t.off(I,t.renderOnTimeupdate);var n=t.config.startInterval;!t.player.paused&&t._checkIfCanStart()&&t.start(0,n)}}),aJ(aX(t),"start",function(e,n){var i=t.player.video,r=function(){try{return parseInt(window.performance.now(),10)}catch(t){return new Date().getTime()}}(),o=t.checkVideoIsSupport(i);if(!!o&&!!t.canvasCtx)!n&&(n=t.interval),t.stop(),i.videoWidth&&i.videoHeight&&(t.videoPI=i.videoHeight>0?parseInt(i.videoWidth/i.videoHeight*100,10):0,t.config.mode===a$.REAL_TIME?(i&&i.videoWidth&&t.update(o,t.videoPI),t.preTime=r):r-t.preTime>=n&&(i&&i.videoWidth&&t.update(o,t.videoPI),t.preTime=r)),t.frameId="timer"===t._loopType?k.setTimeout(aX(t),t.start,n):k.requestAnimationFrame(t.start)}),aJ(aX(t),"stop",function(){t.frameId&&("timer"===t._loopType?k.clearTimeout(aX(t),t.frameId):k.cancelAnimationFrame(t.frameId),t.frameId=null)}),t}return i=s,r=[{key:"afterCreate",value:function(){var t=this;!0===this.playerConfig.dynamicBg&&(this.config.disable=!1),!s.isSupport&&(this.config.disable=!0);var e=this.config,n=e.disable,i=e.mode,r=e.frameRate;if(n)return;this._pos={width:0,height:0,rwidth:0,rheight:0,x:0,y:0,pi:0},this.isStart=!1,this._isLoaded=!1,this.videoPI=0,this.preTime=0,this.interval=parseInt(1e3/r,10),this.canvas=null,this.canvasCtx=null,this._frameCount=0,this._loopType=this.config.mode!==a$.REAL_TIME&&this.interval>=1e3?"timer":"animation";var o=function(){if(!!t.player)t.init(),t.renderByPoster(),!t.player.paused&&t.start()};if(this.player.hasStart?o():this.once(tn,o),i!==a$.POSTER)i!==a$.FIRST_FRAME&&(this.on(z,function(){t.stop()}),this.on(E,function(){var e=t.config.startInterval;t._checkIfCanStart()&&t.start(0,e)}),this.on(j,function(){t.stop()})),this.on(H,this.onLoadedData),this.on(G,function(){t._isLoaded=!1,t.stop()}),document.addEventListener("visibilitychange",this.onVisibilitychange)}},{key:"setConfig",value:function(t){var e=this;Object.keys(t).forEach(function(n){"root"===n&&t[n]!==e.config[n]?e.reRender(t[n]):"frameRate"===n?e.interval=parseInt(1e3/t[n],10):"disable"===n&&t[n]&&e.stop(),e.config[n]=t[n]})}},{key:"init",value:function(t){var e=this.player,n=this.config;this.canvasFilter=s.supportCanvasFilter();try{var i=t||n.root;!i&&(i=n.isInnerRender&&e.innerContainer||e.root),i.insertAdjacentHTML("afterbegin",'<div class="xgplayer-dynamic-bg" data-index="'.concat(n.index,'"><canvas>\n        </canvas><xgmask></xgmask></div>')),this.root=i.children[0],this.canvas=this.find("canvas"),!this.canvasFilter&&(this.canvas.style.filter=n.filter,this.canvas.style.webkitFilter=n.filter),this.mask=this.find("xgmask"),n.addMask&&(this.mask.style.background=n.maskBg),this.canvasCtx=this.canvas.getContext("2d")}catch(t){y.logError("plugin:DynamicBg",t)}}},{key:"reRender",value:function(t){if(!!this.config.disable||!!this.root){this.stop();var e=this.root?this.root.parentElement:null;if(e!==t&&e.removeChild(this.root),!t){this.root=null;return}this.init(t),this.renderOnce();var n=this.config.startInterval;this._checkIfCanStart()&&this.start(0,n)}}},{key:"checkVideoIsSupport",value:function(t){if(!t)return null;var e=t&&t instanceof window.HTMLVideoElement?t:t.canvas?t.canvas:t.flyVideo?t.flyVideo:null;if(e&&!("safari"===tZ.browser&&k.isMSE(e)))return e;var n=e?e.tagName.toLowerCase():"";return"canvas"===n||"img"===n?e:null}},{key:"renderByPoster",value:function(){var t=this.playerConfig.poster;if(t){var e="String"===k.typeOf(t)?t:"String"===k.typeOf(t.poster)?t.poster:null;this.updateImg(e)}}},{key:"_checkIfCanStart",value:function(){var t=this.config.mode;return this._isLoaded&&!this.player.paused&&t!==a$.FIRST_FRAME&&t!==a$.POSTER}},{key:"renderOnce",value:function(){var t=this.player.video;if(!!t.videoWidth&&!!t.videoHeight){this.videoPI=parseInt(t.videoWidth/t.videoHeight*100,10);var e=this.checkVideoIsSupport(t);e&&this.update(e,this.videoPI)}}},{key:"updateImg",value:function(t){var e=this;if(!!t){var n=this.canvas.getBoundingClientRect(),i=n.width,r=n.height,o=new window.Image;o.onload=function(){if(!!e.canvas&&!e.frameId&&!e.isStart){e.canvas.height=r,e.canvas.width=i;var t=parseInt(i/r*100,10);e.update(o,t),o=null}},o.src=t}}},{key:"update",value:function(t,e){if(!!this.canvas&&!!this.canvasCtx&&!!e)try{var n=this._pos,i=this.config,r=this.canvas.getBoundingClientRect(),o=r.width,a=r.height;if(o!==n.width||a!==n.height||n.pi!==e){var s=parseInt(o/a*100,10);n.pi=e,n.width!==o&&(n.width=this.canvas.width=o),n.height!==a&&(n.height=this.canvas.height=a);var u=a,c=o;s<e?c=parseInt(a*e/100,10):s>e&&(u=parseInt(100*o/e,10)),n.rwidth=c*i.multiple,n.rheight=u*i.multiple,n.x=(o-n.rwidth)/2,n.y=(a-n.rheight)/2}this.canvasFilter&&(this.canvasCtx.filter=i.filter),this.canvasCtx.drawImage(t,n.x,n.y,n.rwidth,n.rheight)}catch(t){y.logError("plugin:DynamicBg",t)}}},{key:"destroy",value:function(){this.stop(),document.removeEventListener("visibilitychange",this.onVisibilitychange),this.canvasCtx=null,this.canvas=null}},{key:"render",value:function(){return""}}],o=[{key:"pluginName",get:function(){return"dynamicBg"}},{key:"defaultConfig",get:function(){return{isInnerRender:!1,disable:!0,index:-1,mode:"framerate",frameRate:10,filter:"blur(50px)",startFrameCount:2,startInterval:0,addMask:!0,multiple:1.2,maskBg:"rgba(0,0,0,0.7)"}}},{key:"isSupport",get:function(){return"boolean"==typeof aQ?aQ:aQ=function(){try{if(document.createElement("canvas").getContext)return!0;return!1}catch(t){return!1}}()}},{key:"supportCanvasFilter",value:function(){return!("safari"===tZ.browser||"firefox"===tZ.browser)}}],r&&aK(i.prototype,r),o&&aK(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function a1(t){return(a1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a2(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function a3(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a2(Object(n),!0).forEach(function(e){a8(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a2(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function a4(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,a7(i.key),i)}}function a6(t,e){return(a6=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function a5(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a9(t){return(a9=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a8(t,e,n){return(e=a7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a7(t){var e=function(t,e){if("object"!==a1(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==a1(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===a1(e)?e:String(e)}var st="info",se=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a6(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=a9(e);return t=n?Reflect.construct(i,arguments,a9(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===a1(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return a5(t)}(this,t)});function s(){var t;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return a8(a5(t=a.call.apply(a,[this].concat(n))),"_recordUserActions",function(e){var n=t._getTime(),i=Object.assign({},e,{msg:e.msg||e.action});t._stats[st].push(a3(a3({type:"userAction"},n),{},{payload:i}))}),a8(a5(t),"_onReset",function(){t.reset()}),a8(a5(t),"_recordInfo",function(e){t.info(e)}),a8(a5(t),"_downloadStats",function(){var e=new Blob([JSON.stringify(t.getStats())],{type:"application/json"}),n=window.URL.createObjectURL(e),i=document.createElement("a");i.style.display="none",i.href=n,i.download="player.txt",i.disabled=!1,i.click()}),t}return i=s,o=[{key:"pluginName",get:function(){return"stats"}},{key:"defaultConfig",get:function(){return{}}}],r=[{key:"_getTime",value:function(){return{timestamp:Date.now(),timeFormat:new Date().toISOString()}}},{key:"afterCreate",value:function(){this.reset(),this.on(tO,this._recordUserActions),this.on(tR.STATS_INFO,this._recordInfo),this.on(tR.STATS_DOWNLOAD,this._downloadStats),this.on(tR.STATS_RESET,this._onReset)}},{key:"destroy",value:function(){this.offAll()}},{key:"downloadStats",value:function(){this._downloadStats()}},{key:"info",value:function(t){t.profile?this._infoProfile(t):this._info(t)}},{key:"_info",value:function(t){var e=this._getTime();this._stats[st].push(a3(a3({},e),{},{payload:t}))}},{key:"_infoProfile",value:function(t){if(t&&t.startMs){var e=a3({cat:"function",dur:Date.now()-t.startMs,name:t.name||t.msg,ph:"X",pid:0,tid:0,ts:t.startMs,profile:!0},t);this._info(e)}}},{key:"reset",value:function(){var t;this._stats=(a8(t={},st,[]),a8(t,"media",{}),t)}},{key:"getStats",value:function(){for(var t=this.player.video,e=[],n=0;n<t.buffered.length;n++)e.push({start:t.buffered.start(n),end:t.buffered.end(n)});var i={currentTime:t.currentTime,readyState:t.readyState,buffered:e,paused:t.paused,ended:t.ended};return this._stats.media=i,{raw:this._stats,timestat:this._getTimeStats(),profile:this._getProfile()}}},{key:"_getTimeStats",value:function(){return this._stats[st].map(function(t){var e=t.payload.data,n="";try{e instanceof Error?n=e.msg:void 0!==e&&(n=JSON.stringify(e))}catch(t){}return"[".concat(t.timeFormat,"] : ").concat(t.payload.msg," ").concat(n," ")})}},{key:"_getProfile",value:function(){var t={traceEvents:[]};return this._stats[st].forEach(function(e){e.payload.profile&&t.traceEvents.push(e.payload)}),t}}],a4(i.prototype,r),o&&a4(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(e_);function sn(t){return(sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function si(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,ss(i.key),i)}}function sr(t,e){return(sr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function so(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sa(t){return(sa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ss(t){var e=function(t,e){if("object"!==sn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==sn(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===sn(e)?e:String(e)}var su=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sr(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=sa(e);return t=n?Reflect.construct(i,arguments,sa(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===sn(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return so(t)}(this,t)});function s(){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var t,e,n,i,r=arguments.length,o=Array(r),u=0;u<r;u++)o[u]=arguments[u];return e=so(t=a.call.apply(a,[this].concat(o))),n="onGapJump",i=function(){var e=so(t),n=e.player,i=e.config;if(n.video.readyState===HTMLMediaElement.HAVE_NOTHING)return;if(n.video.seeking){if(!t.seekingEventReceived)return}else t.seekingEventReceived=!1;if(n.video.paused&&0!==n.video.currentTime&&t.hasPlayed)return;var r=n.video.buffered,o=i.smallGapLimit||.5,a=i.gapDetectionThreshold||.3,u=n.video.currentTime,c=t._getIndex(r,u,a);if(null===c||0===c)return;var l=r.start(c)+.1;if(l>n.video.duration)return;var f=l-u;if(!(f<s.BROWSER_GAP_TOLERANCE))f<=o&&(!1!==i.useGapJump&&(n.video.currentTime=t.isSafari?l+.1:l),t.player&&t.player.emit("detectGap"),.08!==l&&n&&n.emit("log",{type:"oneevent",end_type:"gap",vid:n.config.vid,ext:{video_postion:Math.floor(1e3*l)}}))},(n=ss(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,t}return i=s,o=[{key:"pluginName",get:function(){return"gapJump"}},{key:"defaultConfig",get:function(){return{useGapJump:!1,smallGapLimit:.5,gapDetectionThreshold:.3}}}],r=[{key:"afterCreate",value:function(){var t=this;if(!1!==this.config.useGapJump)this.hasPlayed=!1,this.seekingEventReceived=!1,this.isSafari=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),this.on(D,this.onGapJump),this.on(E,function(){t.hasPlayed=!0}),this.on(A,function(){t.seekingEventReceived=!0})}},{key:"_getIndex",value:function(t,e,n){if(!t||!t.length||1===t.length&&t.end(0)-t.start(0)<1e-6)return null;for(var i=this._getBuffered(t),r=null,o=0;o<i.length;o++)if(i[o].start>e&&(0===o||i[o-1].end-e<=n)){r=o;break}return r}},{key:"_getBuffered",value:function(t){if(!t)return[];for(var e=[],n=0;n<t.length;n++)e.push({start:t.start(n),end:t.end(n)});return e}}],si(i.prototype,r),o&&si(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function sc(t){return(sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}su.BROWSER_GAP_TOLERANCE=.001;function sl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,sy(i.key),i)}}function sf(t,e){return(sf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function sh(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sp(t){return(sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sd(t,e,n){return(e=sy(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sy(t){var e=function(t,e){if("object"!==sc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==sc(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===sc(e)?e:String(e)}var sv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sf(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=sp(e);return t=n?Reflect.construct(i,arguments,sp(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===sc(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return sh(t)}(this,t)});function s(){var t;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return sd(sh(t=a.call.apply(a,[this].concat(n))),"onWaiting",function(){var e=sh(t).config;if(!(t.jumpCnt>e.jumpCntMax)&&!t.timer&&!1!==e.useWaitingTimeoutJump)t.timer=setTimeout(t.onJump,1e3*e.waitingTime)}),sd(sh(t),"onJump",function(){var e=sh(t),n=e.player,i=e.config;if(clearTimeout(t.timer),t.timer=null,t.jumpCnt>i.jumpCntMax||!1===i.useWaitingTimeoutJump||n.video.paused&&0!==n.video.currentTime&&t.hasPlayed)return;t.jumpSize=i.jumpSize*(t.jumpCnt+1),t.jumpCnt===i.jumpSize&&t.jumpSize<6&&(t.jumpSize=6);var r=n.currentTime+t.jumpSize;if(!(r>n.video.duration))t.jumpCnt++,n.currentTime=r}),t}return i=s,o=[{key:"pluginName",get:function(){return"waitingTimeoutJump"}},{key:"defaultConfig",get:function(){return{useWaitingTimeoutJump:!1,waitingTime:15,jumpSize:2,jumpCntMax:4}}}],r=[{key:"afterCreate",value:function(){var t=this,e=this.config,n=e.useWaitingTimeoutJump,i=e.jumpSize;if(!1!==n)this.hasPlayed=!1,this.jumpCnt=0,this.timer=null,this.jumpSize=i,this.on(D,this.onWaiting),this.on([C,N],function(){clearTimeout(t.timer),t.timer=null,t.jumpSize=t.config.jumpSize}),this.on(E,function(){t.hasPlayed=!0})}}],sl(i.prototype,r),o&&sl(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function sg(t){return(sg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sm(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function sb(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,sP(i.key),i)}}function sw(t,e){return(sw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function sk(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s_(t){return(s_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sS(t,e,n){return(e=sP(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sP(t){var e=function(t,e){if("object"!==sg(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==sg(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===sg(e)?e:String(e)}var sO=["cdn"],sT=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sw(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=s_(e);return t=n?Reflect.construct(i,arguments,s_(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===sg(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return sk(t)}(this,t)});function s(){var t;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s);for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return sS(sk(t=a.call.apply(a,[this].concat(n))),"startTimer",function(){if(!k.isMSE(t.player.video))t.cnt=0,t.timer=setTimeout(t.testSpeed,t.config.testTimeStep)}),sS(sk(t),"initSpeedList",function(){sO.forEach(function(t){s.speedListCache[t]||(s.speedListCache[t]=[])})}),sS(sk(t),"_onRealSpeedChange",function(e){e.speed&&t.appendList(e.speed,e.len,e.time,e.type||"cdn")}),sS(sk(t),"testSpeed",function(){if(clearTimeout(t.timer),t.timer=null,t.player&&t.config.openSpeed){var e=t.config,n=e.url,i=e.loadSize,r=e.testCnt,o=e.testTimeStep,a=n+(0>n.indexOf("?")?"?testst=":"&testst=")+Date.now();if(!(t.cnt>=r)){t.cnt++;try{var s=new Date().getTime(),u=null,c=new XMLHttpRequest;t.xhr=c,c.open("GET",a);var l={},f=Math.floor(10*Math.random());l.Range="bytes="+f+"-"+(i+f),l&&Object.keys(l).forEach(function(t){c.setRequestHeader(t,l[t])}),c.onreadystatechange=function(){if(4===c.readyState){t.xhr=null,u=new Date().getTime();var e=c.getResponseHeader("Content-Length")/1024*8,n=u-s,i=Math.round(1e3*e/n);t.appendList(i,e,n),t.timer=setTimeout(t.testSpeed,o)}},c.send()}catch(t){}}}}),sS(sk(t),"appendList",function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"cdn";if(s.speedListCache&&s.speedListCache[r]){var o=t.config.saveSpeedMax;s.speedListCache[r].length>=o&&s.speedListCache[r].shift(),s.speedListCache[r].push({speed:e,bytes:n,time:i});var a=sk(t).player;a&&("cdn"===r?a.realTimeSpeed=e:a[t.getSpeedName("realTime",r)]=e),t.updateSpeed(r)}}),sS(sk(t),"updateSpeed",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cdn",n=s.getAvgSpeedKbs(e),i=sk(t).player;if(i){if("cdn"===e)(!i.avgSpeed||n!==i.avgSpeed)&&(i.avgSpeed=n,i.emit(ta,{speed:n,realTimeSpeed:i.realTimeSpeed}));else{var r=t.getSpeedName("avg",e);(!i[r]||n!==i[r])&&(i[r]=n,i.emit(ta,{speed:n,realTimeSpeed:i.realTimeSpeed}))}}}),t}return i=s,r=[{key:"afterCreate",value:function(){var t,e=this.config,n=e.openSpeed,i=e.addSpeedTypeList,r=e.testCnt;if((null==i?void 0:i.length)>0){;sO.push.apply(sO,function(t){if(Array.isArray(t))return sm(t)}(t=i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return sm(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sm(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}if(this.initSpeedList(),!!n)this.on("real_time_speed",this._onRealSpeedChange),this.timer=null,this.cnt=0,this.xhr=null,r>0&&this.on([H,ti],this.startTimer)}},{key:"getSpeedName",value:function(t,e){return t+"Speed"+e.toUpperCase()}},{key:"openSpeed",get:function(){return this.config.openSpeed},set:function(t){if(this.config.openSpeed=t,!t&&this.timer){clearTimeout(this.timer),this.timer=null;return}if(this.config.openSpeed){if(this.timer)return;this.timer=setTimeout(this.testSpeed,this.config.testTimeStep)}}},{key:"destroy",value:function(){this.off("real_time_speed",this._onRealSpeedChange),this.off([H,ti],this.startTimer),clearTimeout(this.timer),this.timer=null,this.xhr&&4!==this.xhr.readyState&&(this.xhr.cancel&&this.xhr.cancel(),this.xhr=null)}}],o=[{key:"pluginName",get:function(){return"testspeed"}},{key:"speedSampleList",get:function(){return s.speedListCache}},{key:"defaultConfig",get:function(){return{openSpeed:!1,testCnt:3,loadSize:204800,testTimeStep:3e3,url:"",saveSpeedMax:20,addSpeedTypeList:[]}}},{key:"getAvgSpeedKbs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cdn";if(!s.speedListCache||!s.speedListCache[t]||s.speedListCache[t].length<=0)return -1;var e=0;return s.speedListCache[t].map(function(t){e+=t.speed}),Math.floor(e/s.speedListCache[t].length)}},{key:"getWeightedSpeedKbs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cdn",e=-1;if(!s.speedListCache||!s.speedListCache[t]||s.speedListCache[t].length<=0)return e;var n=[];s.speedListCache[t].forEach(function(t){n.push(t)}),n.sort(function(t,e){return t.speed-e.speed});for(var i=n.length,r=0,o=0;o<i;o++)r+=n[o].bytes;r/=2;for(var a=0;a<i;a++)(r-=n[a].bytes)<=0&&(e=n[a].speed);return e<0?-1:e}}],r&&sb(i.prototype,r),o&&sb(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function sE(t){return(sE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}sS(sT,"speedListCache",{});function sC(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==sE(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==sE(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===sE(e)?e:String(e)}(i.key),i)}}function sx(t,e){return(sx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function sj(t){return(sj=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var sR=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sx(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=sj(e);return t=n?Reflect.construct(i,arguments,sj(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===sE(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,o=[{key:"pluginName",get:function(){return"FpsDetect"}},{key:"defaultConfig",get:function(){return{disabled:!1,tick:1e3,stuckCount:3,reportFrame:0}}}],r=[{key:"afterCreate",value:function(){var t=this,e=this.player,n=this.config,i=e.media||e.video;!n.disabled&&i.getVideoPlaybackQuality&&(this.timer=null,this._resetData(),this.on(G,function(){t._resetData(),t._stopTick()}),this.on(E,function(){t._startTick()}),this.on(j,function(){t._stopTick()}),this.on(x,function(){t._stopTick()}),this.on(z,function(){t._stopTick()}))}},{key:"_startTick",value:function(){var t=this;this._stopTick(),this._timer=setTimeout(function(){t._checkDecodeFPS(),t._startTick()},this.config.tick)}},{key:"_stopTick",value:function(){clearTimeout(this._timer),this._timer=null}},{key:"_checkBuffer",value:function(t,e){for(var n=!1,i=[],r=0;r<e.length;r++){var o=e.start(r),a=e.end(r);if(i.push({start:o,end:a}),o<=t&&t<=a-1){n=!0;break}}return{enoughBuffer:n,buffers:i}}},{key:"_checkStuck",value:function(t,e,n,i){var r=this.player.media||this.player.video,o=document.hidden,a=r.paused,s=r.readyState,u=r.currentTime,c=r.buffered;if(o||a||s<4)return;var l=this._checkBuffer(u,c),f=l.enoughBuffer,h=l.buffers;if(!!f)t<=this.config.reportFrame?(this._currentStuckCount++,this._payload.push({currentTime:u,buffers:h,curDecodedFrames:t,totalVideoFrames:e,droppedVideoFrames:n,checkInterval:i}),this._currentStuckCount>=this.config.stuckCount&&(this.emit(tA,this._payload),this._resetCheck())):this._resetCheck()}},{key:"_resetCheck",value:function(){this._payload=[],this._currentStuckCount=0}},{key:"_resetData",value:function(){this._lastDecodedFrames=0,this._currentStuckCount=0,this._lastCheckPoint=null,this._payload=[]}},{key:"_checkDecodeFPS",value:function(){var t,e,n=(null===(t=this.player)||void 0===t?void 0:t.media)||(null===(e=this.player)||void 0===e?void 0:e.video);if(!n){this._stopTick();return}var i=n.getVideoPlaybackQuality(),r=i.totalVideoFrames,o=i.droppedVideoFrames,a=performance.now();if(r&&this._lastCheckPoint){var s=r-this._lastDecodedFrames,u=a-this._lastCheckPoint;this._checkStuck(s,r,o,u)}this._lastDecodedFrames=r,this._lastCheckPoint=a}},{key:"destroy",value:function(){this._stopTick(),this._resetData()}}],sC(i.prototype,r),o&&sC(i,o),Object.defineProperty(i,"prototype",{writable:!1}),s}(eD);function sA(t){return(sA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sL(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function sI(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){var e=function(t,e){if("object"!==sA(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==sA(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===sA(e)?e:String(e)}(i.key),i)}}e8.use({LANG:"zh-cn",TEXT:{ERROR_TYPES:{network:{code:1,msg:""},mse:{code:2,msg:""},parse:{code:3,msg:""},format:{code:4,msg:""},decoder:{code:5,msg:""},runtime:{code:6,msg:""},timeout:{code:7,msg:""},other:{code:8,msg:""}},HAVE_NOTHING:"/",HAVE_METADATA:"/",HAVE_CURRENT_DATA:"/",HAVE_FUTURE_DATA:"",HAVE_ENOUGH_DATA:"",NETWORK_EMPTY:"/",NETWORK_IDLE:"/",NETWORK_LOADING:"",NETWORK_NO_SOURCE:"/",MEDIA_ERR_ABORTED:"",MEDIA_ERR_NETWORK:"",MEDIA_ERR_DECODE:"",MEDIA_ERR_SRC_NOT_SUPPORTED:"/",REPLAY:"",ERROR:"",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:"",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:"",EXITFULLSCREEN_TIPS:"",CSSFULLSCREEN_TIPS:"",EXITCSSFULLSCREEN_TIPS:"",TEXTTRACK:"",PIP:"",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"",MINISCREEN:"",REFRESH_TIPS:"",REFRESH:"",FORWARD:"",LIVE_TIP:""}});var sD=(r=function t(e,n){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,t);var i,r,o,a,s=n&&"mobile"===n.isMobileSimulateMode,u=n.isLive,c=[].concat(u?[]:[rb,aG,aI,r0],[rD,rX,oa,oj,at,aa,oH,oK,r8,oS]),l=[nH,nz,n0,rr,n6,ag,a_,aF,iS];this.plugins=[nD,se,sv,su].concat(function(t){if(Array.isArray(t))return sL(t)}(i=c)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return sL(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sL(t,e)}}(i)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),l);var f=s?"mobile":tZ.device;switch(f){case"pc":(r=this.plugins).push.apply(r,[i7,iL,ah,sT,sR]);break;case"mobile":(o=this.plugins).push.apply(o,[iQ]);break;default:(a=this.plugins).push.apply(a,[i7,iL,ah])}(tZ.os.isIpad||"pc"===f)&&this.plugins.push(a0),tZ.os.isIpad&&this.plugins.push(iL),this.ignores=[],this.i18n=[]},Object.defineProperty(r,"prototype",{writable:!1}),r);function sN(t){return(sN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sM(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,sU(i.key),i)}}function sB(t,e){return(sB=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function sF(t){return(sF=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function sH(t,e,n){return(e=sU(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sU(t){var e=function(t,e){if("object"!==sN(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!==sN(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===sN(e)?e:String(e)}var sW=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sB(t,e)}(s,t);var e,n,i,r,o,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,i=sF(e);return t=n?Reflect.construct(i,arguments,sF(this).constructor):i.apply(this,arguments),function(t,e){if(e&&("object"===sN(e)||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,s),a.apply(this,arguments)}return i=s,Object.defineProperty(i,"prototype",{writable:!1}),i}(n_);sH(sW,"defaultPreset",sD),sH(sW,"Util",k),sH(sW,"Sniffer",tZ),sH(sW,"Errors",T),sH(sW,"Events",s),sH(sW,"Plugin",eD),sH(sW,"BasePlugin",e_),sH(sW,"I18N",e8),sH(sW,"STATE_CLASS",eW),sH(sW,"PAUSE_TYPES",ei),sH(sW,"BUFFER_CONTROL_TYPES",er),sH(sW,"InstManager",na),sH(sW,"TestSpeed",sT);var sV=sW;try{window.pre_build_xgplayer=u}catch(t){}}(),{}}()});